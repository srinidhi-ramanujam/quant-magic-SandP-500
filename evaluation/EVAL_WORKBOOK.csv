Testrun_ID,Timestamp,Tier,Question,SQL_template,SQL_generated,Answer_received,Answer_expected,Quality,Confidence,Generation_method,SQL_validation_result,SQL_validation_confidence,LLM_calls,Total_latency_s,Entity_extraction_s,SQL_generation_s,Query_execution_s,Response_formatting_s
RUN_021,"10 Nov 2025, 1300 hours",simple,How many S&P 500 companies are in the Information Technology sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%information technology%'),There are 165 companies in the Information Technology sector.,"{""value"": 165, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.2141,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,Which sector has the most companies in our S&P 500 dataset?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,0.1058,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are incorporated in Delaware?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('DE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('DE'))
  )
",Count: 346,"{""value"": 346, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0595,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What currency is used most frequently in the numerical data?,most_common_currency,"SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL GROUP BY 1 ORDER BY fact_count DESC LIMIT 1",currency: USD | fact_count: 14760135,"{""value"": ""USD"", ""type"": ""text""}",5.0,0.65,template,,,,0.9371,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many financial facts have footnotes?,fact_count_with_footnotes,SELECT COUNT(*) AS fact_count FROM num WHERE footnote IS NOT NULL AND TRIM(CAST(footnote AS VARCHAR)) <> '',Count: 33959,"{""value"": 33959, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0204,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,Which company has CIK 0000066740?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000066740' LIMIT 1,3M CO's CIK is unknown.,"{""value"": ""3M CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0091,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are in the Health Care sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%health care%'),There are 80 companies in the Health Care sector.,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.9936,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What is the most recent filing date in the dataset?,latest_filing_date,SELECT MAX(filed) AS latest_filing_date FROM sub,latest_filing_date: 2025-06-30 00:00:00,"{""value"": ""2025-06-30 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,1.0222,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies filed 10-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-K'),Count: 563,"{""value"": 563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,1.0143,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,Which state has the most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 1
",state: CA | count: 123,"{""value"": ""CA"", ""type"": ""text""}",5.0,0.65,template,,,,0.0171,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many different fiscal year ends are represented?,distinct_fiscal_year_total,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0112,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What is Amazon's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%AMAZON COM INC%') LIMIT 1",AMAZON COM INC is in the Consumer Discretionary sector.,"{""value"": ""Consumer Discretionary"", ""type"": ""text""}",5.0,0.8,template,,,,0.0197,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies have international (non-US) incorporation?,international_incorporation_count,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS company_count
FROM latest_submission
WHERE rn = 1 AND UPPER(countryinc) <> 'US'",Count: 34,"{""value"": 34, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.016,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What is the earliest period date in the financial data?,earliest_period_date,SELECT MIN(period) AS earliest_period FROM sub,earliest_period: 2014-05-31 00:00:00,"{""value"": ""2014-05-31 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0085,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many unique companies are represented in the dataset?,total_company_count,SELECT COUNT(DISTINCT cik) AS company_count FROM companies,Count: 589,"{""value"": 589, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0073,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,Which form type appears most frequently in submissions?,most_common_form_type,"SELECT form, COUNT(*) AS filing_count FROM sub GROUP BY form ORDER BY filing_count DESC LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.0109,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many financial facts are denominated in USD?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0227,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What is Tesla's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1","TESLA, INC.'s CIK is 0001318605.","{""value"": ""0001318605"", ""type"": ""text""}",5.0,0.8,template,,,,0.0125,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are in the Utilities sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%utilities%'),There are 20 companies in the Utilities sector.,"{""value"": 20, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.01,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many quarterly (qtrs=1) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 1,Count: 3566310,"{""value"": 3566310, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0303,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.012,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What is Berkshire Hathaway's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%BERKSHIRE HATHAWAY INC%') LIMIT 1",BERKSHIRE HATHAWAY INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,0.0118,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,Which company has the longest company name in the dataset?,company_with_longest_name,SELECT name FROM companies ORDER BY LENGTH(name) DESC LIMIT 1,"name: CHARLES RIVER LABORATORIES INTERNATIONAL, INC.","{""type"": ""text"", ""value"": ""CHARLES RIVER LABORATORIES INTERNATIONAL, INC.""}",5.0,0.65,template,,,,0.0088,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What is Procter & Gamble's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%PROCTER & GAMBLE CO%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",PROCTER & GAMBLE CO's CIK is 0000080424.,"{""value"": ""0000080424"", ""type"": ""text""}",5.0,0.8,template,,,,0.0077,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0067,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies have 'CORP' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%CORP%'),Count: 180,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.007,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What is Walmart Inc.'s CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%WALMART INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",WALMART INC.'s CIK is 0000104169.,"{""value"": ""0000104169"", ""type"": ""text""}",5.0,0.8,template,,,,0.0073,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,Which company has CIK 0000050863?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000050863' LIMIT 1,INTEL CORP's CIK is unknown.,"{""value"": ""INTEL CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0103,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies have 'INC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%INC%'),Count: 459,"{""value"": 459, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0111,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,Which company has CIK 0000019617?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000019617' LIMIT 1,JPMORGAN CHASE & CO's CIK is unknown.,"{""value"": ""JPMORGAN CHASE & CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.007,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies have 'LLC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%LLC%'),Count: 5,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 5}",5.0,0.7,template,,,,0.0075,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What was Tesla's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 74653000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 74653000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.0697,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What was Johnson & Johnson's most recent gross profit?,latest_gross_profit,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS gross_profit,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K','10-K/A')
      AND n.tag = 'GrossProfit'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT gross_profit, period_end
FROM latest_metric
WHERE rn = 1",gross_profit: 61350000000.0 | period_end: 2024-12-31 00:00:00,"{""type"": ""numeric"", ""value"": 61350000000.0, ""tolerance"": {""absolute"": 2000000000.0}}",5.0,0.8,template,,,,0.2545,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies reported positive net income in the latest period?,companies_positive_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_net_income AS (
    SELECT
        lf.cik,
        n.value,
        ROW_NUMBER() OVER (
            PARTITION BY lf.cik
            ORDER BY n.ddate DESC, n.adsh DESC
        ) AS rn
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT COUNT(*) AS company_count
FROM latest_net_income
WHERE rn = 1 AND value > 0",Count: 452,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 452}",5.0,0.85,template,,,,0.2368,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What was Walmart's most recent total liabilities?,latest_total_liabilities,"
WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%WALMART INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.filed,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K', '10-K/A')
), selected_filing AS (
    SELECT adsh, cik, period, filed
    FROM latest_filing
    WHERE rn = 1
), metric_values AS (
    SELECT
        MAX(CASE WHEN n.tag = 'LiabilitiesAndStockholdersEquity' THEN n.value END) AS total_assets_equity,
        COALESCE(
            MAX(CASE WHEN n.tag = 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest' THEN n.value END),
            MAX(CASE WHEN n.tag = 'StockholdersEquity' THEN n.value END)
        ) AS equity
    FROM num n
    JOIN selected_filing lf ON n.adsh = lf.adsh
    WHERE n.tag IN (
        'LiabilitiesAndStockholdersEquity',
        'StockholdersEquity',
        'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest'
    )
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT
    (total_assets_equity - equity) AS total_liabilities,
    period AS period_end
FROM metric_values, selected_filing
",total_liabilities: 163402000000.0 | period_end: 2025-01-31 00:00:00,"{""type"": ""text"", ""value"": 163402000000.0, ""tolerance"": {""absolute"": 5000000000.0}}",5.0,0.8,template,,,,0.1214,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies have total revenue exceeding $50 billion in the latest period?,companies_revenue_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_revenue AS (
    SELECT lf.cik, n.value AS revenue
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('Revenues','SalesRevenueNet')
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS count
FROM latest_revenue
WHERE revenue > 50000000000.0",Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.85,template,,,,0.1213,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies reported cost of revenue in the latest period?,companies_reporting_cost_of_revenue,"WITH latest_cost AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'CostOfRevenue'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_cost
WHERE rn = 1 AND value IS NOT NULL",Count: 134,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 134}",5.0,0.85,template,,,,0.1141,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What was Meta's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%META PLATFORMS, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 76793000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 76793000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.0606,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are in the Industrials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%industrials%'),There are 82 companies in the Industrials sector.,"{""value"": 82, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0106,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,Which sector has the second most companies?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""AT&T INC is in the Financials sector."", ""type"": ""text""}",5.0,0.9,template,,,,0.0103,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are in the Materials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%materials%'),There are 41 companies in the Materials sector.,"{""value"": 41, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.01,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are in the Energy sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%energy%'),There are 51 companies in the Energy sector.,"{""value"": 51, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0092,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are in the Consumer Discretionary sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer discretionary%'),There are 99 companies in the Consumer Discretionary sector.,"{""value"": 99, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are in the Consumer Staples sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer staples%'),There are 28 companies in the Consumer Staples sector.,"{""value"": 28, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.007,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are in the Real Estate sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%real estate%'),There are 3 companies in the Real Estate sector.,"{""value"": 3, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are in the Communication Services sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%communication services%'),There are 17 companies in the Communication Services sector.,"{""value"": 17, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,Which sector has the fewest companies?,sector_with_fewest_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL AND gics_sector != 'Other' GROUP BY gics_sector ORDER BY count ASC LIMIT 1",AT&T INC is in the Real Estate sector.,"{""type"": ""text"", ""value"": ""Real Estate""}",5.0,0.9,template,,,,0.0083,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many sectors have more than 50 companies?,sectors_above_threshold,"SELECT COUNT(DISTINCT gics_sector) as sector_count FROM (SELECT gics_sector, COUNT(*) as cnt FROM companies GROUP BY gics_sector HAVING cnt > 50.0) subq",Count: 6,"{""value"": 6, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.011,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many sectors have fewer than 25 companies?,sectors_below_threshold,"WITH sector_counts AS (
    SELECT gics_sector, COUNT(*) AS count
    FROM companies
    WHERE gics_sector IS NOT NULL
    GROUP BY gics_sector
)
SELECT COUNT(*) AS sector_count
FROM sector_counts
WHERE count < 25.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0105,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,Which sector contains Johnson & Johnson?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%') LIMIT 1",JOHNSON & JOHNSON is in the Health Care sector.,"{""value"": ""Health Care"", ""type"": ""text""}",5.0,0.8,template,,,,1.0071,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are headquartered in New York?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NY')",Count: 69,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 69}",5.0,0.7,template,,,,0.0136,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are headquartered in Texas?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('TX')",Count: 81,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 81}",5.0,0.7,template,,,,0.014,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are incorporated in Nevada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('NV'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('NV'))
  )
",Count: 9,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 9}",5.0,0.7,template,,,,0.0162,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are incorporated in Ireland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IE'))
  )
",Count: 11,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 11}",5.0,0.7,template,,,,0.016,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are incorporated in Canada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('CA'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('CA'))
  )
",Count: 11,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 11}",5.0,0.7,template,,,,0.0169,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,Which state has the second most company headquarters after California?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 2
",state: TX | count: 81,"{""value"": ""TX"", ""type"": ""text""}",5.0,0.65,template,,,,0.0181,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are headquartered in Illinois?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('IL')",Count: 42,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 42}",5.0,0.7,template,,,,0.0161,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are headquartered in Florida?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('FL')",Count: 26,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 26}",5.0,0.7,template,,,,0.0157,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are incorporated in Switzerland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('CH'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('CH'))
  )
",Count: 4,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 5}",5.0,0.7,template,,,,0.0133,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many different countries are represented in the incorporation data?,distinct_incorporation_countries,SELECT COUNT(DISTINCT countryinc) AS country_count FROM sub WHERE countryinc IS NOT NULL,Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 16}",5.0,0.7,template,,,,0.0123,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many different US states are represented in headquarters data?,distinct_headquarters_states,SELECT COUNT(DISTINCT stprba) AS state_count FROM sub WHERE stprba IS NOT NULL,Count: 44,"{""value"": 44, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0116,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are headquartered in Ohio?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('OH')",Count: 24,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 24}",5.0,0.7,template,,,,0.017,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are headquartered in North Carolina?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NC')",Count: 20,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",5.0,0.7,template,,,,0.014,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are incorporated in the United Kingdom?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('GB'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('GB'))
  )
",Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 1}",5.0,0.7,template,,,,0.0167,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are headquartered in Massachusetts?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('MA')",Count: 31,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 31}",5.0,0.7,template,,,,0.0167,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,Which state has the third most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 3
",state: NY | count: 69,"{""value"": ""NY"", ""type"": ""text""}",5.0,0.65,template,,,,0.0169,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are headquartered in Washington state?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('WA')",Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",5.0,0.7,template,,,,0.0164,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are incorporated in Bermuda?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('BM'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('BM'))
  )
",Count: 2,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 2}",5.0,0.7,template,,,,0.0159,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies are headquartered in Georgia?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('GA')",Count: 22,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 22}",5.0,0.7,template,,,,0.0164,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What is Google's (Alphabet) return on equity (ROE)?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%ALPHABET INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: ALPHABET INC. | roe_percentage: 32.91,"{""value"": 32.91, ""type"": ""numeric"", ""tolerance"": {""absolute"": 0.5}}",5.0,0.8,template,,,,0.2138,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many XBRL tags have a debit-credit flag of 'Debit'?,tag_count_by_debit_credit,SELECT COUNT(*) AS tag_count FROM tag WHERE crdr IS NOT NULL AND UPPER(TRIM(crdr)) = CASE WHEN UPPER(TRIM('Debit')) LIKE 'D%' THEN 'D' WHEN UPPER(TRIM('Debit')) LIKE 'C%' THEN 'C' ELSE UPPER(TRIM('Debit')) END,Count: 224017,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 224017}",5.0,0.7,template,,,,0.0796,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many XBRL tags are classified as 'monetary' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%monetary%'),Count: 454617,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 454617}",5.0,0.7,template,,,,0.0149,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many XBRL tags contain the word 'Revenue' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%REVENUE%'),Count: 12221,"{""value"": 12221, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0772,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many XBRL tags contain the word 'Asset' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%ASSET%'),Count: 40285,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 40285}",5.0,0.7,template,,,,0.0437,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many XBRL tags contain the word 'Liability' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%LIABILITY%'),Count: 11059,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 11059}",5.0,0.7,template,,,,0.0394,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many different unit types (UOM) are present in the numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 49.0}",5.0,0.7,template,,,,0.0217,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many financial facts have duplicate values (dimhash populated)?,fact_count_dimhash_populated,SELECT COUNT(*) AS fact_count FROM num WHERE segments IS NOT NULL AND TRIM(segments) <> '',Count: 8738244,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 8738244}",5.0,0.7,template,,,,0.5858,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many XBRL tags have 'shares' as unit of measure in numerical data?,tag_count_by_unit,SELECT COUNT(DISTINCT tag) AS tag_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 949,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 949}",5.0,0.7,template,,,,0.0716,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many XBRL tags are classified as 'per-share' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%per-share%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0.0}",5.0,0.7,template,,,,0.0481,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many numerical facts have negative values?,fact_count_negative_values,SELECT COUNT(*) AS fact_count FROM num WHERE value < 0,Count: 2124201,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 2124201.0}",5.0,0.7,template,,,,0.0717,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many numerical facts have zero values?,fact_count_zero_values,SELECT COUNT(*) AS fact_count FROM num WHERE value = 0,Count: 1427015,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 1427015}",5.0,0.7,template,,,,0.0635,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What is the third most frequent XBRL tag in numerical data?,tag_nth_most_common,"WITH tag_counts AS (
    SELECT
        tag,
        COUNT(*) AS fact_count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    GROUP BY tag
)
SELECT tag, fact_count
FROM tag_counts
WHERE rank = 3
LIMIT 1",tag: Revenues | fact_count: 491457,"{""type"": ""text"", ""value"": ""Revenues""}",5.0,0.65,template,,,,0.0381,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many XBRL tags contain the word 'Cash' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%CASH%'),Count: 29232,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 29232}",5.0,0.85,template,,,,0.04,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many XBRL tags contain the word 'Equity' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%EQUITY%'),Count: 24563,"{""value"": 24563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0477,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many XBRL tags contain the word 'Debt' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%DEBT%'),Count: 26515,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 26515}",5.0,0.85,template,,,,0.0395,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many XBRL tags are classified as 'string' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%string%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.7,template,,,,0.0098,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many financial facts are reported with coreg (co-registrant) information?,fact_count_with_coreg,SELECT COUNT(*) AS fact_count FROM num WHERE coreg IS NOT NULL AND TRIM(coreg) <> '',Count: 1261087,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 1261087}",5.0,0.7,template,,,,0.0223,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies filed 10-Q forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-Q'),Count: 543,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 543}",5.0,0.7,template,,,,0.0152,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies filed 8-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('8-K'),Count: 112,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 112}",5.0,0.7,template,,,,0.0111,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What is the earliest filing date in the dataset?,earliest_filing_date,SELECT MIN(filed) AS earliest_filing_date FROM sub,earliest_filing_date: 2015-01-02 00:00:00,"{""value"": ""2015-01-02 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0151,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many submissions have fiscal year 2024?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2024,Count: 4167,"{""value"": 4167, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.75,template,,,,0.0107,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many submissions have fiscal year 2025?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2025,Count: 917,"{""value"": 917, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.75,template,,,,0.0072,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many submissions have fiscal period Q1?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q1'),Count: 5664,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5664}",5.0,0.75,template,,,,0.0076,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many submissions have fiscal period FY (full year)?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('FY'),Count: 6476,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 6476}",5.0,0.7,template,,,,1.0455,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many different form types are present in the submissions?,distinct_form_type_count,SELECT COUNT(DISTINCT form) AS form_type_count FROM sub,Count: 21,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 21}",5.0,0.7,template,,,,0.0084,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many submissions have December fiscal year end (1231)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '1231',Count: 17572,"{""value"": 17572, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0092,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many submissions have March fiscal year end (0331)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0331',Count: 394,"{""value"": 394, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0087,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many submissions have June fiscal year end (0630)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0630',Count: 949,"{""value"": 949, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.009,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many submissions have September fiscal year end (0930)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0930',Count: 1134,"{""value"": 1134, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0091,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many submissions are for fiscal period Q2?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q2'),Count: 5296,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5296}",5.0,0.75,template,,,,0.0117,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many submissions are for fiscal period Q3?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q3'),Count: 5238,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5238}",5.0,0.75,template,,,,0.0078,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many submissions are for fiscal period Q4?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q4'),Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 1}",5.0,0.75,template,,,,0.0086,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What is the second most frequent form type in submissions?,form_type_rank,"WITH form_counts AS (
    SELECT form, COUNT(*) AS filing_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM sub
    GROUP BY form
)
SELECT form, filing_count
FROM form_counts
WHERE rank = 2
LIMIT 1",form: 10-K | filing_count: 6274,"{""value"": ""10-K"", ""type"": ""text""}",5.0,0.65,template,,,,0.0093,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many annual (qtrs=0) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 0,Count: 5484928,"{""value"": 5484928, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0362,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies have positive Return on Equity in the latest period?,companies_positive_return_on_equity,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 0",Count: 433,"{""value"": 448, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,1.0195,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies have a current ratio above 2.0?,companies_current_ratio_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND current_liabilities <> 0
  AND current_assets / current_liabilities > 2.0",Count: 115,"{""value"": 115.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.7,template,,,,0.1608,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies have negative Return on Assets?,companies_negative_return_on_assets,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('NetIncomeLoss','Assets')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL
  AND assets <> 0
  AND net_income IS NOT NULL
  AND net_income / assets < 0",Count: 24,"{""value"": 21, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.7021,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies have a debt-to-equity ratio above 1.0?,companies_debt_to_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Liabilities','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND liabilities IS NOT NULL
  AND liabilities / equity > 1.0",Count: 236,"{""value"": 236.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.1682,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies have gross margin above 50%?,companies_gross_margin_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('Revenues','SalesRevenueNet') THEN n.value END) AS revenue,
        MAX(CASE WHEN n.tag = 'CostOfRevenue' THEN n.value END) AS cost
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Revenues','SalesRevenueNet','CostOfRevenue')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE revenue IS NOT NULL
  AND revenue <> 0
  AND cost IS NOT NULL
  AND (revenue - cost) / revenue > (
        CASE WHEN 50.0 >= 1 THEN 50.0 / 100.0 ELSE 50.0 END
      )",Count: 12,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.7081,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies have Return on Equity above 20%?,companies_return_on_equity_above_threshold,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 20.0",Count: 174,"{""value"": 174, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.9801,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies have current assets exceeding $100 billion?,companies_current_assets_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_assets AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag = 'AssetsCurrent'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_assets
WHERE current_assets > 100000000000.0",Count: 9,"{""value"": 9, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.85,template,,,,0.221,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies have more liabilities than assets?,companies_more_liabilities_than_assets,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed,
                   ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Assets','Liabilities')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND liabilities IS NOT NULL
  AND liabilities > assets",Count: 25,"{""value"": 25, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.152,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,"What is Tesla's property, plant and equipment value?",latest_property_plant_equipment,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS property_plant_equipment,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PropertyPlantAndEquipmentNet'
      AND n.qtrs IN (0,4)
)
SELECT property_plant_equipment, period_end
FROM latest_metric
WHERE rn = 1",property_plant_equipment: 35836000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 37088000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.65,template,,,,0.1025,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies have negative stockholders' equity?,companies_negative_equity,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity < 0",Count: 1,"{""value"": 1, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.85,template,,,,0.1552,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies have intangible assets exceeding $10 billion?,companies_intangibles_above_threshold,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'IntangibleAssetsNetExcludingGoodwill' THEN n.value END) AS intangible_assets
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag = 'IntangibleAssetsNetExcludingGoodwill'
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE intangible_assets IS NOT NULL AND intangible_assets > 10000000000.0",Count: 38,"{""value"": 38, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.1068,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies report goodwill on their balance sheets?,companies_goodwill_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'Goodwill'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 3491,"{""value"": 3491.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.1065,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies have working capital exceeding $50 billion?,companies_working_capital_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND (current_assets - current_liabilities) > 50000000000.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.2041,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies reported research and development expenses?,companies_research_expense_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ResearchAndDevelopmentExpense'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 344,"{""value"": 344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.1056,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies have positive operating income?,companies_positive_operating_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'OperatingIncomeLoss'
  AND n.value > 0",Count: 907,"{""value"": 907.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.1215,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What was Tesla's other income (expense) in the latest period?,latest_other_income_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS other_income_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K', '10-K/A')
      AND n.tag = 'OtherNonoperatingIncomeExpense'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT other_income_expense, period_end
FROM latest_metric
WHERE rn = 1
",other_income_expense: 695000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 695000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",5.0,0.8,template,,,,0.2258,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies reported depreciation and amortization expenses?,companies_depreciation_amortization_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'DepreciationAndAmortization'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 321,"{""value"": 321, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.1112,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What was Johnson & Johnson's income tax expense?,latest_income_tax_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS income_tax_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K', '10-K/A')
      AND n.tag = 'IncomeTaxExpenseBenefit'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT income_tax_expense, period_end
FROM latest_metric
WHERE rn = 1
",income_tax_expense: 2621000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 2621000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.208,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies have negative net income?,companies_negative_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetIncomeLoss'
  AND n.value < 0",Count: 201,"{""value"": 201, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.85,template,,,,0.1094,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies reported foreign exchange gains/losses?,companies_forex_gain_loss,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag IN ('ForeignCurrencyTransactionGainLoss','GainLossOnForeignCurrencyExchange')
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.1664,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies have EBITDA exceeding $10 billion?,companies_ebitda_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('OperatingIncomeLoss',
                                'OperatingIncomeLoss1',
                                'OperatingProfitLoss',
                                'EarningsBeforeInterestAndTaxes',
                                'IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments',
                                'IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest') THEN n.value END) AS operating_income,
        MAX(CASE WHEN n.tag IN ('DepreciationAndAmortization',
                                'DepreciationAndAmortization1',
                                'DepreciationAndAmortization2',
                                'DepreciationAndAmortization3',
                                'DepreciationAndAmortization4',
                                'DepreciationAndAmortization5',
                                'DepreciationAmortizationAndImpairment',
                                'DepreciationDepletionAndAmortization',
                                'DepreciationAndAmortizationExpense') THEN n.value END) AS depreciation_amortization
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('OperatingIncomeLoss','OperatingIncomeLoss1','OperatingProfitLoss',
                    'EarningsBeforeInterestAndTaxes',
                    'IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments',
                    'IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest',
                    'DepreciationAndAmortization','DepreciationAndAmortization1','DepreciationAndAmortization2',
                    'DepreciationAndAmortization3','DepreciationAndAmortization4','DepreciationAndAmortization5',
                    'DepreciationAmortizationAndImpairment','DepreciationDepletionAndAmortization',
                    'DepreciationAndAmortizationExpense')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE operating_income IS NOT NULL
  AND (operating_income + COALESCE(depreciation_amortization, 0)) > 10000000000.0",Count: 68,"{""value"": 68, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.7058,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies have positive free cash flow?,companies_positive_free_cash_flow,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value > 0",Count: 525,"{""value"": 525, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.1122,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies spent more than $5 billion on acquisitions?,companies_acquisition_spending_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'PaymentsToAcquireBusinessesNetOfCashAcquired'
  AND ABS(n.value) > 5000000000.0",Count: 7,"{""value"": 7, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,template,,,,0.1061,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What was Tesla's change in cash and cash equivalents?,companies_change_in_cash,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS change_in_cash,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
      AND n.qtrs IN (0,4)
)
SELECT change_in_cash, period_end
FROM latest_metric
WHERE rn = 1",change_in_cash: 14923000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 14923000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.85,template,,,,0.1024,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies have negative operating cash flow?,companies_negative_operating_cash_flow,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value < 0",Count: 93,"{""value"": 93, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.1064,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What was Johnson & Johnson's acquisition spending?,company_acquisition_spending,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS acquisition_spending,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K', '10-K/A')
      AND n.tag = 'PaymentsToAcquireBusinessesNetOfCashAcquired'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT acquisition_spending, period_end
FROM latest_metric
WHERE rn = 1
",acquisition_spending: 15146000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 15146000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",5.0,0.8,template,,,,0.2008,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies issued new debt during the period?,companies_new_debt_issued,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ProceedsFromIssuanceOfLongTermDebt'
  AND n.value > 0",Count: 215,"{""value"": 215, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.1084,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies have free cash flow exceeding $10 billion?,companies_free_cash_flow_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value > 10000000000.0",Count: 11,"{""value"": 11, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,template,,,,0.1073,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many companies returned more than 50% of operating cash flow to shareholders?,companies_shareholder_return_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), payout_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'PaymentsOfDividends' THEN n.value END) AS dividends,
        MAX(CASE WHEN n.tag = 'PaymentsForRepurchaseOfCommonStock' THEN n.value END) AS buybacks,
        MAX(CASE WHEN n.tag = 'NetCashProvidedByUsedInOperatingActivities' THEN n.value END) AS operating_cash_flow
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('PaymentsOfDividends','PaymentsForRepurchaseOfCommonStock','NetCashProvidedByUsedInOperatingActivities')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM payout_metrics
WHERE operating_cash_flow IS NOT NULL AND operating_cash_flow <> 0
  AND (COALESCE(dividends,0) + COALESCE(buybacks,0)) / operating_cash_flow > (CASE WHEN 50.0 > 1 THEN 50.0 / 100.0 ELSE 50.0 END)",Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,template,,,,0.1565,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many different currencies are represented in the financial data?,distinct_currency_count,SELECT COUNT(DISTINCT UPPER(TRIM(uom))) AS currency_count FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3,Count: 27,"{""value"": 27, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0294,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What is the second most common currency in the dataset?,second_most_common_currency,"WITH currency_counts AS (SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS currency_rank FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3 GROUP BY 1) SELECT currency, fact_count FROM currency_counts WHERE currency_rank = 2",currency: EUR | fact_count: 37847,"{""value"": ""EUR"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.039,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many facts are denominated in Canadian dollars (CAD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CAD'),Count: 2926,"{""value"": 2926, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0234,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many facts are denominated in Euros (EUR)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('EUR'),Count: 37847,"{""value"": 37847, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0195,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many facts use 'shares' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0289,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many facts are measured in British pounds (GBP)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('GBP'),Count: 446,"{""value"": 446, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0222,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What is the most common non-monetary unit of measure?,most_common_non_monetary_unit,"WITH unit_counts AS (
    SELECT UPPER(TRIM(uom)) AS unit, COUNT(*) AS cnt,
           ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    WHERE uom IS NOT NULL
      AND LENGTH(TRIM(uom)) <> 3
    GROUP BY 1
)
SELECT unit, cnt FROM unit_counts WHERE rank = 1",unit: SHARES | cnt: 642330,"{""value"": ""SHARES"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.036,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many facts use percentage as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('pure'),Count: 50344,"{""value"": 50344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0262,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many facts are denominated in Swiss francs (CHF)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CHF'),Count: 218,"{""value"": 218, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.025,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many facts use square feet as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('square feet'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0127,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many facts are measured in Japanese yen (JPY)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('JPY'),Count: 122,"{""value"": 122, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0216,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What is the least common currency in the dataset?,least_common_currency,"WITH currency_counts AS (SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) ASC, UPPER(TRIM(uom))) AS currency_rank FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3 GROUP BY 1) SELECT currency, fact_count FROM currency_counts WHERE currency_rank = 1",currency: COP | fact_count: 1,"{""value"": ""COP"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0563,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many facts use 'days' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('days'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0225,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many facts are denominated in Australian dollars (AUD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('AUD'),Count: 110,"{""value"": 110, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.038,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many facts use barrels as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('barrels'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0169,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many facts are denominated in Mexican pesos (MXN)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('MXN'),Count: 37,"{""value"": 37, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0213,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What is the total count of unique unit types in the dataset?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 49, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0275,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,"How many facts use per-share units (per share, per unit)?",fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""absolute"": 100}}",5.0,0.7,template,,,,0.0288,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,How many facts are denominated in Hong Kong dollars (HKD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('HKD'),Count: 140,"{""value"": 140, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0221,0.0,0.0,0.0,0.0
RUN_021,"10 Nov 2025, 1300 hours",simple,What is Johnson & Johnson's return on equity (ROE) percentage?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: JOHNSON & JOHNSON | roe_percentage: 20.06,"{""value"": 20.06, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1.0}}",5.0,0.8,template,,,,0.2464,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What is Johnson & Johnson's return on equity (ROE) percentage?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: JOHNSON & JOHNSON | roe_percentage: 20.06,"{""value"": 20.06, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1.0}}",5.0,0.8,template,,,,0.3678,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many facts are denominated in Hong Kong dollars (HKD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('HKD'),Count: 140,"{""value"": 140, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0119,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,"How many facts use per-share units (per share, per unit)?",fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""absolute"": 100}}",5.0,0.7,template,,,,0.0164,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What is the total count of unique unit types in the dataset?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 49, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0166,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many facts are denominated in Mexican pesos (MXN)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('MXN'),Count: 37,"{""value"": 37, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0073,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many facts use barrels as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('barrels'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0031,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many facts are denominated in Australian dollars (AUD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('AUD'),Count: 110,"{""value"": 110, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0123,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many facts use 'days' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('days'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What is the least common currency in the dataset?,least_common_currency,"WITH currency_counts AS (SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) ASC, UPPER(TRIM(uom))) AS currency_rank FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3 GROUP BY 1) SELECT currency, fact_count FROM currency_counts WHERE currency_rank = 1",currency: COP | fact_count: 1,"{""value"": ""COP"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0322,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many facts are measured in Japanese yen (JPY)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('JPY'),Count: 122,"{""value"": 122, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.012,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many facts use square feet as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('square feet'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0021,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many facts are denominated in Swiss francs (CHF)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CHF'),Count: 218,"{""value"": 218, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0154,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many facts use percentage as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('pure'),Count: 50344,"{""value"": 50344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0124,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What is the most common non-monetary unit of measure?,most_common_non_monetary_unit,"WITH unit_counts AS (
    SELECT UPPER(TRIM(uom)) AS unit, COUNT(*) AS cnt,
           ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    WHERE uom IS NOT NULL
      AND LENGTH(TRIM(uom)) <> 3
    GROUP BY 1
)
SELECT unit, cnt FROM unit_counts WHERE rank = 1",unit: SHARES | cnt: 642330,"{""value"": ""SHARES"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.018,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many facts are measured in British pounds (GBP)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('GBP'),Count: 446,"{""value"": 446, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0122,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many facts use 'shares' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0159,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many facts are denominated in Euros (EUR)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('EUR'),Count: 37847,"{""value"": 37847, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0128,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many facts are denominated in Canadian dollars (CAD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CAD'),Count: 2926,"{""value"": 2926, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0131,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What is the second most common currency in the dataset?,second_most_common_currency,"WITH currency_counts AS (SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS currency_rank FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3 GROUP BY 1) SELECT currency, fact_count FROM currency_counts WHERE currency_rank = 2",currency: EUR | fact_count: 37847,"{""value"": ""EUR"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0687,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many different currencies are represented in the financial data?,distinct_currency_count,SELECT COUNT(DISTINCT UPPER(TRIM(uom))) AS currency_count FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3,Count: 27,"{""value"": 27, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0584,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies returned more than 50% of operating cash flow to shareholders?,companies_shareholder_return_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), payout_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'PaymentsOfDividends' THEN n.value END) AS dividends,
        MAX(CASE WHEN n.tag = 'PaymentsForRepurchaseOfCommonStock' THEN n.value END) AS buybacks,
        MAX(CASE WHEN n.tag = 'NetCashProvidedByUsedInOperatingActivities' THEN n.value END) AS operating_cash_flow
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('PaymentsOfDividends','PaymentsForRepurchaseOfCommonStock','NetCashProvidedByUsedInOperatingActivities')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM payout_metrics
WHERE operating_cash_flow IS NOT NULL AND operating_cash_flow <> 0
  AND (COALESCE(dividends,0) + COALESCE(buybacks,0)) / operating_cash_flow > (CASE WHEN 50.0 > 1 THEN 50.0 / 100.0 ELSE 50.0 END)",Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,template,,,,0.5709,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies have free cash flow exceeding $10 billion?,companies_free_cash_flow_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value > 10000000000.0",Count: 11,"{""value"": 11, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,template,,,,1.2328,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies issued new debt during the period?,companies_new_debt_issued,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ProceedsFromIssuanceOfLongTermDebt'
  AND n.value > 0",Count: 215,"{""value"": 215, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.1202,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What was Johnson & Johnson's acquisition spending?,company_acquisition_spending,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS acquisition_spending,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K', '10-K/A')
      AND n.tag = 'PaymentsToAcquireBusinessesNetOfCashAcquired'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT acquisition_spending, period_end
FROM latest_metric
WHERE rn = 1
",acquisition_spending: 15146000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 15146000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",5.0,0.65,template,,,,0.2152,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies have negative operating cash flow?,companies_negative_operating_cash_flow,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value < 0",Count: 93,"{""value"": 93, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.1046,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What was Tesla's change in cash and cash equivalents?,companies_change_in_cash,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS change_in_cash,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
      AND n.qtrs IN (0,4)
)
SELECT change_in_cash, period_end
FROM latest_metric
WHERE rn = 1",change_in_cash: 14923000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 14923000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.85,template,,,,0.1064,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies spent more than $5 billion on acquisitions?,companies_acquisition_spending_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'PaymentsToAcquireBusinessesNetOfCashAcquired'
  AND ABS(n.value) > 5000000000.0",Count: 7,"{""value"": 7, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.7,template,,,,0.1065,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies have positive free cash flow?,companies_positive_free_cash_flow,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value > 0",Count: 525,"{""value"": 525, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.1096,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies have EBITDA exceeding $10 billion?,companies_ebitda_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('OperatingIncomeLoss',
                                'OperatingIncomeLoss1',
                                'OperatingProfitLoss',
                                'EarningsBeforeInterestAndTaxes',
                                'IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments',
                                'IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest') THEN n.value END) AS operating_income,
        MAX(CASE WHEN n.tag IN ('DepreciationAndAmortization',
                                'DepreciationAndAmortization1',
                                'DepreciationAndAmortization2',
                                'DepreciationAndAmortization3',
                                'DepreciationAndAmortization4',
                                'DepreciationAndAmortization5',
                                'DepreciationAmortizationAndImpairment',
                                'DepreciationDepletionAndAmortization',
                                'DepreciationAndAmortizationExpense') THEN n.value END) AS depreciation_amortization
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('OperatingIncomeLoss','OperatingIncomeLoss1','OperatingProfitLoss',
                    'EarningsBeforeInterestAndTaxes',
                    'IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments',
                    'IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest',
                    'DepreciationAndAmortization','DepreciationAndAmortization1','DepreciationAndAmortization2',
                    'DepreciationAndAmortization3','DepreciationAndAmortization4','DepreciationAndAmortization5',
                    'DepreciationAmortizationAndImpairment','DepreciationDepletionAndAmortization',
                    'DepreciationAndAmortizationExpense')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE operating_income IS NOT NULL
  AND (operating_income + COALESCE(depreciation_amortization, 0)) > 10000000000.0",Count: 68,"{""value"": 68, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.777,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies reported foreign exchange gains/losses?,companies_forex_gain_loss,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag IN ('ForeignCurrencyTransactionGainLoss','GainLossOnForeignCurrencyExchange')
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.1671,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies have negative net income?,companies_negative_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetIncomeLoss'
  AND n.value < 0",Count: 201,"{""value"": 201, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.85,template,,,,0.1112,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What was Johnson & Johnson's income tax expense?,latest_income_tax_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS income_tax_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K', '10-K/A')
      AND n.tag = 'IncomeTaxExpenseBenefit'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT income_tax_expense, period_end
FROM latest_metric
WHERE rn = 1
",income_tax_expense: 2621000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 2621000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.2145,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies reported depreciation and amortization expenses?,companies_depreciation_amortization_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'DepreciationAndAmortization'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 321,"{""value"": 321, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.1172,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What was Tesla's other income (expense) in the latest period?,latest_other_income_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS other_income_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K', '10-K/A')
      AND n.tag = 'OtherNonoperatingIncomeExpense'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT other_income_expense, period_end
FROM latest_metric
WHERE rn = 1
",other_income_expense: 695000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 695000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",5.0,0.8,template,,,,0.2454,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies have positive operating income?,companies_positive_operating_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'OperatingIncomeLoss'
  AND n.value > 0",Count: 907,"{""value"": 907.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.1115,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies reported research and development expenses?,companies_research_expense_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ResearchAndDevelopmentExpense'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 344,"{""value"": 344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.1011,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies have working capital exceeding $50 billion?,companies_working_capital_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND (current_assets - current_liabilities) > 50000000000.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.1507,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies report goodwill on their balance sheets?,companies_goodwill_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'Goodwill'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 3491,"{""value"": 3491.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.1096,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies have intangible assets exceeding $10 billion?,companies_intangibles_above_threshold,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'IntangibleAssetsNetExcludingGoodwill' THEN n.value END) AS intangible_assets
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag = 'IntangibleAssetsNetExcludingGoodwill'
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE intangible_assets IS NOT NULL AND intangible_assets > 10000000000.0",Count: 38,"{""value"": 38, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.1053,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies have negative stockholders' equity?,companies_negative_equity,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity < 0",Count: 1,"{""value"": 1, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.85,template,,,,0.1745,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,"What is Tesla's property, plant and equipment value?",latest_property_plant_equipment,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS property_plant_equipment,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PropertyPlantAndEquipmentNet'
      AND n.qtrs IN (0,4)
)
SELECT property_plant_equipment, period_end
FROM latest_metric
WHERE rn = 1",property_plant_equipment: 35836000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 37088000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.65,template,,,,0.0979,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies have more liabilities than assets?,companies_more_liabilities_than_assets,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed,
                   ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Assets','Liabilities')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND liabilities IS NOT NULL
  AND liabilities > assets",Count: 25,"{""value"": 25, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.163,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies have current assets exceeding $100 billion?,companies_current_assets_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_assets AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag = 'AssetsCurrent'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_assets
WHERE current_assets > 100000000000.0",Count: 9,"{""value"": 9, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.85,template,,,,0.2343,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies have Return on Equity above 20%?,companies_return_on_equity_above_threshold,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 20.0",Count: 175,"{""value"": 174, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,1.2834,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies have gross margin above 50%?,companies_gross_margin_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('Revenues','SalesRevenueNet') THEN n.value END) AS revenue,
        MAX(CASE WHEN n.tag = 'CostOfRevenue' THEN n.value END) AS cost
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Revenues','SalesRevenueNet','CostOfRevenue')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE revenue IS NOT NULL
  AND revenue <> 0
  AND cost IS NOT NULL
  AND (revenue - cost) / revenue > (
        CASE WHEN 50.0 >= 1 THEN 50.0 / 100.0 ELSE 50.0 END
      )",Count: 12,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.7933,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies have a debt-to-equity ratio above 1.0?,companies_debt_to_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Liabilities','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND liabilities IS NOT NULL
  AND liabilities / equity > 1.0",Count: 236,"{""value"": 236.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.2035,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies have negative Return on Assets?,companies_negative_return_on_assets,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('NetIncomeLoss','Assets')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL
  AND assets <> 0
  AND net_income IS NOT NULL
  AND net_income / assets < 0",Count: 24,"{""value"": 21, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.8516,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies have a current ratio above 2.0?,companies_current_ratio_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND current_liabilities <> 0
  AND current_assets / current_liabilities > 2.0",Count: 115,"{""value"": 115.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.7,template,,,,0.2769,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies have positive Return on Equity in the latest period?,companies_positive_return_on_equity,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 0",Count: 434,"{""value"": 448, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,2.9226,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many annual (qtrs=0) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 0,Count: 5484928,"{""value"": 5484928, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0252,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What is the second most frequent form type in submissions?,form_type_rank,"WITH form_counts AS (
    SELECT form, COUNT(*) AS filing_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM sub
    GROUP BY form
)
SELECT form, filing_count
FROM form_counts
WHERE rank = 2
LIMIT 1",form: 10-K | filing_count: 6274,"{""value"": ""10-K"", ""type"": ""text""}",5.0,0.65,template,,,,0.002,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many submissions are for fiscal period Q4?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q4'),Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 1}",5.0,0.75,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many submissions are for fiscal period Q3?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q3'),Count: 5238,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5238}",5.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many submissions are for fiscal period Q2?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q2'),Count: 5296,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5296}",5.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many submissions have September fiscal year end (0930)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0930',Count: 1134,"{""value"": 1134, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many submissions have June fiscal year end (0630)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0630',Count: 949,"{""value"": 949, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many submissions have March fiscal year end (0331)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0331',Count: 394,"{""value"": 394, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many submissions have December fiscal year end (1231)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '1231',Count: 17572,"{""value"": 17572, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many different form types are present in the submissions?,distinct_form_type_count,SELECT COUNT(DISTINCT form) AS form_type_count FROM sub,Count: 21,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 21}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many submissions have fiscal period FY (full year)?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('FY'),Count: 6476,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 6476}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many submissions have fiscal period Q1?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q1'),Count: 5664,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5664}",5.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many submissions have fiscal year 2025?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2025,Count: 917,"{""value"": 917, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.75,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many submissions have fiscal year 2024?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2024,Count: 4167,"{""value"": 4167, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.75,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What is the earliest filing date in the dataset?,earliest_filing_date,SELECT MIN(filed) AS earliest_filing_date FROM sub,earliest_filing_date: 2015-01-02 00:00:00,"{""value"": ""2015-01-02 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies filed 8-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('8-K'),Count: 112,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 112}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies filed 10-Q forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-Q'),Count: 543,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 543}",5.0,0.7,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many financial facts are reported with coreg (co-registrant) information?,fact_count_with_coreg,SELECT COUNT(*) AS fact_count FROM num WHERE coreg IS NOT NULL AND TRIM(coreg) <> '',Count: 1261087,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 1261087}",5.0,0.7,template,,,,0.0142,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many XBRL tags are classified as 'string' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%string%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Debt' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%DEBT%'),Count: 26515,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 26515}",5.0,0.85,template,,,,0.0333,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Equity' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%EQUITY%'),Count: 24563,"{""value"": 24563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0431,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Cash' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%CASH%'),Count: 29232,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 29232}",5.0,0.85,template,,,,0.0356,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What is the third most frequent XBRL tag in numerical data?,tag_nth_most_common,"WITH tag_counts AS (
    SELECT
        tag,
        COUNT(*) AS fact_count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    GROUP BY tag
)
SELECT tag, fact_count
FROM tag_counts
WHERE rank = 3
LIMIT 1",tag: Revenues | fact_count: 491457,"{""type"": ""text"", ""value"": ""Revenues""}",5.0,0.65,template,,,,0.0408,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many numerical facts have zero values?,fact_count_zero_values,SELECT COUNT(*) AS fact_count FROM num WHERE value = 0,Count: 1427015,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 1427015}",5.0,0.7,template,,,,0.0774,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many numerical facts have negative values?,fact_count_negative_values,SELECT COUNT(*) AS fact_count FROM num WHERE value < 0,Count: 2124201,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 2124201.0}",5.0,0.7,template,,,,0.0653,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many XBRL tags are classified as 'per-share' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%per-share%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0.0}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many XBRL tags have 'shares' as unit of measure in numerical data?,tag_count_by_unit,SELECT COUNT(DISTINCT tag) AS tag_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 949,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 949}",5.0,0.7,template,,,,0.0318,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many financial facts have duplicate values (dimhash populated)?,fact_count_dimhash_populated,SELECT COUNT(*) AS fact_count FROM num WHERE segments IS NOT NULL AND TRIM(segments) <> '',Count: 8738244,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 8738244}",5.0,0.7,template,,,,0.6096,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many different unit types (UOM) are present in the numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 49.0}",5.0,0.7,template,,,,0.0141,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Liability' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%LIABILITY%'),Count: 11059,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 11059}",5.0,0.7,template,,,,0.0407,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Asset' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%ASSET%'),Count: 40285,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 40285}",5.0,0.7,template,,,,0.0398,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Revenue' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%REVENUE%'),Count: 12221,"{""value"": 12221, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0469,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many XBRL tags are classified as 'monetary' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%monetary%'),Count: 454617,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 454617}",5.0,0.7,template,,,,0.0029,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many XBRL tags have a debit-credit flag of 'Debit'?,tag_count_by_debit_credit,SELECT COUNT(*) AS tag_count FROM tag WHERE crdr IS NOT NULL AND UPPER(TRIM(crdr)) = CASE WHEN UPPER(TRIM('Debit')) LIKE 'D%' THEN 'D' WHEN UPPER(TRIM('Debit')) LIKE 'C%' THEN 'C' ELSE UPPER(TRIM('Debit')) END,Count: 224017,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 224017}",5.0,0.7,template,,,,0.005,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What is Google's (Alphabet) return on equity (ROE)?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%ALPHABET INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: ALPHABET INC. | roe_percentage: 32.91,"{""value"": 32.91, ""type"": ""numeric"", ""tolerance"": {""absolute"": 0.5}}",5.0,0.8,template,,,,0.4217,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in Georgia?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('GA')",Count: 22,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 22}",5.0,0.7,template,,,,0.0084,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are incorporated in Bermuda?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('BM'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('BM'))
  )
",Count: 2,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 2}",5.0,0.7,template,,,,0.008,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in Washington state?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('WA')",Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",5.0,0.7,template,,,,0.007,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,Which state has the third most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 3
",state: NY | count: 69,"{""value"": ""NY"", ""type"": ""text""}",5.0,0.65,template,,,,0.0077,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in Massachusetts?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('MA')",Count: 31,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 31}",5.0,0.7,template,,,,0.008,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are incorporated in the United Kingdom?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('GB'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('GB'))
  )
",Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 1}",5.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in North Carolina?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NC')",Count: 20,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",5.0,0.7,template,,,,0.0066,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in Ohio?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('OH')",Count: 24,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 24}",5.0,0.7,template,,,,0.0058,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many different US states are represented in headquarters data?,distinct_headquarters_states,SELECT COUNT(DISTINCT stprba) AS state_count FROM sub WHERE stprba IS NOT NULL,Count: 44,"{""value"": 44, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many different countries are represented in the incorporation data?,distinct_incorporation_countries,SELECT COUNT(DISTINCT countryinc) AS country_count FROM sub WHERE countryinc IS NOT NULL,Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 16}",5.0,0.7,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are incorporated in Switzerland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('CH'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('CH'))
  )
",Count: 4,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 5}",5.0,0.7,template,,,,0.0063,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in Florida?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('FL')",Count: 26,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 26}",5.0,0.7,template,,,,0.0062,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in Illinois?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('IL')",Count: 42,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 42}",5.0,0.7,template,,,,0.0062,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,Which state has the second most company headquarters after California?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 2
",state: TX | count: 81,"{""value"": ""TX"", ""type"": ""text""}",5.0,0.65,template,,,,0.0076,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are incorporated in Canada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('CA'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('CA'))
  )
",Count: 11,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 11}",5.0,0.7,template,,,,0.0072,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are incorporated in Ireland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IE'))
  )
",Count: 11,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 11}",5.0,0.7,template,,,,0.0082,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are incorporated in Nevada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('NV'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('NV'))
  )
",Count: 9,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 9}",5.0,0.7,template,,,,0.008,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in Texas?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('TX')",Count: 81,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 81}",5.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in New York?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NY')",Count: 69,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 69}",5.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,Which sector contains Johnson & Johnson?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%') LIMIT 1",JOHNSON & JOHNSON is in the Health Care sector.,"{""value"": ""Health Care"", ""type"": ""text""}",5.0,0.8,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many sectors have fewer than 25 companies?,sectors_below_threshold,"WITH sector_counts AS (
    SELECT gics_sector, COUNT(*) AS count
    FROM companies
    WHERE gics_sector IS NOT NULL
    GROUP BY gics_sector
)
SELECT COUNT(*) AS sector_count
FROM sector_counts
WHERE count < 25.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many sectors have more than 50 companies?,sectors_above_threshold,"SELECT COUNT(DISTINCT gics_sector) as sector_count FROM (SELECT gics_sector, COUNT(*) as cnt FROM companies GROUP BY gics_sector HAVING cnt > 50.0) subq",Count: 6,"{""value"": 6, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0043,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,Which sector has the fewest companies?,sector_with_fewest_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL AND gics_sector != 'Other' GROUP BY gics_sector ORDER BY count ASC LIMIT 1",AT&T INC is in the Real Estate sector.,"{""type"": ""text"", ""value"": ""Real Estate""}",5.0,0.8,template,,,,0.0021,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are in the Communication Services sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%communication services%'),There are 17 companies in the Communication Services sector.,"{""value"": 17, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are in the Real Estate sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%real estate%'),There are 3 companies in the Real Estate sector.,"{""value"": 3, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are in the Consumer Staples sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer staples%'),There are 28 companies in the Consumer Staples sector.,"{""value"": 28, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are in the Consumer Discretionary sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer discretionary%'),There are 99 companies in the Consumer Discretionary sector.,"{""value"": 99, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are in the Energy sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%energy%'),There are 51 companies in the Energy sector.,"{""value"": 51, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are in the Materials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%materials%'),There are 41 companies in the Materials sector.,"{""value"": 41, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,Which sector has the second most companies?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""AT&T INC is in the Financials sector."", ""type"": ""text""}",5.0,0.8,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are in the Industrials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%industrials%'),There are 82 companies in the Industrials sector.,"{""value"": 82, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What was Meta's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%META PLATFORMS, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 76793000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 76793000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.0558,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies reported cost of revenue in the latest period?,companies_reporting_cost_of_revenue,"WITH latest_cost AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'CostOfRevenue'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_cost
WHERE rn = 1 AND value IS NOT NULL",Count: 134,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 134}",5.0,0.85,template,,,,0.1103,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies have total revenue exceeding $50 billion in the latest period?,companies_revenue_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_revenue AS (
    SELECT lf.cik, n.value AS revenue
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('Revenues','SalesRevenueNet')
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS count
FROM latest_revenue
WHERE revenue > 50000000000.0",Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.85,template,,,,0.1263,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What was Walmart's most recent total liabilities?,latest_total_liabilities,"
WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%WALMART INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.filed,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K', '10-K/A')
), selected_filing AS (
    SELECT adsh, cik, period, filed
    FROM latest_filing
    WHERE rn = 1
), metric_values AS (
    SELECT
        MAX(CASE WHEN n.tag = 'LiabilitiesAndStockholdersEquity' THEN n.value END) AS total_assets_equity,
        COALESCE(
            MAX(CASE WHEN n.tag = 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest' THEN n.value END),
            MAX(CASE WHEN n.tag = 'StockholdersEquity' THEN n.value END)
        ) AS equity
    FROM num n
    JOIN selected_filing lf ON n.adsh = lf.adsh
    WHERE n.tag IN (
        'LiabilitiesAndStockholdersEquity',
        'StockholdersEquity',
        'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest'
    )
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT
    (total_assets_equity - equity) AS total_liabilities,
    period AS period_end
FROM metric_values, selected_filing
",total_liabilities: 163402000000.0 | period_end: 2025-01-31 00:00:00,"{""type"": ""text"", ""value"": 163402000000.0, ""tolerance"": {""absolute"": 5000000000.0}}",5.0,0.8,template,,,,0.1283,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies reported positive net income in the latest period?,companies_positive_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_net_income AS (
    SELECT
        lf.cik,
        n.value,
        ROW_NUMBER() OVER (
            PARTITION BY lf.cik
            ORDER BY n.ddate DESC, n.adsh DESC
        ) AS rn
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT COUNT(*) AS company_count
FROM latest_net_income
WHERE rn = 1 AND value > 0",Count: 452,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 452}",5.0,0.85,template,,,,0.2574,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What was Johnson & Johnson's most recent gross profit?,latest_gross_profit,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS gross_profit,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K','10-K/A')
      AND n.tag = 'GrossProfit'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT gross_profit, period_end
FROM latest_metric
WHERE rn = 1",gross_profit: 61350000000.0 | period_end: 2024-12-31 00:00:00,"{""type"": ""numeric"", ""value"": 61350000000.0, ""tolerance"": {""absolute"": 2000000000.0}}",5.0,0.8,template,,,,0.3131,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What was Tesla's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 74653000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 74653000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.1134,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies have 'LLC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%LLC%'),Count: 5,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 5}",5.0,0.7,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,Which company has CIK 0000019617?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000019617' LIMIT 1,JPMORGAN CHASE & CO's CIK is unknown.,"{""value"": ""JPMORGAN CHASE & CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies have 'INC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%INC%'),Count: 459,"{""value"": 459, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,Which company has CIK 0000050863?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000050863' LIMIT 1,INTEL CORP's CIK is unknown.,"{""value"": ""INTEL CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What is Walmart Inc.'s CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%WALMART INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",WALMART INC.'s CIK is 0000104169.,"{""value"": ""0000104169"", ""type"": ""text""}",5.0,0.8,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies have 'CORP' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%CORP%'),Count: 180,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What is Procter & Gamble's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%PROCTER & GAMBLE CO%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",PROCTER & GAMBLE CO's CIK is 0000080424.,"{""value"": ""0000080424"", ""type"": ""text""}",5.0,0.8,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,Which company has the longest company name in the dataset?,company_with_longest_name,SELECT name FROM companies ORDER BY LENGTH(name) DESC LIMIT 1,"name: CHARLES RIVER LABORATORIES INTERNATIONAL, INC.","{""type"": ""text"", ""value"": ""CHARLES RIVER LABORATORIES INTERNATIONAL, INC.""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What is Berkshire Hathaway's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%BERKSHIRE HATHAWAY INC%') LIMIT 1",BERKSHIRE HATHAWAY INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many quarterly (qtrs=1) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 1,Count: 3566310,"{""value"": 3566310, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0236,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are in the Utilities sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%utilities%'),There are 20 companies in the Utilities sector.,"{""value"": 20, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What is Tesla's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1","TESLA, INC.'s CIK is 0001318605.","{""value"": ""0001318605"", ""type"": ""text""}",5.0,0.8,template,,,,0.0028,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many financial facts are denominated in USD?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0151,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,Which form type appears most frequently in submissions?,most_common_form_type,"SELECT form, COUNT(*) AS filing_count FROM sub GROUP BY form ORDER BY filing_count DESC LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many unique companies are represented in the dataset?,total_company_count,SELECT COUNT(DISTINCT cik) AS company_count FROM companies,Count: 589,"{""value"": 589, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What is the earliest period date in the financial data?,earliest_period_date,SELECT MIN(period) AS earliest_period FROM sub,earliest_period: 2014-05-31 00:00:00,"{""value"": ""2014-05-31 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies have international (non-US) incorporation?,international_incorporation_count,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS company_count
FROM latest_submission
WHERE rn = 1 AND UPPER(countryinc) <> 'US'",Count: 34,"{""value"": 34, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0053,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What is Amazon's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%AMAZON COM INC%') LIMIT 1",AMAZON COM INC is in the Consumer Discretionary sector.,"{""value"": ""Consumer Discretionary"", ""type"": ""text""}",5.0,0.8,template,,,,0.0117,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many different fiscal year ends are represented?,distinct_fiscal_year_total,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,Which state has the most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 1
",state: CA | count: 123,"{""value"": ""CA"", ""type"": ""text""}",5.0,0.65,template,,,,0.0074,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies filed 10-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-K'),Count: 563,"{""value"": 563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What is the most recent filing date in the dataset?,latest_filing_date,SELECT MAX(filed) AS latest_filing_date FROM sub,latest_filing_date: 2025-06-30 00:00:00,"{""value"": ""2025-06-30 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.003,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are in the Health Care sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%health care%'),There are 80 companies in the Health Care sector.,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,Which company has CIK 0000066740?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000066740' LIMIT 1,3M CO's CIK is unknown.,"{""value"": ""3M CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many financial facts have footnotes?,fact_count_with_footnotes,SELECT COUNT(*) AS fact_count FROM num WHERE footnote IS NOT NULL AND TRIM(CAST(footnote AS VARCHAR)) <> '',Count: 33959,"{""value"": 33959, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0156,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,What currency is used most frequently in the numerical data?,most_common_currency,"SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL GROUP BY 1 ORDER BY fact_count DESC LIMIT 1",currency: USD | fact_count: 14760135,"{""value"": ""USD"", ""type"": ""text""}",5.0,0.65,template,,,,0.0362,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many companies are incorporated in Delaware?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('DE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('DE'))
  )
",Count: 346,"{""value"": 346, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0221,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,Which sector has the most companies in our S&P 500 dataset?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,17.0238,0.0,0.0,0.0,0.0
RUN_020,"07 Nov 2025, 1600 hours",simple,How many S&P 500 companies are in the Information Technology sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%information technology%'),There are 165 companies in the Information Technology sector.,"{""value"": 165, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.9,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 295}, 'latency_ms': 4907, 'success': True}]",4.9228,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What is Johnson & Johnson's return on equity (ROE) percentage?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: JOHNSON & JOHNSON | roe_percentage: 20.06,"{""value"": 20.06, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1.0}}",5.0,0.8,template,,,,0.2814,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many facts are denominated in Hong Kong dollars (HKD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('HKD'),Count: 140,"{""value"": 140, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0207,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,"How many facts use per-share units (per share, per unit)?",fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""absolute"": 100}}",5.0,0.7,template,,,,0.0178,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What is the total count of unique unit types in the dataset?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 49, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0154,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many facts are denominated in Mexican pesos (MXN)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('MXN'),Count: 37,"{""value"": 37, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0089,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many facts use barrels as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('barrels'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.005,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many facts are denominated in Australian dollars (AUD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('AUD'),Count: 110,"{""value"": 110, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0125,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many facts use 'days' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('days'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0028,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What is the least common currency in the dataset?,least_common_currency,"WITH currency_counts AS (SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) ASC, UPPER(TRIM(uom))) AS currency_rank FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3 GROUP BY 1) SELECT currency, fact_count FROM currency_counts WHERE currency_rank = 1",currency: COP | fact_count: 1,"{""value"": ""COP"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0343,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many facts are measured in Japanese yen (JPY)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('JPY'),Count: 122,"{""value"": 122, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.014,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many facts use square feet as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('square feet'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0024,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many facts are denominated in Swiss francs (CHF)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CHF'),Count: 218,"{""value"": 218, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0142,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many facts use percentage as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('pure'),Count: 50344,"{""value"": 50344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0136,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What is the most common non-monetary unit of measure?,most_common_non_monetary_unit,"WITH unit_counts AS (
    SELECT UPPER(TRIM(uom)) AS unit, COUNT(*) AS cnt,
           ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    WHERE uom IS NOT NULL
      AND LENGTH(TRIM(uom)) <> 3
    GROUP BY 1
)
SELECT unit, cnt FROM unit_counts WHERE rank = 1",unit: SHARES | cnt: 642330,"{""value"": ""SHARES"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0186,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many facts are measured in British pounds (GBP)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('GBP'),Count: 446,"{""value"": 446, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0134,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many facts use 'shares' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.016,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many facts are denominated in Euros (EUR)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('EUR'),Count: 37847,"{""value"": 37847, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0127,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many facts are denominated in Canadian dollars (CAD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CAD'),Count: 2926,"{""value"": 2926, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0126,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What is the second most common currency in the dataset?,second_most_common_currency,"WITH currency_counts AS (SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS currency_rank FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3 GROUP BY 1) SELECT currency, fact_count FROM currency_counts WHERE currency_rank = 2",currency: EUR | fact_count: 37847,"{""value"": ""EUR"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0334,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many different currencies are represented in the financial data?,distinct_currency_count,SELECT COUNT(DISTINCT UPPER(TRIM(uom))) AS currency_count FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3,Count: 27,"{""value"": 27, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0237,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies returned more than 50% of operating cash flow to shareholders?,companies_shareholder_return_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), payout_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'PaymentsOfDividends' THEN n.value END) AS dividends,
        MAX(CASE WHEN n.tag = 'PaymentsForRepurchaseOfCommonStock' THEN n.value END) AS buybacks,
        MAX(CASE WHEN n.tag = 'NetCashProvidedByUsedInOperatingActivities' THEN n.value END) AS operating_cash_flow
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('PaymentsOfDividends','PaymentsForRepurchaseOfCommonStock','NetCashProvidedByUsedInOperatingActivities')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM payout_metrics
WHERE operating_cash_flow IS NOT NULL AND operating_cash_flow <> 0
  AND (COALESCE(dividends,0) + COALESCE(buybacks,0)) / operating_cash_flow > (CASE WHEN 50.0 > 1 THEN 50.0 / 100.0 ELSE 50.0 END)",Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,template,,,,0.1815,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies have free cash flow exceeding $10 billion?,companies_free_cash_flow_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value > 10000000000.0",Count: 11,"{""value"": 11, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,template,,,,0.1214,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies issued new debt during the period?,companies_new_debt_issued,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ProceedsFromIssuanceOfLongTermDebt'
  AND n.value > 0",Count: 215,"{""value"": 215, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.132,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What was Johnson & Johnson's acquisition spending?,company_acquisition_spending,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS acquisition_spending,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K', '10-K/A')
      AND n.tag = 'PaymentsToAcquireBusinessesNetOfCashAcquired'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT acquisition_spending, period_end
FROM latest_metric
WHERE rn = 1
",acquisition_spending: 15146000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 15146000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",5.0,0.65,template,,,,0.2316,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies have negative operating cash flow?,companies_negative_operating_cash_flow,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value < 0",Count: 93,"{""value"": 93, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.1178,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What was Tesla's change in cash and cash equivalents?,companies_change_in_cash,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS change_in_cash,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
      AND n.qtrs IN (0,4)
)
SELECT change_in_cash, period_end
FROM latest_metric
WHERE rn = 1",change_in_cash: 14923000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 14923000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.85,template,,,,0.1029,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies spent more than $5 billion on acquisitions?,companies_acquisition_spending_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'PaymentsToAcquireBusinessesNetOfCashAcquired'
  AND ABS(n.value) > 5000000000.0",Count: 7,"{""value"": 7, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.7,template,,,,0.1075,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies have positive free cash flow?,companies_positive_free_cash_flow,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value > 0",Count: 525,"{""value"": 525, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.1418,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies have EBITDA exceeding $10 billion?,companies_ebitda_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('OperatingIncomeLoss',
                                'OperatingIncomeLoss1',
                                'OperatingProfitLoss',
                                'EarningsBeforeInterestAndTaxes',
                                'IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments',
                                'IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest') THEN n.value END) AS operating_income,
        MAX(CASE WHEN n.tag IN ('DepreciationAndAmortization',
                                'DepreciationAndAmortization1',
                                'DepreciationAndAmortization2',
                                'DepreciationAndAmortization3',
                                'DepreciationAndAmortization4',
                                'DepreciationAndAmortization5',
                                'DepreciationAmortizationAndImpairment',
                                'DepreciationDepletionAndAmortization',
                                'DepreciationAndAmortizationExpense') THEN n.value END) AS depreciation_amortization
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('OperatingIncomeLoss','OperatingIncomeLoss1','OperatingProfitLoss',
                    'EarningsBeforeInterestAndTaxes',
                    'IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments',
                    'IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest',
                    'DepreciationAndAmortization','DepreciationAndAmortization1','DepreciationAndAmortization2',
                    'DepreciationAndAmortization3','DepreciationAndAmortization4','DepreciationAndAmortization5',
                    'DepreciationAmortizationAndImpairment','DepreciationDepletionAndAmortization',
                    'DepreciationAndAmortizationExpense')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE operating_income IS NOT NULL
  AND (operating_income + COALESCE(depreciation_amortization, 0)) > 10000000000.0",Count: 68,"{""value"": 68, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.938,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies reported foreign exchange gains/losses?,companies_forex_gain_loss,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag IN ('ForeignCurrencyTransactionGainLoss','GainLossOnForeignCurrencyExchange')
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.1939,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies have negative net income?,companies_negative_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetIncomeLoss'
  AND n.value < 0",Count: 201,"{""value"": 201, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.85,template,,,,0.1897,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What was Johnson & Johnson's income tax expense?,latest_income_tax_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS income_tax_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K', '10-K/A')
      AND n.tag = 'IncomeTaxExpenseBenefit'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT income_tax_expense, period_end
FROM latest_metric
WHERE rn = 1
",income_tax_expense: 2621000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 2621000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.2234,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies reported depreciation and amortization expenses?,companies_depreciation_amortization_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'DepreciationAndAmortization'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 321,"{""value"": 321, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.1135,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What was Tesla's other income (expense) in the latest period?,latest_other_income_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS other_income_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K', '10-K/A')
      AND n.tag = 'OtherNonoperatingIncomeExpense'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT other_income_expense, period_end
FROM latest_metric
WHERE rn = 1
",other_income_expense: 695000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 695000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",5.0,0.8,template,,,,0.268,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies have positive operating income?,companies_positive_operating_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'OperatingIncomeLoss'
  AND n.value > 0",Count: 907,"{""value"": 907.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.1175,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies reported research and development expenses?,companies_research_expense_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ResearchAndDevelopmentExpense'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 344,"{""value"": 344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.1159,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies have working capital exceeding $50 billion?,companies_working_capital_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND (current_assets - current_liabilities) > 50000000000.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.2172,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies report goodwill on their balance sheets?,companies_goodwill_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'Goodwill'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 3491,"{""value"": 3491.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.1955,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies have intangible assets exceeding $10 billion?,companies_intangibles_above_threshold,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'IntangibleAssetsNetExcludingGoodwill' THEN n.value END) AS intangible_assets
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag = 'IntangibleAssetsNetExcludingGoodwill'
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE intangible_assets IS NOT NULL AND intangible_assets > 10000000000.0",Count: 38,"{""value"": 38, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.1272,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies have negative stockholders' equity?,companies_negative_equity,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity < 0",Count: 1,"{""value"": 1, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.85,template,,,,0.196,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,"What is Tesla's property, plant and equipment value?",latest_property_plant_equipment,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS property_plant_equipment,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PropertyPlantAndEquipmentNet'
      AND n.qtrs IN (0,4)
)
SELECT property_plant_equipment, period_end
FROM latest_metric
WHERE rn = 1",property_plant_equipment: 35836000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 37088000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.65,template,,,,0.1268,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies have more liabilities than assets?,companies_more_liabilities_than_assets,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed,
                   ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Assets','Liabilities')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND liabilities IS NOT NULL
  AND liabilities > assets",Count: 25,"{""value"": 25, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.1805,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies have current assets exceeding $100 billion?,companies_current_assets_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_assets AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag = 'AssetsCurrent'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_assets
WHERE current_assets > 100000000000.0",Count: 9,"{""value"": 9, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.85,template,,,,0.3087,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies have Return on Equity above 20%?,companies_return_on_equity_above_threshold,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 20.0",Count: 174,"{""value"": 174, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,1.2151,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies have gross margin above 50%?,companies_gross_margin_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('Revenues','SalesRevenueNet') THEN n.value END) AS revenue,
        MAX(CASE WHEN n.tag = 'CostOfRevenue' THEN n.value END) AS cost
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Revenues','SalesRevenueNet','CostOfRevenue')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE revenue IS NOT NULL
  AND revenue <> 0
  AND cost IS NOT NULL
  AND (revenue - cost) / revenue > (
        CASE WHEN 50.0 >= 1 THEN 50.0 / 100.0 ELSE 50.0 END
      )",Count: 12,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.7538,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies have a debt-to-equity ratio above 1.0?,companies_debt_to_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Liabilities','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND liabilities IS NOT NULL
  AND liabilities / equity > 1.0",Count: 236,"{""value"": 236.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.1909,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies have negative Return on Assets?,companies_negative_return_on_assets,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('NetIncomeLoss','Assets')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL
  AND assets <> 0
  AND net_income IS NOT NULL
  AND net_income / assets < 0",Count: 24,"{""value"": 21, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.9496,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies have a current ratio above 2.0?,companies_current_ratio_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND current_liabilities <> 0
  AND current_assets / current_liabilities > 2.0",Count: 115,"{""value"": 115.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.7,template,,,,0.1695,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies have positive Return on Equity in the latest period?,companies_positive_return_on_equity,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 0",Count: 433,"{""value"": 448, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,1.3522,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many annual (qtrs=0) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 0,Count: 5484928,"{""value"": 5484928, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0251,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What is the second most frequent form type in submissions?,form_type_rank,"WITH form_counts AS (
    SELECT form, COUNT(*) AS filing_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM sub
    GROUP BY form
)
SELECT form, filing_count
FROM form_counts
WHERE rank = 2
LIMIT 1",form: 10-K | filing_count: 6274,"{""value"": ""10-K"", ""type"": ""text""}",5.0,0.65,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many submissions are for fiscal period Q4?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q4'),Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 1}",5.0,0.75,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many submissions are for fiscal period Q3?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q3'),Count: 5238,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5238}",5.0,0.75,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many submissions are for fiscal period Q2?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q2'),Count: 5296,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5296}",5.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many submissions have September fiscal year end (0930)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0930',Count: 1134,"{""value"": 1134, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many submissions have June fiscal year end (0630)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0630',Count: 949,"{""value"": 949, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many submissions have March fiscal year end (0331)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0331',Count: 394,"{""value"": 394, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many submissions have December fiscal year end (1231)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '1231',Count: 17572,"{""value"": 17572, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many different form types are present in the submissions?,distinct_form_type_count,SELECT COUNT(DISTINCT form) AS form_type_count FROM sub,Count: 21,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 21}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many submissions have fiscal period FY (full year)?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('FY'),Count: 6476,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 6476}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many submissions have fiscal period Q1?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q1'),Count: 5664,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5664}",5.0,0.75,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many submissions have fiscal year 2025?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2025,Count: 917,"{""value"": 917, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many submissions have fiscal year 2024?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2024,Count: 4167,"{""value"": 4167, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.75,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What is the earliest filing date in the dataset?,earliest_filing_date,SELECT MIN(filed) AS earliest_filing_date FROM sub,earliest_filing_date: 2015-01-02 00:00:00,"{""value"": ""2015-01-02 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies filed 8-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('8-K'),Count: 112,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 112}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies filed 10-Q forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-Q'),Count: 543,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 543}",5.0,0.7,template,,,,0.0021,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many financial facts are reported with coreg (co-registrant) information?,fact_count_with_coreg,SELECT COUNT(*) AS fact_count FROM num WHERE coreg IS NOT NULL AND TRIM(coreg) <> '',Count: 1261087,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 1261087}",5.0,0.7,template,,,,0.0142,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many XBRL tags are classified as 'string' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%string%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Debt' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%DEBT%'),Count: 26515,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 26515}",5.0,0.85,template,,,,0.0348,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Equity' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%EQUITY%'),Count: 24563,"{""value"": 24563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0453,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Cash' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%CASH%'),Count: 29232,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 29232}",5.0,0.85,template,,,,0.0353,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What is the third most frequent XBRL tag in numerical data?,tag_nth_most_common,"WITH tag_counts AS (
    SELECT
        tag,
        COUNT(*) AS fact_count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    GROUP BY tag
)
SELECT tag, fact_count
FROM tag_counts
WHERE rank = 3
LIMIT 1",tag: Revenues | fact_count: 491457,"{""type"": ""text"", ""value"": ""Revenues""}",5.0,0.65,template,,,,0.0351,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many numerical facts have zero values?,fact_count_zero_values,SELECT COUNT(*) AS fact_count FROM num WHERE value = 0,Count: 1427015,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 1427015}",5.0,0.7,template,,,,0.0691,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many numerical facts have negative values?,fact_count_negative_values,SELECT COUNT(*) AS fact_count FROM num WHERE value < 0,Count: 2124201,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 2124201.0}",5.0,0.7,template,,,,0.0648,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many XBRL tags are classified as 'per-share' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%per-share%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0.0}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many XBRL tags have 'shares' as unit of measure in numerical data?,tag_count_by_unit,SELECT COUNT(DISTINCT tag) AS tag_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 949,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 949}",5.0,0.7,template,,,,0.0416,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many financial facts have duplicate values (dimhash populated)?,fact_count_dimhash_populated,SELECT COUNT(*) AS fact_count FROM num WHERE segments IS NOT NULL AND TRIM(segments) <> '',Count: 8738244,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 8738244}",5.0,0.7,template,,,,0.7051,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many different unit types (UOM) are present in the numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 49.0}",5.0,0.7,template,,,,0.0138,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Liability' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%LIABILITY%'),Count: 11059,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 11059}",5.0,0.7,template,,,,0.0352,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Asset' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%ASSET%'),Count: 40285,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 40285}",5.0,0.7,template,,,,0.0394,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Revenue' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%REVENUE%'),Count: 12221,"{""value"": 12221, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0409,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many XBRL tags are classified as 'monetary' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%monetary%'),Count: 454617,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 454617}",5.0,0.7,template,,,,0.0027,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many XBRL tags have a debit-credit flag of 'Debit'?,tag_count_by_debit_credit,SELECT COUNT(*) AS tag_count FROM tag WHERE crdr IS NOT NULL AND UPPER(TRIM(crdr)) = CASE WHEN UPPER(TRIM('Debit')) LIKE 'D%' THEN 'D' WHEN UPPER(TRIM('Debit')) LIKE 'C%' THEN 'C' ELSE UPPER(TRIM('Debit')) END,Count: 224017,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 224017}",5.0,0.7,template,,,,0.005,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What is Google's (Alphabet) return on equity (ROE)?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%ALPHABET INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: ALPHABET INC. | roe_percentage: 32.91,"{""value"": 32.91, ""type"": ""numeric"", ""tolerance"": {""absolute"": 0.5}}",5.0,0.8,template,,,,0.2124,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in Georgia?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('GA')",Count: 22,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 22}",5.0,0.7,template,,,,0.0064,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are incorporated in Bermuda?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('BM'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('BM'))
  )
",Count: 2,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 2}",5.0,0.7,template,,,,0.0063,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in Washington state?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('WA')",Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",5.0,0.7,template,,,,0.0062,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,Which state has the third most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 3
",state: NY | count: 69,"{""value"": ""NY"", ""type"": ""text""}",5.0,0.65,template,,,,0.0066,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in Massachusetts?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('MA')",Count: 31,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 31}",5.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are incorporated in the United Kingdom?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('GB'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('GB'))
  )
",Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 1}",5.0,0.7,template,,,,0.0073,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in North Carolina?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NC')",Count: 20,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",5.0,0.7,template,,,,0.0073,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in Ohio?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('OH')",Count: 24,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 24}",5.0,0.7,template,,,,0.0066,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many different US states are represented in headquarters data?,distinct_headquarters_states,SELECT COUNT(DISTINCT stprba) AS state_count FROM sub WHERE stprba IS NOT NULL,Count: 44,"{""value"": 44, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many different countries are represented in the incorporation data?,distinct_incorporation_countries,SELECT COUNT(DISTINCT countryinc) AS country_count FROM sub WHERE countryinc IS NOT NULL,Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 16}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are incorporated in Switzerland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('CH'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('CH'))
  )
",Count: 4,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 5}",5.0,0.7,template,,,,0.0066,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in Florida?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('FL')",Count: 26,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 26}",5.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in Illinois?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('IL')",Count: 42,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 42}",5.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,Which state has the second most company headquarters after California?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 2
",state: TX | count: 81,"{""value"": ""TX"", ""type"": ""text""}",5.0,0.65,template,,,,0.0075,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are incorporated in Canada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('CA'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('CA'))
  )
",Count: 11,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 11}",5.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are incorporated in Ireland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IE'))
  )
",Count: 11,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 11}",5.0,0.7,template,,,,0.0066,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are incorporated in Nevada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('NV'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('NV'))
  )
",Count: 9,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 9}",5.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in Texas?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('TX')",Count: 81,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 81}",5.0,0.7,template,,,,0.0064,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in New York?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NY')",Count: 69,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 69}",5.0,0.7,template,,,,0.0064,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,Which sector contains Johnson & Johnson?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%') LIMIT 1",JOHNSON & JOHNSON is in the Health Care sector.,"{""value"": ""Health Care"", ""type"": ""text""}",5.0,0.8,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many sectors have fewer than 25 companies?,sectors_below_threshold,"WITH sector_counts AS (
    SELECT gics_sector, COUNT(*) AS count
    FROM companies
    WHERE gics_sector IS NOT NULL
    GROUP BY gics_sector
)
SELECT COUNT(*) AS sector_count
FROM sector_counts
WHERE count < 25.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many sectors have more than 50 companies?,sectors_above_threshold,"SELECT COUNT(DISTINCT gics_sector) as sector_count FROM (SELECT gics_sector, COUNT(*) as cnt FROM companies GROUP BY gics_sector HAVING cnt > 50.0) subq",Count: 6,"{""value"": 6, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0039,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,Which sector has the fewest companies?,sector_with_fewest_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL AND gics_sector != 'Other' GROUP BY gics_sector ORDER BY count ASC LIMIT 1",AT&T INC is in the Real Estate sector.,"{""type"": ""text"", ""value"": ""Real Estate""}",5.0,0.8,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are in the Communication Services sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%communication services%'),There are 17 companies in the Communication Services sector.,"{""value"": 17, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are in the Real Estate sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%real estate%'),There are 3 companies in the Real Estate sector.,"{""value"": 3, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are in the Consumer Staples sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer staples%'),There are 28 companies in the Consumer Staples sector.,"{""value"": 28, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are in the Consumer Discretionary sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer discretionary%'),There are 99 companies in the Consumer Discretionary sector.,"{""value"": 99, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are in the Energy sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%energy%'),There are 51 companies in the Energy sector.,"{""value"": 51, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are in the Materials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%materials%'),There are 41 companies in the Materials sector.,"{""value"": 41, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,Which sector has the second most companies?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""AT&T INC is in the Financials sector."", ""type"": ""text""}",5.0,0.8,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are in the Industrials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%industrials%'),There are 82 companies in the Industrials sector.,"{""value"": 82, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What was Meta's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%META PLATFORMS, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 76793000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 76793000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.0554,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies reported cost of revenue in the latest period?,companies_reporting_cost_of_revenue,"WITH latest_cost AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'CostOfRevenue'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_cost
WHERE rn = 1 AND value IS NOT NULL",Count: 134,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 134}",5.0,0.85,template,,,,0.1098,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies have total revenue exceeding $50 billion in the latest period?,companies_revenue_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_revenue AS (
    SELECT lf.cik, n.value AS revenue
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('Revenues','SalesRevenueNet')
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS count
FROM latest_revenue
WHERE revenue > 50000000000.0",Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.85,template,,,,0.1212,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What was Walmart's most recent total liabilities?,latest_total_liabilities,"
WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%WALMART INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.filed,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K', '10-K/A')
), selected_filing AS (
    SELECT adsh, cik, period, filed
    FROM latest_filing
    WHERE rn = 1
), metric_values AS (
    SELECT
        MAX(CASE WHEN n.tag = 'LiabilitiesAndStockholdersEquity' THEN n.value END) AS total_assets_equity,
        COALESCE(
            MAX(CASE WHEN n.tag = 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest' THEN n.value END),
            MAX(CASE WHEN n.tag = 'StockholdersEquity' THEN n.value END)
        ) AS equity
    FROM num n
    JOIN selected_filing lf ON n.adsh = lf.adsh
    WHERE n.tag IN (
        'LiabilitiesAndStockholdersEquity',
        'StockholdersEquity',
        'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest'
    )
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT
    (total_assets_equity - equity) AS total_liabilities,
    period AS period_end
FROM metric_values, selected_filing
",total_liabilities: 163402000000.0 | period_end: 2025-01-31 00:00:00,"{""type"": ""text"", ""value"": 163402000000.0, ""tolerance"": {""absolute"": 5000000000.0}}",5.0,0.8,template,,,,0.1225,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies reported positive net income in the latest period?,companies_positive_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_net_income AS (
    SELECT
        lf.cik,
        n.value,
        ROW_NUMBER() OVER (
            PARTITION BY lf.cik
            ORDER BY n.ddate DESC, n.adsh DESC
        ) AS rn
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT COUNT(*) AS company_count
FROM latest_net_income
WHERE rn = 1 AND value > 0",Count: 452,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 452}",5.0,0.85,template,,,,0.3054,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What was Johnson & Johnson's most recent gross profit?,latest_gross_profit,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS gross_profit,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'GrossProfit'
      AND n.qtrs IN (0,4)
)
SELECT gross_profit, period_end
FROM latest_metric
WHERE rn = 1",gross_profit: 61350000000.0 | period_end: 2024-12-31 00:00:00,"{""type"": ""numeric"", ""value"": 55394000000.0, ""tolerance"": {""absolute"": 2000000000.0}}",1.0,0.8,template,,,,0.0978,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What was Tesla's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 74653000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 74653000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.0706,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies have 'LLC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%LLC%'),Count: 5,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 5}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,Which company has CIK 0000019617?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000019617' LIMIT 1,JPMORGAN CHASE & CO's CIK is unknown.,"{""value"": ""JPMORGAN CHASE & CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies have 'INC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%INC%'),Count: 459,"{""value"": 459, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,Which company has CIK 0000050863?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000050863' LIMIT 1,INTEL CORP's CIK is unknown.,"{""value"": ""INTEL CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0006,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What is Walmart Inc.'s CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%WALMART INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",WALMART INC.'s CIK is 0000104169.,"{""value"": ""0000104169"", ""type"": ""text""}",5.0,0.8,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies have 'CORP' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%CORP%'),Count: 180,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What is Procter & Gamble's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%PROCTER & GAMBLE CO%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",PROCTER & GAMBLE CO's CIK is 0000080424.,"{""value"": ""0000080424"", ""type"": ""text""}",5.0,0.8,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,Which company has the longest company name in the dataset?,company_with_longest_name,SELECT name FROM companies ORDER BY LENGTH(name) DESC LIMIT 1,"name: CHARLES RIVER LABORATORIES INTERNATIONAL, INC.","{""type"": ""text"", ""value"": ""CHARLES RIVER LABORATORIES INTERNATIONAL, INC.""}",5.0,0.65,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What is Berkshire Hathaway's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%BERKSHIRE HATHAWAY INC%') LIMIT 1",BERKSHIRE HATHAWAY INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many quarterly (qtrs=1) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 1,Count: 3566310,"{""value"": 3566310, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0225,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are in the Utilities sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%utilities%'),There are 20 companies in the Utilities sector.,"{""value"": 20, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What is Tesla's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1","TESLA, INC.'s CIK is 0001318605.","{""value"": ""0001318605"", ""type"": ""text""}",5.0,0.8,template,,,,0.0028,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many financial facts are denominated in USD?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0152,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,Which form type appears most frequently in submissions?,most_common_form_type,"SELECT form, COUNT(*) AS filing_count FROM sub GROUP BY form ORDER BY filing_count DESC LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many unique companies are represented in the dataset?,total_company_count,SELECT COUNT(DISTINCT cik) AS company_count FROM companies,Count: 589,"{""value"": 589, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What is the earliest period date in the financial data?,earliest_period_date,SELECT MIN(period) AS earliest_period FROM sub,earliest_period: 2014-05-31 00:00:00,"{""value"": ""2014-05-31 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies have international (non-US) incorporation?,international_incorporation_count,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS company_count
FROM latest_submission
WHERE rn = 1 AND UPPER(countryinc) <> 'US'",Count: 34,"{""value"": 34, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0057,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What is Amazon's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%AMAZON COM INC%') LIMIT 1",AMAZON COM INC is in the Consumer Discretionary sector.,"{""value"": ""Consumer Discretionary"", ""type"": ""text""}",5.0,0.8,template,,,,0.0127,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many different fiscal year ends are represented?,distinct_fiscal_year_total,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,Which state has the most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 1
",state: CA | count: 123,"{""value"": ""CA"", ""type"": ""text""}",5.0,0.65,template,,,,0.0083,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies filed 10-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-K'),Count: 563,"{""value"": 563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0022,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What is the most recent filing date in the dataset?,latest_filing_date,SELECT MAX(filed) AS latest_filing_date FROM sub,latest_filing_date: 2025-06-30 00:00:00,"{""value"": ""2025-06-30 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0096,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are in the Health Care sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%health care%'),There are 80 companies in the Health Care sector.,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,Which company has CIK 0000066740?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000066740' LIMIT 1,3M CO's CIK is unknown.,"{""value"": ""3M CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many financial facts have footnotes?,fact_count_with_footnotes,SELECT COUNT(*) AS fact_count FROM num WHERE footnote IS NOT NULL AND TRIM(CAST(footnote AS VARCHAR)) <> '',Count: 33959,"{""value"": 33959, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0127,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,What currency is used most frequently in the numerical data?,most_common_currency,"SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL GROUP BY 1 ORDER BY fact_count DESC LIMIT 1",currency: USD | fact_count: 14760135,"{""value"": ""USD"", ""type"": ""text""}",5.0,0.65,template,,,,0.0305,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many companies are incorporated in Delaware?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('DE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('DE'))
  )
",Count: 346,"{""value"": 346, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,21.261,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,Which sector has the most companies in our S&P 500 dataset?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",Financials has 168 matching records.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.95,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 410}, 'latency_ms': 4255, 'success': True}]",16.8188,0.0,0.0,0.0,0.0
RUN_019,"07 Nov 2025, 1600 hours",simple,How many S&P 500 companies are in the Information Technology sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%information technology%'),There are 165 companies in the Information Technology sector.,"{""value"": 165, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 360}, 'latency_ms': 4295, 'success': True}]",11.7357,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What is Johnson & Johnson's return on equity (ROE) percentage?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: JOHNSON & JOHNSON | roe_percentage: 20.06,"{""value"": 20.06, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1.0}}",5.0,0.8,template,,,,0.2808,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many facts are denominated in Hong Kong dollars (HKD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('HKD'),Count: 140,"{""value"": 140, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0103,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,"How many facts use per-share units (per share, per unit)?",fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""absolute"": 100}}",5.0,0.7,template,,,,0.0144,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What is the total count of unique unit types in the dataset?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 49, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0126,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many facts are denominated in Mexican pesos (MXN)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('MXN'),Count: 37,"{""value"": 37, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.008,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many facts use barrels as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('barrels'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0022,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many facts are denominated in Australian dollars (AUD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('AUD'),Count: 110,"{""value"": 110, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0137,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many facts use 'days' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('days'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0045,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What is the least common currency in the dataset?,least_common_currency,"WITH currency_counts AS (SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) ASC, UPPER(TRIM(uom))) AS currency_rank FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3 GROUP BY 1) SELECT currency, fact_count FROM currency_counts WHERE currency_rank = 1",currency: COP | fact_count: 1,"{""value"": ""COP"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0368,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many facts are measured in Japanese yen (JPY)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('JPY'),Count: 122,"{""value"": 122, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0187,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many facts use square feet as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('square feet'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0034,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many facts are denominated in Swiss francs (CHF)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CHF'),Count: 218,"{""value"": 218, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0407,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many facts use percentage as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('pure'),Count: 50344,"{""value"": 50344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.026,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What is the most common non-monetary unit of measure?,most_common_non_monetary_unit,"WITH unit_counts AS (
    SELECT UPPER(TRIM(uom)) AS unit, COUNT(*) AS cnt,
           ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    WHERE uom IS NOT NULL
      AND LENGTH(TRIM(uom)) <> 3
    GROUP BY 1
)
SELECT unit, cnt FROM unit_counts WHERE rank = 1",unit: SHARES | cnt: 642330,"{""value"": ""SHARES"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0323,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many facts are measured in British pounds (GBP)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('GBP'),Count: 446,"{""value"": 446, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0147,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many facts use 'shares' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.037,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many facts are denominated in Euros (EUR)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('EUR'),Count: 37847,"{""value"": 37847, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0759,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many facts are denominated in Canadian dollars (CAD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CAD'),Count: 2926,"{""value"": 2926, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0121,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What is the second most common currency in the dataset?,second_most_common_currency,"WITH currency_counts AS (SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS currency_rank FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3 GROUP BY 1) SELECT currency, fact_count FROM currency_counts WHERE currency_rank = 2",currency: EUR | fact_count: 37847,"{""value"": ""EUR"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0302,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many different currencies are represented in the financial data?,distinct_currency_count,SELECT COUNT(DISTINCT UPPER(TRIM(uom))) AS currency_count FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3,Count: 27,"{""value"": 27, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0202,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies returned more than 50% of operating cash flow to shareholders?,companies_shareholder_return_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), payout_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'PaymentsOfDividends' THEN n.value END) AS dividends,
        MAX(CASE WHEN n.tag = 'PaymentsForRepurchaseOfCommonStock' THEN n.value END) AS buybacks,
        MAX(CASE WHEN n.tag = 'NetCashProvidedByUsedInOperatingActivities' THEN n.value END) AS operating_cash_flow
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('PaymentsOfDividends','PaymentsForRepurchaseOfCommonStock','NetCashProvidedByUsedInOperatingActivities')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM payout_metrics
WHERE operating_cash_flow IS NOT NULL AND operating_cash_flow <> 0
  AND (COALESCE(dividends,0) + COALESCE(buybacks,0)) / operating_cash_flow > (CASE WHEN 50.0 > 1 THEN 50.0 / 100.0 ELSE 50.0 END)",Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,template,,,,0.1788,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies have free cash flow exceeding $10 billion?,companies_free_cash_flow_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value > 10000000000.0",Count: 11,"{""value"": 11, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,template,,,,0.1098,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies issued new debt during the period?,companies_new_debt_issued,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ProceedsFromIssuanceOfLongTermDebt'
  AND n.value > 0",Count: 215,"{""value"": 215, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.114,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What was Johnson & Johnson's acquisition spending?,company_acquisition_spending,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS acquisition_spending,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K', '10-K/A')
      AND n.tag = 'PaymentsToAcquireBusinessesNetOfCashAcquired'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT acquisition_spending, period_end
FROM latest_metric
WHERE rn = 1
",acquisition_spending: 15146000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 15146000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",5.0,0.65,template,,,,0.2202,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies have negative operating cash flow?,companies_negative_operating_cash_flow,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value < 0",Count: 93,"{""value"": 93, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.1073,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What was Tesla's change in cash and cash equivalents?,companies_change_in_cash,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS change_in_cash,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
      AND n.qtrs IN (0,4)
)
SELECT change_in_cash, period_end
FROM latest_metric
WHERE rn = 1",change_in_cash: 14724000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 14923000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.85,template,,,,0.1072,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies spent more than $5 billion on acquisitions?,companies_acquisition_spending_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'PaymentsToAcquireBusinessesNetOfCashAcquired'
  AND ABS(n.value) > 5000000000.0",Count: 7,"{""value"": 7, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.7,template,,,,0.1067,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies have positive free cash flow?,companies_positive_free_cash_flow,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value > 0",Count: 525,"{""value"": 525, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.1131,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies have EBITDA exceeding $10 billion?,companies_ebitda_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('OperatingIncomeLoss',
                                'OperatingIncomeLoss1',
                                'OperatingProfitLoss',
                                'EarningsBeforeInterestAndTaxes',
                                'IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments',
                                'IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest') THEN n.value END) AS operating_income,
        MAX(CASE WHEN n.tag IN ('DepreciationAndAmortization',
                                'DepreciationAndAmortization1',
                                'DepreciationAndAmortization2',
                                'DepreciationAndAmortization3',
                                'DepreciationAndAmortization4',
                                'DepreciationAndAmortization5',
                                'DepreciationAmortizationAndImpairment',
                                'DepreciationDepletionAndAmortization',
                                'DepreciationAndAmortizationExpense') THEN n.value END) AS depreciation_amortization
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('OperatingIncomeLoss','OperatingIncomeLoss1','OperatingProfitLoss',
                    'EarningsBeforeInterestAndTaxes',
                    'IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments',
                    'IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest',
                    'DepreciationAndAmortization','DepreciationAndAmortization1','DepreciationAndAmortization2',
                    'DepreciationAndAmortization3','DepreciationAndAmortization4','DepreciationAndAmortization5',
                    'DepreciationAmortizationAndImpairment','DepreciationDepletionAndAmortization',
                    'DepreciationAndAmortizationExpense')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE operating_income IS NOT NULL
  AND (operating_income + COALESCE(depreciation_amortization, 0)) > 10000000000.0",Count: 68,"{""value"": 2, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.8393,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies reported foreign exchange gains/losses?,companies_forex_gain_loss,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag IN ('ForeignCurrencyTransactionGainLoss','GainLossOnForeignCurrencyExchange')
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.1821,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies have negative net income?,companies_negative_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetIncomeLoss'
  AND n.value < 0",Count: 201,"{""value"": 201, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.85,template,,,,0.1228,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What was Johnson & Johnson's income tax expense?,latest_income_tax_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS income_tax_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K', '10-K/A')
      AND n.tag = 'IncomeTaxExpenseBenefit'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT income_tax_expense, period_end
FROM latest_metric
WHERE rn = 1
",income_tax_expense: 2621000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 2621000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.2893,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies reported depreciation and amortization expenses?,companies_depreciation_amortization_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'DepreciationAndAmortization'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 321,"{""value"": 321, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.1078,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What was Tesla's other income (expense) in the latest period?,latest_other_income_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS other_income_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K', '10-K/A')
      AND n.tag = 'OtherNonoperatingIncomeExpense'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT other_income_expense, period_end
FROM latest_metric
WHERE rn = 1
",other_income_expense: 695000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 695000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",5.0,0.8,template,,,,0.3314,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies have positive operating income?,companies_positive_operating_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'OperatingIncomeLoss'
  AND n.value > 0",Count: 907,"{""value"": 907.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.1543,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies reported research and development expenses?,companies_research_expense_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ResearchAndDevelopmentExpense'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 344,"{""value"": 344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.1091,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies have working capital exceeding $50 billion?,companies_working_capital_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND (current_assets - current_liabilities) > 50000000000.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.159,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies report goodwill on their balance sheets?,companies_goodwill_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'Goodwill'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 3491,"{""value"": 3491.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.1356,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies have intangible assets exceeding $10 billion?,companies_intangibles_above_threshold,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'IntangibleAssetsNetExcludingGoodwill' THEN n.value END) AS intangible_assets
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag = 'IntangibleAssetsNetExcludingGoodwill'
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE intangible_assets IS NOT NULL AND intangible_assets > 10000000000.0",Count: 38,"{""value"": 38, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.1477,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies have negative stockholders' equity?,companies_negative_equity,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity < 0",Count: 1,"{""value"": 1, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.85,template,,,,0.1721,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,"What is Tesla's property, plant and equipment value?",latest_property_plant_equipment,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS property_plant_equipment,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PropertyPlantAndEquipmentNet'
      AND n.qtrs IN (0,4)
)
SELECT property_plant_equipment, period_end
FROM latest_metric
WHERE rn = 1",property_plant_equipment: 35836000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 37088000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.65,template,,,,0.1031,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies have more liabilities than assets?,companies_more_liabilities_than_assets,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed,
                   ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Assets','Liabilities')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND liabilities IS NOT NULL
  AND liabilities > assets",Count: 25,"{""value"": 25, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.1703,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies have current assets exceeding $100 billion?,companies_current_assets_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_assets AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag = 'AssetsCurrent'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_assets
WHERE current_assets > 100000000000.0",Count: 9,"{""value"": 9, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.85,template,,,,0.2447,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies have Return on Equity above 20%?,companies_return_on_equity_above_threshold,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 20.0",Count: 175,"{""value"": 174, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,1.1359,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies have gross margin above 50%?,companies_gross_margin_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('Revenues','SalesRevenueNet') THEN n.value END) AS revenue,
        MAX(CASE WHEN n.tag = 'CostOfRevenue' THEN n.value END) AS cost
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Revenues','SalesRevenueNet','CostOfRevenue')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE revenue IS NOT NULL
  AND revenue <> 0
  AND cost IS NOT NULL
  AND (revenue - cost) / revenue > (
        CASE WHEN 50.0 >= 1 THEN 50.0 / 100.0 ELSE 50.0 END
      )",Count: 12,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.822,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies have a debt-to-equity ratio above 1.0?,companies_debt_to_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Liabilities','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND liabilities IS NOT NULL
  AND liabilities / equity > 1.0",Count: 236,"{""value"": 236.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.2357,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies have negative Return on Assets?,companies_negative_return_on_assets,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('NetIncomeLoss','Assets')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL
  AND assets <> 0
  AND net_income IS NOT NULL
  AND net_income / assets < 0",Count: 24,"{""value"": 21, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.7588,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies have a current ratio above 2.0?,companies_current_ratio_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND current_liabilities <> 0
  AND current_assets / current_liabilities > 2.0",Count: 115,"{""value"": 115.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.7,template,,,,0.1644,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies have positive Return on Equity in the latest period?,companies_positive_return_on_equity,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 0",Count: 433,"{""value"": 448, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,1.1287,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many annual (qtrs=0) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 0,Count: 5484928,"{""value"": 5484928, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0274,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What is the second most frequent form type in submissions?,form_type_rank,"WITH form_counts AS (
    SELECT form, COUNT(*) AS filing_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM sub
    GROUP BY form
)
SELECT form, filing_count
FROM form_counts
WHERE rank = 2
LIMIT 1",form: 10-K | filing_count: 6274,"{""value"": ""10-K"", ""type"": ""text""}",5.0,0.65,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many submissions are for fiscal period Q4?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q4'),Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 1}",5.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many submissions are for fiscal period Q3?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q3'),Count: 5238,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5238}",5.0,0.75,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many submissions are for fiscal period Q2?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q2'),Count: 5296,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5296}",5.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many submissions have September fiscal year end (0930)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0930',Count: 1134,"{""value"": 1134, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many submissions have June fiscal year end (0630)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0630',Count: 949,"{""value"": 949, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many submissions have March fiscal year end (0331)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0331',Count: 394,"{""value"": 394, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many submissions have December fiscal year end (1231)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '1231',Count: 17572,"{""value"": 17572, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many different form types are present in the submissions?,distinct_form_type_count,SELECT COUNT(DISTINCT form) AS form_type_count FROM sub,Count: 21,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 21}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many submissions have fiscal period FY (full year)?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('FY'),Count: 6476,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 6476}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many submissions have fiscal period Q1?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q1'),Count: 5664,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5664}",5.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many submissions have fiscal year 2025?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2025,Count: 917,"{""value"": 917, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.75,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many submissions have fiscal year 2024?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2024,Count: 4167,"{""value"": 4167, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.75,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What is the earliest filing date in the dataset?,earliest_filing_date,SELECT MIN(filed) AS earliest_filing_date FROM sub,earliest_filing_date: 2015-01-02 00:00:00,"{""value"": ""2015-01-02 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies filed 8-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('8-K'),Count: 112,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 112}",5.0,0.7,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies filed 10-Q forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-Q'),Count: 543,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 543}",5.0,0.7,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many financial facts are reported with coreg (co-registrant) information?,fact_count_with_coreg,SELECT COUNT(*) AS fact_count FROM num WHERE coreg IS NOT NULL AND TRIM(coreg) <> '',Count: 1261087,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 1261087}",5.0,0.7,template,,,,0.0166,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many XBRL tags are classified as 'string' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%string%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Debt' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%DEBT%'),Count: 26515,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 26515}",5.0,0.85,template,,,,0.035,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Equity' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%EQUITY%'),Count: 24563,"{""value"": 24563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0487,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Cash' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%CASH%'),Count: 29232,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 29232}",5.0,0.85,template,,,,0.0371,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What is the third most frequent XBRL tag in numerical data?,tag_nth_most_common,"WITH tag_counts AS (
    SELECT
        tag,
        COUNT(*) AS fact_count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    GROUP BY tag
)
SELECT tag, fact_count
FROM tag_counts
WHERE rank = 3
LIMIT 1",tag: Revenues | fact_count: 491457,"{""type"": ""text"", ""value"": ""Revenues""}",5.0,0.65,template,,,,0.0332,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many numerical facts have zero values?,fact_count_zero_values,SELECT COUNT(*) AS fact_count FROM num WHERE value = 0,Count: 1427015,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 1427015}",5.0,0.7,template,,,,0.0661,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many numerical facts have negative values?,fact_count_negative_values,SELECT COUNT(*) AS fact_count FROM num WHERE value < 0,Count: 2124201,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 2124201.0}",5.0,0.7,template,,,,0.0773,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many XBRL tags are classified as 'per-share' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%per-share%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0.0}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many XBRL tags have 'shares' as unit of measure in numerical data?,tag_count_by_unit,SELECT COUNT(DISTINCT tag) AS tag_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 949,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 949}",5.0,0.7,template,,,,0.0335,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many financial facts have duplicate values (dimhash populated)?,fact_count_dimhash_populated,SELECT COUNT(*) AS fact_count FROM num WHERE segments IS NOT NULL AND TRIM(segments) <> '',Count: 8738244,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 8738244}",5.0,0.7,template,,,,0.6423,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many different unit types (UOM) are present in the numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 49.0}",5.0,0.7,template,,,,0.0154,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Liability' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%LIABILITY%'),Count: 11059,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 11059}",5.0,0.7,template,,,,0.0395,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Asset' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%ASSET%'),Count: 40285,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 40285}",5.0,0.7,template,,,,0.0377,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Revenue' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%REVENUE%'),Count: 12221,"{""value"": 12221, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0406,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many XBRL tags are classified as 'monetary' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%monetary%'),Count: 454617,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 454617}",5.0,0.7,template,,,,0.0028,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many XBRL tags have a debit-credit flag of 'Debit'?,tag_count_by_debit_credit,SELECT COUNT(*) AS tag_count FROM tag WHERE crdr IS NOT NULL AND UPPER(TRIM(crdr)) = CASE WHEN UPPER(TRIM('Debit')) LIKE 'D%' THEN 'D' WHEN UPPER(TRIM('Debit')) LIKE 'C%' THEN 'C' ELSE UPPER(TRIM('Debit')) END,Count: 224017,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 224017}",5.0,0.7,template,,,,0.0058,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What is Google's (Alphabet) return on equity (ROE)?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%ALPHABET INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: ALPHABET INC. | roe_percentage: 32.91,"{""value"": 32.91, ""type"": ""numeric"", ""tolerance"": {""absolute"": 0.5}}",5.0,0.8,template,,,,0.2715,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in Georgia?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('GA')",Count: 22,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 22}",5.0,0.7,template,,,,0.007,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are incorporated in Bermuda?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('BM'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('BM'))
  )
",Count: 2,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",1.0,0.7,template,,,,0.0074,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in Washington state?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('WA')",Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",5.0,0.7,template,,,,0.0061,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,Which state has the third most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 3
",state: NY | count: 69,"{""value"": ""NY"", ""type"": ""text""}",5.0,0.65,template,,,,0.0076,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in Massachusetts?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('MA')",Count: 31,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 31}",5.0,0.7,template,,,,0.0078,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are incorporated in the United Kingdom?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('GB'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('GB'))
  )
",Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",1.0,0.7,template,,,,0.0094,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in North Carolina?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NC')",Count: 20,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",5.0,0.7,template,,,,0.0074,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in Ohio?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('OH')",Count: 24,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 24}",5.0,0.7,template,,,,0.0078,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many different US states are represented in headquarters data?,distinct_headquarters_states,SELECT COUNT(DISTINCT stprba) AS state_count FROM sub WHERE stprba IS NOT NULL,Count: 44,"{""value"": 44, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many different countries are represented in the incorporation data?,distinct_incorporation_countries,SELECT COUNT(DISTINCT countryinc) AS country_count FROM sub WHERE countryinc IS NOT NULL,Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 16}",5.0,0.7,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are incorporated in Switzerland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('CH'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('CH'))
  )
",Count: 4,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 5}",5.0,0.7,template,,,,0.0074,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in Florida?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('FL')",Count: 26,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 26}",5.0,0.7,template,,,,0.0063,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in Illinois?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('IL')",Count: 42,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 42}",5.0,0.7,template,,,,0.0077,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,Which state has the second most company headquarters after California?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 2
",state: TX | count: 81,"{""value"": ""TX"", ""type"": ""text""}",5.0,0.65,template,,,,0.008,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are incorporated in Canada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('CA'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('CA'))
  )
",Count: 11,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 11}",5.0,0.7,template,,,,0.0073,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are incorporated in Ireland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IE'))
  )
",Count: 11,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 6}",1.0,0.7,template,,,,0.007,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are incorporated in Nevada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('NV'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('NV'))
  )
",Count: 9,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 9}",5.0,0.7,template,,,,0.0076,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in Texas?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('TX')",Count: 81,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 81}",5.0,0.7,template,,,,0.0071,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are headquartered in New York?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NY')",Count: 69,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 69}",5.0,0.7,template,,,,0.0082,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,Which sector contains Johnson & Johnson?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%') LIMIT 1",JOHNSON & JOHNSON is in the Health Care sector.,"{""value"": ""Health Care"", ""type"": ""text""}",5.0,0.8,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many sectors have fewer than 25 companies?,sectors_below_threshold,"WITH sector_counts AS (
    SELECT gics_sector, COUNT(*) AS count
    FROM companies
    WHERE gics_sector IS NOT NULL
    GROUP BY gics_sector
)
SELECT COUNT(*) AS sector_count
FROM sector_counts
WHERE count < 25.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many sectors have more than 50 companies?,sectors_above_threshold,"SELECT COUNT(DISTINCT gics_sector) as sector_count FROM (SELECT gics_sector, COUNT(*) as cnt FROM companies GROUP BY gics_sector HAVING cnt > 50.0) subq",Count: 6,"{""value"": 6, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,Which sector has the fewest companies?,sector_with_fewest_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL AND gics_sector != 'Other' GROUP BY gics_sector ORDER BY count ASC LIMIT 1",AT&T INC is in the Real Estate sector.,"{""type"": ""text"", ""value"": ""Real Estate""}",5.0,0.8,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are in the Communication Services sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%communication services%'),There are 17 companies in the Communication Services sector.,"{""value"": 17, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are in the Real Estate sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%real estate%'),There are 3 companies in the Real Estate sector.,"{""value"": 3, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are in the Consumer Staples sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer staples%'),There are 28 companies in the Consumer Staples sector.,"{""value"": 28, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are in the Consumer Discretionary sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer discretionary%'),There are 99 companies in the Consumer Discretionary sector.,"{""value"": 99, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are in the Energy sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%energy%'),There are 51 companies in the Energy sector.,"{""value"": 51, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are in the Materials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%materials%'),There are 41 companies in the Materials sector.,"{""value"": 41, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,Which sector has the second most companies?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""AT&T INC is in the Financials sector."", ""type"": ""text""}",5.0,0.8,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are in the Industrials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%industrials%'),There are 82 companies in the Industrials sector.,"{""value"": 82, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What was Meta's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%META PLATFORMS, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 76793000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 76793000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.0591,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies reported cost of revenue in the latest period?,companies_reporting_cost_of_revenue,"WITH latest_cost AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'CostOfRevenue'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_cost
WHERE rn = 1 AND value IS NOT NULL",Count: 134,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 134}",5.0,0.85,template,,,,0.1217,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies have total revenue exceeding $50 billion in the latest period?,companies_revenue_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_revenue AS (
    SELECT lf.cik, n.value AS revenue
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('Revenues','SalesRevenueNet')
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS count
FROM latest_revenue
WHERE revenue > 50000000000.0",Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.85,template,,,,0.149,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What was Walmart's most recent total liabilities?,latest_total_liabilities,"
WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%WALMART INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.filed,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K', '10-K/A')
), selected_filing AS (
    SELECT adsh, cik, period, filed
    FROM latest_filing
    WHERE rn = 1
), metric_values AS (
    SELECT
        MAX(CASE WHEN n.tag = 'LiabilitiesAndStockholdersEquity' THEN n.value END) AS total_assets_equity,
        COALESCE(
            MAX(CASE WHEN n.tag = 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest' THEN n.value END),
            MAX(CASE WHEN n.tag = 'StockholdersEquity' THEN n.value END)
        ) AS equity
    FROM num n
    JOIN selected_filing lf ON n.adsh = lf.adsh
    WHERE n.tag IN (
        'LiabilitiesAndStockholdersEquity',
        'StockholdersEquity',
        'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest'
    )
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT
    (total_assets_equity - equity) AS total_liabilities,
    period AS period_end
FROM metric_values, selected_filing
",total_liabilities: 163402000000.0 | period_end: 2025-01-31 00:00:00,"{""type"": ""text"", ""value"": 163402000000.0, ""tolerance"": {""absolute"": 5000000000.0}}",5.0,0.8,template,,,,0.1306,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies reported positive net income in the latest period?,companies_positive_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_net_income AS (
    SELECT
        lf.cik,
        n.value,
        ROW_NUMBER() OVER (
            PARTITION BY lf.cik
            ORDER BY n.ddate DESC, n.adsh DESC
        ) AS rn
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT COUNT(*) AS company_count
FROM latest_net_income
WHERE rn = 1 AND value > 0",Count: 452,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 446}",3.0,0.85,template,,,,0.3176,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What was Johnson & Johnson's most recent gross profit?,latest_gross_profit,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS gross_profit,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'GrossProfit'
      AND n.qtrs IN (0,4)
)
SELECT gross_profit, period_end
FROM latest_metric
WHERE rn = 1",gross_profit: 55394000000.0 | period_end: 2024-12-31 00:00:00,"{""type"": ""numeric"", ""value"": 55394000000.0, ""tolerance"": {""absolute"": 2000000000.0}}",5.0,0.8,template,,,,0.1038,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What was Tesla's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 74653000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 74653000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.0686,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies have 'LLC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%LLC%'),Count: 5,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 5}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,Which company has CIK 0000019617?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000019617' LIMIT 1,JPMORGAN CHASE & CO's CIK is unknown.,"{""value"": ""JPMORGAN CHASE & CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0006,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies have 'INC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%INC%'),Count: 459,"{""value"": 459, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,Which company has CIK 0000050863?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000050863' LIMIT 1,INTEL CORP's CIK is unknown.,"{""value"": ""INTEL CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0006,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What is Walmart Inc.'s CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%WALMART INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",WALMART INC.'s CIK is 0000104169.,"{""value"": ""0000104169"", ""type"": ""text""}",5.0,0.8,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies have 'CORP' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%CORP%'),Count: 180,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What is Procter & Gamble's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%PROCTER & GAMBLE CO%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",PROCTER & GAMBLE CO's CIK is 0000080424.,"{""value"": ""0000080424"", ""type"": ""text""}",5.0,0.8,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,Which company has the longest company name in the dataset?,company_with_longest_name,SELECT name FROM companies ORDER BY LENGTH(name) DESC LIMIT 1,"name: CHARLES RIVER LABORATORIES INTERNATIONAL, INC.","{""type"": ""text"", ""value"": ""CHARLES RIVER LABORATORIES INTERNATIONAL, INC.""}",5.0,0.65,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What is Berkshire Hathaway's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%BERKSHIRE HATHAWAY INC%') LIMIT 1",BERKSHIRE HATHAWAY INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many quarterly (qtrs=1) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 1,Count: 3566310,"{""value"": 3566310, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0222,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are in the Utilities sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%utilities%'),There are 20 companies in the Utilities sector.,"{""value"": 20, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What is Tesla's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1","TESLA, INC.'s CIK is 0001318605.","{""value"": ""0001318605"", ""type"": ""text""}",5.0,0.8,template,,,,0.002,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many financial facts are denominated in USD?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0155,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,Which form type appears most frequently in submissions?,most_common_form_type,"SELECT form, COUNT(*) AS filing_count FROM sub GROUP BY form ORDER BY filing_count DESC LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many unique companies are represented in the dataset?,total_company_count,SELECT COUNT(DISTINCT cik) AS company_count FROM companies,Count: 589,"{""value"": 589, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What is the earliest period date in the financial data?,earliest_period_date,SELECT MIN(period) AS earliest_period FROM sub,earliest_period: 2014-05-31 00:00:00,"{""value"": ""2014-05-31 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies have international (non-US) incorporation?,international_incorporation_count,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS company_count
FROM latest_submission
WHERE rn = 1 AND UPPER(countryinc) <> 'US'",Count: 34,"{""value"": 34, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0086,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What is Amazon's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%AMAZON COM INC%') LIMIT 1",AMAZON COM INC is in the Consumer Discretionary sector.,"{""value"": ""Consumer Discretionary"", ""type"": ""text""}",5.0,0.8,template,,,,0.0121,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many different fiscal year ends are represented?,distinct_fiscal_year_total,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,Which state has the most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 1
",state: CA | count: 123,"{""value"": ""CA"", ""type"": ""text""}",5.0,0.65,template,,,,0.0078,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies filed 10-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-K'),Count: 563,"{""value"": 563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0023,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What is the most recent filing date in the dataset?,latest_filing_date,SELECT MAX(filed) AS latest_filing_date FROM sub,latest_filing_date: 2025-06-30 00:00:00,"{""value"": ""2025-06-30 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are in the Health Care sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%health care%'),There are 80 companies in the Health Care sector.,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,Which company has CIK 0000066740?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000066740' LIMIT 1,3M CO's CIK is unknown.,"{""value"": ""3M CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many financial facts have footnotes?,fact_count_with_footnotes,SELECT COUNT(*) AS fact_count FROM num WHERE footnote IS NOT NULL AND TRIM(CAST(footnote AS VARCHAR)) <> '',Count: 33959,"{""value"": 33959, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0133,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,What currency is used most frequently in the numerical data?,most_common_currency,"SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL GROUP BY 1 ORDER BY fact_count DESC LIMIT 1",currency: USD | fact_count: 14760135,"{""value"": ""USD"", ""type"": ""text""}",5.0,0.65,template,,,,0.0418,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many companies are incorporated in Delaware?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('DE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('DE'))
  )
",Count: 346,"{""value"": 346, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.021,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,Which sector has the most companies in our S&P 500 dataset?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,22.0223,0.0,0.0,0.0,0.0
RUN_018,"07 Nov 2025, 1600 hours",simple,How many S&P 500 companies are in the Information Technology sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%information technology%'),There are 165 companies in the Information Technology sector.,"{""value"": 165, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 300}, 'latency_ms': 4864, 'success': True}]",4.8758,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What is Johnson & Johnson's return on equity (ROE) percentage?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: JOHNSON & JOHNSON | roe_percentage: 20.06,"{""value"": 20.06, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1.0}}",5.0,0.8,template,,,,0.2308,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many facts are denominated in Hong Kong dollars (HKD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('HKD'),Count: 140,"{""value"": 140, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0103,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,"How many facts use per-share units (per share, per unit)?",fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""absolute"": 100}}",5.0,0.7,template,,,,0.0139,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What is the total count of unique unit types in the dataset?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 49, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0136,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many facts are denominated in Mexican pesos (MXN)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('MXN'),Count: 37,"{""value"": 37, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0086,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many facts use barrels as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('barrels'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many facts are denominated in Australian dollars (AUD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('AUD'),Count: 110,"{""value"": 110, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0129,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many facts use 'days' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('days'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0028,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What is the least common currency in the dataset?,least_common_currency,"WITH currency_counts AS (SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) ASC, UPPER(TRIM(uom))) AS currency_rank FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3 GROUP BY 1) SELECT currency, fact_count FROM currency_counts WHERE currency_rank = 1",currency: COP | fact_count: 1,"{""value"": ""COP"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0314,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many facts are measured in Japanese yen (JPY)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('JPY'),Count: 122,"{""value"": 122, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0139,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many facts use square feet as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('square feet'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0023,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many facts are denominated in Swiss francs (CHF)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CHF'),Count: 218,"{""value"": 218, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0133,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many facts use percentage as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('pure'),Count: 50344,"{""value"": 50344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0132,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What is the most common non-monetary unit of measure?,most_common_non_monetary_unit,"WITH unit_counts AS (
    SELECT UPPER(TRIM(uom)) AS unit, COUNT(*) AS cnt,
           ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    WHERE uom IS NOT NULL
      AND LENGTH(TRIM(uom)) <> 3
    GROUP BY 1
)
SELECT unit, cnt FROM unit_counts WHERE rank = 1",unit: SHARES | cnt: 642330,"{""value"": ""SHARES"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0164,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many facts are measured in British pounds (GBP)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('GBP'),Count: 446,"{""value"": 446, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0128,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many facts use 'shares' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.017,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many facts are denominated in Euros (EUR)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('EUR'),Count: 37847,"{""value"": 37847, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0141,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many facts are denominated in Canadian dollars (CAD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CAD'),Count: 2926,"{""value"": 2926, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0129,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What is the second most common currency in the dataset?,second_most_common_currency,"WITH currency_counts AS (SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS currency_rank FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3 GROUP BY 1) SELECT currency, fact_count FROM currency_counts WHERE currency_rank = 2",currency: EUR | fact_count: 37847,"{""value"": ""EUR"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.03,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many different currencies are represented in the financial data?,distinct_currency_count,SELECT COUNT(DISTINCT UPPER(TRIM(uom))) AS currency_count FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3,Count: 27,"{""value"": 27, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0206,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies returned more than 50% of operating cash flow to shareholders?,companies_shareholder_return_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), payout_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'PaymentsOfDividends' THEN n.value END) AS dividends,
        MAX(CASE WHEN n.tag = 'PaymentsForRepurchaseOfCommonStock' THEN n.value END) AS buybacks,
        MAX(CASE WHEN n.tag = 'NetCashProvidedByUsedInOperatingActivities' THEN n.value END) AS operating_cash_flow
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('PaymentsOfDividends','PaymentsForRepurchaseOfCommonStock','NetCashProvidedByUsedInOperatingActivities')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM payout_metrics
WHERE operating_cash_flow IS NOT NULL AND operating_cash_flow <> 0
  AND (COALESCE(dividends,0) + COALESCE(buybacks,0)) / operating_cash_flow > (CASE WHEN 0.5 > 1 THEN 0.5 / 100.0 ELSE 0.5 END)",Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,template,,,,0.1687,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies have free cash flow exceeding $10 billion?,companies_free_cash_flow_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value > 10000000000.0",Count: 11,"{""value"": 11, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,template,,,,0.1163,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies issued new debt during the period?,companies_new_debt_issued,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ProceedsFromIssuanceOfLongTermDebt'
  AND n.value > 0",Count: 215,"{""value"": 215, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.1247,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What was Johnson & Johnson's acquisition spending?,company_acquisition_spending,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS acquisition_spending,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K', '10-K/A')
      AND n.tag = 'PaymentsToAcquireBusinessesNetOfCashAcquired'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT acquisition_spending, period_end
FROM latest_metric
WHERE rn = 1
",acquisition_spending: 15146000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 15146000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",5.0,0.65,template,,,,0.2203,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies have negative operating cash flow?,companies_negative_operating_cash_flow,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value < 0",Count: 93,"{""value"": 93, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.1113,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What was Tesla's change in cash and cash equivalents?,companies_change_in_cash,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS change_in_cash,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
      AND n.qtrs IN (0,4)
)
SELECT change_in_cash, period_end
FROM latest_metric
WHERE rn = 1",change_in_cash: 14923000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 14923000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.85,template,,,,0.1081,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies spent more than $5 billion on acquisitions?,companies_acquisition_spending_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'PaymentsToAcquireBusinessesNetOfCashAcquired'
  AND ABS(n.value) > 5000000000.0",Count: 7,"{""value"": 7, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.7,template,,,,0.1266,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies have positive free cash flow?,companies_positive_free_cash_flow,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value > 0",Count: 525,"{""value"": 525, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.1246,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies have EBITDA exceeding $10 billion?,companies_ebitda_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh, period
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K', '10-K/A')
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('OperatingIncomeLoss',
        'OperatingIncomeLoss1',
        'OperatingProfitLoss',
        'EarningsBeforeInterestAndTaxes',
        'IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments',
        'IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest') THEN n.value END) AS operating_income,
        MAX(CASE WHEN n.tag IN ('DepreciationAndAmortization',
        'DepreciationAndAmortization1',
        'DepreciationAndAmortization2',
        'DepreciationAndAmortization3',
        'DepreciationAndAmortization4',
        'DepreciationAndAmortization5',
        'DepreciationAndAmortization6',
        'DepreciationAndAmortization7',
        'DepreciationAmortizationAndImpairment',
        'DepreciationDepletionAndAmortization',
        'DepreciationDepletionAndAmortization1',
        'DepreciationDepletionAndAmortization2',
        'DepreciationAndAmortizationExpense') THEN n.value END) AS depreciation_amortization
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = lf.period
      AND n.tag IN ('DepreciationAmortizationAndImpairment',
        'DepreciationAndAmortization',
        'DepreciationAndAmortization1',
        'DepreciationAndAmortization2',
        'DepreciationAndAmortization3',
        'DepreciationAndAmortization4',
        'DepreciationAndAmortization5',
        'DepreciationAndAmortization6',
        'DepreciationAndAmortization7',
        'DepreciationAndAmortizationExpense',
        'DepreciationDepletionAndAmortization',
        'DepreciationDepletionAndAmortization1',
        'DepreciationDepletionAndAmortization2',
        'EarningsBeforeInterestAndTaxes',
        'IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest',
        'IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments',
        'OperatingIncomeLoss',
        'OperatingIncomeLoss1',
        'OperatingProfitLoss')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE operating_income IS NOT NULL
  AND (operating_income + COALESCE(depreciation_amortization, 0)) > 10000000000.0
",Count: 62,"{""value"": 2, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.7575,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies reported foreign exchange gains/losses?,companies_forex_gain_loss,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag IN ('ForeignCurrencyTransactionGainLoss','GainLossOnForeignCurrencyExchange')
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.1698,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies have negative net income?,companies_negative_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetIncomeLoss'
  AND n.value < 0",Count: 201,"{""value"": 201, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.85,template,,,,0.1171,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What was Johnson & Johnson's income tax expense?,latest_income_tax_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS income_tax_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K', '10-K/A')
      AND n.tag = 'IncomeTaxExpenseBenefit'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT income_tax_expense, period_end
FROM latest_metric
WHERE rn = 1
",income_tax_expense: 2621000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 2621000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.2248,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies reported depreciation and amortization expenses?,companies_depreciation_amortization_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'DepreciationAndAmortization'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 321,"{""value"": 321, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.1249,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What was Tesla's other income (expense) in the latest period?,latest_other_income_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS other_income_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K', '10-K/A')
      AND n.tag = 'OtherNonoperatingIncomeExpense'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT other_income_expense, period_end
FROM latest_metric
WHERE rn = 1
",other_income_expense: 695000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 695000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",5.0,0.8,template,,,,0.244,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies have positive operating income?,companies_positive_operating_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'OperatingIncomeLoss'
  AND n.value > 0",Count: 907,"{""value"": 907.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.1106,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies reported research and development expenses?,companies_research_expense_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ResearchAndDevelopmentExpense'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 344,"{""value"": 344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.1057,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies have working capital exceeding $50 billion?,companies_working_capital_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND (current_assets - current_liabilities) > 50000000000.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.1552,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies report goodwill on their balance sheets?,companies_goodwill_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'Goodwill'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 3491,"{""value"": 3491.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.1068,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies have intangible assets exceeding $10 billion?,companies_intangibles_above_threshold,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'IntangibleAssetsNetExcludingGoodwill' THEN n.value END) AS intangible_assets
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag = 'IntangibleAssetsNetExcludingGoodwill'
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE intangible_assets IS NOT NULL AND intangible_assets > 10000000000.0",Count: 38,"{""value"": 38, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.1058,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies have negative stockholders' equity?,companies_negative_equity,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity < 0",Count: 1,"{""value"": 1, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.85,template,,,,0.1612,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,"What is Tesla's property, plant and equipment value?",latest_property_plant_equipment,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS property_plant_equipment,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PropertyPlantAndEquipmentNet'
      AND n.qtrs IN (0,4)
)
SELECT property_plant_equipment, period_end
FROM latest_metric
WHERE rn = 1",property_plant_equipment: 35836000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 37088000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.65,template,,,,0.11,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies have more liabilities than assets?,companies_more_liabilities_than_assets,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed,
                   ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Assets','Liabilities')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND liabilities IS NOT NULL
  AND liabilities > assets",Count: 25,"{""value"": 25, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.1567,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies have current assets exceeding $100 billion?,companies_current_assets_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_assets AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag = 'AssetsCurrent'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_assets
WHERE current_assets > 100000000000.0",Count: 9,"{""value"": 9, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.85,template,,,,0.2471,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies have Return on Equity above 20%?,companies_return_on_equity_above_threshold,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 0.2",Count: 431,"{""value"": 174, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.85,template,,,,1.1079,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies have gross margin above 50%?,companies_gross_margin_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('Revenues','SalesRevenueNet') THEN n.value END) AS revenue,
        MAX(CASE WHEN n.tag = 'CostOfRevenue' THEN n.value END) AS cost
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Revenues','SalesRevenueNet','CostOfRevenue')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE revenue IS NOT NULL
  AND revenue <> 0
  AND cost IS NOT NULL
  AND (revenue - cost) / revenue > 0.5",Count: 12,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.7647,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies have a debt-to-equity ratio above 1.0?,companies_debt_to_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Liabilities','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND liabilities IS NOT NULL
  AND liabilities / equity > 1.0",Count: 236,"{""value"": 236.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.1752,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies have negative Return on Assets?,companies_negative_return_on_assets,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('NetIncomeLoss','Assets')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL
  AND assets <> 0
  AND net_income IS NOT NULL
  AND net_income / assets < 0",Count: 24,"{""value"": 21, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.7887,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies have a current ratio above 2.0?,companies_current_ratio_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND current_liabilities <> 0
  AND current_assets / current_liabilities > 2.0",Count: 115,"{""value"": 115.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.7,template,,,,0.16,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies have positive Return on Equity in the latest period?,companies_positive_return_on_equity,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 0",Count: 433,"{""value"": 448, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,1.1989,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many annual (qtrs=0) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 0,Count: 5484928,"{""value"": 5484928, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0247,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What is the second most frequent form type in submissions?,form_type_rank,"WITH form_counts AS (
    SELECT form, COUNT(*) AS filing_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM sub
    GROUP BY form
)
SELECT form, filing_count
FROM form_counts
WHERE rank = 2
LIMIT 1",form: 10-K | filing_count: 6274,"{""value"": ""10-K"", ""type"": ""text""}",5.0,0.65,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many submissions are for fiscal period Q4?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q4'),Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 1}",5.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many submissions are for fiscal period Q3?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q3'),Count: 5238,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5238}",5.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many submissions are for fiscal period Q2?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q2'),Count: 5296,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5296}",5.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many submissions have September fiscal year end (0930)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0930',Count: 1134,"{""value"": 1134, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many submissions have June fiscal year end (0630)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0630',Count: 949,"{""value"": 949, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many submissions have March fiscal year end (0331)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0331',Count: 394,"{""value"": 394, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many submissions have December fiscal year end (1231)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '1231',Count: 17572,"{""value"": 17572, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many different form types are present in the submissions?,distinct_form_type_count,SELECT COUNT(DISTINCT form) AS form_type_count FROM sub,Count: 21,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 21}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many submissions have fiscal period FY (full year)?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('FY'),Count: 6476,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 6476}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many submissions have fiscal period Q1?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q1'),Count: 5664,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5664}",5.0,0.75,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many submissions have fiscal year 2025?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2025,Count: 917,"{""value"": 917, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many submissions have fiscal year 2024?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2024,Count: 4167,"{""value"": 4167, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.75,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What is the earliest filing date in the dataset?,earliest_filing_date,SELECT MIN(filed) AS earliest_filing_date FROM sub,earliest_filing_date: 2015-01-02 00:00:00,"{""value"": ""2015-01-02 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies filed 8-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('8-K'),Count: 112,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 112}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies filed 10-Q forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-Q'),Count: 543,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 543}",5.0,0.7,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many financial facts are reported with coreg (co-registrant) information?,fact_count_with_coreg,SELECT COUNT(*) AS fact_count FROM num WHERE coreg IS NOT NULL AND TRIM(coreg) <> '',Count: 1261087,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 1261087}",5.0,0.7,template,,,,0.0147,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many XBRL tags are classified as 'string' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%string%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Debt' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%DEBT%'),Count: 26515,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 26515}",5.0,0.85,template,,,,0.0342,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Equity' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%EQUITY%'),Count: 24563,"{""value"": 24563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.043,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Cash' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%CASH%'),Count: 29232,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 29232}",5.0,0.85,template,,,,0.0354,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What is the third most frequent XBRL tag in numerical data?,tag_nth_most_common,"WITH tag_counts AS (
    SELECT
        tag,
        COUNT(*) AS fact_count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    GROUP BY tag
)
SELECT tag, fact_count
FROM tag_counts
WHERE rank = 3
LIMIT 1",tag: Revenues | fact_count: 491457,"{""type"": ""text"", ""value"": ""Revenues""}",5.0,0.65,template,,,,0.0326,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many numerical facts have zero values?,fact_count_zero_values,SELECT COUNT(*) AS fact_count FROM num WHERE value = 0,Count: 1427015,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 1427015}",5.0,0.7,template,,,,0.0606,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many numerical facts have negative values?,fact_count_negative_values,SELECT COUNT(*) AS fact_count FROM num WHERE value < 0,Count: 2124201,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 2124201.0}",5.0,0.7,template,,,,0.065,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many XBRL tags are classified as 'per-share' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%per-share%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0.0}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many XBRL tags have 'shares' as unit of measure in numerical data?,tag_count_by_unit,SELECT COUNT(DISTINCT tag) AS tag_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 949,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 949}",5.0,0.7,template,,,,0.0334,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many financial facts have duplicate values (dimhash populated)?,fact_count_dimhash_populated,SELECT COUNT(*) AS fact_count FROM num WHERE segments IS NOT NULL AND TRIM(segments) <> '',Count: 8738244,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 8738244}",5.0,0.7,template,,,,0.6238,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many different unit types (UOM) are present in the numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 49.0}",5.0,0.7,template,,,,0.0122,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Liability' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%LIABILITY%'),Count: 11059,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 11059}",5.0,0.7,template,,,,0.033,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Asset' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%ASSET%'),Count: 40285,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 40285}",5.0,0.7,template,,,,0.0383,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Revenue' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%REVENUE%'),Count: 12221,"{""value"": 12221, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0401,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many XBRL tags are classified as 'monetary' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%monetary%'),Count: 454617,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 454617}",5.0,0.7,template,,,,0.0029,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many XBRL tags have a debit-credit flag of 'Debit'?,tag_count_by_debit_credit,SELECT COUNT(*) AS tag_count FROM tag WHERE crdr IS NOT NULL AND UPPER(TRIM(crdr)) = CASE WHEN UPPER(TRIM('Debit')) LIKE 'D%' THEN 'D' WHEN UPPER(TRIM('Debit')) LIKE 'C%' THEN 'C' ELSE UPPER(TRIM('Debit')) END,Count: 224017,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 224017}",5.0,0.7,template,,,,0.0056,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What is Google's (Alphabet) return on equity (ROE)?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%ALPHABET INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: ALPHABET INC. | roe_percentage: 32.91,"{""value"": 32.91, ""type"": ""numeric"", ""tolerance"": {""absolute"": 0.5}}",5.0,0.8,template,,,,0.2044,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are headquartered in Georgia?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('GA')",Count: 22,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 22}",5.0,0.7,template,,,,0.0073,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are incorporated in Bermuda?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('BM'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('BM'))
  )
",Count: 2,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",1.0,0.7,template,,,,0.0061,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are headquartered in Washington state?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('WA')",Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",5.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,Which state has the third most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 3
",state: NY | count: 69,"{""value"": ""NY"", ""type"": ""text""}",5.0,0.65,template,,,,0.0073,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are headquartered in Massachusetts?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('MA')",Count: 31,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 31}",5.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are incorporated in the United Kingdom?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('GB'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('GB'))
  )
",Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",1.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are headquartered in North Carolina?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NC')",Count: 20,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",5.0,0.7,template,,,,0.0067,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are headquartered in Ohio?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('OH')",Count: 24,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 24}",5.0,0.7,template,,,,0.0062,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many different US states are represented in headquarters data?,distinct_headquarters_states,SELECT COUNT(DISTINCT stprba) AS state_count FROM sub WHERE stprba IS NOT NULL,Count: 44,"{""value"": 44, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many different countries are represented in the incorporation data?,distinct_incorporation_countries,SELECT COUNT(DISTINCT countryinc) AS country_count FROM sub WHERE countryinc IS NOT NULL,Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 16}",5.0,0.7,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are incorporated in Switzerland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('CH'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('CH'))
  )
",Count: 4,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 5}",5.0,0.7,template,,,,0.0076,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are headquartered in Florida?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('FL')",Count: 26,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 26}",5.0,0.7,template,,,,0.0088,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are headquartered in Illinois?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('IL')",Count: 42,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 42}",5.0,0.7,template,,,,0.0087,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,Which state has the second most company headquarters after California?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 2
",state: TX | count: 81,"{""value"": ""TX"", ""type"": ""text""}",5.0,0.65,template,,,,0.0075,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are incorporated in Canada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('CA'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('CA'))
  )
",Count: 11,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 11}",5.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are incorporated in Ireland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IE'))
  )
",Count: 11,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 6}",1.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are incorporated in Nevada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('NV'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('NV'))
  )
",Count: 9,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 9}",5.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are headquartered in Texas?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('TX')",Count: 81,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 81}",5.0,0.7,template,,,,0.0064,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are headquartered in New York?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NY')",Count: 69,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 69}",5.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,Which sector contains Johnson & Johnson?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%') LIMIT 1",JOHNSON & JOHNSON is in the Health Care sector.,"{""value"": ""Health Care"", ""type"": ""text""}",5.0,0.8,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many sectors have fewer than 25 companies?,sectors_below_threshold,"WITH sector_counts AS (
    SELECT gics_sector, COUNT(*) AS count
    FROM companies
    WHERE gics_sector IS NOT NULL
    GROUP BY gics_sector
)
SELECT COUNT(*) AS sector_count
FROM sector_counts
WHERE count < 25.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many sectors have more than 50 companies?,sectors_above_threshold,"SELECT COUNT(DISTINCT gics_sector) as sector_count FROM (SELECT gics_sector, COUNT(*) as cnt FROM companies GROUP BY gics_sector HAVING cnt > 50.0) subq",Count: 6,"{""value"": 6, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0022,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,Which sector has the fewest companies?,sector_with_fewest_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL AND gics_sector != 'Other' GROUP BY gics_sector ORDER BY count ASC LIMIT 1",AT&T INC is in the Real Estate sector.,"{""type"": ""text"", ""value"": ""Real Estate""}",5.0,0.8,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are in the Communication Services sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%communication services%'),There are 17 companies in the Communication Services sector.,"{""value"": 17, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are in the Real Estate sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%real estate%'),There are 3 companies in the Real Estate sector.,"{""value"": 3, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are in the Consumer Staples sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer staples%'),There are 28 companies in the Consumer Staples sector.,"{""value"": 28, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are in the Consumer Discretionary sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer discretionary%'),There are 99 companies in the Consumer Discretionary sector.,"{""value"": 99, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are in the Energy sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%energy%'),There are 51 companies in the Energy sector.,"{""value"": 51, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are in the Materials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%materials%'),There are 41 companies in the Materials sector.,"{""value"": 41, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,Which sector has the second most companies?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""AT&T INC is in the Financials sector."", ""type"": ""text""}",5.0,0.8,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are in the Industrials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%industrials%'),There are 82 companies in the Industrials sector.,"{""value"": 82, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What was Meta's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%META PLATFORMS, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 76793000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 76793000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.0593,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies reported cost of revenue in the latest period?,companies_reporting_cost_of_revenue,"WITH latest_cost AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'CostOfRevenue'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_cost
WHERE rn = 1 AND value IS NOT NULL",Count: 134,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 134}",5.0,0.85,template,,,,0.1114,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies have total revenue exceeding $50 billion in the latest period?,companies_revenue_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_revenue AS (
    SELECT lf.cik, n.value AS revenue
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('Revenues','SalesRevenueNet')
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS count
FROM latest_revenue
WHERE revenue > 50000000000.0",Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.85,template,,,,0.119,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What was Walmart's most recent total liabilities?,latest_total_liabilities,"
WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%WALMART INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.filed,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K', '10-K/A')
), selected_filing AS (
    SELECT adsh, cik, period, filed
    FROM latest_filing
    WHERE rn = 1
), metric_values AS (
    SELECT
        MAX(CASE WHEN n.tag = 'LiabilitiesAndStockholdersEquity' THEN n.value END) AS total_assets_equity,
        COALESCE(
            MAX(CASE WHEN n.tag = 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest' THEN n.value END),
            MAX(CASE WHEN n.tag = 'StockholdersEquity' THEN n.value END)
        ) AS equity
    FROM num n
    JOIN selected_filing lf ON n.adsh = lf.adsh
    WHERE n.tag IN (
        'LiabilitiesAndStockholdersEquity',
        'StockholdersEquity',
        'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest'
    )
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT
    (total_assets_equity - equity) AS total_liabilities,
    period AS period_end
FROM metric_values, selected_filing
",total_liabilities: 163402000000.0 | period_end: 2025-01-31 00:00:00,"{""type"": ""text"", ""value"": 163402000000.0, ""tolerance"": {""absolute"": 5000000000.0}}",5.0,0.8,template,,,,0.1317,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies reported positive net income in the latest period?,companies_positive_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_net_income AS (
    SELECT
        lf.cik,
        n.value
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT COUNT(*) AS company_count
FROM latest_net_income
WHERE value > 0",Count: 5700,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 446}",1.0,0.85,template,,,,0.2913,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What was Johnson & Johnson's most recent gross profit?,latest_gross_profit,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS gross_profit,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'GrossProfit'
      AND n.qtrs IN (0,4)
)
SELECT gross_profit, period_end
FROM latest_metric
WHERE rn = 1",gross_profit: 55394000000.0 | period_end: 2024-12-31 00:00:00,"{""type"": ""numeric"", ""value"": 55394000000.0, ""tolerance"": {""absolute"": 2000000000.0}}",5.0,0.8,template,,,,0.1028,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What was Tesla's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 74653000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 74653000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.0676,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies have 'LLC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%LLC%'),Count: 5,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 5}",5.0,0.7,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,Which company has CIK 0000019617?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000019617' LIMIT 1,JPMORGAN CHASE & CO's CIK is unknown.,"{""value"": ""JPMORGAN CHASE & CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies have 'INC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%INC%'),Count: 459,"{""value"": 459, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,Which company has CIK 0000050863?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000050863' LIMIT 1,INTEL CORP's CIK is unknown.,"{""value"": ""INTEL CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What is Walmart Inc.'s CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%WALMART INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",WALMART INC.'s CIK is 0000104169.,"{""value"": ""0000104169"", ""type"": ""text""}",5.0,0.8,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies have 'CORP' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%CORP%'),Count: 180,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What is Procter & Gamble's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%PROCTER & GAMBLE CO%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",PROCTER & GAMBLE CO's CIK is 0000080424.,"{""value"": ""0000080424"", ""type"": ""text""}",5.0,0.8,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,Which company has the longest company name in the dataset?,company_with_longest_name,SELECT name FROM companies ORDER BY LENGTH(name) DESC LIMIT 1,"name: CHARLES RIVER LABORATORIES INTERNATIONAL, INC.","{""type"": ""text"", ""value"": ""CHARLES RIVER LABORATORIES INTERNATIONAL, INC.""}",5.0,0.65,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What is Berkshire Hathaway's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%BERKSHIRE HATHAWAY INC%') LIMIT 1",BERKSHIRE HATHAWAY INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many quarterly (qtrs=1) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 1,Count: 3566310,"{""value"": 3566310, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0235,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are in the Utilities sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%utilities%'),There are 20 companies in the Utilities sector.,"{""value"": 20, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What is Tesla's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1","TESLA, INC.'s CIK is 0001318605.","{""value"": ""0001318605"", ""type"": ""text""}",5.0,0.8,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many financial facts are denominated in USD?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0153,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,Which form type appears most frequently in submissions?,most_common_form_type,"SELECT form, COUNT(*) AS filing_count FROM sub GROUP BY form ORDER BY filing_count DESC LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many unique companies are represented in the dataset?,total_company_count,SELECT COUNT(DISTINCT cik) AS company_count FROM companies,Count: 589,"{""value"": 589, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What is the earliest period date in the financial data?,earliest_period_date,SELECT MIN(period) AS earliest_period FROM sub,earliest_period: 2014-05-31 00:00:00,"{""value"": ""2014-05-31 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies have international (non-US) incorporation?,international_incorporation_count,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS company_count
FROM latest_submission
WHERE rn = 1 AND UPPER(countryinc) <> 'US'",Count: 34,"{""value"": 34, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0059,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What is Amazon's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%AMAZON COM INC%') LIMIT 1",AMAZON COM INC is in the Consumer Discretionary sector.,"{""value"": ""Consumer Discretionary"", ""type"": ""text""}",5.0,0.8,template,,,,0.0118,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many different fiscal year ends are represented?,distinct_fiscal_year_total,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,Which state has the most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 1
",state: CA | count: 123,"{""value"": ""CA"", ""type"": ""text""}",5.0,0.65,template,,,,0.0075,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies filed 10-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-K'),Count: 563,"{""value"": 563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0023,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What is the most recent filing date in the dataset?,latest_filing_date,SELECT MAX(filed) AS latest_filing_date FROM sub,latest_filing_date: 2025-06-30 00:00:00,"{""value"": ""2025-06-30 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are in the Health Care sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%health care%'),There are 80 companies in the Health Care sector.,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,Which company has CIK 0000066740?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000066740' LIMIT 1,3M CO's CIK is unknown.,"{""value"": ""3M CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many financial facts have footnotes?,fact_count_with_footnotes,SELECT COUNT(*) AS fact_count FROM num WHERE footnote IS NOT NULL AND TRIM(CAST(footnote AS VARCHAR)) <> '',Count: 33959,"{""value"": 33959, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0145,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,What currency is used most frequently in the numerical data?,most_common_currency,"SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL GROUP BY 1 ORDER BY fact_count DESC LIMIT 1",currency: USD | fact_count: 14760135,"{""value"": ""USD"", ""type"": ""text""}",5.0,0.65,template,,,,0.0276,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many companies are incorporated in Delaware?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('DE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('DE'))
  )
",Count: 346,"{""value"": 346, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0159,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,Which sector has the most companies in our S&P 500 dataset?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,20.0259,0.0,0.0,0.0,0.0
RUN_017,"07 Nov 2025, 1500 hours",simple,How many S&P 500 companies are in the Information Technology sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%information technology%'),There are 165 companies in the Information Technology sector.,"{""value"": 165, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 292}, 'latency_ms': 3667, 'success': True}]",3.6803,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What is Johnson & Johnson's return on equity (ROE) percentage?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: JOHNSON & JOHNSON | roe_percentage: 20.06,"{""value"": 20.06, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1.0}}",5.0,0.8,template,,,,0.4065,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Hong Kong dollars (HKD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('HKD'),Count: 140,"{""value"": 140, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0211,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,"How many facts use per-share units (per share, per unit)?",fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""absolute"": 100}}",5.0,0.7,template,,,,0.0278,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What is the total count of unique unit types in the dataset?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 49, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0258,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Mexican pesos (MXN)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('MXN'),Count: 37,"{""value"": 37, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0096,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many facts use barrels as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('barrels'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0036,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Australian dollars (AUD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('AUD'),Count: 110,"{""value"": 110, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0155,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many facts use 'days' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('days'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0034,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What is the least common currency in the dataset?,least_common_currency,"WITH currency_counts AS (SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) ASC, UPPER(TRIM(uom))) AS currency_rank FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3 GROUP BY 1) SELECT currency, fact_count FROM currency_counts WHERE currency_rank = 1",currency: COP | fact_count: 1,"{""value"": ""COP"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0459,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many facts are measured in Japanese yen (JPY)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('JPY'),Count: 122,"{""value"": 122, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0203,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many facts use square feet as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('square feet'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0027,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Swiss francs (CHF)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CHF'),Count: 218,"{""value"": 218, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.02,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many facts use percentage as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('pure'),Count: 50344,"{""value"": 50344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0185,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What is the most common non-monetary unit of measure?,most_common_non_monetary_unit,"WITH unit_counts AS (
    SELECT UPPER(TRIM(uom)) AS unit, COUNT(*) AS cnt,
           ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    WHERE uom IS NOT NULL
      AND LENGTH(TRIM(uom)) <> 3
    GROUP BY 1
)
SELECT unit, cnt FROM unit_counts WHERE rank = 1",unit: SHARES | cnt: 642330,"{""value"": ""SHARES"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0319,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many facts are measured in British pounds (GBP)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('GBP'),Count: 446,"{""value"": 446, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0255,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many facts use 'shares' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0283,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Euros (EUR)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('EUR'),Count: 37847,"{""value"": 37847, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0206,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Canadian dollars (CAD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CAD'),Count: 2926,"{""value"": 2926, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0168,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What is the second most common currency in the dataset?,second_most_common_currency,"WITH currency_counts AS (SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS currency_rank FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3 GROUP BY 1) SELECT currency, fact_count FROM currency_counts WHERE currency_rank = 2",currency: EUR | fact_count: 37847,"{""value"": ""EUR"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0446,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many different currencies are represented in the financial data?,distinct_currency_count,SELECT COUNT(DISTINCT UPPER(TRIM(uom))) AS currency_count FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3,Count: 27,"{""value"": 27, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0297,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies returned more than 50% of operating cash flow to shareholders?,companies_shareholder_return_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), payout_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'PaymentsOfDividends' THEN n.value END) AS dividends,
        MAX(CASE WHEN n.tag = 'PaymentsForRepurchaseOfCommonStock' THEN n.value END) AS buybacks,
        MAX(CASE WHEN n.tag = 'NetCashProvidedByUsedInOperatingActivities' THEN n.value END) AS operating_cash_flow
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('PaymentsOfDividends','PaymentsForRepurchaseOfCommonStock','NetCashProvidedByUsedInOperatingActivities')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM payout_metrics
WHERE operating_cash_flow IS NOT NULL AND operating_cash_flow <> 0
  AND (COALESCE(dividends,0) + COALESCE(buybacks,0)) / operating_cash_flow > (CASE WHEN 50.0 > 1 THEN 50.0 / 100.0 ELSE 50.0 END)",Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,template,,,,0.3013,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies have free cash flow exceeding $10 billion?,companies_free_cash_flow_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value > 10000000000.0",Count: 11,"{""value"": 11, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,template,,,,0.2204,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies issued new debt during the period?,companies_new_debt_issued,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ProceedsFromIssuanceOfLongTermDebt'
  AND n.value > 0",Count: 215,"{""value"": 215, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.4023,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What was Johnson & Johnson's acquisition spending?,company_acquisition_spending,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS acquisition_spending,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PaymentsToAcquireBusinessesNetOfCashAcquired'
      AND n.qtrs IN (0,4)
)
SELECT acquisition_spending, period_end
FROM latest_metric
WHERE rn = 1",acquisition_spending: 800000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 1800000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",1.0,0.65,template,,,,0.1006,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies have negative operating cash flow?,companies_negative_operating_cash_flow,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value < 0",Count: 93,"{""value"": 93, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.1314,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What was Tesla's change in cash and cash equivalents?,companies_change_in_cash,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS change_in_cash,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
      AND n.qtrs IN (0,4)
)
SELECT change_in_cash, period_end
FROM latest_metric
WHERE rn = 1",change_in_cash: 14923000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 14923000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.85,template,,,,0.1934,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies spent more than $5 billion on acquisitions?,companies_acquisition_spending_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'PaymentsToAcquireBusinessesNetOfCashAcquired'
  AND ABS(n.value) > 5000000000.0",Count: 7,"{""value"": 7, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.7,template,,,,0.22,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies have positive free cash flow?,companies_positive_free_cash_flow,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value > 0",Count: 525,"{""value"": 525, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.4423,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies have EBITDA exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 2, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0554,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies reported foreign exchange gains/losses?,companies_forex_gain_loss,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag IN ('ForeignCurrencyTransactionGainLoss','GainLossOnForeignCurrencyExchange')
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.781,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies have negative net income?,companies_negative_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetIncomeLoss'
  AND n.value < 0",Count: 201,"{""value"": 201, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.85,template,,,,0.1334,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What was Johnson & Johnson's income tax expense?,latest_income_tax_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS income_tax_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'IncomeTaxExpenseBenefit'
      AND n.qtrs IN (0,4)
)
SELECT income_tax_expense, period_end
FROM latest_metric
WHERE rn = 1",income_tax_expense: 2989000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 2621000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.8,template,,,,0.1008,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies reported depreciation and amortization expenses?,companies_depreciation_amortization_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'DepreciationAndAmortization'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 321,"{""value"": 321, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.1118,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What was Tesla's other income (expense) in the latest period?,latest_other_income_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS other_income_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'OtherNonoperatingIncomeExpense'
      AND n.qtrs IN (0,4)
)
SELECT other_income_expense, period_end
FROM latest_metric
WHERE rn = 1",other_income_expense: 172000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": -43000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",1.0,0.8,template,,,,0.1079,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies have positive operating income?,companies_positive_operating_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'OperatingIncomeLoss'
  AND n.value > 0",Count: 907,"{""value"": 907.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.1171,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies reported research and development expenses?,companies_research_expense_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ResearchAndDevelopmentExpense'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 344,"{""value"": 344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.1201,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies have working capital exceeding $50 billion?,companies_working_capital_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND (current_assets - current_liabilities) > 50000000000.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.1784,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies report goodwill on their balance sheets?,companies_goodwill_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'Goodwill'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 3491,"{""value"": 3491.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.1467,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies have intangible assets exceeding $10 billion?,companies_intangibles_above_threshold,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'IntangibleAssetsNetExcludingGoodwill' THEN n.value END) AS intangible_assets
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag = 'IntangibleAssetsNetExcludingGoodwill'
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE intangible_assets IS NOT NULL AND intangible_assets > 10000000000.0",Count: 38,"{""value"": 38, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.0999,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies have negative stockholders' equity?,companies_negative_equity,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity < 0",Count: 1,"{""value"": 1, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.85,template,,,,0.1865,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,"What is Tesla's property, plant and equipment value?",latest_property_plant_equipment,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS property_plant_equipment,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PropertyPlantAndEquipmentNet'
      AND n.qtrs IN (0,4)
)
SELECT property_plant_equipment, period_end
FROM latest_metric
WHERE rn = 1",property_plant_equipment: 35836000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 37088000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.65,template,,,,0.1053,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies have more liabilities than assets?,companies_more_liabilities_than_assets,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed,
                   ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Assets','Liabilities')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND liabilities IS NOT NULL
  AND liabilities > assets",Count: 25,"{""value"": 25, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.248,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies have current assets exceeding $100 billion?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%MASTERCARD INC%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",MASTERCARD INC has 0 matching records.,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",3.0,0.85,llm_template_selection,,,,21.0721,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies have Return on Equity above 20%?,companies_return_on_equity_above_threshold,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 20.0",Count: 177,"{""value"": 174, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,1.3337,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies have gross margin above 50%?,companies_gross_margin_above_threshold,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('Revenues','SalesRevenueNet') THEN n.value END) AS revenue,
        MAX(CASE WHEN n.tag = 'CostOfRevenue' THEN n.value END) AS cost
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Revenues','SalesRevenueNet','CostOfRevenue')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE revenue IS NOT NULL AND revenue <> 0 AND cost IS NOT NULL
  AND (revenue - cost) / revenue > 50.0",Count: 0,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",3.0,0.7,template,,,,0.1843,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies have a debt-to-equity ratio above 1.0?,companies_debt_to_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Liabilities','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND liabilities IS NOT NULL
  AND liabilities / equity > 1.0",Count: 236,"{""value"": 236.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.1936,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies have negative Return on Assets?,companies_negative_return_on_assets,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('NetIncomeLoss','Assets')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND assets <> 0 AND net_income IS NOT NULL AND net_income / assets < 0",Count: 3,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",3.0,0.85,template,,,,0.1864,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies have a current ratio above 2.0?,companies_current_ratio_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND current_liabilities <> 0
  AND current_assets / current_liabilities > 2.0",Count: 115,"{""value"": 115.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.7,template,,,,0.1735,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies have positive Return on Equity in the latest period?,companies_positive_return_on_equity,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 0",Count: 433,"{""value"": 448, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,1.1745,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many annual (qtrs=0) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 0,Count: 5484928,"{""value"": 5484928, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0249,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What is the second most frequent form type in submissions?,form_type_rank,"WITH form_counts AS (
    SELECT form, COUNT(*) AS filing_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM sub
    GROUP BY form
)
SELECT form, filing_count
FROM form_counts
WHERE rank = 2
LIMIT 1",form: 10-K | filing_count: 6274,"{""value"": ""10-K"", ""type"": ""text""}",5.0,0.65,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many submissions are for fiscal period Q4?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q4'),Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 1}",5.0,0.75,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many submissions are for fiscal period Q3?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q3'),Count: 5238,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5238}",5.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many submissions are for fiscal period Q2?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q2'),Count: 5296,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5296}",5.0,0.75,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many submissions have September fiscal year end (0930)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0930',Count: 1134,"{""value"": 1134, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many submissions have June fiscal year end (0630)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0630',Count: 949,"{""value"": 949, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many submissions have March fiscal year end (0331)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0331',Count: 394,"{""value"": 394, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many submissions have December fiscal year end (1231)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '1231',Count: 17572,"{""value"": 17572, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many different form types are present in the submissions?,distinct_form_type_count,SELECT COUNT(DISTINCT form) AS form_type_count FROM sub,Count: 21,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 21}",5.0,0.7,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal period FY (full year)?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('FY'),Count: 6476,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 6476}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal period Q1?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q1'),Count: 5664,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5664}",5.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal year 2025?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2025,Count: 917,"{""value"": 917, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.75,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal year 2024?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2024,Count: 4167,"{""value"": 4167, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.75,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What is the earliest filing date in the dataset?,earliest_filing_date,SELECT MIN(filed) AS earliest_filing_date FROM sub,earliest_filing_date: 2015-01-02 00:00:00,"{""value"": ""2015-01-02 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies filed 8-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('8-K'),Count: 112,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 112}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies filed 10-Q forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-Q'),Count: 543,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 543}",5.0,0.7,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many financial facts are reported with coreg (co-registrant) information?,fact_count_with_coreg,SELECT COUNT(*) AS fact_count FROM num WHERE coreg IS NOT NULL AND TRIM(coreg) <> '',Count: 1261087,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 1261087}",5.0,0.7,template,,,,0.0154,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many XBRL tags are classified as 'string' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%string%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Debt' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%DEBT%'),Count: 26515,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 26515}",5.0,0.85,template,,,,0.036,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Equity' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%EQUITY%'),Count: 24563,"{""value"": 24563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0607,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Cash' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%CASH%'),Count: 29232,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 29232}",5.0,0.85,template,,,,0.0351,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What is the third most frequent XBRL tag in numerical data?,tag_nth_most_common,"WITH tag_counts AS (
    SELECT
        tag,
        COUNT(*) AS fact_count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    GROUP BY tag
)
SELECT tag, fact_count
FROM tag_counts
WHERE rank = 3
LIMIT 1",tag: Revenues | fact_count: 491457,"{""type"": ""text"", ""value"": ""Revenues""}",5.0,0.65,template,,,,0.0328,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many numerical facts have zero values?,fact_count_zero_values,SELECT COUNT(*) AS fact_count FROM num WHERE value = 0,Count: 1427015,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 1427015}",5.0,0.7,template,,,,0.0588,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many numerical facts have negative values?,fact_count_negative_values,SELECT COUNT(*) AS fact_count FROM num WHERE value < 0,Count: 2124201,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 2124201.0}",5.0,0.7,template,,,,0.06,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many XBRL tags are classified as 'per-share' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%per-share%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0.0}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many XBRL tags have 'shares' as unit of measure in numerical data?,tag_count_by_unit,SELECT COUNT(DISTINCT tag) AS tag_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 949,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 949}",5.0,0.7,template,,,,0.035,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many financial facts have duplicate values (dimhash populated)?,fact_count_dimhash_populated,SELECT COUNT(*) AS fact_count FROM num WHERE segments IS NOT NULL AND TRIM(segments) <> '',Count: 8738244,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 8738244}",5.0,0.7,template,,,,0.6579,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many different unit types (UOM) are present in the numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 49.0}",5.0,0.7,template,,,,0.0136,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Liability' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%LIABILITY%'),Count: 11059,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 11059}",5.0,0.7,template,,,,0.0348,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Asset' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%ASSET%'),Count: 40285,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 40285}",5.0,0.7,template,,,,0.0435,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Revenue' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%REVENUE%'),Count: 12221,"{""value"": 12221, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.045,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many XBRL tags are classified as 'monetary' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%monetary%'),Count: 454617,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 454617}",5.0,0.7,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many XBRL tags have a debit-credit flag of 'Debit'?,tag_count_by_debit_credit,SELECT COUNT(*) AS tag_count FROM tag WHERE crdr IS NOT NULL AND UPPER(TRIM(crdr)) = CASE WHEN UPPER(TRIM('Debit')) LIKE 'D%' THEN 'D' WHEN UPPER(TRIM('Debit')) LIKE 'C%' THEN 'C' ELSE UPPER(TRIM('Debit')) END,Count: 224017,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 224017}",5.0,0.7,template,,,,0.0044,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What is Google's (Alphabet) return on equity (ROE)?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%ALPHABET INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: ALPHABET INC. | roe_percentage: 32.91,"{""value"": 32.91, ""type"": ""numeric"", ""tolerance"": {""absolute"": 0.5}}",5.0,0.8,template,,,,0.2087,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Georgia?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('GA')",Count: 22,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 22}",5.0,0.7,template,,,,0.0064,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Bermuda?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",5.0,0.7,template,,,,0.0071,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Washington state?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('WA')",Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",5.0,0.7,template,,,,0.0066,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,Which state has the third most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 3
",state: NY | count: 69,"{""value"": ""NY"", ""type"": ""text""}",5.0,0.65,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Massachusetts?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('MA')",Count: 31,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 27}",3.0,0.7,template,,,,0.0067,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in the United Kingdom?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",5.0,0.7,template,,,,0.0067,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in North Carolina?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NC')",Count: 20,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",5.0,0.7,template,,,,0.0067,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Ohio?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('OH')",Count: 24,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",3.0,0.7,template,,,,0.0067,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many different US states are represented in headquarters data?,distinct_headquarters_states,SELECT COUNT(DISTINCT stprba) AS state_count FROM sub WHERE stprba IS NOT NULL,Count: 44,"{""value"": 44, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many different countries are represented in the incorporation data?,distinct_incorporation_countries,SELECT COUNT(DISTINCT countryinc) AS country_count FROM sub WHERE countryinc IS NOT NULL,Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 16}",5.0,0.7,template,,,,0.0024,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Switzerland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 5}",5.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Florida?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('FL')",Count: 26,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 26}",5.0,0.7,template,,,,0.006,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Illinois?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('IL')",Count: 42,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 42}",5.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,Which state has the second most company headquarters after California?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 2
",state: TX | count: 81,"{""value"": ""TX"", ""type"": ""text""}",5.0,0.65,template,,,,0.0078,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Canada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 3}",3.0,0.7,template,,,,0.0066,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Ireland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 6}",5.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Nevada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('NV'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('NV'))
  )
",Count: 9,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 9}",5.0,0.7,template,,,,0.0063,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Texas?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('TX')",Count: 81,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 81}",5.0,0.7,template,,,,0.0062,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in New York?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NY')",Count: 69,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 69}",5.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,Which sector contains Johnson & Johnson?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%') LIMIT 1",JOHNSON & JOHNSON is in the Health Care sector.,"{""value"": ""Health Care"", ""type"": ""text""}",5.0,0.8,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many sectors have fewer than 25 companies?,sectors_below_threshold,"WITH sector_counts AS (
    SELECT gics_sector, COUNT(*) AS count
    FROM companies
    WHERE gics_sector IS NOT NULL
    GROUP BY gics_sector
)
SELECT COUNT(*) AS sector_count
FROM sector_counts
WHERE count < 25.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many sectors have more than 50 companies?,sectors_above_threshold,"SELECT COUNT(DISTINCT gics_sector) as sector_count FROM (SELECT gics_sector, COUNT(*) as cnt FROM companies GROUP BY gics_sector HAVING cnt > 50.0) subq",Count: 6,"{""value"": 6, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.004,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,Which sector has the fewest companies?,sector_with_fewest_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL AND gics_sector != 'Other' GROUP BY gics_sector ORDER BY count ASC LIMIT 1",AT&T INC is in the Real Estate sector.,"{""type"": ""text"", ""value"": ""Real Estate""}",5.0,0.8,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are in the Communication Services sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%communication services%'),There are 17 companies in the Communication Services sector.,"{""value"": 17, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are in the Real Estate sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%real estate%'),There are 3 companies in the Real Estate sector.,"{""value"": 3, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are in the Consumer Staples sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer staples%'),There are 28 companies in the Consumer Staples sector.,"{""value"": 26, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",3.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are in the Consumer Discretionary sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer discretionary%'),There are 99 companies in the Consumer Discretionary sector.,"{""value"": 99, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are in the Energy sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%energy%'),There are 51 companies in the Energy sector.,"{""value"": 51, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are in the Materials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%materials%'),There are 41 companies in the Materials sector.,"{""value"": 41, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,Which sector has the second most companies?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""AT&T INC is in the Financials sector."", ""type"": ""text""}",5.0,0.8,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are in the Industrials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%industrials%'),There are 82 companies in the Industrials sector.,"{""value"": 82, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What was Meta's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%META PLATFORMS, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 76793000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 76793000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.0622,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies reported cost of revenue in the latest period?,companies_reporting_cost_of_revenue,"WITH latest_cost AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'CostOfRevenue'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_cost
WHERE rn = 1 AND value IS NOT NULL",Count: 134,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 134}",5.0,0.85,template,,,,0.1138,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies have total revenue exceeding $50 billion in the latest period?,companies_revenue_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_revenue AS (
    SELECT lf.cik, n.value AS revenue
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('Revenues','SalesRevenueNet')
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS count
FROM latest_revenue
WHERE revenue > 50000000000.0",Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.85,template,,,,0.1381,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What was Walmart's most recent total liabilities?,latest_total_liabilities,"
WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%WALMART INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.filed,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K', '10-K/A')
), selected_filing AS (
    SELECT adsh, cik, period, filed
    FROM latest_filing
    WHERE rn = 1
), metric_values AS (
    SELECT
        MAX(CASE WHEN n.tag = 'LiabilitiesAndStockholdersEquity' THEN n.value END) AS total_assets_equity,
        COALESCE(
            MAX(CASE WHEN n.tag = 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest' THEN n.value END),
            MAX(CASE WHEN n.tag = 'StockholdersEquity' THEN n.value END)
        ) AS equity
    FROM num n
    JOIN selected_filing lf ON n.adsh = lf.adsh
    WHERE n.tag IN (
        'LiabilitiesAndStockholdersEquity',
        'StockholdersEquity',
        'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest'
    )
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT
    (total_assets_equity - equity) AS total_liabilities,
    period AS period_end
FROM metric_values, selected_filing
",total_liabilities: 163402000000.0 | period_end: 2025-01-31 00:00:00,"{""type"": ""text"", ""value"": 163402000000.0, ""tolerance"": {""absolute"": 5000000000.0}}",5.0,0.8,template,,,,0.1826,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies reported positive net income in the latest period?,companies_positive_net_income,"WITH latest_net_income AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_net_income
WHERE rn = 1 AND value > 0",Count: 457,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 447.0}",3.0,0.85,template,,,,0.1597,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What was Johnson & Johnson's most recent gross profit?,latest_gross_profit,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS gross_profit,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'GrossProfit'
      AND n.qtrs IN (0,4)
)
SELECT gross_profit, period_end
FROM latest_metric
WHERE rn = 1",gross_profit: 55394000000.0 | period_end: 2024-12-31 00:00:00,"{""type"": ""numeric"", ""value"": 55394000000.0, ""tolerance"": {""absolute"": 2000000000.0}}",5.0,0.8,template,,,,0.2245,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What was Tesla's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 74653000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 74653000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.2597,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies have 'LLC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%LLC%'),Count: 5,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 5}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000019617?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000019617' LIMIT 1,JPMORGAN CHASE & CO's CIK is unknown.,"{""value"": ""JPMORGAN CHASE & CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies have 'INC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%INC%'),Count: 459,"{""value"": 459, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000050863?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000050863' LIMIT 1,INTEL CORP's CIK is unknown.,"{""value"": ""INTEL CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What is Walmart Inc.'s CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%WALMART INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",WALMART INC.'s CIK is 0000104169.,"{""value"": ""0000104169"", ""type"": ""text""}",5.0,0.8,template,,,,0.0029,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies have 'CORP' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%CORP%'),Count: 180,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0026,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What is Procter & Gamble's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%PROCTER & GAMBLE CO%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",PROCTER & GAMBLE CO's CIK is 0000080424.,"{""value"": ""0000080424"", ""type"": ""text""}",5.0,0.8,template,,,,0.0052,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,Which company has the longest company name in the dataset?,company_with_longest_name,SELECT name FROM companies ORDER BY LENGTH(name) DESC LIMIT 1,"name: CHARLES RIVER LABORATORIES INTERNATIONAL, INC.","{""type"": ""text"", ""value"": ""CHARLES RIVER LABORATORIES INTERNATIONAL, INC.""}",5.0,0.65,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What is Berkshire Hathaway's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%BERKSHIRE HATHAWAY INC%') LIMIT 1",BERKSHIRE HATHAWAY INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many quarterly (qtrs=1) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 1,Count: 3566310,"{""value"": 3566310, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0375,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are in the Utilities sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%utilities%'),There are 20 companies in the Utilities sector.,"{""value"": 20, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What is Tesla's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1","TESLA, INC.'s CIK is 0001318605.","{""value"": ""0001318605"", ""type"": ""text""}",5.0,0.8,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many financial facts are denominated in USD?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0209,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,Which form type appears most frequently in submissions?,most_common_form_type,"SELECT form, COUNT(*) AS filing_count FROM sub GROUP BY form ORDER BY filing_count DESC LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many unique companies are represented in the dataset?,total_company_count,SELECT COUNT(DISTINCT cik) AS company_count FROM companies,Count: 589,"{""value"": 589, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What is the earliest period date in the financial data?,earliest_period_date,SELECT MIN(period) AS earliest_period FROM sub,earliest_period: 2014-05-31 00:00:00,"{""value"": ""2014-05-31 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies have international (non-US) incorporation?,international_incorporation_count,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS company_count
FROM latest_submission
WHERE rn = 1 AND UPPER(countryinc) <> 'US'",Count: 34,"{""value"": 34, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0061,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What is Amazon's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%AMAZON COM INC%') LIMIT 1",AMAZON COM INC is in the Consumer Discretionary sector.,"{""value"": ""Consumer Discretionary"", ""type"": ""text""}",5.0,0.8,template,,,,0.0153,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many different fiscal year ends are represented?,distinct_fiscal_year_total,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,Which state has the most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 1
",state: CA | count: 123,"{""value"": ""CA"", ""type"": ""text""}",5.0,0.65,template,,,,0.0101,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies filed 10-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-K'),Count: 563,"{""value"": 563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.002,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What is the most recent filing date in the dataset?,latest_filing_date,SELECT MAX(filed) AS latest_filing_date FROM sub,latest_filing_date: 2025-06-30 00:00:00,"{""value"": ""2025-06-30 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0036,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are in the Health Care sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%health care%'),There are 80 companies in the Health Care sector.,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000066740?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000066740' LIMIT 1,3M CO's CIK is unknown.,"{""value"": ""3M CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many financial facts have footnotes?,fact_count_with_footnotes,SELECT COUNT(*) AS fact_count FROM num WHERE footnote IS NOT NULL AND TRIM(CAST(footnote AS VARCHAR)) <> '',Count: 33959,"{""value"": 33959, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0153,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,What currency is used most frequently in the numerical data?,most_common_currency,"SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL GROUP BY 1 ORDER BY fact_count DESC LIMIT 1",currency: USD | fact_count: 14760135,"{""value"": ""USD"", ""type"": ""text""}",5.0,0.65,template,,,,0.0282,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Delaware?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('DE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('DE'))
  )
",Count: 346,"{""value"": 349, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",3.0,0.7,template,,,,0.0216,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,Which sector has the most companies in our S&P 500 dataset?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,18.7544,0.0,0.0,0.0,0.0
RUN_016,"06 Nov 2025, 1700 hours",simple,How many S&P 500 companies are in the Information Technology sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%information technology%'),There are 165 companies in the Information Technology sector.,"{""value"": 165, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 295}, 'latency_ms': 4140, 'success': True}]",22.6784,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What is Johnson & Johnson's return on equity (ROE) percentage?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: JOHNSON & JOHNSON | roe_percentage: 20.06,"{""value"": 20.06, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1.0}}",5.0,0.8,template,,,,0.3682,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Hong Kong dollars (HKD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('HKD'),Count: 140,"{""value"": 140, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0129,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,"How many facts use per-share units (per share, per unit)?",fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""absolute"": 100}}",5.0,0.7,template,,,,0.016,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What is the total count of unique unit types in the dataset?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 49, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0131,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Mexican pesos (MXN)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('MXN'),Count: 37,"{""value"": 37, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0077,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many facts use barrels as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('barrels'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0023,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Australian dollars (AUD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('AUD'),Count: 110,"{""value"": 110, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0127,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many facts use 'days' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('days'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0024,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What is the least common currency in the dataset?,least_common_currency,"WITH currency_counts AS (SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) ASC, UPPER(TRIM(uom))) AS currency_rank FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3 GROUP BY 1) SELECT currency, fact_count FROM currency_counts WHERE currency_rank = 1",currency: COP | fact_count: 1,"{""value"": ""COP"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0331,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many facts are measured in Japanese yen (JPY)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('JPY'),Count: 122,"{""value"": 122, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0118,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many facts use square feet as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('square feet'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0023,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Swiss francs (CHF)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CHF'),Count: 218,"{""value"": 218, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.013,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many facts use percentage as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('pure'),Count: 50344,"{""value"": 50344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0156,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What is the most common non-monetary unit of measure?,most_common_non_monetary_unit,"WITH unit_counts AS (
    SELECT UPPER(TRIM(uom)) AS unit, COUNT(*) AS cnt,
           ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    WHERE uom IS NOT NULL
      AND LENGTH(TRIM(uom)) <> 3
    GROUP BY 1
)
SELECT unit, cnt FROM unit_counts WHERE rank = 1",unit: SHARES | cnt: 642330,"{""value"": ""SHARES"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0258,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many facts are measured in British pounds (GBP)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('GBP'),Count: 446,"{""value"": 446, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0321,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many facts use 'shares' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0234,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Euros (EUR)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('EUR'),Count: 37847,"{""value"": 37847, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0196,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Canadian dollars (CAD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CAD'),Count: 2926,"{""value"": 2926, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0195,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What is the second most common currency in the dataset?,second_most_common_currency,"WITH currency_counts AS (SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS currency_rank FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3 GROUP BY 1) SELECT currency, fact_count FROM currency_counts WHERE currency_rank = 2",currency: EUR | fact_count: 37847,"{""value"": ""EUR"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.044,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many different currencies are represented in the financial data?,distinct_currency_count,SELECT COUNT(DISTINCT UPPER(TRIM(uom))) AS currency_count FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3,Count: 27,"{""value"": 27, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.021,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies returned more than 50% of operating cash flow to shareholders?,companies_shareholder_return_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), payout_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'PaymentsOfDividends' THEN n.value END) AS dividends,
        MAX(CASE WHEN n.tag = 'PaymentsForRepurchaseOfCommonStock' THEN n.value END) AS buybacks,
        MAX(CASE WHEN n.tag = 'NetCashProvidedByUsedInOperatingActivities' THEN n.value END) AS operating_cash_flow
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN (
          'PaymentsOfDividends',
          'PaymentsForRepurchaseOfCommonStock',
          'NetCashProvidedByUsedInOperatingActivities'
      )
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM payout_metrics
WHERE operating_cash_flow IS NOT NULL AND operating_cash_flow <> 0
  AND (COALESCE(dividends, 0) + COALESCE(buybacks, 0)) / operating_cash_flow > 0.5",Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,template,,,,0.1876,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies have free cash flow exceeding $10 billion?,companies_free_cash_flow_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value > 10000000000.0",Count: 11,"{""value"": 11, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,template,,,,0.1038,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies issued new debt during the period?,companies_new_debt_issued,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ProceedsFromIssuanceOfLongTermDebt'
  AND n.value > 0",Count: 215,"{""value"": 215, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.1751,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What was Johnson & Johnson's acquisition spending?,company_acquisition_spending,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS acquisition_spending,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PaymentsToAcquireBusinessesNetOfCashAcquired'
      AND n.qtrs IN (0,4)
)
SELECT acquisition_spending, period_end
FROM latest_metric
WHERE rn = 1",acquisition_spending: 1800000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 1800000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",5.0,0.65,template,,,,0.1394,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies have negative operating cash flow?,companies_negative_operating_cash_flow,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value < 0",Count: 93,"{""value"": 93, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.123,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What was Tesla's change in cash and cash equivalents?,companies_change_in_cash,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS change_in_cash,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
      AND n.qtrs IN (0,4)
)
SELECT change_in_cash, period_end
FROM latest_metric
WHERE rn = 1",change_in_cash: 14923000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 14923000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.85,template,,,,0.1152,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies spent more than $5 billion on acquisitions?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 7, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0005,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies have positive free cash flow?,companies_positive_free_cash_flow,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value > 0",Count: 525,"{""value"": 525, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.1356,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies have EBITDA exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 2, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0014,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies reported foreign exchange gains/losses?,companies_forex_gain_loss,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag IN ('ForeignCurrencyTransactionGainLoss','GainLossOnForeignCurrencyExchange')
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.2668,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies have negative net income?,companies_negative_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetIncomeLoss'
  AND n.value < 0",Count: 201,"{""value"": 201, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.85,template,,,,0.1656,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What was Johnson & Johnson's income tax expense?,latest_income_tax_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS income_tax_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'IncomeTaxExpenseBenefit'
      AND n.qtrs IN (0,4)
)
SELECT income_tax_expense, period_end
FROM latest_metric
WHERE rn = 1",income_tax_expense: 2621000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 1736000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",1.0,0.8,template,,,,0.163,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies reported depreciation and amortization expenses?,companies_depreciation_amortization_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'DepreciationAndAmortization'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 321,"{""value"": 321, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.1665,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What was Tesla's other income (expense) in the latest period?,latest_other_income_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS other_income_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'OtherNonoperatingIncomeExpense'
      AND n.qtrs IN (0,4)
)
SELECT other_income_expense, period_end
FROM latest_metric
WHERE rn = 1",other_income_expense: -43000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": -43000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",5.0,0.8,template,,,,0.1693,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies have positive operating income?,companies_positive_operating_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'OperatingIncomeLoss'
  AND n.value > 0",Count: 907,"{""value"": 907.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.1581,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies reported research and development expenses?,companies_research_expense_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ResearchAndDevelopmentExpense'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 344,"{""value"": 344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.1466,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies have working capital exceeding $50 billion?,companies_working_capital_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND (current_assets - current_liabilities) > 50000000000.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.203,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies report goodwill on their balance sheets?,companies_goodwill_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'Goodwill'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 3491,"{""value"": 3491.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.1969,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies have intangible assets exceeding $10 billion?,companies_intangibles_above_threshold,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'IntangibleAssetsNetExcludingGoodwill' THEN n.value END) AS intangible_assets
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag = 'IntangibleAssetsNetExcludingGoodwill'
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE intangible_assets IS NOT NULL AND intangible_assets > 10000000000.0",Count: 38,"{""value"": 38, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.1262,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies have negative stockholders' equity?,companies_negative_equity,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity < 0",Count: 1,"{""value"": 1, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.85,template,,,,0.3014,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,"What is Tesla's property, plant and equipment value?",latest_property_plant_equipment,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS property_plant_equipment,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PropertyPlantAndEquipmentNet'
      AND n.qtrs IN (0,4)
)
SELECT property_plant_equipment, period_end
FROM latest_metric
WHERE rn = 1",property_plant_equipment: 35836000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 37088000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.65,template,,,,0.1341,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies have more liabilities than assets?,companies_more_liabilities_than_assets,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed,
                   ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Assets','Liabilities')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND liabilities IS NOT NULL
  AND liabilities > assets",Count: 25,"{""value"": 25, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.2194,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies have current assets exceeding $100 billion?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%MASTERCARD INC%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",MASTERCARD INC has 0 matching records.,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",3.0,0.85,llm_template_selection,,,,16.6596,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies have Return on Equity above 20%?,companies_return_on_equity_above_threshold,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 0.2",Count: 432,"{""value"": 175, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.85,template,,,,1.4044,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies have gross margin above 50%?,companies_gross_margin_above_threshold,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('Revenues','SalesRevenueNet') THEN n.value END) AS revenue,
        MAX(CASE WHEN n.tag = 'CostOfRevenue' THEN n.value END) AS cost
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Revenues','SalesRevenueNet','CostOfRevenue')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE revenue IS NOT NULL AND revenue <> 0 AND cost IS NOT NULL
  AND (revenue - cost) / revenue > 0.5",Count: 2,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.1889,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies have a debt-to-equity ratio above 1.0?,companies_debt_to_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Liabilities','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND liabilities IS NOT NULL
  AND liabilities / equity > 1.0",Count: 236,"{""value"": 236.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.2685,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies have negative Return on Assets?,companies_negative_return_on_assets,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('NetIncomeLoss','Assets')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND assets <> 0 AND net_income IS NOT NULL AND net_income / assets < 0",Count: 3,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",3.0,0.85,template,,,,0.21,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies have a current ratio above 2.0?,companies_current_ratio_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND current_liabilities <> 0
  AND current_assets / current_liabilities > 2.0",Count: 115,"{""value"": 115.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.7,template,,,,0.1826,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies have positive Return on Equity in the latest period?,companies_positive_return_on_equity,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 0",Count: 434,"{""value"": 448, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,1.3981,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many annual (qtrs=0) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 0,Count: 5484928,"{""value"": 5484928, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0414,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What is the second most frequent form type in submissions?,form_type_rank,"WITH form_counts AS (
    SELECT form, COUNT(*) AS filing_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM sub
    GROUP BY form
)
SELECT form, filing_count
FROM form_counts
WHERE rank = 2
LIMIT 1",form: 10-K | filing_count: 6274,"{""value"": ""10-K"", ""type"": ""text""}",5.0,0.65,template,,,,0.0023,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many submissions are for fiscal period Q4?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q4'),Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 1}",5.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many submissions are for fiscal period Q3?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q3'),Count: 5238,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5238}",5.0,0.75,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many submissions are for fiscal period Q2?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q2'),Count: 5296,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5296}",5.0,0.75,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many submissions have September fiscal year end (0930)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0930',Count: 1134,"{""value"": 1134, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many submissions have June fiscal year end (0630)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0630',Count: 949,"{""value"": 949, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0026,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many submissions have March fiscal year end (0331)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0331',Count: 394,"{""value"": 394, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many submissions have December fiscal year end (1231)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '1231',Count: 17572,"{""value"": 17572, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many different form types are present in the submissions?,distinct_form_type_count,SELECT COUNT(DISTINCT form) AS form_type_count FROM sub,Count: 21,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 21}",5.0,0.7,template,,,,0.0024,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal period FY (full year)?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('FY'),Count: 6476,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 6476}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal period Q1?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q1'),Count: 5664,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5664}",5.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal year 2025?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2025,Count: 917,"{""value"": 917, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal year 2024?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2024,Count: 4167,"{""value"": 4167, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.75,template,,,,0.0021,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What is the earliest filing date in the dataset?,earliest_filing_date,SELECT MIN(filed) AS earliest_filing_date FROM sub,earliest_filing_date: 2015-01-02 00:00:00,"{""value"": ""2015-01-02 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies filed 8-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('8-K'),Count: 112,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 112}",5.0,0.7,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies filed 10-Q forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-Q'),Count: 543,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 543}",5.0,0.7,template,,,,0.0038,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many financial facts are reported with coreg (co-registrant) information?,fact_count_with_coreg,SELECT COUNT(*) AS fact_count FROM num WHERE coreg IS NOT NULL AND TRIM(coreg) <> '',Count: 1261087,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 1261087}",5.0,0.7,template,,,,0.0207,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many XBRL tags are classified as 'string' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%string%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Debt' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%DEBT%'),Count: 26515,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 26515}",5.0,0.85,template,,,,0.0435,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Equity' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%EQUITY%'),Count: 24563,"{""value"": 24563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0483,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Cash' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%CASH%'),Count: 29232,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 29232}",5.0,0.85,template,,,,0.0382,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What is the third most frequent XBRL tag in numerical data?,tag_nth_most_common,"WITH tag_counts AS (
    SELECT
        tag,
        COUNT(*) AS fact_count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    GROUP BY tag
)
SELECT tag, fact_count
FROM tag_counts
WHERE rank = 3
LIMIT 1",tag: Revenues | fact_count: 491457,"{""type"": ""text"", ""value"": ""Revenues""}",5.0,0.65,template,,,,0.0365,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many numerical facts have zero values?,fact_count_zero_values,SELECT COUNT(*) AS fact_count FROM num WHERE value = 0,Count: 1427015,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 1427015}",5.0,0.7,template,,,,0.0753,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many numerical facts have negative values?,fact_count_negative_values,SELECT COUNT(*) AS fact_count FROM num WHERE value < 0,Count: 2124201,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 2124201.0}",5.0,0.7,template,,,,0.0871,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many XBRL tags are classified as 'per-share' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%per-share%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0.0}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many XBRL tags have 'shares' as unit of measure in numerical data?,tag_count_by_unit,SELECT COUNT(DISTINCT tag) AS tag_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 949,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 949}",5.0,0.7,template,,,,0.0545,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many financial facts have duplicate values (dimhash populated)?,fact_count_dimhash_populated,SELECT COUNT(*) AS fact_count FROM num WHERE segments IS NOT NULL AND TRIM(segments) <> '',Count: 8738244,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 8738244}",5.0,0.7,template,,,,1.4307,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many different unit types (UOM) are present in the numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 49.0}",5.0,0.7,template,,,,0.0144,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Liability' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%LIABILITY%'),Count: 11059,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 11059}",5.0,0.7,template,,,,0.0384,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Asset' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%ASSET%'),Count: 40285,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 40285}",5.0,0.7,template,,,,0.0381,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Revenue' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%REVENUE%'),Count: 12221,"{""value"": 12221, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.054,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many XBRL tags are classified as 'monetary' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%monetary%'),Count: 454617,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 454617}",5.0,0.7,template,,,,0.0028,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many XBRL tags have a debit-credit flag of 'Debit'?,tag_count_by_debit_credit,SELECT COUNT(*) AS tag_count FROM tag WHERE crdr IS NOT NULL AND UPPER(TRIM(crdr)) = CASE WHEN UPPER(TRIM('Debit')) LIKE 'D%' THEN 'D' WHEN UPPER(TRIM('Debit')) LIKE 'C%' THEN 'C' ELSE UPPER(TRIM('Debit')) END,Count: 224017,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 224017}",5.0,0.7,template,,,,0.0076,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What is Google's (Alphabet) return on equity (ROE)?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%ALPHABET INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: ALPHABET INC. | roe_percentage: 32.91,"{""value"": 32.91, ""type"": ""numeric"", ""tolerance"": {""absolute"": 0.5}}",5.0,0.8,template,,,,0.3418,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Georgia?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('GA')",Count: 22,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 22}",5.0,0.7,template,,,,0.0089,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Bermuda?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",5.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Washington state?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('WA')",Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",5.0,0.7,template,,,,0.0071,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,Which state has the third most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 3
",state: NY | count: 69,"{""value"": ""NY"", ""type"": ""text""}",5.0,0.65,template,,,,0.0088,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Massachusetts?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('MA')",Count: 31,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 27}",3.0,0.7,template,,,,0.0092,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in the United Kingdom?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",5.0,0.7,template,,,,0.0092,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in North Carolina?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NC')",Count: 20,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",5.0,0.7,template,,,,0.0076,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Ohio?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('OH')",Count: 24,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",3.0,0.7,template,,,,0.0078,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many different US states are represented in headquarters data?,distinct_headquarters_states,SELECT COUNT(DISTINCT stprba) AS state_count FROM sub WHERE stprba IS NOT NULL,Count: 44,"{""value"": 44, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many different countries are represented in the incorporation data?,distinct_incorporation_countries,SELECT COUNT(DISTINCT countryinc) AS country_count FROM sub WHERE countryinc IS NOT NULL,Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 16}",5.0,0.7,template,,,,0.002,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Switzerland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 5}",5.0,0.7,template,,,,0.0064,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Florida?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('FL')",Count: 26,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 26}",5.0,0.7,template,,,,0.0067,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Illinois?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('IL')",Count: 42,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 42}",5.0,0.7,template,,,,0.008,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,Which state has the second most company headquarters after California?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 2
",state: TX | count: 81,"{""value"": ""TX"", ""type"": ""text""}",5.0,0.65,template,,,,0.009,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Canada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 3}",3.0,0.7,template,,,,0.0114,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Ireland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 6}",5.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Nevada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('NV'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('NV'))
  )
",Count: 9,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 9}",5.0,0.7,template,,,,0.0074,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Texas?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('TX')",Count: 81,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 81}",5.0,0.7,template,,,,0.0089,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in New York?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NY')",Count: 69,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 69}",5.0,0.7,template,,,,0.0135,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,Which sector contains Johnson & Johnson?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%') LIMIT 1",JOHNSON & JOHNSON is in the Health Care sector.,"{""value"": ""Health Care"", ""type"": ""text""}",5.0,0.8,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many sectors have fewer than 25 companies?,sectors_below_threshold,"WITH sector_counts AS (
    SELECT gics_sector, COUNT(*) AS count
    FROM companies
    WHERE gics_sector IS NOT NULL
    GROUP BY gics_sector
)
SELECT COUNT(*) AS sector_count
FROM sector_counts
WHERE count < 25.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many sectors have more than 50 companies?,sectors_above_threshold,"SELECT COUNT(DISTINCT gics_sector) as sector_count FROM (SELECT gics_sector, COUNT(*) as cnt FROM companies GROUP BY gics_sector HAVING cnt > 50.0) subq",Count: 6,"{""value"": 6, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0043,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,Which sector has the fewest companies?,sector_with_fewest_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL AND gics_sector != 'Other' GROUP BY gics_sector ORDER BY count ASC LIMIT 1",AT&T INC is in the Real Estate sector.,"{""type"": ""text"", ""value"": ""Real Estate""}",5.0,0.8,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are in the Communication Services sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%communication services%'),There are 17 companies in the Communication Services sector.,"{""value"": 17, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are in the Real Estate sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%real estate%'),There are 3 companies in the Real Estate sector.,"{""value"": 3, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are in the Consumer Staples sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer staples%'),There are 28 companies in the Consumer Staples sector.,"{""value"": 26, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",3.0,0.95,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are in the Consumer Discretionary sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer discretionary%'),There are 99 companies in the Consumer Discretionary sector.,"{""value"": 99, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are in the Energy sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%energy%'),There are 51 companies in the Energy sector.,"{""value"": 51, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are in the Materials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%materials%'),There are 41 companies in the Materials sector.,"{""value"": 41, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,Which sector has the second most companies?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""AT&T INC is in the Financials sector."", ""type"": ""text""}",5.0,0.8,template,,,,0.003,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are in the Industrials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%industrials%'),There are 82 companies in the Industrials sector.,"{""value"": 82, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0022,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What was Meta's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%META PLATFORMS, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 76793000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 76793000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.1663,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies reported cost of revenue in the latest period?,companies_reporting_cost_of_revenue,"WITH latest_cost AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'CostOfRevenue'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_cost
WHERE rn = 1 AND value IS NOT NULL",Count: 134,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 134}",5.0,0.85,template,,,,0.1786,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies have total revenue exceeding $50 billion in the latest period?,companies_revenue_above_threshold,"WITH latest_filing AS (
    SELECT
        s.cik,
        s.adsh,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
),
latest_revenue AS (
    SELECT lf.cik, n.value AS revenue
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE lf.rn = 1
      AND n.tag IN ('Revenues', 'SalesRevenueNet')
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS count
FROM latest_revenue lr
JOIN companies c ON c.cik = lr.cik
WHERE lr.revenue > 50000000000.0",Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.85,template,,,,0.2315,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What was Walmart's most recent total liabilities?,latest_total_liabilities,"
WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%WALMART INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.filed,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K', '10-K/A')
), selected_filing AS (
    SELECT adsh, cik, period, filed
    FROM latest_filing
    WHERE rn = 1
), metric_values AS (
    SELECT
        MAX(CASE WHEN n.tag = 'LiabilitiesAndStockholdersEquity' THEN n.value END) AS total_assets_equity,
        COALESCE(
            MAX(CASE WHEN n.tag = 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest' THEN n.value END),
            MAX(CASE WHEN n.tag = 'StockholdersEquity' THEN n.value END)
        ) AS equity
    FROM num n
    JOIN selected_filing lf ON n.adsh = lf.adsh
    WHERE n.tag IN (
        'LiabilitiesAndStockholdersEquity',
        'StockholdersEquity',
        'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest'
    )
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT
    (total_assets_equity - equity) AS total_liabilities,
    period AS period_end
FROM metric_values, selected_filing
",total_liabilities: 163402000000.0 | period_end: 2025-01-31 00:00:00,"{""type"": ""text"", ""value"": 163402000000.0, ""tolerance"": {""absolute"": 5000000000.0}}",5.0,0.8,template,,,,0.5529,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies reported positive net income in the latest period?,companies_positive_net_income,"WITH latest_net_income AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_net_income
WHERE rn = 1 AND value > 0",Count: 454,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 447.0}",3.0,0.85,template,,,,1.3268,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What was Johnson & Johnson's most recent gross profit?,latest_gross_profit,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS gross_profit,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'GrossProfit'
      AND n.qtrs IN (0,4)
)
SELECT gross_profit, period_end
FROM latest_metric
WHERE rn = 1",gross_profit: 55394000000.0 | period_end: 2024-12-31 00:00:00,"{""type"": ""numeric"", ""value"": 55394000000.0, ""tolerance"": {""absolute"": 2000000000.0}}",5.0,0.8,template,,,,0.425,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What was Tesla's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 74653000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 74653000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.3064,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies have 'LLC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%LLC%'),Count: 5,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 5}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000019617?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000019617' LIMIT 1,JPMORGAN CHASE & CO's CIK is unknown.,"{""value"": ""JPMORGAN CHASE & CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies have 'INC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%INC%'),Count: 459,"{""value"": 459, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000050863?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000050863' LIMIT 1,INTEL CORP's CIK is unknown.,"{""value"": ""INTEL CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What is Walmart Inc.'s CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%WALMART INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",WALMART INC.'s CIK is 0000104169.,"{""value"": ""0000104169"", ""type"": ""text""}",5.0,0.8,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies have 'CORP' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%CORP%'),Count: 180,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0021,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What is Procter & Gamble's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%PROCTER & GAMBLE CO%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",PROCTER & GAMBLE CO's CIK is 0000080424.,"{""value"": ""0000080424"", ""type"": ""text""}",5.0,0.8,template,,,,0.0024,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,Which company has the longest company name in the dataset?,company_with_longest_name,SELECT name FROM companies ORDER BY LENGTH(name) DESC LIMIT 1,"name: CHARLES RIVER LABORATORIES INTERNATIONAL, INC.","{""type"": ""text"", ""value"": ""CHARLES RIVER LABORATORIES INTERNATIONAL, INC.""}",5.0,0.65,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What is Berkshire Hathaway's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%BERKSHIRE HATHAWAY INC%') LIMIT 1",BERKSHIRE HATHAWAY INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,0.0036,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0074,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many quarterly (qtrs=1) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 1,Count: 3566310,"{""value"": 3566310, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0286,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are in the Utilities sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%utilities%'),There are 20 companies in the Utilities sector.,"{""value"": 20, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0026,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What is Tesla's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1","TESLA, INC.'s CIK is 0001318605.","{""value"": ""0001318605"", ""type"": ""text""}",5.0,0.8,template,,,,0.0085,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many financial facts are denominated in USD?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0715,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,Which form type appears most frequently in submissions?,most_common_form_type,"SELECT form, COUNT(*) AS filing_count FROM sub GROUP BY form ORDER BY filing_count DESC LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.0042,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many unique companies are represented in the dataset?,total_company_count,SELECT COUNT(DISTINCT cik) AS company_count FROM companies,Count: 589,"{""value"": 589, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0021,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What is the earliest period date in the financial data?,earliest_period_date,SELECT MIN(period) AS earliest_period FROM sub,earliest_period: 2014-05-31 00:00:00,"{""value"": ""2014-05-31 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0033,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies have international (non-US) incorporation?,international_incorporation_count,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS company_count
FROM latest_submission
WHERE rn = 1 AND UPPER(countryinc) <> 'US'",Count: 34,"{""value"": 34, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0239,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What is Amazon's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%AMAZON COM INC%') LIMIT 1",AMAZON COM INC is in the Consumer Discretionary sector.,"{""value"": ""Consumer Discretionary"", ""type"": ""text""}",5.0,0.8,template,,,,0.0172,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many different fiscal year ends are represented?,distinct_fiscal_year_total,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,Which state has the most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 1
",state: CA | count: 123,"{""value"": ""CA"", ""type"": ""text""}",5.0,0.65,template,,,,0.0147,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies filed 10-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-K'),Count: 563,"{""value"": 563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0045,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What is the most recent filing date in the dataset?,latest_filing_date,SELECT MAX(filed) AS latest_filing_date FROM sub,latest_filing_date: 2025-06-30 00:00:00,"{""value"": ""2025-06-30 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0052,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are in the Health Care sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%health care%'),There are 80 companies in the Health Care sector.,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000066740?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000066740' LIMIT 1,3M CO's CIK is unknown.,"{""value"": ""3M CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many financial facts have footnotes?,fact_count_with_footnotes,SELECT COUNT(*) AS fact_count FROM num WHERE footnote IS NOT NULL AND TRIM(CAST(footnote AS VARCHAR)) <> '',Count: 33959,"{""value"": 33959, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0227,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,What currency is used most frequently in the numerical data?,most_common_currency,"SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL GROUP BY 1 ORDER BY fact_count DESC LIMIT 1",currency: USD | fact_count: 14760135,"{""value"": ""USD"", ""type"": ""text""}",5.0,0.65,template,,,,0.0727,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Delaware?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('DE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('DE'))
  )
",Count: 346,"{""value"": 349, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",3.0,0.7,template,,,,0.0255,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,Which sector has the most companies in our S&P 500 dataset?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,23.2069,0.0,0.0,0.0,0.0
RUN_015,"06 Nov 2025, 1700 hours",simple,How many S&P 500 companies are in the Information Technology sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%information technology%'),There are 165 companies in the Information Technology sector.,"{""value"": 165, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 357}, 'latency_ms': 5538, 'success': True}]",5.5684,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What is Johnson & Johnson's return on equity (ROE) percentage?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: JOHNSON & JOHNSON | roe_percentage: 20.06,"{""value"": 20.06, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1.0}}",5.0,0.8,template,,,,0.3524,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Hong Kong dollars (HKD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('HKD'),Count: 140,"{""value"": 140, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0178,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,"How many facts use per-share units (per share, per unit)?",fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""absolute"": 100}}",5.0,0.7,template,,,,0.0229,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What is the total count of unique unit types in the dataset?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 49, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0163,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Mexican pesos (MXN)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('MXN'),Count: 37,"{""value"": 37, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0082,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many facts use barrels as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('barrels'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0028,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Australian dollars (AUD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('AUD'),Count: 110,"{""value"": 110, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0148,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many facts use 'days' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('days'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.003,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What is the least common currency in the dataset?,least_common_currency,"WITH currency_counts AS (SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) ASC, UPPER(TRIM(uom))) AS currency_rank FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3 GROUP BY 1) SELECT currency, fact_count FROM currency_counts WHERE currency_rank = 1",currency: COP | fact_count: 1,"{""value"": ""COP"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0398,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many facts are measured in Japanese yen (JPY)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('JPY'),Count: 122,"{""value"": 122, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0139,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many facts use square feet as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('square feet'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0032,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Swiss francs (CHF)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CHF'),Count: 218,"{""value"": 218, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0148,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many facts use percentage as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('pure'),Count: 50344,"{""value"": 50344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0297,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What is the most common non-monetary unit of measure?,most_common_non_monetary_unit,"WITH unit_counts AS (
    SELECT UPPER(TRIM(uom)) AS unit, COUNT(*) AS cnt,
           ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    WHERE uom IS NOT NULL
      AND LENGTH(TRIM(uom)) <> 3
    GROUP BY 1
)
SELECT unit, cnt FROM unit_counts WHERE rank = 1",unit: SHARES | cnt: 642330,"{""value"": ""SHARES"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0279,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many facts are measured in British pounds (GBP)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('GBP'),Count: 446,"{""value"": 446, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0138,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many facts use 'shares' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0198,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Euros (EUR)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('EUR'),Count: 37847,"{""value"": 37847, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0141,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Canadian dollars (CAD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CAD'),Count: 2926,"{""value"": 2926, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0147,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What is the second most common currency in the dataset?,second_most_common_currency,"WITH currency_counts AS (SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS currency_rank FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3 GROUP BY 1) SELECT currency, fact_count FROM currency_counts WHERE currency_rank = 2",currency: EUR | fact_count: 37847,"{""value"": ""EUR"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0402,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many different currencies are represented in the financial data?,distinct_currency_count,SELECT COUNT(DISTINCT UPPER(TRIM(uom))) AS currency_count FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3,Count: 27,"{""value"": 27, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0366,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies returned more than 50% of operating cash flow to shareholders?,companies_shareholder_return_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), payout_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'PaymentsOfDividends' THEN n.value END) AS dividends,
        MAX(CASE WHEN n.tag = 'PaymentsForRepurchaseOfCommonStock' THEN n.value END) AS buybacks,
        MAX(CASE WHEN n.tag = 'NetCashProvidedByUsedInOperatingActivities' THEN n.value END) AS operating_cash_flow
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN (
          'PaymentsOfDividends',
          'PaymentsForRepurchaseOfCommonStock',
          'NetCashProvidedByUsedInOperatingActivities'
      )
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM payout_metrics
WHERE operating_cash_flow IS NOT NULL AND operating_cash_flow <> 0
  AND (COALESCE(dividends, 0) + COALESCE(buybacks, 0)) / operating_cash_flow > 50.0",Count: 0,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.85,template,,,,0.2104,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies have free cash flow exceeding $10 billion?,companies_free_cash_flow_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value > 10000000000.0",Count: 11,"{""value"": 11, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,template,,,,0.1296,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies issued new debt during the period?,companies_new_debt_issued,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ProceedsFromIssuanceOfLongTermDebt'
  AND n.value > 0",Count: 215,"{""value"": 215, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.2087,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What was Johnson & Johnson's acquisition spending?,company_acquisition_spending,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS acquisition_spending,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PaymentsToAcquireBusinessesNetOfCashAcquired'
      AND n.qtrs IN (0,4)
)
SELECT acquisition_spending, period_end
FROM latest_metric
WHERE rn = 1",acquisition_spending: 1800000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 1800000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",5.0,0.65,template,,,,0.1535,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies have negative operating cash flow?,companies_negative_operating_cash_flow,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value < 0",Count: 93,"{""value"": 93, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.1748,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What was Tesla's change in cash and cash equivalents?,companies_change_in_cash,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS change_in_cash,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
      AND n.qtrs IN (0,4)
)
SELECT change_in_cash, period_end
FROM latest_metric
WHERE rn = 1",change_in_cash: 14923000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 13256000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.85,template,,,,0.12,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies spent more than $5 billion on acquisitions?,companies_acquisition_spending_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'PaymentsToAcquireBusinessesNetOfCashAcquired'
  AND ABS(n.value) > 5000000000.0",Count: 7,"{""value"": 7, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.7,template,,,,0.1899,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies have positive free cash flow?,companies_positive_free_cash_flow,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value > 0",Count: 525,"{""value"": 525, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.2333,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies have EBITDA exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.0,,,,,0.0016,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies reported foreign exchange gains/losses?,companies_forex_gain_loss,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag IN ('ForeignCurrencyTransactionGainLoss','GainLossOnForeignCurrencyExchange')
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.4226,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies have negative net income?,companies_negative_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetIncomeLoss'
  AND n.value < 0",Count: 201,"{""value"": 74, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.85,template,,,,1.3623,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What was Johnson & Johnson's income tax expense?,latest_income_tax_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS income_tax_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'IncomeTaxExpenseBenefit'
      AND n.qtrs IN (0,4)
)
SELECT income_tax_expense, period_end
FROM latest_metric
WHERE rn = 1",income_tax_expense: 1736000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 2621000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.8,template,,,,0.1075,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies reported depreciation and amortization expenses?,companies_depreciation_amortization_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'DepreciationAndAmortization'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 321,"{""value"": 321, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.2623,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What was Tesla's other income (expense) in the latest period?,latest_other_income_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS other_income_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'OtherNonoperatingIncomeExpense'
      AND n.qtrs IN (0,4)
)
SELECT other_income_expense, period_end
FROM latest_metric
WHERE rn = 1",other_income_expense: -43000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 695000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",1.0,0.8,template,,,,0.2489,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies have positive operating income?,companies_positive_operating_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'OperatingIncomeLoss'
  AND n.value > 0",Count: 907,"{""value"": 907.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.2279,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies reported research and development expenses?,companies_research_expense_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ResearchAndDevelopmentExpense'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 344,"{""value"": 344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.3213,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies have working capital exceeding $50 billion?,companies_working_capital_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND (current_assets - current_liabilities) > 50000000000.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.3401,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies report goodwill on their balance sheets?,companies_goodwill_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'Goodwill'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 3491,"{""value"": 3491.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.2079,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies have intangible assets exceeding $10 billion?,companies_intangibles_above_threshold,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'IntangibleAssetsNetExcludingGoodwill' THEN n.value END) AS intangible_assets
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag = 'IntangibleAssetsNetExcludingGoodwill'
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE intangible_assets IS NOT NULL AND intangible_assets > 10000000000.0",Count: 38,"{""value"": 38, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.2558,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies have negative stockholders' equity?,companies_negative_equity,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity < 0",Count: 1,"{""value"": 1, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.85,template,,,,0.474,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,"What is Tesla's property, plant and equipment value?",latest_property_plant_equipment,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS property_plant_equipment,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PropertyPlantAndEquipmentNet'
      AND n.qtrs IN (0,4)
)
SELECT property_plant_equipment, period_end
FROM latest_metric
WHERE rn = 1",property_plant_equipment: 37088000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 35836000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.65,template,,,,0.2,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies have more liabilities than assets?,companies_more_liabilities_than_assets,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed,
                   ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Assets','Liabilities')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND liabilities IS NOT NULL
  AND liabilities > assets",Count: 25,"{""value"": 25, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.2467,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies have current assets exceeding $100 billion?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%MASTERCARD INC%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",MASTERCARD INC has 0 matching records.,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",3.0,0.85,llm_template_selection,,,,21.7856,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies have Return on Equity above 20%?,companies_return_on_equity_above_threshold,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 20.0",Count: 175,"{""value"": 175, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,1.7084,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies have gross margin above 50%?,companies_gross_margin_above_threshold,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('Revenues','SalesRevenueNet') THEN n.value END) AS revenue,
        MAX(CASE WHEN n.tag = 'CostOfRevenue' THEN n.value END) AS cost
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Revenues','SalesRevenueNet','CostOfRevenue')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE revenue IS NOT NULL AND revenue <> 0 AND cost IS NOT NULL
  AND (revenue - cost) / revenue > 50.0",Count: 0,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",3.0,0.7,template,,,,0.182,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies have a debt-to-equity ratio above 1.0?,companies_debt_to_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Liabilities','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND liabilities IS NOT NULL
  AND liabilities / equity > 1.0",Count: 236,"{""value"": 236.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.1979,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies have negative Return on Assets?,companies_negative_return_on_assets,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('NetIncomeLoss','Assets')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND assets <> 0 AND net_income IS NOT NULL AND net_income / assets < 0",Count: 3,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",3.0,0.85,template,,,,0.1997,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies have a current ratio above 2.0?,companies_current_ratio_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND current_liabilities <> 0
  AND current_assets / current_liabilities > 2.0",Count: 115,"{""value"": 115.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.7,template,,,,0.2528,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies have positive Return on Equity in the latest period?,companies_positive_return_on_equity,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 0",Count: 433,"{""value"": 448, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,1.8032,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many annual (qtrs=0) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 0,Count: 5484928,"{""value"": 5484928, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0469,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What is the second most frequent form type in submissions?,form_type_rank,"WITH form_counts AS (
    SELECT form, COUNT(*) AS filing_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM sub
    GROUP BY form
)
SELECT form, filing_count
FROM form_counts
WHERE rank = 2
LIMIT 1",form: 10-K | filing_count: 6274,"{""value"": ""10-K"", ""type"": ""text""}",5.0,0.65,template,,,,0.0026,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many submissions are for fiscal period Q4?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q4'),Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 1}",5.0,0.75,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many submissions are for fiscal period Q3?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q3'),Count: 5238,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5238}",5.0,0.75,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many submissions are for fiscal period Q2?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q2'),Count: 5296,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5296}",5.0,0.75,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many submissions have September fiscal year end (0930)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0930',Count: 1134,"{""value"": 1134, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many submissions have June fiscal year end (0630)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0630',Count: 949,"{""value"": 949, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many submissions have March fiscal year end (0331)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0331',Count: 394,"{""value"": 394, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.03,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many submissions have December fiscal year end (1231)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '1231',Count: 17572,"{""value"": 17572, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0169,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many different form types are present in the submissions?,distinct_form_type_count,SELECT COUNT(DISTINCT form) AS form_type_count FROM sub,Count: 21,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 21}",5.0,0.7,template,,,,0.0131,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal period FY (full year)?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('FY'),Count: 6476,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 6476}",5.0,0.7,template,,,,0.0034,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal period Q1?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q1'),Count: 5664,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5664}",5.0,0.75,template,,,,0.0041,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal year 2025?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2025,Count: 917,"{""value"": 917, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.75,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal year 2024?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2024,Count: 4167,"{""value"": 4167, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.75,template,,,,0.0029,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What is the earliest filing date in the dataset?,earliest_filing_date,SELECT MIN(filed) AS earliest_filing_date FROM sub,earliest_filing_date: 2015-01-02 00:00:00,"{""value"": ""2015-01-02 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies filed 8-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('8-K'),Count: 112,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 112}",5.0,0.7,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies filed 10-Q forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-Q'),Count: 543,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 543}",5.0,0.7,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many financial facts are reported with coreg (co-registrant) information?,fact_count_with_coreg,SELECT COUNT(*) AS fact_count FROM num WHERE coreg IS NOT NULL AND TRIM(coreg) <> '',Count: 1261087,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 1261087}",5.0,0.7,template,,,,0.0208,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many XBRL tags are classified as 'string' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%string%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Debt' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%DEBT%'),Count: 26515,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 26515}",5.0,0.85,template,,,,0.0338,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Equity' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%EQUITY%'),Count: 24563,"{""value"": 24563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0507,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Cash' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%CASH%'),Count: 29232,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 29232}",5.0,0.85,template,,,,0.0409,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What is the third most frequent XBRL tag in numerical data?,tag_nth_most_common,"WITH tag_counts AS (
    SELECT
        tag,
        COUNT(*) AS fact_count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    GROUP BY tag
)
SELECT tag, fact_count
FROM tag_counts
WHERE rank = 3
LIMIT 1",tag: Revenues | fact_count: 491457,"{""type"": ""text"", ""value"": ""Revenues""}",5.0,0.65,template,,,,0.042,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many numerical facts have zero values?,fact_count_zero_values,SELECT COUNT(*) AS fact_count FROM num WHERE value = 0,Count: 1427015,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 1427015}",5.0,0.7,template,,,,0.0622,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many numerical facts have negative values?,fact_count_negative_values,SELECT COUNT(*) AS fact_count FROM num WHERE value < 0,Count: 2124201,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 2124201.0}",5.0,0.7,template,,,,0.0763,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many XBRL tags are classified as 'per-share' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%per-share%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0.0}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many XBRL tags have 'shares' as unit of measure in numerical data?,tag_count_by_unit,SELECT COUNT(DISTINCT tag) AS tag_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 949,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 949}",5.0,0.7,template,,,,0.0433,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many financial facts have duplicate values (dimhash populated)?,fact_count_dimhash_populated,SELECT COUNT(*) AS fact_count FROM num WHERE segments IS NOT NULL AND TRIM(segments) <> '',Count: 8738244,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 8738244}",5.0,0.7,template,,,,1.9895,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many different unit types (UOM) are present in the numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 49.0}",5.0,0.7,template,,,,0.0149,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Liability' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%LIABILITY%'),Count: 11059,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 11059}",5.0,0.7,template,,,,0.0332,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Asset' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%ASSET%'),Count: 40285,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 40285}",5.0,0.7,template,,,,0.0408,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Revenue' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%REVENUE%'),Count: 12221,"{""value"": 12221, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0445,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many XBRL tags are classified as 'monetary' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%monetary%'),Count: 454617,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 454617}",5.0,0.7,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many XBRL tags have a debit-credit flag of 'Debit'?,tag_count_by_debit_credit,SELECT COUNT(*) AS tag_count FROM tag WHERE crdr IS NOT NULL AND UPPER(TRIM(crdr)) = CASE WHEN UPPER(TRIM('Debit')) LIKE 'D%' THEN 'D' WHEN UPPER(TRIM('Debit')) LIKE 'C%' THEN 'C' ELSE UPPER(TRIM('Debit')) END,Count: 224017,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 224017}",5.0,0.7,template,,,,0.0044,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What is Google's (Alphabet) return on equity (ROE)?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%ALPHABET INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: ALPHABET INC. | roe_percentage: 32.91,"{""value"": 32.91, ""type"": ""numeric"", ""tolerance"": {""absolute"": 0.5}}",5.0,0.8,template,,,,0.2705,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Georgia?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('GA')",Count: 22,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 22}",5.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Bermuda?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",5.0,0.7,template,,,,0.0072,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Washington state?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('WA')",Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",5.0,0.7,template,,,,0.007,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,Which state has the third most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 3
",state: NY | count: 69,"{""value"": ""NY"", ""type"": ""text""}",5.0,0.65,template,,,,0.0074,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Massachusetts?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('MA')",Count: 31,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 27}",3.0,0.7,template,,,,0.0067,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in the United Kingdom?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",5.0,0.7,template,,,,0.007,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in North Carolina?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NC')",Count: 20,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",5.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Ohio?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('OH')",Count: 24,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",3.0,0.7,template,,,,0.0075,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many different US states are represented in headquarters data?,distinct_headquarters_states,SELECT COUNT(DISTINCT stprba) AS state_count FROM sub WHERE stprba IS NOT NULL,Count: 44,"{""value"": 44, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many different countries are represented in the incorporation data?,distinct_incorporation_countries,SELECT COUNT(DISTINCT countryinc) AS country_count FROM sub WHERE countryinc IS NOT NULL,Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 16}",5.0,0.7,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Switzerland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 5}",5.0,0.7,template,,,,0.0088,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Florida?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('FL')",Count: 26,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 26}",5.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Illinois?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('IL')",Count: 42,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 42}",5.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,Which state has the second most company headquarters after California?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 2
",state: TX | count: 81,"{""value"": ""TX"", ""type"": ""text""}",5.0,0.65,template,,,,0.0079,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Canada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 3}",3.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Ireland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 6}",5.0,0.7,template,,,,0.0064,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Nevada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('NV'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('NV'))
  )
",Count: 9,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 9}",5.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Texas?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('TX')",Count: 81,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 81}",5.0,0.7,template,,,,0.0062,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in New York?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NY')",Count: 69,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 69}",5.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,Which sector contains Johnson & Johnson?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%') LIMIT 1",JOHNSON & JOHNSON is in the Health Care sector.,"{""value"": ""Health Care"", ""type"": ""text""}",5.0,0.8,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many sectors have fewer than 25 companies?,sectors_below_threshold,"WITH sector_counts AS (
    SELECT gics_sector, COUNT(*) AS count
    FROM companies
    WHERE gics_sector IS NOT NULL
    GROUP BY gics_sector
)
SELECT COUNT(*) AS sector_count
FROM sector_counts
WHERE count < 25.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many sectors have more than 50 companies?,sectors_above_threshold,"SELECT COUNT(DISTINCT gics_sector) as sector_count FROM (SELECT gics_sector, COUNT(*) as cnt FROM companies GROUP BY gics_sector HAVING cnt > 50.0) subq",Count: 6,"{""value"": 6, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0046,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,Which sector has the fewest companies?,sector_with_fewest_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL AND gics_sector != 'Other' GROUP BY gics_sector ORDER BY count ASC LIMIT 1",AT&T INC is in the Real Estate sector.,"{""type"": ""text"", ""value"": ""Real Estate""}",5.0,0.8,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are in the Communication Services sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%communication services%'),There are 17 companies in the Communication Services sector.,"{""value"": 17, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are in the Real Estate sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%real estate%'),There are 3 companies in the Real Estate sector.,"{""value"": 3, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are in the Consumer Staples sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer staples%'),There are 28 companies in the Consumer Staples sector.,"{""value"": 26, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",3.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are in the Consumer Discretionary sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer discretionary%'),There are 99 companies in the Consumer Discretionary sector.,"{""value"": 99, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are in the Energy sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%energy%'),There are 51 companies in the Energy sector.,"{""value"": 51, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are in the Materials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%materials%'),There are 41 companies in the Materials sector.,"{""value"": 41, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,Which sector has the second most companies?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""AT&T INC is in the Financials sector."", ""type"": ""text""}",5.0,0.8,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are in the Industrials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%industrials%'),There are 82 companies in the Industrials sector.,"{""value"": 82, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What was Meta's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%META PLATFORMS, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 76793000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 76793000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.0724,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies reported cost of revenue in the latest period?,companies_reporting_cost_of_revenue,"WITH latest_cost AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'CostOfRevenue'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_cost
WHERE rn = 1 AND value IS NOT NULL",Count: 134,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 134}",5.0,0.85,template,,,,0.123,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies have total revenue exceeding $50 billion in the latest period?,companies_revenue_above_threshold,"WITH latest_filing AS (
    SELECT
        s.cik,
        s.adsh,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
),
latest_revenue AS (
    SELECT lf.cik, n.value AS revenue
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE lf.rn = 1
      AND n.tag IN ('Revenues', 'SalesRevenueNet')
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS count
FROM latest_revenue lr
JOIN companies c ON c.cik = lr.cik
WHERE lr.revenue > 50000000000.0",Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.85,template,,,,0.1282,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What was Walmart's most recent total liabilities?,latest_total_liabilities,"
WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%WALMART INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.filed,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K', '10-K/A')
), selected_filing AS (
    SELECT adsh, cik, period, filed
    FROM latest_filing
    WHERE rn = 1
), metric_values AS (
    SELECT
        MAX(CASE WHEN n.tag = 'LiabilitiesAndStockholdersEquity' THEN n.value END) AS total_assets_equity,
        COALESCE(
            MAX(CASE WHEN n.tag = 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest' THEN n.value END),
            MAX(CASE WHEN n.tag = 'StockholdersEquity' THEN n.value END)
        ) AS equity
    FROM num n
    JOIN selected_filing lf ON n.adsh = lf.adsh
    WHERE n.tag IN (
        'LiabilitiesAndStockholdersEquity',
        'StockholdersEquity',
        'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest'
    )
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT
    (total_assets_equity - equity) AS total_liabilities,
    period AS period_end
FROM metric_values, selected_filing
",total_liabilities: 163402000000.0 | period_end: 2025-01-31 00:00:00,"{""type"": ""text"", ""value"": 163402000000.0, ""tolerance"": {""absolute"": 5000000000.0}}",5.0,0.8,template,,,,0.1516,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies reported positive net income in the latest period?,companies_positive_net_income,"WITH latest_net_income AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_net_income
WHERE rn = 1 AND value > 0",Count: 446,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 447.0}",5.0,0.85,template,,,,0.1361,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What was Johnson & Johnson's most recent gross profit?,latest_gross_profit,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS gross_profit,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'GrossProfit'
      AND n.qtrs IN (0,4)
)
SELECT gross_profit, period_end
FROM latest_metric
WHERE rn = 1",gross_profit: 55394000000.0 | period_end: 2024-12-31 00:00:00,"{""type"": ""numeric"", ""value"": 55394000000.0, ""tolerance"": {""absolute"": 2000000000.0}}",5.0,0.8,template,,,,0.1597,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What was Tesla's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 74653000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 74653000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.0968,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies have 'LLC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%LLC%'),Count: 5,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 5}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000019617?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000019617' LIMIT 1,JPMORGAN CHASE & CO's CIK is unknown.,"{""value"": ""JPMORGAN CHASE & CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies have 'INC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%INC%'),Count: 459,"{""value"": 459, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000050863?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000050863' LIMIT 1,INTEL CORP's CIK is unknown.,"{""value"": ""INTEL CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What is Walmart Inc.'s CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%WALMART INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",WALMART INC.'s CIK is 0000104169.,"{""value"": ""0000104169"", ""type"": ""text""}",5.0,0.8,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies have 'CORP' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%CORP%'),Count: 180,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0006,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What is Procter & Gamble's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%PROCTER & GAMBLE CO%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",PROCTER & GAMBLE CO's CIK is 0000080424.,"{""value"": ""0000080424"", ""type"": ""text""}",5.0,0.8,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,Which company has the longest company name in the dataset?,company_with_longest_name,SELECT name FROM companies ORDER BY LENGTH(name) DESC LIMIT 1,"name: CHARLES RIVER LABORATORIES INTERNATIONAL, INC.","{""type"": ""text"", ""value"": ""CHARLES RIVER LABORATORIES INTERNATIONAL, INC.""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What is Berkshire Hathaway's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%BERKSHIRE HATHAWAY INC%') LIMIT 1",BERKSHIRE HATHAWAY INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many quarterly (qtrs=1) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 1,Count: 3566310,"{""value"": 3566310, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0241,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are in the Utilities sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%utilities%'),There are 20 companies in the Utilities sector.,"{""value"": 20, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What is Tesla's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1","TESLA, INC.'s CIK is 0001318605.","{""value"": ""0001318605"", ""type"": ""text""}",5.0,0.8,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many financial facts are denominated in USD?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0147,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,Which form type appears most frequently in submissions?,most_common_form_type,"SELECT form, COUNT(*) AS filing_count FROM sub GROUP BY form ORDER BY filing_count DESC LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many unique companies are represented in the dataset?,total_company_count,SELECT COUNT(DISTINCT cik) AS company_count FROM companies,Count: 589,"{""value"": 589, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What is the earliest period date in the financial data?,earliest_period_date,SELECT MIN(period) AS earliest_period FROM sub,earliest_period: 2014-05-31 00:00:00,"{""value"": ""2014-05-31 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies have international (non-US) incorporation?,international_incorporation_count,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS company_count
FROM latest_submission
WHERE rn = 1 AND UPPER(countryinc) <> 'US'",Count: 34,"{""value"": 34, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0055,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What is Amazon's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%AMAZON COM INC%') LIMIT 1",AMAZON COM INC is in the Consumer Discretionary sector.,"{""value"": ""Consumer Discretionary"", ""type"": ""text""}",5.0,0.8,template,,,,0.0123,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many different fiscal year ends are represented?,distinct_fiscal_year_total,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,Which state has the most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 1
",state: CA | count: 123,"{""value"": ""CA"", ""type"": ""text""}",5.0,0.65,template,,,,0.0076,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies filed 10-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-K'),Count: 563,"{""value"": 563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What is the most recent filing date in the dataset?,latest_filing_date,SELECT MAX(filed) AS latest_filing_date FROM sub,latest_filing_date: 2025-06-30 00:00:00,"{""value"": ""2025-06-30 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0031,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are in the Health Care sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%health care%'),There are 80 companies in the Health Care sector.,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000066740?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000066740' LIMIT 1,3M CO's CIK is unknown.,"{""value"": ""3M CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many financial facts have footnotes?,fact_count_with_footnotes,SELECT COUNT(*) AS fact_count FROM num WHERE footnote IS NOT NULL AND TRIM(CAST(footnote AS VARCHAR)) <> '',Count: 33959,"{""value"": 33959, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0193,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,What currency is used most frequently in the numerical data?,most_common_currency,"SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL GROUP BY 1 ORDER BY fact_count DESC LIMIT 1",currency: USD | fact_count: 14760135,"{""value"": ""USD"", ""type"": ""text""}",5.0,0.65,template,,,,0.0324,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Delaware?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('DE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('DE'))
  )
",Count: 346,"{""value"": 349, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",3.0,0.7,template,,,,0.0221,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,Which sector has the most companies in our S&P 500 dataset?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,19.6294,0.0,0.0,0.0,0.0
RUN_014,"06 Nov 2025, 1700 hours",simple,How many S&P 500 companies are in the Information Technology sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%information technology%'),There are 165 companies in the Information Technology sector.,"{""value"": 165, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 421}, 'latency_ms': 5069, 'success': True}]",5.0889,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What is Johnson & Johnson's return on equity (ROE) percentage?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: JOHNSON & JOHNSON | roe_percentage: 20.06,"{""value"": 20.06, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1.0}}",5.0,0.8,template,,,,4.8488,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Hong Kong dollars (HKD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('HKD'),Count: 140,"{""value"": 140, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0519,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,"How many facts use per-share units (per share, per unit)?",fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""absolute"": 100}}",5.0,0.7,template,,,,0.7867,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What is the total count of unique unit types in the dataset?,unique_unit_count,SELECT COUNT(DISTINCT UPPER(TRIM(uom))) AS unit_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 49, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.1473,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Mexican pesos (MXN)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('MXN'),Count: 37,"{""value"": 37, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0897,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many facts use barrels as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('barrels'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.091,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Australian dollars (AUD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('AUD'),Count: 110,"{""value"": 110, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.1522,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many facts use 'days' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('days'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0987,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What is the least common currency in the dataset?,least_common_currency,"WITH currency_counts AS (
    SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count,
           ROW_NUMBER() OVER (ORDER BY COUNT(*) ASC, UPPER(TRIM(uom))) AS currency_rank
    FROM num
    WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3
    GROUP BY 1
)
SELECT currency, fact_count FROM currency_counts WHERE currency_rank = 1",currency: COP | fact_count: 1,"{""value"": ""COP"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,1.465,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many facts are measured in Japanese yen (JPY)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 122, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0289,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many facts use square feet as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('square feet'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.1811,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Swiss francs (CHF)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CHF'),Count: 218,"{""value"": 218, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.1368,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many facts use percentage as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('pure'),Count: 50344,"{""value"": 50344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.1795,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What is the most common non-monetary unit of measure?,most_common_non_monetary_unit,"WITH unit_counts AS (
    SELECT UPPER(TRIM(uom)) AS unit, COUNT(*) AS cnt,
           ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    WHERE uom IS NOT NULL
      AND LENGTH(TRIM(uom)) <> 3
    GROUP BY 1
)
SELECT unit, cnt FROM unit_counts WHERE rank = 1",unit: SHARES | cnt: 642330,"{""value"": ""SHARES"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.3913,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many facts are measured in British pounds (GBP)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 446, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.0,,,,,0.0015,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many facts use 'shares' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.2432,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Euros (EUR)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('EUR'),Count: 37847,"{""value"": 37847, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.1975,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Canadian dollars (CAD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CAD'),Count: 2926,"{""value"": 2926, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0983,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What is the second most common currency in the dataset?,second_most_common_currency,"WITH currency_counts AS (
    SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count,
           ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS currency_rank
    FROM num
    WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3
    GROUP BY 1
)
SELECT currency, fact_count FROM currency_counts WHERE currency_rank = 2",currency: EUR | fact_count: 37847,"{""value"": ""EUR"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0945,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many different currencies are represented in the financial data?,distinct_currency_count,SELECT COUNT(DISTINCT UPPER(TRIM(uom))) AS currency_count FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3,Count: 27,"{""value"": 27, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0539,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies returned more than 50% of operating cash flow to shareholders?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0005,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies have free cash flow exceeding $10 billion?,companies_free_cash_flow_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value > 10000000000.0",Count: 11,"{""value"": 11, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,template,,,,0.2175,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies issued new debt during the period?,companies_new_debt_issued,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ProceedsFromIssuanceOfLongTermDebt'
  AND n.value > 0",Count: 215,"{""value"": 215, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.2181,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What was Johnson & Johnson's acquisition spending?,company_acquisition_spending,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS acquisition_spending,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PaymentsToAcquireBusinessesNetOfCashAcquired'
      AND n.qtrs IN (0,4)
)
SELECT acquisition_spending, period_end
FROM latest_metric
WHERE rn = 1",acquisition_spending: 1800000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 800000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",1.0,0.65,template,,,,0.1893,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies have negative operating cash flow?,companies_negative_operating_cash_flow,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value < 0",Count: 93,"{""value"": 93, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.1989,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What was Tesla's change in cash and cash equivalents?,companies_change_in_cash,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS change_in_cash,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
      AND n.qtrs IN (0,4)
)
SELECT change_in_cash, period_end
FROM latest_metric
WHERE rn = 1",change_in_cash: 13256000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 13256000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.85,template,,,,0.2058,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies spent more than $5 billion on acquisitions?,companies_acquisition_spending_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'PaymentsToAcquireBusinessesNetOfCashAcquired'
  AND ABS(n.value) > 5000000000.0",Count: 7,"{""value"": 7, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.7,template,,,,0.3645,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies have positive free cash flow?,companies_positive_free_cash_flow,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value > 0",Count: 525,"{""value"": 525, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.2744,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies have EBITDA exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.0,,,,,0.0019,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies reported foreign exchange gains/losses?,companies_forex_gain_loss,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag IN ('ForeignCurrencyTransactionGainLoss','GainLossOnForeignCurrencyExchange')
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.5153,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies have negative net income?,companies_negative_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetIncomeLoss'
  AND n.value < 0",Count: 201,"{""value"": 74, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.85,template,,,,0.8274,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What was Johnson & Johnson's income tax expense?,latest_income_tax_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS income_tax_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'IncomeTaxExpenseBenefit'
      AND n.qtrs IN (0,4)
)
SELECT income_tax_expense, period_end
FROM latest_metric
WHERE rn = 1",income_tax_expense: 2621000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 2989000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.8,template,,,,0.8116,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies reported depreciation and amortization expenses?,companies_depreciation_amortization_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'DepreciationAndAmortization'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 321,"{""value"": 321, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.8745,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What was Tesla's other income (expense) in the latest period?,latest_other_income_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS other_income_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'OtherNonoperatingIncomeExpense'
      AND n.qtrs IN (0,4)
)
SELECT other_income_expense, period_end
FROM latest_metric
WHERE rn = 1",other_income_expense: 695000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": -43000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",1.0,0.8,template,,,,0.4057,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies have positive operating income?,companies_positive_operating_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'OperatingIncomeLoss'
  AND n.value > 0",Count: 907,"{""value"": 907.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.1561,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies reported research and development expenses?,companies_research_expense_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ResearchAndDevelopmentExpense'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 344,"{""value"": 344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.1096,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies have working capital exceeding $50 billion?,companies_working_capital_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND (current_assets - current_liabilities) > 50000000000.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.2569,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies report goodwill on their balance sheets?,companies_goodwill_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'Goodwill'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 3491,"{""value"": 3491.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.1732,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies have intangible assets exceeding $10 billion?,companies_intangibles_above_threshold,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'IntangibleAssetsNetExcludingGoodwill' THEN n.value END) AS intangible_assets
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag = 'IntangibleAssetsNetExcludingGoodwill'
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE intangible_assets IS NOT NULL AND intangible_assets > 10000000000.0",Count: 38,"{""value"": 38, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.1767,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies have negative stockholders' equity?,companies_negative_equity,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity < 0",Count: 1,"{""value"": 1, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.85,template,,,,0.1948,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,"What is Tesla's property, plant and equipment value?",latest_property_plant_equipment,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS property_plant_equipment,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PropertyPlantAndEquipmentNet'
      AND n.qtrs IN (0,4)
)
SELECT property_plant_equipment, period_end
FROM latest_metric
WHERE rn = 1",property_plant_equipment: 35836000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 35836000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.65,template,,,,0.1275,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies have more liabilities than assets?,companies_more_liabilities_than_assets,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed,
                   ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Assets','Liabilities')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND liabilities IS NOT NULL
  AND liabilities > assets",Count: 25,"{""value"": 25, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.3343,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies have current assets exceeding $100 billion?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%MASTERCARD INC%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",MASTERCARD INC has 0 matching records.,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",3.0,0.85,llm_template_selection,,,,19.1783,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies have Return on Equity above 20%?,companies_return_on_equity_above_threshold,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 20.0",Count: 174,"{""value"": 175, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,1.3202,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies have gross margin above 50%?,companies_gross_margin_above_threshold,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('Revenues','SalesRevenueNet') THEN n.value END) AS revenue,
        MAX(CASE WHEN n.tag = 'CostOfRevenue' THEN n.value END) AS cost
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Revenues','SalesRevenueNet','CostOfRevenue')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE revenue IS NOT NULL AND revenue <> 0 AND cost IS NOT NULL
  AND (revenue - cost) / revenue > 50.0",Count: 0,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",3.0,0.7,template,,,,0.1903,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies have a debt-to-equity ratio above 1.0?,companies_debt_to_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Liabilities','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND liabilities IS NOT NULL
  AND liabilities / equity > 1.0",Count: 236,"{""value"": 236.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.2867,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies have negative Return on Assets?,companies_negative_return_on_assets,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('NetIncomeLoss','Assets')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND assets <> 0 AND net_income IS NOT NULL AND net_income / assets < 0",Count: 3,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",3.0,0.85,template,,,,0.217,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies have a current ratio above 2.0?,companies_current_ratio_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND current_liabilities <> 0
  AND current_assets / current_liabilities > 2.0",Count: 115,"{""value"": 115.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.7,template,,,,0.1989,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies have positive Return on Equity in the latest period?,companies_positive_return_on_equity,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 0",Count: 434,"{""value"": 448, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,1.6907,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many annual (qtrs=0) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 0,Count: 5484928,"{""value"": 5484928, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0367,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What is the second most frequent form type in submissions?,form_type_rank,"WITH form_counts AS (
    SELECT form, COUNT(*) AS filing_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM sub
    GROUP BY form
)
SELECT form, filing_count
FROM form_counts
WHERE rank = 2
LIMIT 1",form: 10-K | filing_count: 6274,"{""value"": ""10-K"", ""type"": ""text""}",5.0,0.65,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many submissions are for fiscal period Q4?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q4'),Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 1}",5.0,0.75,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many submissions are for fiscal period Q3?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q3'),Count: 5238,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5238}",5.0,0.75,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many submissions are for fiscal period Q2?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q2'),Count: 5296,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5296}",5.0,0.75,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many submissions have September fiscal year end (0930)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0930',Count: 1134,"{""value"": 1134, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0024,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many submissions have June fiscal year end (0630)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0630',Count: 949,"{""value"": 949, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many submissions have March fiscal year end (0331)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0331',Count: 394,"{""value"": 394, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many submissions have December fiscal year end (1231)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '1231',Count: 17572,"{""value"": 17572, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many different form types are present in the submissions?,distinct_form_type_count,SELECT COUNT(DISTINCT form) AS form_type_count FROM sub,Count: 21,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 21}",5.0,0.7,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal period FY (full year)?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('FY'),Count: 6476,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 6476}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal period Q1?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q1'),Count: 5664,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5664}",5.0,0.75,template,,,,0.0036,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal year 2025?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '2025',Count: 0,"{""value"": 917, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",1.0,0.75,template,,,,0.0038,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal year 2024?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '2024',Count: 0,"{""value"": 4167, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",1.0,0.75,template,,,,0.002,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What is the earliest filing date in the dataset?,earliest_filing_date,SELECT MIN(filed) AS earliest_filing_date FROM sub,earliest_filing_date: 2015-01-02 00:00:00,"{""value"": ""2015-01-02 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies filed 8-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('8-K'),Count: 112,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 112}",5.0,0.7,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies filed 10-Q forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-Q'),Count: 543,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 543}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many financial facts are reported with coreg (co-registrant) information?,fact_count_with_coreg,SELECT COUNT(*) AS fact_count FROM num WHERE coreg IS NOT NULL AND TRIM(coreg) <> '',Count: 1261087,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 1261087}",5.0,0.7,template,,,,0.0177,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many XBRL tags are classified as 'string' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%string%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Debt' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%DEBT%'),Count: 26515,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 26515}",5.0,0.85,template,,,,0.0372,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Equity' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%EQUITY%'),Count: 24563,"{""value"": 24563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0466,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Cash' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%CASH%'),Count: 29232,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 29232}",5.0,0.85,template,,,,0.0377,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What is the third most frequent XBRL tag in numerical data?,tag_nth_most_common,"WITH tag_counts AS (
    SELECT
        tag,
        COUNT(*) AS fact_count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    GROUP BY tag
)
SELECT tag, fact_count
FROM tag_counts
WHERE rank = 3
LIMIT 1",tag: Revenues | fact_count: 491457,"{""type"": ""text"", ""value"": ""Revenues""}",5.0,0.65,template,,,,0.0406,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many numerical facts have zero values?,fact_count_zero_values,SELECT COUNT(*) AS fact_count FROM num WHERE value = 0,Count: 1427015,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 1427015}",5.0,0.7,template,,,,0.0742,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many numerical facts have negative values?,fact_count_negative_values,SELECT COUNT(*) AS fact_count FROM num WHERE value < 0,Count: 2124201,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 2124201.0}",5.0,0.7,template,,,,0.076,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many XBRL tags are classified as 'per-share' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%per-share%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0.0}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many XBRL tags have 'shares' as unit of measure in numerical data?,tag_count_by_unit,SELECT COUNT(DISTINCT tag) AS tag_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 949,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 949}",5.0,0.7,template,,,,0.0405,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many financial facts have duplicate values (dimhash populated)?,fact_count_dimhash_populated,SELECT COUNT(*) AS fact_count FROM num WHERE segments IS NOT NULL AND TRIM(segments) <> '',Count: 8738244,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 8738244}",5.0,0.7,template,,,,0.8431,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many different unit types (UOM) are present in the numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 49.0}",5.0,0.7,template,,,,0.0149,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Liability' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%LIABILITY%'),Count: 11059,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 11059}",5.0,0.7,template,,,,0.04,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Asset' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%ASSET%'),Count: 40285,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 40285}",5.0,0.7,template,,,,0.0519,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Revenue' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%REVENUE%'),Count: 12221,"{""value"": 12221, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0507,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many XBRL tags are classified as 'monetary' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%monetary%'),Count: 454617,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 454617}",5.0,0.7,template,,,,0.0044,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many XBRL tags have a debit-credit flag of 'Debit'?,tag_count_by_debit_credit,SELECT COUNT(*) AS tag_count FROM tag WHERE crdr IS NOT NULL AND UPPER(TRIM(crdr)) = CASE WHEN UPPER(TRIM('Debit')) LIKE 'D%' THEN 'D' WHEN UPPER(TRIM('Debit')) LIKE 'C%' THEN 'C' ELSE UPPER(TRIM('Debit')) END,Count: 224017,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 224017}",5.0,0.7,template,,,,0.0049,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What is Google's (Alphabet) return on equity (ROE)?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%ALPHABET INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: ALPHABET INC. | roe_percentage: 32.91,"{""value"": 32.91, ""type"": ""numeric"", ""tolerance"": {""absolute"": 0.5}}",5.0,0.8,template,,,,0.295,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Georgia?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('GA')",Count: 22,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 22}",5.0,0.7,template,,,,0.0067,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Bermuda?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",5.0,0.7,template,,,,0.0072,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Washington state?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('WA')",Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",5.0,0.7,template,,,,0.0079,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,Which state has the third most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 3
",state: NY | count: 69,"{""value"": ""NY"", ""type"": ""text""}",5.0,0.65,template,,,,0.0099,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Massachusetts?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('MA')",Count: 31,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 27}",3.0,0.7,template,,,,0.008,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in the United Kingdom?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",5.0,0.7,template,,,,0.0091,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in North Carolina?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NC')",Count: 20,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",5.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Ohio?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('OH')",Count: 24,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",3.0,0.7,template,,,,0.0072,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many different US states are represented in headquarters data?,distinct_headquarters_states,SELECT COUNT(DISTINCT stprba) AS state_count FROM sub WHERE stprba IS NOT NULL,Count: 44,"{""value"": 44, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0032,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many different countries are represented in the incorporation data?,distinct_incorporation_countries,SELECT COUNT(DISTINCT countryinc) AS country_count FROM sub WHERE countryinc IS NOT NULL,Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 16}",5.0,0.7,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Switzerland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 5}",5.0,0.7,template,,,,0.0089,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Florida?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('FL')",Count: 26,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 26}",5.0,0.7,template,,,,0.0071,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Illinois?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('IL')",Count: 42,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 42}",5.0,0.7,template,,,,0.0064,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,Which state has the second most company headquarters after California?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 2
",state: TX | count: 81,"{""value"": ""TX"", ""type"": ""text""}",5.0,0.65,template,,,,0.0072,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Canada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 3}",3.0,0.7,template,,,,0.0072,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Ireland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 6}",5.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Nevada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('NV'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('NV'))
  )
",Count: 9,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 9}",5.0,0.7,template,,,,0.0072,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Texas?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('TX')",Count: 81,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 81}",5.0,0.7,template,,,,0.0066,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in New York?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NY')",Count: 69,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 69}",5.0,0.7,template,,,,0.0064,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,Which sector contains Johnson & Johnson?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%') LIMIT 1",JOHNSON & JOHNSON is in the Health Care sector.,"{""value"": ""Health Care"", ""type"": ""text""}",5.0,0.8,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many sectors have fewer than 25 companies?,sectors_below_threshold,"WITH sector_counts AS (
    SELECT gics_sector, COUNT(*) AS count
    FROM companies
    WHERE gics_sector IS NOT NULL
    GROUP BY gics_sector
)
SELECT COUNT(*) AS sector_count
FROM sector_counts
WHERE count < 25.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many sectors have more than 50 companies?,sectors_above_threshold,"SELECT COUNT(DISTINCT gics_sector) as sector_count FROM (SELECT gics_sector, COUNT(*) as cnt FROM companies GROUP BY gics_sector HAVING cnt > 50.0) subq",Count: 6,"{""value"": 6, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0046,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,Which sector has the fewest companies?,sector_with_fewest_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL AND gics_sector != 'Other' GROUP BY gics_sector ORDER BY count ASC LIMIT 1",AT&T INC is in the Real Estate sector.,"{""type"": ""text"", ""value"": ""Real Estate""}",5.0,0.8,template,,,,0.002,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are in the Communication Services sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%communication services%'),There are 17 companies in the Communication Services sector.,"{""value"": 17, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are in the Real Estate sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%real estate%'),There are 3 companies in the Real Estate sector.,"{""value"": 3, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are in the Consumer Staples sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer staples%'),There are 28 companies in the Consumer Staples sector.,"{""value"": 26, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",3.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are in the Consumer Discretionary sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer discretionary%'),There are 99 companies in the Consumer Discretionary sector.,"{""value"": 99, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are in the Energy sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%energy%'),There are 51 companies in the Energy sector.,"{""value"": 51, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are in the Materials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%materials%'),There are 41 companies in the Materials sector.,"{""value"": 41, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,Which sector has the second most companies?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""AT&T INC is in the Financials sector."", ""type"": ""text""}",5.0,0.8,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are in the Industrials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%industrials%'),There are 82 companies in the Industrials sector.,"{""value"": 82, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What was Meta's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%META PLATFORMS, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 76793000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 76793000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.0723,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies reported cost of revenue in the latest period?,companies_reporting_cost_of_revenue,"WITH latest_cost AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'CostOfRevenue'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_cost
WHERE rn = 1 AND value IS NOT NULL",Count: 134,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 134}",5.0,0.85,template,,,,0.1335,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies have total revenue exceeding $50 billion in the latest period?,companies_revenue_above_threshold,"WITH latest_filing AS (
    SELECT
        s.cik,
        s.adsh,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
),
latest_revenue AS (
    SELECT lf.cik, n.value AS revenue
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE lf.rn = 1
      AND n.tag IN ('Revenues', 'SalesRevenueNet')
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS count
FROM latest_revenue lr
JOIN companies c ON c.cik = lr.cik
WHERE lr.revenue > 50000000000.0",Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 1213.0}",1.0,0.85,template,,,,0.1202,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What was Walmart's most recent total liabilities?,latest_total_liabilities,"
WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%WALMART INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.filed,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K', '10-K/A')
), selected_filing AS (
    SELECT adsh, cik, period, filed
    FROM latest_filing
    WHERE rn = 1
), metric_values AS (
    SELECT
        MAX(CASE WHEN n.tag = 'LiabilitiesAndStockholdersEquity' THEN n.value END) AS total_assets_equity,
        COALESCE(
            MAX(CASE WHEN n.tag = 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest' THEN n.value END),
            MAX(CASE WHEN n.tag = 'StockholdersEquity' THEN n.value END)
        ) AS equity
    FROM num n
    JOIN selected_filing lf ON n.adsh = lf.adsh
    WHERE n.tag IN (
        'LiabilitiesAndStockholdersEquity',
        'StockholdersEquity',
        'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest'
    )
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT
    (total_assets_equity - equity) AS total_liabilities,
    period AS period_end
FROM metric_values, selected_filing
",total_liabilities: 163402000000.0 | period_end: 2025-01-31 00:00:00,"{""type"": ""text"", ""value"": 163402000000.0, ""tolerance"": {""absolute"": 5000000000.0}}",5.0,0.8,template,,,,0.1644,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies reported positive net income in the latest period?,companies_positive_net_income,"WITH latest_net_income AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_net_income
WHERE rn = 1 AND value > 0",Count: 449,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 447.0}",5.0,0.85,template,,,,0.1651,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What was Johnson & Johnson's most recent gross profit?,latest_gross_profit,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS gross_profit,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'GrossProfit'
      AND n.qtrs IN (0,4)
)
SELECT gross_profit, period_end
FROM latest_metric
WHERE rn = 1",gross_profit: 55394000000.0 | period_end: 2024-12-31 00:00:00,"{""type"": ""numeric"", ""value"": 55394000000.0, ""tolerance"": {""absolute"": 2000000000.0}}",5.0,0.8,template,,,,0.126,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What was Tesla's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 74653000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 74653000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.0846,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies have 'LLC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%LLC%'),Count: 5,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 5}",5.0,0.7,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000019617?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000019617' LIMIT 1,JPMORGAN CHASE & CO's CIK is unknown.,"{""value"": ""JPMORGAN CHASE & CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0006,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies have 'INC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%INC%'),Count: 459,"{""value"": 459, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000050863?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000050863' LIMIT 1,INTEL CORP's CIK is unknown.,"{""value"": ""INTEL CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What is Walmart Inc.'s CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%WALMART INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",WALMART INC.'s CIK is 0000104169.,"{""value"": ""0000104169"", ""type"": ""text""}",5.0,0.8,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies have 'CORP' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%CORP%'),Count: 180,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What is Procter & Gamble's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%PROCTER & GAMBLE CO%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",PROCTER & GAMBLE CO's CIK is 0000080424.,"{""value"": ""0000080424"", ""type"": ""text""}",5.0,0.8,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,Which company has the longest company name in the dataset?,company_with_longest_name,SELECT name FROM companies ORDER BY LENGTH(name) DESC LIMIT 1,"name: CHARLES RIVER LABORATORIES INTERNATIONAL, INC.","{""type"": ""text"", ""value"": ""CHARLES RIVER LABORATORIES INTERNATIONAL, INC.""}",5.0,0.65,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What is Berkshire Hathaway's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%BERKSHIRE HATHAWAY INC%') LIMIT 1",BERKSHIRE HATHAWAY INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many quarterly (qtrs=1) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 1,Count: 3566310,"{""value"": 3566310, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0234,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are in the Utilities sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%utilities%'),There are 20 companies in the Utilities sector.,"{""value"": 20, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What is Tesla's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1","TESLA, INC.'s CIK is 0001318605.","{""value"": ""0001318605"", ""type"": ""text""}",5.0,0.8,template,,,,0.0031,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many financial facts are denominated in USD?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0179,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,Which form type appears most frequently in submissions?,most_common_form_type,"SELECT form, COUNT(*) AS filing_count FROM sub GROUP BY form ORDER BY filing_count DESC LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many unique companies are represented in the dataset?,total_company_count,SELECT COUNT(DISTINCT cik) AS company_count FROM companies,Count: 589,"{""value"": 589, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What is the earliest period date in the financial data?,earliest_period_date,SELECT MIN(period) AS earliest_period FROM sub,earliest_period: 2014-05-31 00:00:00,"{""value"": ""2014-05-31 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies have international (non-US) incorporation?,international_incorporation_count,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS company_count
FROM latest_submission
WHERE rn = 1 AND UPPER(countryinc) <> 'US'",Count: 34,"{""value"": 34, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0074,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What is Amazon's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%AMAZON COM INC%') LIMIT 1",AMAZON COM INC is in the Consumer Discretionary sector.,"{""value"": ""Consumer Discretionary"", ""type"": ""text""}",5.0,0.8,template,,,,0.0135,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many different fiscal year ends are represented?,distinct_fiscal_year_total,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,Which state has the most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 1
",state: CA | count: 123,"{""value"": ""CA"", ""type"": ""text""}",5.0,0.65,template,,,,0.0074,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies filed 10-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-K'),Count: 563,"{""value"": 563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What is the most recent filing date in the dataset?,latest_filing_date,SELECT MAX(filed) AS latest_filing_date FROM sub,latest_filing_date: 2025-06-30 00:00:00,"{""value"": ""2025-06-30 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0037,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are in the Health Care sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%health care%'),There are 80 companies in the Health Care sector.,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000066740?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000066740' LIMIT 1,3M CO's CIK is unknown.,"{""value"": ""3M CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many financial facts have footnotes?,fact_count_with_footnotes,SELECT COUNT(*) AS fact_count FROM num WHERE footnote IS NOT NULL AND TRIM(CAST(footnote AS VARCHAR)) <> '',Count: 33959,"{""value"": 33959, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0136,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,What currency is used most frequently in the numerical data?,most_common_currency,"SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL GROUP BY 1 ORDER BY fact_count DESC LIMIT 1",currency: USD | fact_count: 14760135,"{""value"": ""USD"", ""type"": ""text""}",5.0,0.65,template,,,,0.0273,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Delaware?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('DE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('DE'))
  )
",Count: 346,"{""value"": 349, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",3.0,0.7,template,,,,0.0145,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,Which sector has the most companies in our S&P 500 dataset?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,20.8543,0.0,0.0,0.0,0.0
RUN_013,"06 Nov 2025, 1700 hours",simple,How many S&P 500 companies are in the Information Technology sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%information technology%'),There are 165 companies in the Information Technology sector.,"{""value"": 165, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.96,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 363}, 'latency_ms': 5720, 'success': True}]",5.7327,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What is Johnson & Johnson's return on equity (ROE) percentage?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: JOHNSON & JOHNSON | roe_percentage: 20.06,"{""value"": 20.06, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1.0}}",5.0,0.8,template,,,,0.4049,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Hong Kong dollars (HKD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('HKD'),Count: 140,"{""value"": 140, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0165,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,"How many facts use per-share units (per share, per unit)?",fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""absolute"": 100}}",5.0,0.7,template,,,,0.019,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What is the total count of unique unit types in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 21, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Mexican pesos (MXN)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('MXN'),Count: 37,"{""value"": 37, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0121,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many facts use barrels as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('barrels'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Australian dollars (AUD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('AUD'),Count: 110,"{""value"": 110, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.014,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many facts use 'days' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('days'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0021,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What is the least common currency in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""14"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many facts are measured in Japanese yen (JPY)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 122, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many facts use square feet as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('square feet'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Swiss francs (CHF)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CHF'),Count: 218,"{""value"": 218, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0133,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many facts use percentage as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('pure'),Count: 50344,"{""value"": 50344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0159,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What is the most common non-monetary unit of measure?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""shares"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many facts are measured in British pounds (GBP)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 446, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.0,,,,,0.0007,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many facts use 'shares' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0206,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Euros (EUR)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('EUR'),Count: 37847,"{""value"": 37847, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0206,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Canadian dollars (CAD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CAD'),Count: 2926,"{""value"": 2926, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0175,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What is the second most common currency in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""14"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many different currencies are represented in the financial data?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies returned more than 50% of operating cash flow to shareholders?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 85, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies have free cash flow exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 45, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies issued new debt during the period?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What was Johnson & Johnson's acquisition spending?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 2.8, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies have negative operating cash flow?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 76, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What was Tesla's change in cash and cash equivalents?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 16352000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies spent more than $5 billion on acquisitions?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies have positive free cash flow?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 282, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies have EBITDA exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies reported foreign exchange gains/losses?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0005,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies have negative net income?,companies_negative_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetIncomeLoss'
  AND n.value < 0",Count: 201,"{""value"": 201.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.1325,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What was Johnson & Johnson's income tax expense?,latest_income_tax_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS income_tax_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'IncomeTaxExpenseBenefit'
      AND n.qtrs IN (0,4)
)
SELECT income_tax_expense, period_end
FROM latest_metric
WHERE rn = 1",income_tax_expense: 2989000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 2989000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.1216,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies reported depreciation and amortization expenses?,companies_depreciation_amortization_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'DepreciationAndAmortization'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 321,"{""value"": 321.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.1388,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What was Tesla's other income (expense) in the latest period?,latest_other_income_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS other_income_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'OtherNonoperatingIncomeExpense'
      AND n.qtrs IN (0,4)
)
SELECT other_income_expense, period_end
FROM latest_metric
WHERE rn = 1",other_income_expense: 172000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": -43000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",1.0,0.8,template,,,,0.1095,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies have positive operating income?,companies_positive_operating_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'OperatingIncomeLoss'
  AND n.value > 0",Count: 907,"{""value"": 907.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.1347,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies reported research and development expenses?,companies_research_expense_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ResearchAndDevelopmentExpense'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 344,"{""value"": 344.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.7,template,,,,0.1275,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies have working capital exceeding $50 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0005,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies report goodwill on their balance sheets?,companies_goodwill_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'Goodwill'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 3491,"{""value"": 3491.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.1677,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies have intangible assets exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0007,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies have negative stockholders' equity?,companies_negative_equity,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity < 0",Count: 1,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.85,template,,,,0.2136,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,"What is Tesla's property, plant and equipment value?",latest_property_plant_equipment,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS property_plant_equipment,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PropertyPlantAndEquipmentNet'
      AND n.qtrs IN (0,4)
)
SELECT property_plant_equipment, period_end
FROM latest_metric
WHERE rn = 1",property_plant_equipment: 35836000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 35836000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.65,template,,,,0.1936,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies have more liabilities than assets?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",1.0,0.0,,,,,0.0008,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies have current assets exceeding $100 billion?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%MASTERCARD INC%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",MASTERCARD INC has 0 matching records.,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,llm_template_selection,,,,22.4242,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies have Return on Equity above 20%?,companies_return_on_equity_above_threshold,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 20.0",Count: 175,"{""value"": 175, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,1.2814,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies have gross margin above 50%?,companies_gross_margin_above_threshold,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('Revenues','SalesRevenueNet') THEN n.value END) AS revenue,
        MAX(CASE WHEN n.tag = 'CostOfRevenue' THEN n.value END) AS cost
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Revenues','SalesRevenueNet','CostOfRevenue')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE revenue IS NOT NULL AND revenue <> 0 AND cost IS NOT NULL
  AND (revenue - cost) / revenue > 50.0",Count: 0,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",3.0,0.7,template,,,,0.1703,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies have a debt-to-equity ratio above 1.0?,companies_debt_to_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Liabilities','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND liabilities IS NOT NULL
  AND liabilities / equity > 1.0",Count: 236,"{""value"": 236.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.1678,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies have negative Return on Assets?,companies_negative_return_on_assets,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('NetIncomeLoss','Assets')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND assets <> 0 AND net_income IS NOT NULL AND net_income / assets < 0",Count: 3,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",3.0,0.85,template,,,,0.1513,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies have a current ratio above 2.0?,companies_current_ratio_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND current_liabilities <> 0
  AND current_assets / current_liabilities > 2.0",Count: 115,"{""value"": 115.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.7,template,,,,0.1652,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies have positive Return on Equity in the latest period?,companies_positive_return_on_equity,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 0",Count: 434,"{""value"": 434, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,1.2044,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many annual (qtrs=0) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 0,Count: 5484928,"{""value"": 5484928.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0301,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What is the second most frequent form type in submissions?,form_type_rank,"WITH form_counts AS (
    SELECT form, COUNT(*) AS filing_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM sub
    GROUP BY form
)
SELECT form, filing_count
FROM form_counts
WHERE rank = 2
LIMIT 1",form: 10-K | filing_count: 6274,"{""value"": ""10-K"", ""type"": ""text""}",5.0,0.65,template,,,,0.002,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many submissions are for fiscal period Q4?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q4'),Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 1}",5.0,0.75,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many submissions are for fiscal period Q3?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q3'),Count: 5238,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5238}",5.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many submissions are for fiscal period Q2?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q2'),Count: 5296,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5296}",5.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many submissions have September fiscal year end (0930)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0930',Count: 1134,"{""value"": 14.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many submissions have June fiscal year end (0630)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0630',Count: 949,"{""value"": 14.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many submissions have March fiscal year end (0331)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0331',Count: 394,"{""value"": 14.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.7,template,,,,0.0024,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many submissions have December fiscal year end (1231)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '1231',Count: 17572,"{""value"": 14.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.7,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many different form types are present in the submissions?,distinct_form_type_count,SELECT COUNT(DISTINCT form) AS form_type_count FROM sub,Count: 21,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 21}",5.0,0.7,template,,,,0.0026,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal period FY (full year)?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('FY'),Count: 6476,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 6476}",5.0,0.7,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal period Q1?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q1'),Count: 5664,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5664}",5.0,0.75,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal year 2025?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2025,Count: 917,"{""value"": 917.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal year 2024?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2024,Count: 4167,"{""value"": 4167.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.75,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What is the earliest filing date in the dataset?,earliest_filing_date,SELECT MIN(filed) AS earliest_filing_date FROM sub,earliest_filing_date: 2015-01-02 00:00:00,"{""value"": ""2015-01-02 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies filed 8-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('8-K'),Count: 112,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 112}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies filed 10-Q forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-Q'),Count: 543,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 543}",5.0,0.7,template,,,,0.002,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many financial facts are reported with coreg (co-registrant) information?,fact_count_with_coreg,SELECT COUNT(*) AS fact_count FROM num WHERE coreg IS NOT NULL AND TRIM(coreg) <> '',Count: 1261087,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 1261087.0}",5.0,0.7,template,,,,0.0154,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many XBRL tags are classified as 'string' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%string%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.7,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Debt' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%DEBT%'),Count: 26515,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 26515}",5.0,0.85,template,,,,0.0376,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Equity' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%EQUITY%'),Count: 24563,"{""value"": 24563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.049,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Cash' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%CASH%'),Count: 29232,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 29232}",5.0,0.85,template,,,,0.0388,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What is the third most frequent XBRL tag in numerical data?,tag_nth_most_common,"WITH tag_counts AS (
    SELECT
        tag,
        COUNT(*) AS fact_count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    GROUP BY tag
)
SELECT tag, fact_count
FROM tag_counts
WHERE rank = 3
LIMIT 1",tag: Revenues | fact_count: 491457,"{""type"": ""text"", ""value"": ""Revenues""}",5.0,0.65,template,,,,0.0415,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many numerical facts have zero values?,fact_count_zero_values,SELECT COUNT(*) AS fact_count FROM num WHERE value = 0,Count: 1427015,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 1427015.0}",5.0,0.7,template,,,,0.0866,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many numerical facts have negative values?,fact_count_negative_values,SELECT COUNT(*) AS fact_count FROM num WHERE value < 0,Count: 2124201,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 2124201.0}",5.0,0.7,template,,,,0.0837,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many XBRL tags are classified as 'per-share' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%per-share%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0.0}",5.0,0.7,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many XBRL tags have 'shares' as unit of measure in numerical data?,tag_count_by_unit,SELECT COUNT(DISTINCT tag) AS tag_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 949,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 949}",5.0,0.7,template,,,,0.0451,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many financial facts have duplicate values (dimhash populated)?,fact_count_dimhash_populated,SELECT COUNT(*) AS fact_count FROM num WHERE segments IS NOT NULL AND TRIM(segments) <> '',Count: 8738244,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 8738244}",5.0,0.7,template,,,,0.7911,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many different unit types (UOM) are present in the numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 49.0}",5.0,0.7,template,,,,0.0154,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Liability' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%LIABILITY%'),Count: 11059,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 11059}",5.0,0.7,template,,,,0.0336,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Asset' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%ASSET%'),Count: 40285,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 40285}",5.0,0.7,template,,,,0.043,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Revenue' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%REVENUE%'),Count: 12221,"{""value"": 12221, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0499,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many XBRL tags are classified as 'monetary' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%monetary%'),Count: 454617,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 454617}",5.0,0.7,template,,,,0.0027,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many XBRL tags have a debit-credit flag of 'Debit'?,tag_count_by_debit_credit,SELECT COUNT(*) AS tag_count FROM tag WHERE crdr IS NOT NULL AND UPPER(TRIM(crdr)) = CASE WHEN UPPER(TRIM('Debit')) LIKE 'D%' THEN 'D' WHEN UPPER(TRIM('Debit')) LIKE 'C%' THEN 'C' ELSE UPPER(TRIM('Debit')) END,Count: 224017,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 224017}",5.0,0.7,template,,,,0.0048,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What is Google's (Alphabet) return on equity (ROE)?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%ALPHABET INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: ALPHABET INC. | roe_percentage: 32.91,"{""value"": 32.91, ""type"": ""numeric"", ""tolerance"": {""absolute"": 0.5}}",5.0,0.8,template,,,,0.2378,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Georgia?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('GA')",Count: 22,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 22}",5.0,0.7,template,,,,0.0072,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Bermuda?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",5.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Washington state?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('WA')",Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",5.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,Which state has the third most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 3
",state: NY | count: 69,"{""value"": ""NY"", ""type"": ""text""}",5.0,0.65,template,,,,0.0105,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Massachusetts?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('MA')",Count: 31,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 27}",3.0,0.7,template,,,,0.0116,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in the United Kingdom?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",5.0,0.7,template,,,,0.0071,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in North Carolina?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NC')",Count: 20,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",5.0,0.7,template,,,,0.0115,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Ohio?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('OH')",Count: 24,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",3.0,0.7,template,,,,0.0077,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many different US states are represented in headquarters data?,distinct_headquarters_states,SELECT COUNT(DISTINCT stprba) AS state_count FROM sub WHERE stprba IS NOT NULL,Count: 44,"{""value"": 44, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many different countries are represented in the incorporation data?,distinct_incorporation_countries,SELECT COUNT(DISTINCT countryinc) AS country_count FROM sub WHERE countryinc IS NOT NULL,Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 16}",5.0,0.7,template,,,,0.002,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Switzerland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 5}",5.0,0.7,template,,,,0.0072,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Florida?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('FL')",Count: 26,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 26}",5.0,0.7,template,,,,0.0072,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Illinois?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('IL')",Count: 42,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 42}",5.0,0.7,template,,,,0.007,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,Which state has the second most company headquarters after California?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 2
",state: TX | count: 81,"{""value"": ""TX"", ""type"": ""text""}",5.0,0.65,template,,,,0.0087,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Canada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 3}",3.0,0.7,template,,,,0.0077,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Ireland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 6}",5.0,0.7,template,,,,0.0075,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Nevada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('NV'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('NV'))
  )
",Count: 9,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 9}",5.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Texas?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('TX')",Count: 81,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 81}",5.0,0.7,template,,,,0.008,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in New York?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NY')",Count: 69,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 69}",5.0,0.7,template,,,,0.006,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,Which sector contains Johnson & Johnson?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%') LIMIT 1",JOHNSON & JOHNSON is in the Health Care sector.,"{""value"": ""Health Care"", ""type"": ""text""}",5.0,0.8,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many sectors have fewer than 25 companies?,sectors_below_threshold,"WITH sector_counts AS (
    SELECT gics_sector, COUNT(*) AS count
    FROM companies
    WHERE gics_sector IS NOT NULL
    GROUP BY gics_sector
)
SELECT COUNT(*) AS sector_count
FROM sector_counts
WHERE count < 25.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many sectors have more than 50 companies?,sectors_above_threshold,"SELECT COUNT(DISTINCT gics_sector) as sector_count FROM (SELECT gics_sector, COUNT(*) as cnt FROM companies GROUP BY gics_sector HAVING cnt > 50.0) subq",Count: 6,"{""value"": 6, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0023,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,Which sector has the fewest companies?,sector_with_fewest_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL AND gics_sector != 'Other' GROUP BY gics_sector ORDER BY count ASC LIMIT 1",AT&T INC is in the Real Estate sector.,"{""type"": ""text"", ""value"": ""Real Estate""}",5.0,0.8,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are in the Communication Services sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%communication services%'),There are 17 companies in the Communication Services sector.,"{""value"": 17, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are in the Real Estate sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%real estate%'),There are 3 companies in the Real Estate sector.,"{""value"": 3, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are in the Consumer Staples sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer staples%'),There are 28 companies in the Consumer Staples sector.,"{""value"": 26, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",3.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are in the Consumer Discretionary sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer discretionary%'),There are 99 companies in the Consumer Discretionary sector.,"{""value"": 99, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are in the Energy sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%energy%'),There are 51 companies in the Energy sector.,"{""value"": 51, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are in the Materials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%materials%'),There are 41 companies in the Materials sector.,"{""value"": 41, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,Which sector has the second most companies?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""AT&T INC is in the Financials sector."", ""type"": ""text""}",5.0,0.8,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are in the Industrials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%industrials%'),There are 82 companies in the Industrials sector.,"{""value"": 82, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What was Meta's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%META PLATFORMS, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 76793000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 76793000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.0622,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies reported cost of revenue in the latest period?,companies_reporting_cost_of_revenue,"WITH latest_cost AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'CostOfRevenue'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_cost
WHERE rn = 1 AND value IS NOT NULL",Count: 134,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 134}",5.0,0.85,template,,,,0.1267,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies have total revenue exceeding $50 billion in the latest period?,companies_revenue_above_threshold,"WITH latest_filing AS (
    SELECT
        s.cik,
        s.adsh,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
),
latest_revenue AS (
    SELECT lf.cik, n.value AS revenue
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE lf.rn = 1
      AND n.tag IN ('Revenues', 'SalesRevenueNet')
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS count
FROM latest_revenue lr
JOIN companies c ON c.cik = lr.cik
WHERE lr.revenue > 50000000000.0",Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 1213.0}",1.0,0.85,template,,,,0.1884,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What was Walmart's most recent total liabilities?,latest_total_liabilities,"
WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%WALMART INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.filed,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K', '10-K/A')
), selected_filing AS (
    SELECT adsh, cik, period, filed
    FROM latest_filing
    WHERE rn = 1
), metric_values AS (
    SELECT
        MAX(CASE WHEN n.tag = 'LiabilitiesAndStockholdersEquity' THEN n.value END) AS total_assets_equity,
        COALESCE(
            MAX(CASE WHEN n.tag = 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest' THEN n.value END),
            MAX(CASE WHEN n.tag = 'StockholdersEquity' THEN n.value END)
        ) AS equity
    FROM num n
    JOIN selected_filing lf ON n.adsh = lf.adsh
    WHERE n.tag IN (
        'LiabilitiesAndStockholdersEquity',
        'StockholdersEquity',
        'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest'
    )
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT
    (total_assets_equity - equity) AS total_liabilities,
    period AS period_end
FROM metric_values, selected_filing
",total_liabilities: 163402000000.0 | period_end: 2025-01-31 00:00:00,"{""type"": ""text"", ""value"": 163402000000.0, ""tolerance"": {""absolute"": 5000000000.0}}",5.0,0.8,template,,,,0.1975,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies reported positive net income in the latest period?,companies_positive_net_income,"WITH latest_net_income AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_net_income
WHERE rn = 1 AND value > 0",Count: 442,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 447.0}",5.0,0.85,template,,,,0.1269,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What was Johnson & Johnson's most recent gross profit?,latest_gross_profit,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS gross_profit,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'GrossProfit'
      AND n.qtrs IN (0,4)
)
SELECT gross_profit, period_end
FROM latest_metric
WHERE rn = 1",gross_profit: 55394000000.0 | period_end: 2024-12-31 00:00:00,"{""type"": ""numeric"", ""value"": 55394000000.0, ""tolerance"": {""absolute"": 2000000000.0}}",5.0,0.8,template,,,,0.1143,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What was Tesla's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 74653000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 74653000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.0964,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies have 'LLC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%LLC%'),Count: 5,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 5}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000019617?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000019617' LIMIT 1,JPMORGAN CHASE & CO's CIK is unknown.,"{""value"": ""JPMORGAN CHASE & CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0006,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies have 'INC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%INC%'),Count: 459,"{""value"": 459, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000050863?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000050863' LIMIT 1,INTEL CORP's CIK is unknown.,"{""value"": ""INTEL CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What is Walmart Inc.'s CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%WALMART INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",WALMART INC.'s CIK is 0000104169.,"{""value"": ""0000104169"", ""type"": ""text""}",5.0,0.8,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies have 'CORP' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%CORP%'),Count: 180,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0006,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What is Procter & Gamble's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%PROCTER & GAMBLE CO%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",PROCTER & GAMBLE CO's CIK is 0000080424.,"{""value"": ""0000080424"", ""type"": ""text""}",5.0,0.8,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,Which company has the longest company name in the dataset?,company_with_longest_name,SELECT name FROM companies ORDER BY LENGTH(name) DESC LIMIT 1,"name: CHARLES RIVER LABORATORIES INTERNATIONAL, INC.","{""type"": ""text"", ""value"": ""CHARLES RIVER LABORATORIES INTERNATIONAL, INC.""}",5.0,0.65,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What is Berkshire Hathaway's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%BERKSHIRE HATHAWAY INC%') LIMIT 1",BERKSHIRE HATHAWAY INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many quarterly (qtrs=1) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 1,Count: 3566310,"{""value"": 3566310, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.027,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are in the Utilities sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%utilities%'),There are 20 companies in the Utilities sector.,"{""value"": 20, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What is Tesla's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1","TESLA, INC.'s CIK is 0001318605.","{""value"": ""0001318605"", ""type"": ""text""}",5.0,0.8,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many financial facts are denominated in USD?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0253,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,Which form type appears most frequently in submissions?,most_common_form_type,"SELECT form, COUNT(*) AS filing_count FROM sub GROUP BY form ORDER BY filing_count DESC LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many unique companies are represented in the dataset?,total_company_count,SELECT COUNT(DISTINCT cik) AS company_count FROM companies,Count: 589,"{""value"": 589, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What is the earliest period date in the financial data?,earliest_period_date,SELECT MIN(period) AS earliest_period FROM sub,earliest_period: 2014-05-31 00:00:00,"{""value"": ""2014-05-31 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies have international (non-US) incorporation?,international_incorporation_count,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS company_count
FROM latest_submission
WHERE rn = 1 AND UPPER(countryinc) <> 'US'",Count: 34,"{""value"": 34, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0058,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What is Amazon's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%AMAZON COM INC%') LIMIT 1",AMAZON COM INC is in the Consumer Discretionary sector.,"{""value"": ""Consumer Discretionary"", ""type"": ""text""}",5.0,0.8,template,,,,0.0119,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many different fiscal year ends are represented?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.0,,,,,0.0014,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,Which state has the most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 1
",state: CA | count: 123,"{""value"": ""CA"", ""type"": ""text""}",5.0,0.65,template,,,,0.0078,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies filed 10-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-K'),Count: 563,"{""value"": 563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0021,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What is the most recent filing date in the dataset?,latest_filing_date,SELECT MAX(filed) AS latest_filing_date FROM sub,latest_filing_date: 2025-06-30 00:00:00,"{""value"": ""2025-06-30 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0082,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are in the Health Care sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%health care%'),There are 80 companies in the Health Care sector.,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000066740?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000066740' LIMIT 1,3M CO's CIK is unknown.,"{""value"": ""3M CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0027,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many financial facts have footnotes?,fact_count_with_footnotes,SELECT COUNT(*) AS fact_count FROM num WHERE footnote IS NOT NULL AND TRIM(CAST(footnote AS VARCHAR)) <> '',Count: 33959,"{""value"": 33959, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0167,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,What currency is used most frequently in the numerical data?,most_common_currency,"SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL GROUP BY 1 ORDER BY fact_count DESC LIMIT 1",currency: USD | fact_count: 14760135,"{""value"": ""USD"", ""type"": ""text""}",5.0,0.65,template,,,,0.0289,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Delaware?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('DE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('DE'))
  )
",Count: 346,"{""value"": 349, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",3.0,0.7,template,,,,0.0164,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,Which sector has the most companies in our S&P 500 dataset?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,23.7444,0.0,0.0,0.0,0.0
RUN_012,"06 Nov 2025, 1700 hours",simple,How many S&P 500 companies are in the Information Technology sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%information technology%'),There are 165 companies in the Information Technology sector.,"{""value"": 165, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.96,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 296}, 'latency_ms': 6365, 'success': True}]",6.3754,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What is Johnson & Johnson's return on equity (ROE) percentage?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: JOHNSON & JOHNSON | roe_percentage: 20.06,"{""value"": 20.06, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1.0}}",5.0,0.8,template,,,,0.3048,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Hong Kong dollars (HKD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('HKD'),Count: 140,"{""value"": 140, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0134,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,"How many facts use per-share units (per share, per unit)?",fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""absolute"": 100}}",5.0,0.7,template,,,,0.0158,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What is the total count of unique unit types in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 21, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Mexican pesos (MXN)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('MXN'),Count: 37,"{""value"": 37, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0073,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many facts use barrels as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('barrels'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0021,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Australian dollars (AUD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('AUD'),Count: 110,"{""value"": 110, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0113,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many facts use 'days' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('days'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.002,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What is the least common currency in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""14"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many facts are measured in Japanese yen (JPY)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 122, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0005,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many facts use square feet as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('square feet'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.003,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Swiss francs (CHF)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CHF'),Count: 218,"{""value"": 218, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0118,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many facts use percentage as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('pure'),Count: 50344,"{""value"": 50344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.013,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What is the most common non-monetary unit of measure?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""shares"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many facts are measured in British pounds (GBP)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 446, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many facts use 'shares' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.014,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Euros (EUR)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('EUR'),Count: 37847,"{""value"": 37847, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0118,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Canadian dollars (CAD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CAD'),Count: 2926,"{""value"": 2926, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0131,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What is the second most common currency in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""14"", ""type"": ""text""}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many different currencies are represented in the financial data?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies returned more than 50% of operating cash flow to shareholders?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 85, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies have free cash flow exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 45, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies issued new debt during the period?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What was Johnson & Johnson's acquisition spending?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 2.8, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies have negative operating cash flow?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 76, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What was Tesla's change in cash and cash equivalents?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 16352000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies spent more than $5 billion on acquisitions?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies have positive free cash flow?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 282, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies have EBITDA exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies reported foreign exchange gains/losses?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies have negative net income?,companies_negative_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetIncomeLoss'
  AND n.value < 0",Count: 201,"{""value"": 201.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.1287,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What was Johnson & Johnson's income tax expense?,latest_income_tax_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS income_tax_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'IncomeTaxExpenseBenefit'
      AND n.qtrs IN (0,4)
)
SELECT income_tax_expense, period_end
FROM latest_metric
WHERE rn = 1",income_tax_expense: 2621000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 2989000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.8,template,,,,0.1203,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies reported depreciation and amortization expenses?,companies_depreciation_amortization_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'DepreciationAndAmortization'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 321,"{""value"": 321.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.1324,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What was Tesla's other income (expense) in the latest period?,latest_other_income_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS other_income_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'OtherNonoperatingIncomeExpense'
      AND n.qtrs IN (0,4)
)
SELECT other_income_expense, period_end
FROM latest_metric
WHERE rn = 1",other_income_expense: 695000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": -43000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",1.0,0.8,template,,,,0.0967,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies have positive operating income?,companies_positive_operating_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'OperatingIncomeLoss'
  AND n.value > 0",Count: 907,"{""value"": 907.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.135,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies reported research and development expenses?,companies_research_expense_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ResearchAndDevelopmentExpense'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 344,"{""value"": 344.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.7,template,,,,0.1051,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies have working capital exceeding $50 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies report goodwill on their balance sheets?,companies_goodwill_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'Goodwill'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 3491,"{""value"": 3491.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.1422,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies have intangible assets exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies have negative stockholders' equity?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,"What is Tesla's property, plant and equipment value?",latest_property_plant_equipment,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS property_plant_equipment,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PropertyPlantAndEquipmentNet'
      AND n.qtrs IN (0,4)
)
SELECT property_plant_equipment, period_end
FROM latest_metric
WHERE rn = 1",property_plant_equipment: 35836000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 35836000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.65,template,,,,0.2041,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies have more liabilities than assets?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",1.0,0.0,,,,,0.001,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies have current assets exceeding $100 billion?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%MASTERCARD INC%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",MASTERCARD INC has 0 matching records.,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,llm_template_selection,,,,19.473,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies have Return on Equity above 20%?,companies_return_on_equity_above_threshold,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 20",Count: 175,"{""value"": 175, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,1.5094,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies have gross margin above 50%?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,55.3304,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies have a debt-to-equity ratio above 1.0?,companies_debt_to_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Liabilities','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND liabilities IS NOT NULL
  AND liabilities / equity > 1.0",Count: 236,"{""value"": 236.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.2276,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies have negative Return on Assets?,companies_negative_return_on_assets,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('NetIncomeLoss','Assets')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND assets <> 0 AND net_income IS NOT NULL AND net_income / assets < 0",Count: 3,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",3.0,0.85,template,,,,0.2291,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies have a current ratio above 2.0?,companies_current_ratio_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND current_liabilities <> 0
  AND current_assets / current_liabilities > 2.0",Count: 115,"{""value"": 115.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.7,template,,,,0.2085,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies have positive Return on Equity in the latest period?,companies_positive_return_on_equity,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 0",Count: 433,"{""value"": 434, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,2.0998,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many annual (qtrs=0) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 0,Count: 5484928,"{""value"": 5484928.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0341,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What is the second most frequent form type in submissions?,form_type_rank,"WITH form_counts AS (
    SELECT form, COUNT(*) AS filing_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM sub
    GROUP BY form
)
SELECT form, filing_count
FROM form_counts
WHERE rank = 2
LIMIT 1",form: 10-K | filing_count: 6274,"{""value"": ""10-K"", ""type"": ""text""}",5.0,0.65,template,,,,0.0041,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many submissions are for fiscal period Q4?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q4'),Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 1}",5.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many submissions are for fiscal period Q3?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q3'),Count: 5238,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5238}",5.0,0.75,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many submissions are for fiscal period Q2?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q2'),Count: 5296,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5296}",5.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many submissions have September fiscal year end (0930)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many submissions have June fiscal year end (0630)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many submissions have March fiscal year end (0331)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many submissions have December fiscal year end (1231)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many different form types are present in the submissions?,distinct_form_type_count,SELECT COUNT(DISTINCT form) AS form_type_count FROM sub,Count: 21,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 21}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal period FY (full year)?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('FY'),Count: 6476,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 6476}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal period Q1?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q1'),Count: 5664,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5664}",5.0,0.75,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal year 2025?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2025,Count: 917,"{""value"": 917.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.75,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal year 2024?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2024,Count: 4167,"{""value"": 4167.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What is the earliest filing date in the dataset?,earliest_filing_date,SELECT MIN(filed) AS earliest_filing_date FROM sub,earliest_filing_date: 2015-01-02 00:00:00,"{""value"": ""2015-01-02 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies filed 8-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('8-K'),Count: 112,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 112}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies filed 10-Q forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-Q'),Count: 543,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 543}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many financial facts are reported with coreg (co-registrant) information?,fact_count_with_coreg,SELECT COUNT(*) AS fact_count FROM num WHERE coreg IS NOT NULL AND TRIM(coreg) <> '',Count: 1261087,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 1261087.0}",5.0,0.7,template,,,,0.0155,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many XBRL tags are classified as 'string' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%string%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Debt' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%DEBT%'),Count: 26515,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 26515}",5.0,0.85,template,,,,0.0359,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Equity' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%EQUITY%'),Count: 24563,"{""value"": 24563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0442,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Cash' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%CASH%'),Count: 29232,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 29232}",5.0,0.85,template,,,,0.036,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What is the third most frequent XBRL tag in numerical data?,tag_nth_most_common,"WITH tag_counts AS (
    SELECT
        tag,
        COUNT(*) AS fact_count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    GROUP BY tag
)
SELECT tag, fact_count
FROM tag_counts
WHERE rank = 3
LIMIT 1",tag: Revenues | fact_count: 491457,"{""type"": ""text"", ""value"": ""Revenues""}",5.0,0.65,template,,,,0.0339,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many numerical facts have zero values?,fact_count_zero_values,SELECT COUNT(*) AS fact_count FROM num WHERE value = 0,Count: 1427015,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 1427015.0}",5.0,0.7,template,,,,0.0779,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many numerical facts have negative values?,fact_count_negative_values,SELECT COUNT(*) AS fact_count FROM num WHERE value < 0,Count: 2124201,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 2124201.0}",5.0,0.7,template,,,,0.0637,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many XBRL tags are classified as 'per-share' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%per-share%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0.0}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many XBRL tags have 'shares' as unit of measure in numerical data?,tag_count_by_unit,SELECT COUNT(DISTINCT tag) AS tag_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 949,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 949}",5.0,0.7,template,,,,0.0337,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many financial facts have duplicate values (dimhash populated)?,fact_count_dimhash_populated,SELECT COUNT(*) AS fact_count FROM num WHERE segments IS NOT NULL AND TRIM(segments) <> '',Count: 8738244,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 8738244}",5.0,0.7,template,,,,0.7403,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many different unit types (UOM) are present in the numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 49.0}",5.0,0.7,template,,,,0.0135,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Liability' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%LIABILITY%'),Count: 11059,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 11059}",5.0,0.7,template,,,,0.0342,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Asset' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%ASSET%'),Count: 40285,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 40285}",5.0,0.7,template,,,,0.0419,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Revenue' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%REVENUE%'),Count: 12221,"{""value"": 12221, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0397,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many XBRL tags are classified as 'monetary' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%monetary%'),Count: 454617,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 454617}",5.0,0.7,template,,,,0.0026,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many XBRL tags have a debit-credit flag of 'Debit'?,tag_count_by_debit_credit,SELECT COUNT(*) AS tag_count FROM tag WHERE crdr IS NOT NULL AND UPPER(TRIM(crdr)) = CASE WHEN UPPER(TRIM('Debit')) LIKE 'D%' THEN 'D' WHEN UPPER(TRIM('Debit')) LIKE 'C%' THEN 'C' ELSE UPPER(TRIM('Debit')) END,Count: 224017,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 224017}",5.0,0.7,template,,,,0.0047,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What is Google's (Alphabet) return on equity (ROE)?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%ALPHABET INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: ALPHABET INC. | roe_percentage: 32.91,"{""value"": 32.91, ""type"": ""numeric"", ""tolerance"": {""absolute"": 0.5}}",5.0,0.8,template,,,,0.2412,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Georgia?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('GA')",Count: 22,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 22}",5.0,0.7,template,,,,0.0081,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Bermuda?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",5.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Washington state?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('WA')",Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",5.0,0.7,template,,,,0.0067,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,Which state has the third most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 3
",state: NY | count: 69,"{""value"": ""NY"", ""type"": ""text""}",5.0,0.65,template,,,,0.0071,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Massachusetts?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('MA')",Count: 31,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 27}",3.0,0.7,template,,,,0.0062,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in the United Kingdom?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",5.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in North Carolina?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NC')",Count: 20,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",5.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Ohio?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('OH')",Count: 24,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",3.0,0.7,template,,,,0.0072,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many different US states are represented in headquarters data?,distinct_headquarters_states,SELECT COUNT(DISTINCT stprba) AS state_count FROM sub WHERE stprba IS NOT NULL,Count: 44,"{""value"": 44, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many different countries are represented in the incorporation data?,distinct_incorporation_countries,SELECT COUNT(DISTINCT countryinc) AS country_count FROM sub WHERE countryinc IS NOT NULL,Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 16}",5.0,0.7,template,,,,0.0036,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Switzerland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 5}",5.0,0.7,template,,,,0.0083,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Florida?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('FL')",Count: 26,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 26}",5.0,0.7,template,,,,0.0085,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Illinois?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('IL')",Count: 42,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 42}",5.0,0.7,template,,,,0.0071,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,Which state has the second most company headquarters after California?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 2
",state: TX | count: 81,"{""value"": ""TX"", ""type"": ""text""}",5.0,0.65,template,,,,0.0097,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Canada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 3}",3.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Ireland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 6}",5.0,0.7,template,,,,0.0073,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Nevada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('NV'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('NV'))
  )
",Count: 9,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 9}",5.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Texas?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('TX')",Count: 81,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 81}",5.0,0.7,template,,,,0.0062,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in New York?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NY')",Count: 69,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 69}",5.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,Which sector contains Johnson & Johnson?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%') LIMIT 1",JOHNSON & JOHNSON is in the Health Care sector.,"{""value"": ""Health Care"", ""type"": ""text""}",5.0,0.8,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many sectors have fewer than 25 companies?,sectors_below_threshold,"WITH sector_counts AS (
    SELECT gics_sector, COUNT(*) AS count
    FROM companies
    WHERE gics_sector IS NOT NULL
    GROUP BY gics_sector
)
SELECT COUNT(*) AS sector_count
FROM sector_counts
WHERE count < 25",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many sectors have more than 50 companies?,sectors_above_threshold,"SELECT COUNT(DISTINCT gics_sector) as sector_count FROM (SELECT gics_sector, COUNT(*) as cnt FROM companies GROUP BY gics_sector HAVING cnt > 50) subq",Count: 6,"{""value"": 6, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,Which sector has the fewest companies?,sector_with_fewest_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL AND gics_sector != 'Other' GROUP BY gics_sector ORDER BY count ASC LIMIT 1",AT&T INC is in the Real Estate sector.,"{""type"": ""text"", ""value"": ""Real Estate""}",5.0,0.8,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are in the Communication Services sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%communication services%'),There are 17 companies in the Communication Services sector.,"{""value"": 17, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are in the Real Estate sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%real estate%'),There are 3 companies in the Real Estate sector.,"{""value"": 3, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are in the Consumer Staples sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer staples%'),There are 28 companies in the Consumer Staples sector.,"{""value"": 26, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",3.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are in the Consumer Discretionary sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer discretionary%'),There are 99 companies in the Consumer Discretionary sector.,"{""value"": 99, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are in the Energy sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%energy%'),There are 51 companies in the Energy sector.,"{""value"": 51, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are in the Materials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%materials%'),There are 41 companies in the Materials sector.,"{""value"": 41, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,Which sector has the second most companies?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""AT&T INC is in the Financials sector."", ""type"": ""text""}",5.0,0.8,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are in the Industrials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%industrials%'),There are 82 companies in the Industrials sector.,"{""value"": 82, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What was Meta's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%META PLATFORMS, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 76793000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 76793000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.0586,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies reported cost of revenue in the latest period?,companies_reporting_cost_of_revenue,"WITH latest_cost AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'CostOfRevenue'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_cost
WHERE rn = 1 AND value IS NOT NULL",Count: 134,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 134}",5.0,0.85,template,,,,0.1264,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies have total revenue exceeding $50 billion in the latest period?,companies_revenue_above_threshold,"WITH latest_filing AS (
    SELECT
        s.cik,
        s.adsh,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
),
latest_revenue AS (
    SELECT lf.cik, n.value AS revenue
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE lf.rn = 1
      AND n.tag IN ('Revenues', 'SalesRevenueNet')
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS count
FROM latest_revenue lr
JOIN companies c ON c.cik = lr.cik
WHERE lr.revenue > 50",Count: 1213,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 1213.0}",5.0,0.85,template,,,,0.1665,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What was Walmart's most recent total liabilities?,latest_total_liabilities,"
WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%WALMART INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.filed,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K', '10-K/A')
), selected_filing AS (
    SELECT adsh, cik, period, filed
    FROM latest_filing
    WHERE rn = 1
), metric_values AS (
    SELECT
        MAX(CASE WHEN n.tag = 'LiabilitiesAndStockholdersEquity' THEN n.value END) AS total_assets_equity,
        COALESCE(
            MAX(CASE WHEN n.tag = 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest' THEN n.value END),
            MAX(CASE WHEN n.tag = 'StockholdersEquity' THEN n.value END)
        ) AS equity
    FROM num n
    JOIN selected_filing lf ON n.adsh = lf.adsh
    WHERE n.tag IN (
        'LiabilitiesAndStockholdersEquity',
        'StockholdersEquity',
        'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest'
    )
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT
    (total_assets_equity - equity) AS total_liabilities,
    period AS period_end
FROM metric_values, selected_filing
",total_liabilities: 163402000000.0 | period_end: 2025-01-31 00:00:00,"{""type"": ""text"", ""value"": 163402000000.0, ""tolerance"": {""absolute"": 5000000000.0}}",5.0,0.8,template,,,,0.1526,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies reported positive net income in the latest period?,companies_positive_net_income,"WITH latest_net_income AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_net_income
WHERE rn = 1 AND value > 0",Count: 440,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 447.0}",3.0,0.85,template,,,,0.1612,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What was Johnson & Johnson's most recent gross profit?,latest_gross_profit,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS gross_profit,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'GrossProfit'
      AND n.qtrs IN (0,4)
)
SELECT gross_profit, period_end
FROM latest_metric
WHERE rn = 1",gross_profit: 58606000000.0 | period_end: 2024-12-31 00:00:00,"{""type"": ""numeric"", ""value"": 55394000000.0, ""tolerance"": {""absolute"": 2000000000.0}}",3.0,0.8,template,,,,0.1019,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What was Tesla's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 74653000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 74653000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.0711,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies have 'LLC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%LLC%'),Count: 5,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 5}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000019617?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000019617' LIMIT 1,JPMORGAN CHASE & CO's CIK is unknown.,"{""value"": ""JPMORGAN CHASE & CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies have 'INC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%INC%'),Count: 459,"{""value"": 459, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000050863?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000050863' LIMIT 1,INTEL CORP's CIK is unknown.,"{""value"": ""INTEL CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What is Walmart Inc.'s CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%WALMART INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",WALMART INC.'s CIK is 0000104169.,"{""value"": ""0000104169"", ""type"": ""text""}",5.0,0.8,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies have 'CORP' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%CORP%'),Count: 180,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What is Procter & Gamble's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%PROCTER & GAMBLE CO%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",PROCTER & GAMBLE CO's CIK is 0000080424.,"{""value"": ""0000080424"", ""type"": ""text""}",5.0,0.8,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,Which company has the longest company name in the dataset?,company_with_longest_name,SELECT name FROM companies ORDER BY LENGTH(name) DESC LIMIT 1,"name: CHARLES RIVER LABORATORIES INTERNATIONAL, INC.","{""type"": ""text"", ""value"": ""CHARLES RIVER LABORATORIES INTERNATIONAL, INC.""}",5.0,0.65,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What is Berkshire Hathaway's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%BERKSHIRE HATHAWAY INC%') LIMIT 1",BERKSHIRE HATHAWAY INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many quarterly (qtrs=1) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 1,Count: 3566310,"{""value"": 3566310, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0249,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are in the Utilities sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%utilities%'),There are 20 companies in the Utilities sector.,"{""value"": 20, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What is Tesla's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1","TESLA, INC.'s CIK is 0001318605.","{""value"": ""0001318605"", ""type"": ""text""}",5.0,0.8,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many financial facts are denominated in USD?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0302,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,Which form type appears most frequently in submissions?,most_common_form_type,"SELECT form, COUNT(*) AS filing_count FROM sub GROUP BY form ORDER BY filing_count DESC LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many unique companies are represented in the dataset?,total_company_count,SELECT COUNT(DISTINCT cik) AS company_count FROM companies,Count: 589,"{""value"": 589, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What is the earliest period date in the financial data?,earliest_period_date,SELECT MIN(period) AS earliest_period FROM sub,earliest_period: 2014-05-31 00:00:00,"{""value"": ""2014-05-31 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies have international (non-US) incorporation?,international_incorporation_count,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS company_count
FROM latest_submission
WHERE rn = 1 AND UPPER(countryinc) <> 'US'",Count: 34,"{""value"": 34, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0086,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What is Amazon's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%AMAZON COM INC%') LIMIT 1",AMAZON COM INC is in the Consumer Discretionary sector.,"{""value"": ""Consumer Discretionary"", ""type"": ""text""}",5.0,0.8,template,,,,0.0212,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many different fiscal year ends are represented?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,Which state has the most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 1
",state: CA | count: 123,"{""value"": ""CA"", ""type"": ""text""}",5.0,0.65,template,,,,0.0071,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies filed 10-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-K'),Count: 563,"{""value"": 563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0022,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What is the most recent filing date in the dataset?,latest_filing_date,SELECT MAX(filed) AS latest_filing_date FROM sub,latest_filing_date: 2025-06-30 00:00:00,"{""value"": ""2025-06-30 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0022,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are in the Health Care sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%health care%'),There are 80 companies in the Health Care sector.,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000066740?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000066740' LIMIT 1,3M CO's CIK is unknown.,"{""value"": ""3M CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many financial facts have footnotes?,fact_count_with_footnotes,SELECT COUNT(*) AS fact_count FROM num WHERE footnote IS NOT NULL AND TRIM(CAST(footnote AS VARCHAR)) <> '',Count: 33959,"{""value"": 33959, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0147,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,What currency is used most frequently in the numerical data?,most_common_currency,"SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL GROUP BY 1 ORDER BY fact_count DESC LIMIT 1",currency: USD | fact_count: 14760135,"{""value"": ""USD"", ""type"": ""text""}",5.0,0.65,template,,,,31.5766,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Delaware?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('DE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('DE'))
  )
",Count: 346,"{""value"": 349, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",3.0,0.9,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1490, 'completion_tokens': 417}, 'latency_ms': 4172, 'success': True}]",4.1897,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,Which sector has the most companies in our S&P 500 dataset?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",Financials has 168 matching records.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.9,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 352}, 'latency_ms': 3886, 'success': True}]",22.6147,0.0,0.0,0.0,0.0
RUN_011,"06 Nov 2025, 1700 hours",simple,How many S&P 500 companies are in the Information Technology sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%information technology%'),There are 165 companies in the Information Technology sector.,"{""value"": 165, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 294}, 'latency_ms': 4812, 'success': True}]",4.8215,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What is Johnson & Johnson's return on equity (ROE) percentage?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: JOHNSON & JOHNSON | roe_percentage: 20.06,"{""value"": 20.06, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1.0}}",5.0,0.8,template,,,,0.2749,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Hong Kong dollars (HKD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('HKD'),Count: 140,"{""value"": 140, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0112,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,"How many facts use per-share units (per share, per unit)?",fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""absolute"": 100}}",5.0,0.7,template,,,,0.0154,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What is the total count of unique unit types in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 21, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0005,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Mexican pesos (MXN)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('MXN'),Count: 37,"{""value"": 37, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0103,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many facts use barrels as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('barrels'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0038,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Australian dollars (AUD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('AUD'),Count: 110,"{""value"": 110, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0143,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many facts use 'days' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('days'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0021,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What is the least common currency in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""14"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many facts are measured in Japanese yen (JPY)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 122, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many facts use square feet as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('square feet'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0022,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Swiss francs (CHF)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CHF'),Count: 218,"{""value"": 218, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0144,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many facts use percentage as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('pure'),Count: 50344,"{""value"": 50344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0183,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What is the most common non-monetary unit of measure?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""shares"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many facts are measured in British pounds (GBP)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 446, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many facts use 'shares' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0322,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Euros (EUR)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('EUR'),Count: 37847,"{""value"": 37847, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0206,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many facts are denominated in Canadian dollars (CAD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CAD'),Count: 2926,"{""value"": 2926, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0174,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What is the second most common currency in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""14"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many different currencies are represented in the financial data?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies returned more than 50% of operating cash flow to shareholders?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 85, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies have free cash flow exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 45, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies issued new debt during the period?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What was Johnson & Johnson's acquisition spending?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 2.8, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.0,,,,,0.0005,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies have negative operating cash flow?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 76, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What was Tesla's change in cash and cash equivalents?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 16352000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.0,,,,,0.0014,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies spent more than $5 billion on acquisitions?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0011,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies have positive free cash flow?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 282, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies have EBITDA exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies reported foreign exchange gains/losses?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies have negative net income?,companies_negative_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetIncomeLoss'
  AND n.value < 0",Count: 201,"{""value"": 201.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.1188,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What was Johnson & Johnson's income tax expense?,latest_income_tax_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS income_tax_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'IncomeTaxExpenseBenefit'
      AND n.qtrs IN (0,4)
)
SELECT income_tax_expense, period_end
FROM latest_metric
WHERE rn = 1",income_tax_expense: 2989000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 2621000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.8,template,,,,0.0835,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies reported depreciation and amortization expenses?,companies_depreciation_amortization_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'DepreciationAndAmortization'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 321,"{""value"": 321.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.1224,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What was Tesla's other income (expense) in the latest period?,latest_other_income_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS other_income_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'OtherNonoperatingIncomeExpense'
      AND n.qtrs IN (0,4)
)
SELECT other_income_expense, period_end
FROM latest_metric
WHERE rn = 1",other_income_expense: -43000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": -43000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",5.0,0.8,template,,,,0.1119,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies have positive operating income?,companies_positive_operating_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'OperatingIncomeLoss'
  AND n.value > 0",Count: 907,"{""value"": 907.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.1206,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies reported research and development expenses?,companies_research_expense_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ResearchAndDevelopmentExpense'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 344,"{""value"": 344.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.7,template,,,,0.1207,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies have working capital exceeding $50 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies report goodwill on their balance sheets?,companies_goodwill_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'Goodwill'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 3491,"{""value"": 3491.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.1181,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies have intangible assets exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies have negative stockholders' equity?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,"What is Tesla's property, plant and equipment value?",latest_property_plant_equipment,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS property_plant_equipment,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PropertyPlantAndEquipmentNet'
      AND n.qtrs IN (0,4)
)
SELECT property_plant_equipment, period_end
FROM latest_metric
WHERE rn = 1",property_plant_equipment: 35836000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 35836000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.65,template,,,,0.1314,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies have more liabilities than assets?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",1.0,0.0,,,,,0.0038,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies have current assets exceeding $100 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0104,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies have Return on Equity above 20%?,companies_return_on_equity_above_threshold,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 20",Count: 175,"{""value"": 175, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,1.6766,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies have gross margin above 50%?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%MASTERCARD INC%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",MASTERCARD INC has 0 matching records.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",3.0,0.7,llm_template_selection,,,,23.5737,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies have a debt-to-equity ratio above 1.0?,companies_debt_to_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Liabilities','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND liabilities IS NOT NULL
  AND liabilities / equity > 1.0",Count: 236,"{""value"": 236.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.2116,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies have negative Return on Assets?,companies_negative_return_on_assets,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('NetIncomeLoss','Assets')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND assets <> 0 AND net_income IS NOT NULL AND net_income / assets < 0",Count: 3,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",3.0,0.85,template,,,,0.2533,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies have a current ratio above 2.0?,companies_current_ratio_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND current_liabilities <> 0
  AND current_assets / current_liabilities > 2.0",Count: 115,"{""value"": 115.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.7,template,,,,0.2168,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies have positive Return on Equity in the latest period?,companies_positive_return_on_equity,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 0",Count: 434,"{""value"": 434, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,1.2174,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many annual (qtrs=0) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 0,Count: 5484928,"{""value"": 5484928.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0426,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What is the second most frequent form type in submissions?,form_type_rank,"WITH form_counts AS (
    SELECT form, COUNT(*) AS filing_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM sub
    GROUP BY form
)
SELECT form, filing_count
FROM form_counts
WHERE rank = 2
LIMIT 1",form: 10-K | filing_count: 6274,"{""value"": ""10-K"", ""type"": ""text""}",5.0,0.65,template,,,,0.0024,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many submissions are for fiscal period Q4?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q4'),Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 1}",5.0,0.75,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many submissions are for fiscal period Q3?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q3'),Count: 5238,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5238}",5.0,0.75,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many submissions are for fiscal period Q2?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q2'),Count: 5296,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5296}",5.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many submissions have September fiscal year end (0930)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many submissions have June fiscal year end (0630)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many submissions have March fiscal year end (0331)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many submissions have December fiscal year end (1231)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many different form types are present in the submissions?,distinct_form_type_count,SELECT COUNT(DISTINCT form) AS form_type_count FROM sub,Count: 21,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 21}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal period FY (full year)?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('FY'),Count: 6476,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 6476}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal period Q1?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q1'),Count: 5664,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5664}",5.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal year 2025?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2025,Count: 917,"{""value"": 917.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many submissions have fiscal year 2024?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2024,Count: 4167,"{""value"": 4167.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.75,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What is the earliest filing date in the dataset?,earliest_filing_date,SELECT MIN(filed) AS earliest_filing_date FROM sub,earliest_filing_date: 2015-01-02 00:00:00,"{""value"": ""2015-01-02 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies filed 8-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('8-K'),Count: 112,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 112}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies filed 10-Q forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-Q'),Count: 543,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 543}",5.0,0.7,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many financial facts are reported with coreg (co-registrant) information?,fact_count_with_coreg,SELECT COUNT(*) AS fact_count FROM num WHERE coreg IS NOT NULL AND TRIM(coreg) <> '',Count: 1261087,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 1261087.0}",5.0,0.7,template,,,,0.0187,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many XBRL tags are classified as 'string' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%string%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Debt' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%DEBT%'),Count: 26515,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 26515}",5.0,0.85,template,,,,0.0371,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Equity' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%EQUITY%'),Count: 24563,"{""value"": 24563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0532,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Cash' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%CASH%'),Count: 29232,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 29232}",5.0,0.85,template,,,,0.0382,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What is the third most frequent XBRL tag in numerical data?,tag_nth_most_common,"WITH tag_counts AS (
    SELECT
        tag,
        COUNT(*) AS fact_count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    GROUP BY tag
)
SELECT tag, fact_count
FROM tag_counts
WHERE rank = 3
LIMIT 1",tag: Revenues | fact_count: 491457,"{""type"": ""text"", ""value"": ""Revenues""}",5.0,0.65,template,,,,0.0336,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many numerical facts have zero values?,fact_count_zero_values,SELECT COUNT(*) AS fact_count FROM num WHERE value = 0,Count: 1427015,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 1427015.0}",5.0,0.7,template,,,,0.0594,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many numerical facts have negative values?,fact_count_negative_values,SELECT COUNT(*) AS fact_count FROM num WHERE value < 0,Count: 2124201,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 2124201.0}",5.0,0.7,template,,,,0.067,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many XBRL tags are classified as 'per-share' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%per-share%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0.0}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many XBRL tags have 'shares' as unit of measure in numerical data?,tag_count_by_unit,SELECT COUNT(DISTINCT tag) AS tag_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 949,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 949}",5.0,0.7,template,,,,0.0351,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many financial facts have duplicate values (dimhash populated)?,fact_count_dimhash_populated,SELECT COUNT(*) AS fact_count FROM num WHERE segments IS NOT NULL AND TRIM(segments) <> '',Count: 8738244,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 8738244}",5.0,0.7,template,,,,0.6757,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many different unit types (UOM) are present in the numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 49.0}",5.0,0.7,template,,,,0.0152,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Liability' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%LIABILITY%'),Count: 11059,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 11059}",5.0,0.7,template,,,,0.0379,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Asset' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%ASSET%'),Count: 40285,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 40285}",5.0,0.7,template,,,,0.0395,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many XBRL tags contain the word 'Revenue' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%REVENUE%'),Count: 12221,"{""value"": 12221, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0384,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many XBRL tags are classified as 'monetary' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%monetary%'),Count: 454617,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 454617}",5.0,0.7,template,,,,0.0027,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many XBRL tags have a debit-credit flag of 'Debit'?,tag_count_by_debit_credit,SELECT COUNT(*) AS tag_count FROM tag WHERE crdr IS NOT NULL AND UPPER(TRIM(crdr)) = CASE WHEN UPPER(TRIM('Debit')) LIKE 'D%' THEN 'D' WHEN UPPER(TRIM('Debit')) LIKE 'C%' THEN 'C' ELSE UPPER(TRIM('Debit')) END,Count: 224017,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 224017}",5.0,0.7,template,,,,0.0055,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What is Google's (Alphabet) return on equity (ROE)?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%ALPHABET INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: ALPHABET INC. | roe_percentage: 32.91,"{""value"": 32.91, ""type"": ""numeric"", ""tolerance"": {""absolute"": 0.5}}",5.0,0.8,template,,,,0.2366,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Georgia?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('GA')",Count: 22,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 22}",5.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Bermuda?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",5.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Washington state?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('WA')",Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",5.0,0.7,template,,,,0.0081,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,Which state has the third most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 3
",state: NY | count: 69,"{""value"": ""NY"", ""type"": ""text""}",5.0,0.65,template,,,,0.0085,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Massachusetts?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('MA')",Count: 31,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 27}",3.0,0.7,template,,,,0.0079,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in the United Kingdom?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",5.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in North Carolina?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NC')",Count: 20,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",5.0,0.7,template,,,,0.0067,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Ohio?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('OH')",Count: 24,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",3.0,0.7,template,,,,0.0061,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many different US states are represented in headquarters data?,distinct_headquarters_states,SELECT COUNT(DISTINCT stprba) AS state_count FROM sub WHERE stprba IS NOT NULL,Count: 44,"{""value"": 44, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many different countries are represented in the incorporation data?,distinct_incorporation_countries,SELECT COUNT(DISTINCT countryinc) AS country_count FROM sub WHERE countryinc IS NOT NULL,Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 16}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Switzerland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 5}",5.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Florida?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('FL')",Count: 26,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 26}",5.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Illinois?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('IL')",Count: 42,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 42}",5.0,0.7,template,,,,0.0075,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,Which state has the second most company headquarters after California?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 2
",state: TX | count: 81,"{""value"": ""TX"", ""type"": ""text""}",5.0,0.65,template,,,,0.0074,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Canada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 3}",3.0,0.7,template,,,,0.0072,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Ireland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 6}",5.0,0.7,template,,,,0.0072,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Nevada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('NV'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('NV'))
  )
",Count: 9,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 9}",5.0,0.7,template,,,,0.0066,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in Texas?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('TX')",Count: 81,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 81}",5.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are headquartered in New York?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NY')",Count: 69,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 69}",5.0,0.7,template,,,,0.0062,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,Which sector contains Johnson & Johnson?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%') LIMIT 1",JOHNSON & JOHNSON is in the Health Care sector.,"{""value"": ""Health Care"", ""type"": ""text""}",5.0,0.8,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many sectors have fewer than 25 companies?,sectors_below_threshold,"WITH sector_counts AS (
    SELECT gics_sector, COUNT(*) AS count
    FROM companies
    WHERE gics_sector IS NOT NULL
    GROUP BY gics_sector
)
SELECT COUNT(*) AS sector_count
FROM sector_counts
WHERE count < 25",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many sectors have more than 50 companies?,sectors_above_threshold,"SELECT COUNT(DISTINCT gics_sector) as sector_count FROM (SELECT gics_sector, COUNT(*) as cnt FROM companies GROUP BY gics_sector HAVING cnt > 50) subq",Count: 6,"{""value"": 6, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0032,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,Which sector has the fewest companies?,sector_with_fewest_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL AND gics_sector != 'Other' GROUP BY gics_sector ORDER BY count ASC LIMIT 1",AT&T INC is in the Real Estate sector.,"{""type"": ""text"", ""value"": ""Real Estate""}",5.0,0.8,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are in the Communication Services sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%communication services%'),There are 17 companies in the Communication Services sector.,"{""value"": 17, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are in the Real Estate sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%real estate%'),There are 3 companies in the Real Estate sector.,"{""value"": 3, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are in the Consumer Staples sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer staples%'),There are 28 companies in the Consumer Staples sector.,"{""value"": 26, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",3.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are in the Consumer Discretionary sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer discretionary%'),There are 99 companies in the Consumer Discretionary sector.,"{""value"": 99, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are in the Energy sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%energy%'),There are 51 companies in the Energy sector.,"{""value"": 51, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are in the Materials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%materials%'),There are 41 companies in the Materials sector.,"{""value"": 41, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,Which sector has the second most companies?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""AT&T INC is in the Financials sector."", ""type"": ""text""}",5.0,0.8,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are in the Industrials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%industrials%'),There are 82 companies in the Industrials sector.,"{""value"": 82, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What was Meta's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%META PLATFORMS, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 76793000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 76793000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.0557,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies reported cost of revenue in the latest period?,companies_reporting_cost_of_revenue,"WITH latest_cost AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'CostOfRevenue'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_cost
WHERE rn = 1 AND value IS NOT NULL",Count: 134,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 134}",5.0,0.85,template,,,,0.1266,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies have total revenue exceeding $50 billion in the latest period?,companies_revenue_above_threshold,"WITH latest_filing AS (
    SELECT
        s.cik,
        s.adsh,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
),
latest_revenue AS (
    SELECT lf.cik, n.value AS revenue
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE lf.rn = 1
      AND n.tag IN ('Revenues', 'SalesRevenueNet')
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS count
FROM latest_revenue lr
JOIN companies c ON c.cik = lr.cik
WHERE lr.revenue > 50",Count: 1213,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 1213.0}",5.0,0.85,template,,,,0.1778,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What was Walmart's most recent total liabilities?,latest_total_liabilities,"
WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%WALMART INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.filed,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K', '10-K/A')
), selected_filing AS (
    SELECT adsh, cik, period, filed
    FROM latest_filing
    WHERE rn = 1
), metric_values AS (
    SELECT
        MAX(CASE WHEN n.tag = 'LiabilitiesAndStockholdersEquity' THEN n.value END) AS total_assets_equity,
        COALESCE(
            MAX(CASE WHEN n.tag = 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest' THEN n.value END),
            MAX(CASE WHEN n.tag = 'StockholdersEquity' THEN n.value END)
        ) AS equity
    FROM num n
    JOIN selected_filing lf ON n.adsh = lf.adsh
    WHERE n.tag IN (
        'LiabilitiesAndStockholdersEquity',
        'StockholdersEquity',
        'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest'
    )
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT
    (total_assets_equity - equity) AS total_liabilities,
    period AS period_end
FROM metric_values, selected_filing
",total_liabilities: 163402000000.0 | period_end: 2025-01-31 00:00:00,"{""type"": ""text"", ""value"": 163402000000.0, ""tolerance"": {""absolute"": 5000000000.0}}",5.0,0.8,template,,,,0.1771,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies reported positive net income in the latest period?,companies_positive_net_income,"WITH latest_net_income AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_net_income
WHERE rn = 1 AND value > 0",Count: 457,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 447.0}",3.0,0.85,template,,,,0.1409,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What was Johnson & Johnson's most recent gross profit?,latest_gross_profit,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS gross_profit,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'GrossProfit'
      AND n.qtrs IN (0,4)
)
SELECT gross_profit, period_end
FROM latest_metric
WHERE rn = 1",gross_profit: 55394000000.0 | period_end: 2024-12-31 00:00:00,"{""type"": ""numeric"", ""value"": 55394000000.0, ""tolerance"": {""absolute"": 2000000000.0}}",5.0,0.8,template,,,,0.1149,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What was Tesla's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 74653000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 74653000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.0783,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies have 'LLC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%LLC%'),Count: 5,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 5}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000019617?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000019617' LIMIT 1,JPMORGAN CHASE & CO's CIK is unknown.,"{""value"": ""JPMORGAN CHASE & CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies have 'INC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%INC%'),Count: 459,"{""value"": 459, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000050863?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000050863' LIMIT 1,INTEL CORP's CIK is unknown.,"{""value"": ""INTEL CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0006,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What is Walmart Inc.'s CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%WALMART INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",WALMART INC.'s CIK is 0000104169.,"{""value"": ""0000104169"", ""type"": ""text""}",5.0,0.8,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies have 'CORP' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%CORP%'),Count: 180,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What is Procter & Gamble's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%PROCTER & GAMBLE CO%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",PROCTER & GAMBLE CO's CIK is 0000080424.,"{""value"": ""0000080424"", ""type"": ""text""}",5.0,0.8,template,,,,0.002,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,Which company has the longest company name in the dataset?,company_with_longest_name,SELECT name FROM companies ORDER BY LENGTH(name) DESC LIMIT 1,"name: CHARLES RIVER LABORATORIES INTERNATIONAL, INC.","{""type"": ""text"", ""value"": ""CHARLES RIVER LABORATORIES INTERNATIONAL, INC.""}",5.0,0.65,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What is Berkshire Hathaway's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%BERKSHIRE HATHAWAY INC%') LIMIT 1",BERKSHIRE HATHAWAY INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many quarterly (qtrs=1) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 1,Count: 3566310,"{""value"": 3566310, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.028,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are in the Utilities sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%utilities%'),There are 20 companies in the Utilities sector.,"{""value"": 20, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What is Tesla's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1","TESLA, INC.'s CIK is 0001318605.","{""value"": ""0001318605"", ""type"": ""text""}",5.0,0.8,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many financial facts are denominated in USD?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0181,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,Which form type appears most frequently in submissions?,most_common_form_type,"SELECT form, COUNT(*) AS filing_count FROM sub GROUP BY form ORDER BY filing_count DESC LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.0022,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many unique companies are represented in the dataset?,total_company_count,SELECT COUNT(DISTINCT cik) AS company_count FROM companies,Count: 589,"{""value"": 589, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What is the earliest period date in the financial data?,earliest_period_date,SELECT MIN(period) AS earliest_period FROM sub,earliest_period: 2014-05-31 00:00:00,"{""value"": ""2014-05-31 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies have international (non-US) incorporation?,international_incorporation_count,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS company_count
FROM latest_submission
WHERE rn = 1 AND UPPER(countryinc) <> 'US'",Count: 34,"{""value"": 34, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0056,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What is Amazon's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%AMAZON COM INC%') LIMIT 1",AMAZON COM INC is in the Consumer Discretionary sector.,"{""value"": ""Consumer Discretionary"", ""type"": ""text""}",5.0,0.8,template,,,,0.0136,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many different fiscal year ends are represented?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.7,template,,,,0.0031,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,Which state has the most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 1
",state: CA | count: 123,"{""value"": ""CA"", ""type"": ""text""}",5.0,0.65,template,,,,0.0087,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies filed 10-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-K'),Count: 563,"{""value"": 563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What is the most recent filing date in the dataset?,latest_filing_date,SELECT MAX(filed) AS latest_filing_date FROM sub,latest_filing_date: 2025-06-30 00:00:00,"{""value"": ""2025-06-30 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0022,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are in the Health Care sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%health care%'),There are 80 companies in the Health Care sector.,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,Which company has CIK 0000066740?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000066740' LIMIT 1,3M CO's CIK is unknown.,"{""value"": ""3M CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many financial facts have footnotes?,fact_count_with_footnotes,SELECT COUNT(*) AS fact_count FROM num WHERE footnote IS NOT NULL AND TRIM(CAST(footnote AS VARCHAR)) <> '',Count: 33959,"{""value"": 33959, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.013,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,What currency is used most frequently in the numerical data?,most_common_currency,"SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL GROUP BY 1 ORDER BY fact_count DESC LIMIT 1",currency: USD | fact_count: 14760135,"{""value"": ""USD"", ""type"": ""text""}",5.0,0.65,template,,,,23.1517,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many companies are incorporated in Delaware?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('DE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('DE'))
  )
",Count: 346,"{""value"": 349, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",3.0,0.9,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1490, 'completion_tokens': 416}, 'latency_ms': 6374, 'success': True}]",6.4164,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,Which sector has the most companies in our S&P 500 dataset?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",Financials has 168 matching records.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.95,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 359}, 'latency_ms': 4061, 'success': True}]",17.2677,0.0,0.0,0.0,0.0
RUN_010,"06 Nov 2025, 1700 hours",simple,How many S&P 500 companies are in the Information Technology sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%information technology%'),There are 165 companies in the Information Technology sector.,"{""value"": 165, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 424}, 'latency_ms': 6634, 'success': True}]",6.6428,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What is Johnson & Johnson's return on equity (ROE) percentage?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: JOHNSON & JOHNSON | roe_percentage: 20.06,"{""value"": 20.06, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1.0}}",5.0,0.8,template,,,,0.3653,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Hong Kong dollars (HKD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('HKD'),Count: 140,"{""value"": 140, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0123,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,"How many facts use per-share units (per share, per unit)?",fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""absolute"": 100}}",5.0,0.7,template,,,,0.0224,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What is the total count of unique unit types in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 21, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Mexican pesos (MXN)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('MXN'),Count: 37,"{""value"": 37, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0104,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many facts use barrels as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('barrels'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Australian dollars (AUD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('AUD'),Count: 110,"{""value"": 110, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0177,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many facts use 'days' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('days'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0026,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What is the least common currency in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""14"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many facts are measured in Japanese yen (JPY)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 122, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many facts use square feet as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('square feet'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Swiss francs (CHF)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CHF'),Count: 218,"{""value"": 218, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0176,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many facts use percentage as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('pure'),Count: 50344,"{""value"": 50344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0189,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What is the most common non-monetary unit of measure?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""shares"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many facts are measured in British pounds (GBP)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 446, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.0,,,,,0.0006,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many facts use 'shares' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0203,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Euros (EUR)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('EUR'),Count: 37847,"{""value"": 37847, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0133,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Canadian dollars (CAD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CAD'),Count: 2926,"{""value"": 2926, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0259,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What is the second most common currency in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""14"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many different currencies are represented in the financial data?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies returned more than 50% of operating cash flow to shareholders?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 85, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies have free cash flow exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 45, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies issued new debt during the period?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What was Johnson & Johnson's acquisition spending?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 2.8, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies have negative operating cash flow?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 76, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What was Tesla's change in cash and cash equivalents?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 16352000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies spent more than $5 billion on acquisitions?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies have positive free cash flow?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 282, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies have EBITDA exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies reported foreign exchange gains/losses?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies have negative net income?,companies_negative_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetIncomeLoss'
  AND n.value < 0",Count: 201,"{""value"": 201.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.181,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What was Johnson & Johnson's income tax expense?,latest_income_tax_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS income_tax_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'IncomeTaxExpenseBenefit'
      AND n.qtrs IN (0,4)
)
SELECT income_tax_expense, period_end
FROM latest_metric
WHERE rn = 1",income_tax_expense: 2621000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 2621000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.1295,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies reported depreciation and amortization expenses?,companies_depreciation_amortization_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'DepreciationAndAmortization'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 321,"{""value"": 321.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.1439,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What was Tesla's other income (expense) in the latest period?,latest_other_income_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS other_income_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'OtherNonoperatingIncomeExpense'
      AND n.qtrs IN (0,4)
)
SELECT other_income_expense, period_end
FROM latest_metric
WHERE rn = 1",other_income_expense: 695000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": -43000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.8,template,,,,0.1306,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies have positive operating income?,companies_positive_operating_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'OperatingIncomeLoss'
  AND n.value > 0",Count: 907,"{""value"": 907.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.168,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies reported research and development expenses?,companies_research_expense_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ResearchAndDevelopmentExpense'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 344,"{""value"": 344.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.7,template,,,,0.1392,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies have working capital exceeding $50 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies report goodwill on their balance sheets?,companies_goodwill_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'Goodwill'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 3491,"{""value"": 3491.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.1572,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies have intangible assets exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies have negative stockholders' equity?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,"What is Tesla's property, plant and equipment value?",latest_property_plant_equipment,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS property_plant_equipment,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PropertyPlantAndEquipmentNet'
      AND n.qtrs IN (0,4)
)
SELECT property_plant_equipment, period_end
FROM latest_metric
WHERE rn = 1",property_plant_equipment: 35836000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 35836000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.65,template,,,,0.1677,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies have more liabilities than assets?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",1.0,0.0,,,,,0.0008,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies have current assets exceeding $100 billion?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%MASTERCARD INC%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",MASTERCARD INC has 0 matching records.,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,llm_template_selection,,,,17.0905,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies have Return on Equity above 20%?,companies_return_on_equity_above_threshold,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 20",Count: 175,"{""value"": 175, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,1.5532,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies have gross margin above 50%?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,64.3804,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies have a debt-to-equity ratio above 1.0?,companies_debt_to_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Liabilities','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND liabilities IS NOT NULL
  AND liabilities / equity > 1.0",Count: 236,"{""value"": 236.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.1956,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies have negative Return on Assets?,companies_negative_return_on_assets,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('NetIncomeLoss','Assets')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND assets <> 0 AND net_income IS NOT NULL AND net_income / assets < 0",Count: 3,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",3.0,0.85,template,,,,0.176,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies have a current ratio above 2.0?,companies_current_ratio_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND current_liabilities <> 0
  AND current_assets / current_liabilities > 2.0",Count: 115,"{""value"": 115.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.7,template,,,,0.1718,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies have positive Return on Equity in the latest period?,companies_positive_return_on_equity,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 0",Count: 433,"{""value"": 434, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,1.3818,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many annual (qtrs=0) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 0,Count: 5484928,"{""value"": 5484928.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0444,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What is the second most frequent form type in submissions?,form_type_rank,"WITH form_counts AS (
    SELECT form, COUNT(*) AS filing_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM sub
    GROUP BY form
)
SELECT form, filing_count
FROM form_counts
WHERE rank = 2
LIMIT 1",form: 10-K | filing_count: 6274,"{""value"": ""10-K"", ""type"": ""text""}",5.0,0.65,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many submissions are for fiscal period Q4?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q4'),Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 1}",5.0,0.75,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many submissions are for fiscal period Q3?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q3'),Count: 5238,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5238}",5.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many submissions are for fiscal period Q2?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q2'),Count: 5296,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5296}",5.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many submissions have September fiscal year end (0930)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many submissions have June fiscal year end (0630)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many submissions have March fiscal year end (0331)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many submissions have December fiscal year end (1231)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many different form types are present in the submissions?,distinct_form_type_count,SELECT COUNT(DISTINCT form) AS form_type_count FROM sub,Count: 21,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 21}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many submissions have fiscal period FY (full year)?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('FY'),Count: 6476,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 6476}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many submissions have fiscal period Q1?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q1'),Count: 5664,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5664}",5.0,0.75,template,,,,0.002,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many submissions have fiscal year 2025?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2025,Count: 917,"{""value"": 917.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many submissions have fiscal year 2024?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2024,Count: 4167,"{""value"": 4167.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.75,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What is the earliest filing date in the dataset?,earliest_filing_date,SELECT MIN(filed) AS earliest_filing_date FROM sub,earliest_filing_date: 2015-01-02 00:00:00,"{""value"": ""2015-01-02 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies filed 8-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('8-K'),Count: 112,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 112}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies filed 10-Q forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-Q'),Count: 543,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 543}",5.0,0.7,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many financial facts are reported with coreg (co-registrant) information?,fact_count_with_coreg,SELECT COUNT(*) AS fact_count FROM num WHERE coreg IS NOT NULL AND TRIM(coreg) <> '',Count: 1261087,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 1261087.0}",5.0,0.7,template,,,,0.0143,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many XBRL tags are classified as 'string' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%string%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Debt' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%DEBT%'),Count: 26515,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 26515}",5.0,0.85,template,,,,0.0366,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Equity' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%EQUITY%'),Count: 24563,"{""value"": 24563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0457,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Cash' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%CASH%'),Count: 29232,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 29232}",5.0,0.85,template,,,,0.0468,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What is the third most frequent XBRL tag in numerical data?,tag_nth_most_common,"WITH tag_counts AS (
    SELECT
        tag,
        COUNT(*) AS fact_count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    GROUP BY tag
)
SELECT tag, fact_count
FROM tag_counts
WHERE rank = 3
LIMIT 1",tag: Revenues | fact_count: 491457,"{""type"": ""text"", ""value"": ""Revenues""}",5.0,0.65,template,,,,0.0338,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many numerical facts have zero values?,fact_count_zero_values,SELECT COUNT(*) AS fact_count FROM num WHERE value = 0,Count: 1427015,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 1427015.0}",5.0,0.7,template,,,,0.0814,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many numerical facts have negative values?,fact_count_negative_values,SELECT COUNT(*) AS fact_count FROM num WHERE value < 0,Count: 2124201,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 2124201.0}",5.0,0.7,template,,,,0.0751,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many XBRL tags are classified as 'per-share' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%per-share%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0.0}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many XBRL tags have 'shares' as unit of measure in numerical data?,tag_count_by_unit,SELECT COUNT(DISTINCT tag) AS tag_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 949,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 949}",5.0,0.7,template,,,,0.0334,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many financial facts have duplicate values (dimhash populated)?,fact_count_dimhash_populated,SELECT COUNT(*) AS fact_count FROM num WHERE segments IS NOT NULL AND TRIM(segments) <> '',Count: 8738244,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 8738244}",5.0,0.7,template,,,,0.9806,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many different unit types (UOM) are present in the numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 49.0}",5.0,0.7,template,,,,0.0174,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Liability' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%LIABILITY%'),Count: 11059,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 11059}",5.0,0.7,template,,,,0.034,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Asset' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%ASSET%'),Count: 40285,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 40285}",5.0,0.7,template,,,,0.0534,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Revenue' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%REVENUE%'),Count: 12221,"{""value"": 12221, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0487,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many XBRL tags are classified as 'monetary' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%monetary%'),Count: 454617,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 454617}",5.0,0.7,template,,,,0.0026,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many XBRL tags have a debit-credit flag of 'Debit'?,tag_count_by_debit_credit,SELECT COUNT(*) AS tag_count FROM tag WHERE crdr IS NOT NULL AND UPPER(TRIM(crdr)) = CASE WHEN UPPER(TRIM('Debit')) LIKE 'D%' THEN 'D' WHEN UPPER(TRIM('Debit')) LIKE 'C%' THEN 'C' ELSE UPPER(TRIM('Debit')) END,Count: 224017,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 224017}",5.0,0.7,template,,,,0.005,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What is Google's (Alphabet) return on equity (ROE)?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%ALPHABET INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: ALPHABET INC. | roe_percentage: 32.91,"{""value"": 32.91, ""type"": ""numeric"", ""tolerance"": {""absolute"": 0.5}}",5.0,0.8,template,,,,0.2838,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Georgia?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('GA')",Count: 22,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 22}",5.0,0.7,template,,,,0.0213,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Bermuda?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",5.0,0.7,template,,,,0.0125,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Washington state?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('WA')",Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",5.0,0.7,template,,,,0.0072,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,Which state has the third most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 3
",state: NY | count: 69,"{""value"": ""NY"", ""type"": ""text""}",5.0,0.65,template,,,,0.0092,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Massachusetts?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('MA')",Count: 31,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 27}",3.0,0.7,template,,,,0.0075,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in the United Kingdom?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",5.0,0.7,template,,,,0.0145,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in North Carolina?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NC')",Count: 20,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",5.0,0.7,template,,,,0.019,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Ohio?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('OH')",Count: 24,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",3.0,0.7,template,,,,0.0126,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many different US states are represented in headquarters data?,distinct_headquarters_states,SELECT COUNT(DISTINCT stprba) AS state_count FROM sub WHERE stprba IS NOT NULL,Count: 44,"{""value"": 44, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many different countries are represented in the incorporation data?,distinct_incorporation_countries,SELECT COUNT(DISTINCT countryinc) AS country_count FROM sub WHERE countryinc IS NOT NULL,Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 16}",5.0,0.7,template,,,,0.0023,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Switzerland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 5}",5.0,0.7,template,,,,0.0074,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Florida?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('FL')",Count: 26,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 26}",5.0,0.7,template,,,,0.0079,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Illinois?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('IL')",Count: 42,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 42}",5.0,0.7,template,,,,0.0098,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,Which state has the second most company headquarters after California?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 2
",state: TX | count: 81,"{""value"": ""TX"", ""type"": ""text""}",5.0,0.65,template,,,,0.0083,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Canada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 3}",3.0,0.7,template,,,,0.0078,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Ireland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 6}",5.0,0.7,template,,,,0.0081,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Nevada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('NV'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('NV'))
  )
",Count: 9,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 9}",5.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Texas?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('TX')",Count: 81,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 81}",5.0,0.7,template,,,,0.0062,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in New York?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NY')",Count: 69,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 69}",5.0,0.7,template,,,,0.0067,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,Which sector contains Johnson & Johnson?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%') LIMIT 1",JOHNSON & JOHNSON is in the Health Care sector.,"{""value"": ""Health Care"", ""type"": ""text""}",5.0,0.8,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many sectors have fewer than 25 companies?,sectors_below_threshold,"WITH sector_counts AS (
    SELECT gics_sector, COUNT(*) AS count
    FROM companies
    WHERE gics_sector IS NOT NULL
    GROUP BY gics_sector
)
SELECT COUNT(*) AS sector_count
FROM sector_counts
WHERE count < 25",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many sectors have more than 50 companies?,sectors_above_threshold,"SELECT COUNT(DISTINCT gics_sector) as sector_count FROM (SELECT gics_sector, COUNT(*) as cnt FROM companies GROUP BY gics_sector HAVING cnt > 50) subq",Count: 6,"{""value"": 6, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0036,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,Which sector has the fewest companies?,sector_with_fewest_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL AND gics_sector != 'Other' GROUP BY gics_sector ORDER BY count ASC LIMIT 1",AT&T INC is in the Real Estate sector.,"{""type"": ""text"", ""value"": ""Real Estate""}",5.0,0.8,template,,,,0.0022,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are in the Communication Services sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%communication services%'),There are 17 companies in the Communication Services sector.,"{""value"": 17, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are in the Real Estate sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%real estate%'),There are 3 companies in the Real Estate sector.,"{""value"": 3, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are in the Consumer Staples sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer staples%'),There are 28 companies in the Consumer Staples sector.,"{""value"": 26, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",3.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are in the Consumer Discretionary sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer discretionary%'),There are 99 companies in the Consumer Discretionary sector.,"{""value"": 99, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are in the Energy sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%energy%'),There are 51 companies in the Energy sector.,"{""value"": 51, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are in the Materials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%materials%'),There are 41 companies in the Materials sector.,"{""value"": 41, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,Which sector has the second most companies?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""AT&T INC is in the Financials sector."", ""type"": ""text""}",5.0,0.8,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are in the Industrials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%industrials%'),There are 82 companies in the Industrials sector.,"{""value"": 82, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What was Meta's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%META PLATFORMS, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 76793000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 76793000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.0723,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies reported cost of revenue in the latest period?,companies_reporting_cost_of_revenue,"WITH latest_cost AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'CostOfRevenue'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_cost
WHERE rn = 1 AND value IS NOT NULL",Count: 134,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 134}",5.0,0.85,template,,,,0.1578,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies have total revenue exceeding $50 billion in the latest period?,companies_revenue_above_threshold,"WITH latest_filing AS (
    SELECT
        s.cik,
        s.adsh,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
),
latest_revenue AS (
    SELECT lf.cik, n.value AS revenue
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE lf.rn = 1
      AND n.tag IN ('Revenues', 'SalesRevenueNet')
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS count
FROM latest_revenue lr
JOIN companies c ON c.cik = lr.cik
WHERE lr.revenue > 50",Count: 1213,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 1213.0}",5.0,0.85,template,,,,0.2765,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What was Walmart's most recent total liabilities?,latest_total_liabilities,"
WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%WALMART INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.filed,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K', '10-K/A')
), selected_filing AS (
    SELECT adsh, cik, period, filed
    FROM latest_filing
    WHERE rn = 1
), metric_values AS (
    SELECT
        MAX(CASE WHEN n.tag = 'LiabilitiesAndStockholdersEquity' THEN n.value END) AS total_assets_equity,
        COALESCE(
            MAX(CASE WHEN n.tag = 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest' THEN n.value END),
            MAX(CASE WHEN n.tag = 'StockholdersEquity' THEN n.value END)
        ) AS equity
    FROM num n
    JOIN selected_filing lf ON n.adsh = lf.adsh
    WHERE n.tag IN (
        'LiabilitiesAndStockholdersEquity',
        'StockholdersEquity',
        'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest'
    )
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT
    (total_assets_equity - equity) AS total_liabilities,
    period AS period_end
FROM metric_values, selected_filing
",total_liabilities: 163402000000.0 | period_end: 2025-01-31 00:00:00,"{""type"": ""text"", ""value"": 163402000000.0, ""tolerance"": {""absolute"": 5000000000.0}}",5.0,0.8,template,,,,0.1603,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies reported positive net income in the latest period?,companies_positive_net_income,"WITH latest_net_income AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_net_income
WHERE rn = 1 AND value > 0",Count: 448,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 447.0}",5.0,0.85,template,,,,0.1274,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What was Johnson & Johnson's most recent gross profit?,latest_gross_profit,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS gross_profit,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'GrossProfit'
      AND n.qtrs IN (0,4)
)
SELECT gross_profit, period_end
FROM latest_metric
WHERE rn = 1",gross_profit: 58606000000.0 | period_end: 2024-12-31 00:00:00,"{""type"": ""numeric"", ""value"": 55394000000.0, ""tolerance"": {""absolute"": 1000000000.0}}",1.0,0.8,template,,,,0.1251,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What was Tesla's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 74653000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 74653000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.0917,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies have 'LLC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%LLC%'),Count: 5,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 5}",5.0,0.7,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,Which company has CIK 0000019617?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000019617' LIMIT 1,JPMORGAN CHASE & CO's CIK is unknown.,"{""value"": ""JPMORGAN CHASE & CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0006,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies have 'INC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%INC%'),Count: 459,"{""value"": 459, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,Which company has CIK 0000050863?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000050863' LIMIT 1,INTEL CORP's CIK is unknown.,"{""value"": ""INTEL CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0006,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What is Walmart Inc.'s CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%WALMART INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",WALMART INC.'s CIK is 0000104169.,"{""value"": ""0000104169"", ""type"": ""text""}",5.0,0.8,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies have 'CORP' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%CORP%'),Count: 180,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What is Procter & Gamble's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%PROCTER & GAMBLE CO%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",PROCTER & GAMBLE CO's CIK is 0000080424.,"{""value"": ""0000080424"", ""type"": ""text""}",5.0,0.8,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,Which company has the longest company name in the dataset?,company_with_longest_name,SELECT name FROM companies ORDER BY LENGTH(name) DESC LIMIT 1,"name: CHARLES RIVER LABORATORIES INTERNATIONAL, INC.","{""type"": ""text"", ""value"": ""CHARLES RIVER LABORATORIES INTERNATIONAL, INC.""}",5.0,0.65,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What is Berkshire Hathaway's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%BERKSHIRE HATHAWAY INC%') LIMIT 1",BERKSHIRE HATHAWAY INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many quarterly (qtrs=1) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 1,Count: 3566310,"{""value"": 3566310, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0311,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are in the Utilities sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%utilities%'),There are 20 companies in the Utilities sector.,"{""value"": 20, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What is Tesla's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1","TESLA, INC.'s CIK is 0001318605.","{""value"": ""0001318605"", ""type"": ""text""}",5.0,0.8,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many financial facts are denominated in USD?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0254,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,Which form type appears most frequently in submissions?,most_common_form_type,"SELECT form, COUNT(*) AS filing_count FROM sub GROUP BY form ORDER BY filing_count DESC LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.0051,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many unique companies are represented in the dataset?,total_company_count,SELECT COUNT(DISTINCT cik) AS company_count FROM companies,Count: 589,"{""value"": 589, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What is the earliest period date in the financial data?,earliest_period_date,SELECT MIN(period) AS earliest_period FROM sub,earliest_period: 2014-05-31 00:00:00,"{""value"": ""2014-05-31 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0034,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies have international (non-US) incorporation?,international_incorporation_count,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS company_count
FROM latest_submission
WHERE rn = 1 AND UPPER(countryinc) <> 'US'",Count: 34,"{""value"": 34, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.009,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What is Amazon's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%AMAZON COM INC%') LIMIT 1",AMAZON COM INC is in the Consumer Discretionary sector.,"{""value"": ""Consumer Discretionary"", ""type"": ""text""}",5.0,0.8,template,,,,0.3987,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many different fiscal year ends are represented?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.7,template,,,,0.0034,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,Which state has the most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 1
",state: CA | count: 123,"{""value"": ""CA"", ""type"": ""text""}",5.0,0.65,template,,,,0.0363,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies filed 10-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-K'),Count: 563,"{""value"": 563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0093,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What is the most recent filing date in the dataset?,latest_filing_date,SELECT MAX(filed) AS latest_filing_date FROM sub,latest_filing_date: 2025-06-30 00:00:00,"{""value"": ""2025-06-30 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0613,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are in the Health Care sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%health care%'),There are 80 companies in the Health Care sector.,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.0101,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,Which company has CIK 0000066740?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000066740' LIMIT 1,3M CO's CIK is unknown.,"{""value"": ""3M CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0225,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many financial facts have footnotes?,fact_count_with_footnotes,SELECT COUNT(*) AS fact_count FROM num WHERE footnote IS NOT NULL AND TRIM(CAST(footnote AS VARCHAR)) <> '',Count: 33959,"{""value"": 33959, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0473,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,What currency is used most frequently in the numerical data?,most_common_currency,"SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL GROUP BY 1 ORDER BY fact_count DESC LIMIT 1",currency: USD | fact_count: 14760135,"{""value"": ""USD"", ""type"": ""text""}",5.0,0.65,template,,,,17.8491,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Delaware?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('DE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('DE'))
  )
",Count: 346,"{""value"": 349, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",3.0,0.95,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1490, 'completion_tokens': 224}, 'latency_ms': 4611, 'success': True}]",19.2973,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,Which sector has the most companies in our S&P 500 dataset?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",Financials has 168 matching records.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.9,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 479}, 'latency_ms': 4893, 'success': True}]",4.8985,0.0,0.0,0.0,0.0
RUN_009,"06 Nov 2025, 1600 hours",simple,How many S&P 500 companies are in the Information Technology sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%information technology%'),There are 165 companies in the Information Technology sector.,"{""value"": 165, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.98,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 423}, 'latency_ms': 6936, 'success': True}]",6.9437,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What is Johnson & Johnson's return on equity (ROE) percentage?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: JOHNSON & JOHNSON | roe_percentage: 20.06,"{""value"": 20.06, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1.0}}",5.0,0.8,template,,,,0.2861,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Hong Kong dollars (HKD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('HKD'),Count: 140,"{""value"": 140, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.012,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,"How many facts use per-share units (per share, per unit)?",fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""absolute"": 100}}",5.0,0.7,template,,,,0.0149,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What is the total count of unique unit types in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 21, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Mexican pesos (MXN)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('MXN'),Count: 37,"{""value"": 37, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0128,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many facts use barrels as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('barrels'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0035,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Australian dollars (AUD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('AUD'),Count: 110,"{""value"": 110, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0128,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many facts use 'days' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('days'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0021,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What is the least common currency in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""14"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many facts are measured in Japanese yen (JPY)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 122, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many facts use square feet as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('square feet'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0034,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Swiss francs (CHF)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CHF'),Count: 218,"{""value"": 218, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0127,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many facts use percentage as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('pure'),Count: 50344,"{""value"": 50344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0125,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What is the most common non-monetary unit of measure?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""shares"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many facts are measured in British pounds (GBP)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 446, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many facts use 'shares' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0149,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Euros (EUR)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('EUR'),Count: 37847,"{""value"": 37847, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0116,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Canadian dollars (CAD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CAD'),Count: 2926,"{""value"": 2926, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0125,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What is the second most common currency in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""14"", ""type"": ""text""}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many different currencies are represented in the financial data?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies returned more than 50% of operating cash flow to shareholders?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 85, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies have free cash flow exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 45, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies issued new debt during the period?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What was Johnson & Johnson's acquisition spending?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 2.8, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies have negative operating cash flow?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 76, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What was Tesla's change in cash and cash equivalents?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 16352000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies spent more than $5 billion on acquisitions?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies have positive free cash flow?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 282, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies have EBITDA exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies reported foreign exchange gains/losses?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies have negative net income?,companies_negative_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetIncomeLoss'
  AND n.value < 0",Count: 201,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.85,template,,,,0.1298,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What was Johnson & Johnson's income tax expense?,latest_income_tax_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS income_tax_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'IncomeTaxExpenseBenefit'
      AND n.qtrs IN (0,4)
)
SELECT income_tax_expense, period_end
FROM latest_metric
WHERE rn = 1",income_tax_expense: 2621000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 2621000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.1018,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies reported depreciation and amortization expenses?,companies_depreciation_amortization_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'DepreciationAndAmortization'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 321,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.1089,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What was Tesla's other income (expense) in the latest period?,latest_other_income_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS other_income_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'OtherNonoperatingIncomeExpense'
      AND n.qtrs IN (0,4)
)
SELECT other_income_expense, period_end
FROM latest_metric
WHERE rn = 1",other_income_expense: -43000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 12556000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.8,template,,,,0.0988,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies have positive operating income?,companies_positive_operating_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'OperatingIncomeLoss'
  AND n.value > 0",Count: 907,"{""value"": 375, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.85,template,,,,0.1656,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies reported research and development expenses?,companies_research_expense_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ResearchAndDevelopmentExpense'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 344,"{""value"": 156, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",1.0,0.7,template,,,,0.1066,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies have working capital exceeding $50 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0005,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies report goodwill on their balance sheets?,companies_goodwill_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'Goodwill'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 3491,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.1136,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies have intangible assets exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0005,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies have negative stockholders' equity?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0006,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,"What is Tesla's property, plant and equipment value?",latest_property_plant_equipment,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS property_plant_equipment,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PropertyPlantAndEquipmentNet'
      AND n.qtrs IN (0,4)
)
SELECT property_plant_equipment, period_end
FROM latest_metric
WHERE rn = 1",property_plant_equipment: 35836000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 125000000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.65,template,,,,0.1706,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies have more liabilities than assets?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",1.0,0.0,,,,,0.0008,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies have current assets exceeding $100 billion?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%MASTERCARD INC%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",MASTERCARD INC has 0 matching records.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.85,llm_template_selection,,,,19.5452,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies have Return on Equity above 20%?,companies_return_on_equity_above_threshold,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 20",Count: 174,"{""value"": 175, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,1.2824,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies have gross margin above 50%?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,69.8812,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies have a debt-to-equity ratio above 1.0?,companies_debt_to_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Liabilities','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND liabilities IS NOT NULL
  AND liabilities / equity > 1.0",Count: 236,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.85,template,,,,0.1964,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies have negative Return on Assets?,companies_negative_return_on_assets,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('NetIncomeLoss','Assets')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND assets <> 0 AND net_income IS NOT NULL AND net_income / assets < 0",Count: 3,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",3.0,0.85,template,,,,0.17,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies have a current ratio above 2.0?,companies_current_ratio_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND current_liabilities <> 0
  AND current_assets / current_liabilities > 2.0",Count: 115,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",1.0,0.7,template,,,,0.2192,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies have positive Return on Equity in the latest period?,companies_positive_return_on_equity,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 0",Count: 433,"{""value"": 434, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,1.4818,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many annual (qtrs=0) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 0,Count: 5484928,"{""value"": 613954, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.7,template,,,,0.0278,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What is the second most frequent form type in submissions?,form_type_rank,"WITH form_counts AS (
    SELECT form, COUNT(*) AS filing_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM sub
    GROUP BY form
)
SELECT form, filing_count
FROM form_counts
WHERE rank = 2
LIMIT 1",form: 10-K | filing_count: 6274,"{""value"": ""10-Q"", ""type"": ""text""}",1.0,0.65,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many submissions are for fiscal period Q4?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q4'),Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 1}",5.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many submissions are for fiscal period Q3?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q3'),Count: 5238,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5238}",5.0,0.75,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many submissions are for fiscal period Q2?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q2'),Count: 5296,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5296}",5.0,0.75,template,,,,0.004,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many submissions have September fiscal year end (0930)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 1134, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.7,template,,,,0.0035,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many submissions have June fiscal year end (0630)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 949, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.7,template,,,,0.0029,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many submissions have March fiscal year end (0331)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 394, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many submissions have December fiscal year end (1231)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 17572, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many different form types are present in the submissions?,distinct_form_type_count,SELECT COUNT(DISTINCT form) AS form_type_count FROM sub,Count: 21,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 21}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many submissions have fiscal period FY (full year)?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('FY'),Count: 6476,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 6476}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many submissions have fiscal period Q1?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q1'),Count: 5664,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5664}",5.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many submissions have fiscal year 2025?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2025,Count: 917,"{""value"": 50, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.75,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many submissions have fiscal year 2024?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2024,Count: 4167,"{""value"": 450, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.75,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What is the earliest filing date in the dataset?,earliest_filing_date,SELECT MIN(filed) AS earliest_filing_date FROM sub,earliest_filing_date: 2015-01-02 00:00:00,"{""value"": ""2015-01-02 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies filed 8-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('8-K'),Count: 112,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 112}",5.0,0.7,template,,,,0.0023,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies filed 10-Q forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-Q'),Count: 543,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 543}",5.0,0.7,template,,,,0.0023,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many financial facts are reported with coreg (co-registrant) information?,fact_count_with_coreg,SELECT COUNT(*) AS fact_count FROM num WHERE coreg IS NOT NULL AND TRIM(coreg) <> '',Count: 1261087,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.7,template,,,,0.0241,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many XBRL tags are classified as 'string' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%string%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.7,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Debt' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%DEBT%'),Count: 26515,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 26515}",5.0,0.85,template,,,,0.0415,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Equity' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%EQUITY%'),Count: 24563,"{""value"": 24563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0781,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Cash' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%CASH%'),Count: 29232,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 29232}",5.0,0.85,template,,,,0.0365,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What is the third most frequent XBRL tag in numerical data?,tag_nth_most_common,"WITH tag_counts AS (
    SELECT
        tag,
        COUNT(*) AS fact_count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    GROUP BY tag
)
SELECT tag, fact_count
FROM tag_counts
WHERE rank = 3
LIMIT 1",tag: Revenues | fact_count: 491457,"{""type"": ""text"", ""value"": ""Assets""}",1.0,0.65,template,,,,0.0639,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many numerical facts have zero values?,fact_count_zero_values,SELECT COUNT(*) AS fact_count FROM num WHERE value = 0,Count: 1427015,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 85000}",1.0,0.7,template,,,,0.0774,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many numerical facts have negative values?,fact_count_negative_values,SELECT COUNT(*) AS fact_count FROM num WHERE value < 0,Count: 2124201,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 125000}",1.0,0.7,template,,,,0.0956,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many XBRL tags are classified as 'per-share' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%per-share%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 6063}",1.0,0.7,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many XBRL tags have 'shares' as unit of measure in numerical data?,tag_count_by_unit,SELECT COUNT(DISTINCT tag) AS tag_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 949,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 949}",5.0,0.7,template,,,,0.0332,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many financial facts have duplicate values (dimhash populated)?,fact_count_dimhash_populated,SELECT COUNT(*) AS fact_count FROM num WHERE segments IS NOT NULL AND TRIM(segments) <> '',Count: 8738244,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 8738244}",5.0,0.7,template,,,,1.103,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many different unit types (UOM) are present in the numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 8}",1.0,0.7,template,,,,0.0504,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Liability' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%LIABILITY%'),Count: 11059,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 11059}",5.0,0.7,template,,,,0.0539,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Asset' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%ASSET%'),Count: 40285,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 40285}",5.0,0.7,template,,,,0.0528,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Revenue' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%REVENUE%'),Count: 12221,"{""value"": 12221, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0784,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many XBRL tags are classified as 'monetary' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%monetary%'),Count: 454617,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 454617}",5.0,0.7,template,,,,0.0034,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many XBRL tags have a debit-credit flag of 'Debit'?,tag_count_by_debit_credit,SELECT COUNT(*) AS tag_count FROM tag WHERE crdr IS NOT NULL AND UPPER(TRIM(crdr)) = CASE WHEN UPPER(TRIM('Debit')) LIKE 'D%' THEN 'D' WHEN UPPER(TRIM('Debit')) LIKE 'C%' THEN 'C' ELSE UPPER(TRIM('Debit')) END,Count: 224017,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 224017}",5.0,0.7,template,,,,0.0049,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What is Google's (Alphabet) return on equity (ROE)?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%ALPHABET INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: ALPHABET INC. | roe_percentage: 32.91,"{""value"": 32.91, ""type"": ""numeric"", ""tolerance"": {""absolute"": 0.5}}",5.0,0.8,template,,,,0.2122,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Georgia?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('GA')",Count: 22,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 22}",5.0,0.7,template,,,,0.0071,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Bermuda?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",5.0,0.7,template,,,,0.0075,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Washington state?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('WA')",Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",5.0,0.7,template,,,,0.0067,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,Which state has the third most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 3
",state: NY | count: 69,"{""value"": ""NY"", ""type"": ""text""}",5.0,0.65,template,,,,0.0078,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Massachusetts?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('MA')",Count: 31,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 27}",3.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in the United Kingdom?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",5.0,0.7,template,,,,0.0111,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in North Carolina?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NC')",Count: 20,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",5.0,0.7,template,,,,0.0073,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Ohio?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('OH')",Count: 24,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",3.0,0.7,template,,,,0.007,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many different US states are represented in headquarters data?,distinct_headquarters_states,SELECT COUNT(DISTINCT stprba) AS state_count FROM sub WHERE stprba IS NOT NULL,Count: 44,"{""value"": 44, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0026,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many different countries are represented in the incorporation data?,distinct_incorporation_countries,SELECT COUNT(DISTINCT countryinc) AS country_count FROM sub WHERE countryinc IS NOT NULL,Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 16}",5.0,0.7,template,,,,0.0028,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Switzerland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 5}",5.0,0.7,template,,,,0.0084,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Florida?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('FL')",Count: 26,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 26}",5.0,0.7,template,,,,0.0072,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Illinois?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('IL')",Count: 42,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 42}",5.0,0.7,template,,,,0.0099,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,Which state has the second most company headquarters after California?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 2
",state: TX | count: 81,"{""value"": ""TX"", ""type"": ""text""}",5.0,0.65,template,,,,0.0073,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Canada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 3}",3.0,0.7,template,,,,0.0066,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Ireland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 6}",5.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Nevada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('NV'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('NV'))
  )
",Count: 9,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 9}",5.0,0.7,template,,,,0.0074,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Texas?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('TX')",Count: 81,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 81}",5.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in New York?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NY')",Count: 69,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 69}",5.0,0.7,template,,,,0.0064,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,Which sector contains Johnson & Johnson?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%') LIMIT 1",JOHNSON & JOHNSON is in the Health Care sector.,"{""value"": ""Health Care"", ""type"": ""text""}",5.0,0.8,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many sectors have fewer than 25 companies?,sectors_below_threshold,"WITH sector_counts AS (
    SELECT gics_sector, COUNT(*) AS count
    FROM companies
    WHERE gics_sector IS NOT NULL
    GROUP BY gics_sector
)
SELECT COUNT(*) AS sector_count
FROM sector_counts
WHERE count < 25",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many sectors have more than 50 companies?,sectors_above_threshold,"SELECT COUNT(DISTINCT gics_sector) as sector_count FROM (SELECT gics_sector, COUNT(*) as cnt FROM companies GROUP BY gics_sector HAVING cnt > 50) subq",Count: 6,"{""value"": 6, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0031,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,Which sector has the fewest companies?,sector_with_fewest_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL AND gics_sector != 'Other' GROUP BY gics_sector ORDER BY count ASC LIMIT 1",AT&T INC is in the Real Estate sector.,"{""type"": ""text"", ""value"": ""Real Estate""}",5.0,0.8,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are in the Communication Services sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%communication services%'),There are 17 companies in the Communication Services sector.,"{""value"": 17, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are in the Real Estate sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%real estate%'),There are 3 companies in the Real Estate sector.,"{""value"": 3, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are in the Consumer Staples sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer staples%'),There are 28 companies in the Consumer Staples sector.,"{""value"": 26, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",3.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are in the Consumer Discretionary sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer discretionary%'),There are 99 companies in the Consumer Discretionary sector.,"{""value"": 99, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are in the Energy sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%energy%'),There are 51 companies in the Energy sector.,"{""value"": 51, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are in the Materials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%materials%'),There are 41 companies in the Materials sector.,"{""value"": 41, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,Which sector has the second most companies?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""Information Technology"", ""type"": ""text""}",1.0,0.8,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are in the Industrials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%industrials%'),There are 82 companies in the Industrials sector.,"{""value"": 82, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What was Meta's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%META PLATFORMS, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 76793000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 76793000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.0673,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies reported cost of revenue in the latest period?,companies_reporting_cost_of_revenue,"WITH latest_cost AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'CostOfRevenue'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_cost
WHERE rn = 1 AND value IS NOT NULL",Count: 134,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 134}",5.0,0.85,template,,,,0.1568,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies have total revenue exceeding $50 billion in the latest period?,companies_revenue_above_threshold,"WITH latest_filing AS (
    SELECT
        s.cik,
        s.adsh,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
),
latest_revenue AS (
    SELECT lf.cik, n.value AS revenue
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE lf.rn = 1
      AND n.tag IN ('Revenues', 'SalesRevenueNet')
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS count
FROM latest_revenue lr
JOIN companies c ON c.cik = lr.cik
WHERE lr.revenue > 50",Count: 1213,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",1.0,0.85,template,,,,1.8381,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What was Walmart's most recent total liabilities?,latest_total_liabilities,"
WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%WALMART INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.filed,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K', '10-K/A')
), selected_filing AS (
    SELECT adsh, cik, period, filed
    FROM latest_filing
    WHERE rn = 1
), metric_values AS (
    SELECT
        MAX(CASE WHEN n.tag = 'LiabilitiesAndStockholdersEquity' THEN n.value END) AS total_assets_equity,
        COALESCE(
            MAX(CASE WHEN n.tag = 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest' THEN n.value END),
            MAX(CASE WHEN n.tag = 'StockholdersEquity' THEN n.value END)
        ) AS equity
    FROM num n
    JOIN selected_filing lf ON n.adsh = lf.adsh
    WHERE n.tag IN (
        'LiabilitiesAndStockholdersEquity',
        'StockholdersEquity',
        'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest'
    )
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT
    (total_assets_equity - equity) AS total_liabilities,
    period AS period_end
FROM metric_values, selected_filing
",total_liabilities: 163402000000.0 | period_end: 2025-01-31 00:00:00,"{""type"": ""text"", ""value"": 163402000000.0, ""tolerance"": {""absolute"": 5000000000.0}}",5.0,0.8,template,,,,0.8121,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies reported positive net income in the latest period?,companies_positive_net_income,"WITH latest_net_income AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_net_income
WHERE rn = 1 AND value > 0",Count: 447,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 10}",1.0,0.85,template,,,,0.2184,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What was Johnson & Johnson's most recent gross profit?,latest_gross_profit,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS gross_profit,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'GrossProfit'
      AND n.qtrs IN (0,4)
)
SELECT gross_profit, period_end
FROM latest_metric
WHERE rn = 1",gross_profit: 55394000000.0 | period_end: 2024-12-31 00:00:00,"{""type"": ""text"", ""value"": 58606000000.0, ""tolerance"": {""absolute"": 1000000000.0}}",1.0,0.8,template,,,,0.0987,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What was Tesla's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 74653000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 74653000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.0764,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies have 'LLC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%LLC%'),Count: 5,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 5}",5.0,0.7,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,Which company has CIK 0000019617?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000019617' LIMIT 1,JPMORGAN CHASE & CO's CIK is unknown.,"{""value"": ""JPMORGAN CHASE & CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0006,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies have 'INC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%INC%'),Count: 459,"{""value"": 459, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,Which company has CIK 0000050863?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000050863' LIMIT 1,INTEL CORP's CIK is unknown.,"{""value"": ""INTEL CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0006,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What is Walmart Inc.'s CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%WALMART INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",WALMART INC.'s CIK is 0000104169.,"{""value"": ""0000104169"", ""type"": ""text""}",5.0,0.8,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies have 'CORP' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%CORP%'),Count: 180,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0006,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What is Procter & Gamble's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%PROCTER & GAMBLE CO%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",PROCTER & GAMBLE CO's CIK is 0000080424.,"{""value"": ""0000080424"", ""type"": ""text""}",5.0,0.8,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,Which company has the longest company name in the dataset?,company_with_longest_name,SELECT name FROM companies ORDER BY LENGTH(name) DESC LIMIT 1,"name: CHARLES RIVER LABORATORIES INTERNATIONAL, INC.","{""type"": ""text"", ""value"": ""CHARLES RIVER LABORATORIES INTERNATIONAL, INC.""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What is Berkshire Hathaway's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%BERKSHIRE HATHAWAY INC%') LIMIT 1",BERKSHIRE HATHAWAY INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many quarterly (qtrs=1) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 1,Count: 3566310,"{""value"": 3566310, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0242,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are in the Utilities sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%utilities%'),There are 20 companies in the Utilities sector.,"{""value"": 20, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What is Tesla's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1","TESLA, INC.'s CIK is 0001318605.","{""value"": ""0001318605"", ""type"": ""text""}",5.0,0.8,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many financial facts are denominated in USD?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0309,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,Which form type appears most frequently in submissions?,most_common_form_type,"SELECT form, COUNT(*) AS filing_count FROM sub GROUP BY form ORDER BY filing_count DESC LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.0043,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many unique companies are represented in the dataset?,total_company_count,SELECT COUNT(DISTINCT cik) AS company_count FROM companies,Count: 589,"{""value"": 589, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0023,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What is the earliest period date in the financial data?,earliest_period_date,SELECT MIN(period) AS earliest_period FROM sub,earliest_period: 2014-05-31 00:00:00,"{""value"": ""2014-05-31 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0024,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies have international (non-US) incorporation?,international_incorporation_count,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS company_count
FROM latest_submission
WHERE rn = 1 AND UPPER(countryinc) <> 'US'",Count: 34,"{""value"": 34, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What is Amazon's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%AMAZON COM INC%') LIMIT 1",AMAZON COM INC is in the Consumer Discretionary sector.,"{""value"": ""Consumer Discretionary"", ""type"": ""text""}",5.0,0.8,template,,,,0.0138,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many different fiscal year ends are represented?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.7,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,Which state has the most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 1
",state: CA | count: 123,"{""value"": ""CA"", ""type"": ""text""}",5.0,0.65,template,,,,0.0077,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies filed 10-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-K'),Count: 563,"{""value"": 563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What is the most recent filing date in the dataset?,latest_filing_date,SELECT MAX(filed) AS latest_filing_date FROM sub,latest_filing_date: 2025-06-30 00:00:00,"{""value"": ""2025-06-30 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0022,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are in the Health Care sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%health care%'),There are 80 companies in the Health Care sector.,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,Which company has CIK 0000066740?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000066740' LIMIT 1,3M CO's CIK is unknown.,"{""value"": ""3M CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many financial facts have footnotes?,fact_count_with_footnotes,SELECT COUNT(*) AS fact_count FROM num WHERE footnote IS NOT NULL AND TRIM(CAST(footnote AS VARCHAR)) <> '',Count: 33959,"{""value"": 33959, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0203,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,What currency is used most frequently in the numerical data?,most_common_currency,"SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL GROUP BY 1 ORDER BY fact_count DESC LIMIT 1",currency: USD | fact_count: 14760135,"{""value"": ""USD"", ""type"": ""text""}",5.0,0.65,template,,,,0.0458,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Delaware?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('DE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('DE'))
  )
",Count: 346,"{""value"": 349, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",3.0,0.7,template,,,,0.0184,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,Which sector has the most companies in our S&P 500 dataset?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,21.0326,0.0,0.0,0.0,0.0
RUN_008,"06 Nov 2025, 1600 hours",simple,How many S&P 500 companies are in the Information Technology sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%information technology%'),There are 165 companies in the Information Technology sector.,"{""value"": 165, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.9,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 421}, 'latency_ms': 3960, 'success': True}]",14.289,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What is Johnson & Johnson's return on equity (ROE) percentage?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: JOHNSON & JOHNSON | roe_percentage: 20.06,"{""value"": 20.06, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1.0}}",5.0,0.8,template,,,,0.3125,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Hong Kong dollars (HKD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('HKD'),Count: 140,"{""value"": 140, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.01,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,"How many facts use per-share units (per share, per unit)?",fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""absolute"": 100}}",5.0,0.7,template,,,,0.0135,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What is the total count of unique unit types in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 21, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Mexican pesos (MXN)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('MXN'),Count: 37,"{""value"": 37, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.007,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many facts use barrels as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('barrels'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Australian dollars (AUD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('AUD'),Count: 110,"{""value"": 110, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0115,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many facts use 'days' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('days'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0021,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What is the least common currency in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""14"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many facts are measured in Japanese yen (JPY)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 122, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many facts use square feet as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('square feet'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0028,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Swiss francs (CHF)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CHF'),Count: 218,"{""value"": 218, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0122,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many facts use percentage as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('pure'),Count: 50344,"{""value"": 50344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0144,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What is the most common non-monetary unit of measure?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""shares"", ""type"": ""text""}",1.0,0.0,,,,,0.0005,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many facts are measured in British pounds (GBP)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 446, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.0,,,,,0.0005,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many facts use 'shares' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0151,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Euros (EUR)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('EUR'),Count: 37847,"{""value"": 37847, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0155,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Canadian dollars (CAD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CAD'),Count: 2926,"{""value"": 2926, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0144,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What is the second most common currency in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""14"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many different currencies are represented in the financial data?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies returned more than 50% of operating cash flow to shareholders?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 85, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies have free cash flow exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 45, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies issued new debt during the period?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What was Johnson & Johnson's acquisition spending?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 2.8, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies have negative operating cash flow?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 76, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What was Tesla's change in cash and cash equivalents?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 16352000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies spent more than $5 billion on acquisitions?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies have positive free cash flow?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 282, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies have EBITDA exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies reported foreign exchange gains/losses?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0007,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies have negative net income?,companies_negative_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetIncomeLoss'
  AND n.value < 0",Count: 201,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.85,template,,,,0.2225,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What was Johnson & Johnson's income tax expense?,latest_income_tax_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS income_tax_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'IncomeTaxExpenseBenefit'
      AND n.qtrs IN (0,4)
)
SELECT income_tax_expense, period_end
FROM latest_metric
WHERE rn = 1",income_tax_expense: 1736000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 2621000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.8,template,,,,0.4272,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies reported depreciation and amortization expenses?,companies_depreciation_amortization_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'DepreciationAndAmortization'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 321,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.8469,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What was Tesla's other income (expense) in the latest period?,latest_other_income_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS other_income_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'OtherNonoperatingIncomeExpense'
      AND n.qtrs IN (0,4)
)
SELECT other_income_expense, period_end
FROM latest_metric
WHERE rn = 1",other_income_expense: 695000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 12556000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.8,template,,,,0.2765,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies have positive operating income?,companies_positive_operating_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'OperatingIncomeLoss'
  AND n.value > 0",Count: 907,"{""value"": 375, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.85,template,,,,0.1645,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies reported research and development expenses?,companies_research_expense_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ResearchAndDevelopmentExpense'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 344,"{""value"": 156, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",1.0,0.7,template,,,,0.1173,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies have working capital exceeding $50 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies report goodwill on their balance sheets?,companies_goodwill_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'Goodwill'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 3491,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.1217,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies have intangible assets exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies have negative stockholders' equity?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,"What is Tesla's property, plant and equipment value?",latest_property_plant_equipment,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS property_plant_equipment,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PropertyPlantAndEquipmentNet'
      AND n.qtrs IN (0,4)
)
SELECT property_plant_equipment, period_end
FROM latest_metric
WHERE rn = 1",property_plant_equipment: 35836000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 125000000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.65,template,,,,0.1474,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies have more liabilities than assets?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",1.0,0.0,,,,,0.0008,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies have current assets exceeding $100 billion?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%MASTERCARD INC%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",MASTERCARD INC has 0 matching records.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.85,llm_template_selection,,,,16.3579,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies have Return on Equity above 20%?,companies_return_on_equity_above_threshold,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 20",Count: 174,"{""value"": 175, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,1.2423,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies have gross margin above 50%?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,66.3215,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies have a debt-to-equity ratio above 1.0?,companies_debt_to_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Liabilities','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND liabilities IS NOT NULL
  AND liabilities / equity > 1.0",Count: 236,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.85,template,,,,0.1978,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies have negative Return on Assets?,companies_negative_return_on_assets,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('NetIncomeLoss','Assets')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND assets <> 0 AND net_income IS NOT NULL AND net_income / assets < 0",Count: 3,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",3.0,0.85,template,,,,0.1674,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies have a current ratio above 2.0?,companies_current_ratio_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND current_liabilities <> 0
  AND current_assets / current_liabilities > 2.0",Count: 115,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",1.0,0.7,template,,,,0.1771,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies have positive Return on Equity in the latest period?,companies_positive_return_on_equity,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 0",Count: 433,"{""value"": 434, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,1.0873,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many annual (qtrs=0) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 0,Count: 5484928,"{""value"": 613954, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.7,template,,,,0.0252,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What is the second most frequent form type in submissions?,form_type_rank,"WITH form_counts AS (
    SELECT form, COUNT(*) AS filing_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM sub
    GROUP BY form
)
SELECT form, filing_count
FROM form_counts
WHERE rank = 2
LIMIT 1",form: 10-K | filing_count: 6274,"{""value"": ""10-Q"", ""type"": ""text""}",1.0,0.65,template,,,,0.0023,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many submissions are for fiscal period Q4?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q4'),Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many submissions are for fiscal period Q3?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q3'),Count: 5238,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many submissions are for fiscal period Q2?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q2'),Count: 5296,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many submissions have September fiscal year end (0930)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 25, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many submissions have June fiscal year end (0630)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 45, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many submissions have March fiscal year end (0331)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many submissions have December fiscal year end (1231)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 350, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many different form types are present in the submissions?,distinct_form_type_count,SELECT COUNT(DISTINCT form) AS form_type_count FROM sub,Count: 21,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 21}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many submissions have fiscal period FY (full year)?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('FY'),Count: 6476,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 500}",1.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many submissions have fiscal period Q1?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q1'),Count: 5664,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many submissions have fiscal year 2025?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2025,Count: 917,"{""value"": 50, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.75,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many submissions have fiscal year 2024?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2024,Count: 4167,"{""value"": 450, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.75,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What is the earliest filing date in the dataset?,earliest_filing_date,SELECT MIN(filed) AS earliest_filing_date FROM sub,earliest_filing_date: 2015-01-02 00:00:00,"{""value"": ""2015-01-02 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies filed 8-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('8-K'),Count: 112,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 112}",5.0,0.7,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies filed 10-Q forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-Q'),Count: 543,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 543}",5.0,0.7,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many financial facts are reported with coreg (co-registrant) information?,fact_count_with_coreg,SELECT COUNT(*) AS fact_count FROM num WHERE coreg IS NOT NULL AND TRIM(coreg) <> '',Count: 1261087,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.7,template,,,,0.0147,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many XBRL tags are classified as 'string' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%string%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Debt' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%DEBT%'),Count: 26515,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 26515}",5.0,0.85,template,,,,0.034,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Equity' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%EQUITY%'),Count: 24563,"{""value"": 24563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0436,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Cash' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%CASH%'),Count: 29232,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 29232}",5.0,0.85,template,,,,0.0349,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What is the third most frequent XBRL tag in numerical data?,tag_nth_most_common,"WITH tag_counts AS (
    SELECT
        tag,
        COUNT(*) AS fact_count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    GROUP BY tag
)
SELECT tag, fact_count
FROM tag_counts
WHERE rank = 3
LIMIT 1",tag: Revenues | fact_count: 491457,"{""type"": ""text"", ""value"": ""Assets""}",1.0,0.65,template,,,,0.0305,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many numerical facts have zero values?,fact_count_zero_values,SELECT COUNT(*) AS fact_count FROM num WHERE value = 0,Count: 1427015,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 85000}",1.0,0.7,template,,,,0.0614,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many numerical facts have negative values?,fact_count_negative_values,SELECT COUNT(*) AS fact_count FROM num WHERE value < 0,Count: 2124201,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 125000}",1.0,0.7,template,,,,0.0598,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many XBRL tags are classified as 'per-share' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%per-share%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 6063}",1.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many XBRL tags have 'shares' as unit of measure in numerical data?,tag_count_by_unit,SELECT COUNT(DISTINCT tag) AS tag_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 949,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 949}",5.0,0.7,template,,,,0.0311,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many financial facts have duplicate values (dimhash populated)?,fact_count_dimhash_populated,SELECT COUNT(*) AS fact_count FROM num WHERE segments IS NOT NULL AND TRIM(segments) <> '',Count: 8738244,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 8738244}",5.0,0.7,template,,,,0.6821,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many different unit types (UOM) are present in the numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 8}",1.0,0.7,template,,,,0.0147,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Liability' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%LIABILITY%'),Count: 11059,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 11059}",5.0,0.7,template,,,,0.0356,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Asset' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%ASSET%'),Count: 40285,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 40285}",5.0,0.7,template,,,,0.0387,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Revenue' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%REVENUE%'),Count: 12221,"{""value"": 12221, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0386,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many XBRL tags are classified as 'monetary' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%monetary%'),Count: 454617,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 454617}",5.0,0.7,template,,,,0.0028,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many XBRL tags have a debit-credit flag of 'Debit'?,tag_count_by_debit_credit,SELECT COUNT(*) AS tag_count FROM tag WHERE crdr IS NOT NULL AND UPPER(TRIM(crdr)) = CASE WHEN UPPER(TRIM('Debit')) LIKE 'D%' THEN 'D' WHEN UPPER(TRIM('Debit')) LIKE 'C%' THEN 'C' ELSE UPPER(TRIM('Debit')) END,Count: 224017,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 224017}",5.0,0.7,template,,,,0.0049,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What is Google's (Alphabet) return on equity (ROE)?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%ALPHABET INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: ALPHABET INC. | roe_percentage: 32.91,"{""value"": 32.91, ""type"": ""numeric"", ""tolerance"": {""absolute"": 0.5}}",5.0,0.8,template,,,,0.2159,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Georgia?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('GA')",Count: 22,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 22}",5.0,0.7,template,,,,0.006,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Bermuda?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",5.0,0.7,template,,,,0.0064,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Washington state?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('WA')",Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",5.0,0.7,template,,,,0.0062,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,Which state has the third most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 3
",state: NY | count: 69,"{""value"": ""NY"", ""type"": ""text""}",5.0,0.65,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Massachusetts?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('MA')",Count: 31,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 27}",3.0,0.7,template,,,,0.0064,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in the United Kingdom?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",5.0,0.7,template,,,,0.0062,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in North Carolina?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NC')",Count: 20,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",5.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Ohio?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('OH')",Count: 24,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",3.0,0.7,template,,,,0.0073,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many different US states are represented in headquarters data?,distinct_headquarters_states,SELECT COUNT(DISTINCT stprba) AS state_count FROM sub WHERE stprba IS NOT NULL,Count: 44,"{""value"": 44, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many different countries are represented in the incorporation data?,distinct_incorporation_countries,SELECT COUNT(DISTINCT countryinc) AS country_count FROM sub WHERE countryinc IS NOT NULL,Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 16}",5.0,0.7,template,,,,0.002,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Switzerland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 5}",5.0,0.7,template,,,,0.0105,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Florida?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('FL')",Count: 26,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 26}",5.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Illinois?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('IL')",Count: 42,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 42}",5.0,0.7,template,,,,0.0062,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,Which state has the second most company headquarters after California?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 2
",state: TX | count: 81,"{""value"": ""TX"", ""type"": ""text""}",5.0,0.65,template,,,,0.0072,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Canada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 3}",3.0,0.7,template,,,,0.007,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Ireland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 6}",5.0,0.7,template,,,,0.0071,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Nevada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('NV'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('NV'))
  )
",Count: 9,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 9}",5.0,0.7,template,,,,0.0071,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Texas?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('TX')",Count: 81,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 81}",5.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in New York?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NY')",Count: 69,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 69}",5.0,0.7,template,,,,0.0071,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,Which sector contains Johnson & Johnson?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%') LIMIT 1",JOHNSON & JOHNSON is in the Health Care sector.,"{""value"": ""Health Care"", ""type"": ""text""}",5.0,0.8,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many sectors have fewer than 25 companies?,sectors_below_threshold,"WITH sector_counts AS (
    SELECT gics_sector, COUNT(*) AS count
    FROM companies
    WHERE gics_sector IS NOT NULL
    GROUP BY gics_sector
)
SELECT COUNT(*) AS sector_count
FROM sector_counts
WHERE count < 25",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many sectors have more than 50 companies?,sectors_above_threshold,"SELECT COUNT(DISTINCT gics_sector) as sector_count FROM (SELECT gics_sector, COUNT(*) as cnt FROM companies GROUP BY gics_sector HAVING cnt > 50) subq",Count: 6,"{""value"": 6, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0033,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,Which sector has the fewest companies?,sector_with_fewest_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL AND gics_sector != 'Other' GROUP BY gics_sector ORDER BY count ASC LIMIT 1",AT&T INC is in the Real Estate sector.,"{""type"": ""text"", ""value"": ""Real Estate""}",5.0,0.8,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are in the Communication Services sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%communication services%'),There are 17 companies in the Communication Services sector.,"{""value"": 17, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are in the Real Estate sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%real estate%'),There are 3 companies in the Real Estate sector.,"{""value"": 3, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are in the Consumer Staples sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer staples%'),There are 28 companies in the Consumer Staples sector.,"{""value"": 26, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",3.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are in the Consumer Discretionary sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer discretionary%'),There are 99 companies in the Consumer Discretionary sector.,"{""value"": 99, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are in the Energy sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%energy%'),There are 51 companies in the Energy sector.,"{""value"": 51, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are in the Materials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%materials%'),There are 41 companies in the Materials sector.,"{""value"": 41, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,Which sector has the second most companies?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""Information Technology"", ""type"": ""text""}",1.0,0.8,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are in the Industrials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%industrials%'),There are 82 companies in the Industrials sector.,"{""value"": 82, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What was Meta's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%META PLATFORMS, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 76793000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 76793000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.0724,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies reported cost of revenue in the latest period?,companies_reporting_cost_of_revenue,"WITH latest_cost AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'CostOfRevenue'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_cost
WHERE rn = 1 AND value IS NOT NULL",Count: 134,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 134}",5.0,0.85,template,,,,0.1286,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies have total revenue exceeding $50 billion in the latest period?,companies_revenue_above_threshold,"WITH latest_filing AS (
    SELECT
        s.cik,
        s.adsh,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
),
latest_revenue AS (
    SELECT lf.cik, n.value AS revenue
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE lf.rn = 1
      AND n.tag IN ('Revenues', 'SalesRevenueNet')
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS count
FROM latest_revenue lr
JOIN companies c ON c.cik = lr.cik
WHERE lr.revenue > 50",Count: 1213,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",1.0,0.85,template,,,,0.1678,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What was Walmart's most recent total liabilities?,latest_total_liabilities,"
WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%WALMART INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.filed,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K', '10-K/A')
), selected_filing AS (
    SELECT adsh, cik, period, filed
    FROM latest_filing
    WHERE rn = 1
), metric_values AS (
    SELECT
        MAX(CASE WHEN n.tag = 'LiabilitiesAndStockholdersEquity' THEN n.value END) AS total_assets_equity,
        COALESCE(
            MAX(CASE WHEN n.tag = 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest' THEN n.value END),
            MAX(CASE WHEN n.tag = 'StockholdersEquity' THEN n.value END)
        ) AS equity
    FROM num n
    JOIN selected_filing lf ON n.adsh = lf.adsh
    WHERE n.tag IN (
        'LiabilitiesAndStockholdersEquity',
        'StockholdersEquity',
        'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest'
    )
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT
    (total_assets_equity - equity) AS total_liabilities,
    period AS period_end
FROM metric_values, selected_filing
",total_liabilities: 163402000000.0 | period_end: 2025-01-31 00:00:00,"{""type"": ""text"", ""value"": 163402000000.0, ""tolerance"": {""absolute"": 5000000000.0}}",5.0,0.8,template,,,,0.1315,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies reported positive net income in the latest period?,companies_positive_net_income,"WITH latest_net_income AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_net_income
WHERE rn = 1 AND value > 0",Count: 449,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 10}",1.0,0.85,template,,,,0.1374,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What was Johnson & Johnson's most recent gross profit?,latest_gross_profit,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS gross_profit,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'GrossProfit'
      AND n.qtrs IN (0,4)
)
SELECT gross_profit, period_end
FROM latest_metric
WHERE rn = 1",gross_profit: 58606000000.0 | period_end: 2024-12-31 00:00:00,"{""type"": ""text"", ""value"": 58606000000.0, ""tolerance"": {""absolute"": 1000000000.0}}",5.0,0.8,template,,,,0.1058,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What was Tesla's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 74653000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 74653000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.0899,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies have 'LLC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%LLC%'),Count: 5,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 5}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,Which company has CIK 0000019617?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000019617' LIMIT 1,JPMORGAN CHASE & CO's CIK is unknown.,"{""value"": ""JPMORGAN CHASE & CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies have 'INC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%INC%'),Count: 459,"{""value"": 459, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,Which company has CIK 0000050863?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000050863' LIMIT 1,INTEL CORP's CIK is unknown.,"{""value"": ""INTEL CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What is Walmart Inc.'s CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%WALMART INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",WALMART INC.'s CIK is 0000104169.,"{""value"": ""0000104169"", ""type"": ""text""}",5.0,0.8,template,,,,0.0022,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies have 'CORP' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%CORP%'),Count: 180,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What is Procter & Gamble's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%PROCTER & GAMBLE CO%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",PROCTER & GAMBLE CO's CIK is 0000080424.,"{""value"": ""0000080424"", ""type"": ""text""}",5.0,0.8,template,,,,0.0031,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,Which company has the longest company name in the dataset?,company_with_longest_name,SELECT name FROM companies ORDER BY LENGTH(name) DESC LIMIT 1,"name: CHARLES RIVER LABORATORIES INTERNATIONAL, INC.","{""type"": ""text"", ""value"": ""CHARLES RIVER LABORATORIES INTERNATIONAL, INC.""}",5.0,0.65,template,,,,0.0022,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What is Berkshire Hathaway's GICS sector?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%BERKSHIRE HATHAWAY INC%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",BERKSHIRE HATHAWAY INC's CIK is 0001067983.,"{""value"": ""Financials"", ""type"": ""text""}",1.0,0.8,llm_template_selection,,,"[{'stage': 'template_selection', 'tokens': {'prompt_tokens': 6555, 'completion_tokens': 316}, 'latency_ms': 3124, 'success': True, 'confidence': 0.96}]",3.1299,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many quarterly (qtrs=1) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 1,Count: 3566310,"{""value"": 3566310, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0265,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are in the Utilities sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%utilities%'),There are 20 companies in the Utilities sector.,"{""value"": 20, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What is Tesla's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1","TESLA, INC.'s CIK is 0001318605.","{""value"": ""0001318605"", ""type"": ""text""}",5.0,0.8,template,,,,0.002,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many financial facts are denominated in USD?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.018,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,Which form type appears most frequently in submissions?,most_common_form_type,"SELECT form, COUNT(*) AS filing_count FROM sub GROUP BY form ORDER BY filing_count DESC LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.004,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many unique companies are represented in the dataset?,total_company_count,SELECT COUNT(DISTINCT cik) AS company_count FROM companies,Count: 589,"{""value"": 589, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What is the earliest period date in the financial data?,earliest_period_date,SELECT MIN(period) AS earliest_period FROM sub,earliest_period: 2014-05-31 00:00:00,"{""value"": ""2014-05-31 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0075,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies have international (non-US) incorporation?,international_incorporation_count,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS company_count
FROM latest_submission
WHERE rn = 1 AND UPPER(countryinc) <> 'US'",Count: 34,"{""value"": 34, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.009,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What is Amazon's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%AMAZON COM INC%') LIMIT 1",AMAZON COM INC is in the Consumer Discretionary sector.,"{""value"": ""Consumer Discretionary"", ""type"": ""text""}",5.0,0.8,llm_template_selection,,,"[{'stage': 'template_selection', 'tokens': {'prompt_tokens': 6557, 'completion_tokens': 369}, 'latency_ms': 4381, 'success': True, 'confidence': 0.95}]",11.9362,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many different fiscal year ends are represented?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,Which state has the most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 1
",state: CA | count: 123,"{""value"": ""CA"", ""type"": ""text""}",5.0,0.65,template,,,,0.01,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies filed 10-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-K'),Count: 563,"{""value"": 563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0045,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What is the most recent filing date in the dataset?,latest_filing_date,SELECT MAX(filed) AS latest_filing_date FROM sub,latest_filing_date: 2025-06-30 00:00:00,"{""value"": ""2025-06-30 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0156,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are in the Health Care sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%health care%'),There are 80 companies in the Health Care sector.,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,Which company has CIK 0000066740?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000066740' LIMIT 1,3M CO's CIK is unknown.,"{""value"": ""3M CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many financial facts have footnotes?,fact_count_with_footnotes,SELECT COUNT(*) AS fact_count FROM num WHERE footnote IS NOT NULL AND TRIM(CAST(footnote AS VARCHAR)) <> '',Count: 33959,"{""value"": 33959, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0126,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,What currency is used most frequently in the numerical data?,most_common_currency,"SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL GROUP BY 1 ORDER BY fact_count DESC LIMIT 1",currency: USD | fact_count: 14760135,"{""value"": ""USD"", ""type"": ""text""}",5.0,0.65,template,,,,0.032,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Delaware?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('DE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('DE'))
  )
",Count: 346,"{""value"": 349, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",3.0,0.7,template,,,,0.0264,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,Which sector has the most companies in our S&P 500 dataset?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,29.048,0.0,0.0,0.0,0.0
RUN_007,"06 Nov 2025, 1600 hours",simple,How many S&P 500 companies are in the Information Technology sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%information technology%'),There are 165 companies in the Information Technology sector.,"{""value"": 165, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 355}, 'latency_ms': 6331, 'success': True}]",6.3388,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What is Johnson & Johnson's return on equity (ROE) percentage?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: JOHNSON & JOHNSON | roe_percentage: 20.06,"{""value"": 20.06, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1.0}}",5.0,0.8,template,,,,0.2893,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Hong Kong dollars (HKD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('HKD'),Count: 140,"{""value"": 140, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0117,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,"How many facts use per-share units (per share, per unit)?",fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""absolute"": 100}}",5.0,0.7,template,,,,0.0153,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What is the total count of unique unit types in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 21, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0005,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Mexican pesos (MXN)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('MXN'),Count: 37,"{""value"": 37, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0147,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many facts use barrels as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('barrels'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0047,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Australian dollars (AUD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('AUD'),Count: 110,"{""value"": 110, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0123,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many facts use 'days' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('days'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0024,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What is the least common currency in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""14"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many facts are measured in Japanese yen (JPY)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 122, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many facts use square feet as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('square feet'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0023,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Swiss francs (CHF)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CHF'),Count: 218,"{""value"": 218, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0134,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many facts use percentage as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('pure'),Count: 50344,"{""value"": 50344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0133,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What is the most common non-monetary unit of measure?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""shares"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many facts are measured in British pounds (GBP)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 446, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.0,,,,,0.0005,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many facts use 'shares' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0183,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Euros (EUR)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('EUR'),Count: 37847,"{""value"": 37847, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0163,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many facts are denominated in Canadian dollars (CAD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CAD'),Count: 2926,"{""value"": 2926, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0149,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What is the second most common currency in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""14"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many different currencies are represented in the financial data?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies returned more than 50% of operating cash flow to shareholders?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 85, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies have free cash flow exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 45, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies issued new debt during the period?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What was Johnson & Johnson's acquisition spending?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 2.8, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies have negative operating cash flow?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 76, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What was Tesla's change in cash and cash equivalents?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 16352000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies spent more than $5 billion on acquisitions?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies have positive free cash flow?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 282, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies have EBITDA exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies reported foreign exchange gains/losses?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies have negative net income?,companies_negative_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'NetIncomeLoss'
  AND n.value < 0",Count: 0,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.85,template,,,,0.1204,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What was Johnson & Johnson's income tax expense?,latest_income_tax_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS income_tax_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'IncomeTaxExpenseBenefit'
      AND n.qtrs = 0
)
SELECT income_tax_expense, period_end
FROM latest_metric
WHERE rn = 1",income_tax_expense: -500000000.0 | period_end: 2023-06-30 00:00:00,"{""value"": 2621000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.8,template,,,,0.0562,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies reported depreciation and amortization expenses?,companies_depreciation_amortization_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'DepreciationAndAmortization'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 0,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.0784,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What was Tesla's other income (expense) in the latest period?,latest_other_income_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS other_income_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'OtherNonoperatingIncomeExpense'
      AND n.qtrs = 0
)
SELECT other_income_expense, period_end
FROM latest_metric
WHERE rn = 1",Could not find information for TESLA INC.,"{""value"": 12556000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.8,template,,,,0.0506,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies have positive operating income?,companies_positive_operating_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'OperatingIncomeLoss'
  AND n.value > 0",Count: 0,"{""value"": 375, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.85,template,,,,0.1178,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies reported research and development expenses?,companies_research_expense_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'ResearchAndDevelopmentExpense'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 7,"{""value"": 156, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",1.0,0.7,template,,,,0.1158,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies have working capital exceeding $50 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies report goodwill on their balance sheets?,companies_goodwill_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'Goodwill'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 3491,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.1233,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies have intangible assets exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies have negative stockholders' equity?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,"What is Tesla's property, plant and equipment value?",latest_property_plant_equipment,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS property_plant_equipment,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PropertyPlantAndEquipmentNet'
      AND n.qtrs = 0
)
SELECT property_plant_equipment, period_end
FROM latest_metric
WHERE rn = 1",property_plant_equipment: 35836000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 125000000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.65,template,,,,0.1384,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies have more liabilities than assets?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",1.0,0.0,,,,,0.0015,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies have current assets exceeding $100 billion?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%MASTERCARD INC%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",MASTERCARD INC has 0 matching records.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.85,llm_template_selection,,,,24.4841,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies have Return on Equity above 20%?,companies_return_on_equity_above_threshold,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 20",Count: 174,"{""value"": 175, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,1.4959,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies have gross margin above 50%?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,43.0468,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies have a debt-to-equity ratio above 1.0?,companies_debt_to_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('Liabilities','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND liabilities IS NOT NULL
  AND liabilities / equity > 1.0",Count: 236,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.85,template,,,,0.2055,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies have negative Return on Assets?,companies_negative_return_on_assets,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('NetIncomeLoss','Assets')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND assets <> 0 AND net_income IS NOT NULL AND net_income / assets < 0",Count: 0,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.85,template,,,,0.2043,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies have a current ratio above 2.0?,companies_current_ratio_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND current_liabilities <> 0
  AND current_assets / current_liabilities > 2.0",Count: 115,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",1.0,0.7,template,,,,0.2858,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies have positive Return on Equity in the latest period?,companies_positive_return_on_equity,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 0",Count: 433,"{""value"": 434, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,1.1913,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many annual (qtrs=0) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 0,Count: 5484928,"{""value"": 613954, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.7,template,,,,0.0298,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What is the second most frequent form type in submissions?,form_type_rank,"WITH form_counts AS (
    SELECT form, COUNT(*) AS filing_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM sub
    GROUP BY form
)
SELECT form, filing_count
FROM form_counts
WHERE rank = 1
LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many submissions are for fiscal period Q4?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q4'),Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many submissions are for fiscal period Q3?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q3'),Count: 5238,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many submissions are for fiscal period Q2?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q2'),Count: 5296,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many submissions have September fiscal year end (0930)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 25, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many submissions have June fiscal year end (0630)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 45, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many submissions have March fiscal year end (0331)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many submissions have December fiscal year end (1231)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 350, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many different form types are present in the submissions?,distinct_form_type_count,SELECT COUNT(DISTINCT form) AS form_type_count FROM sub,Count: 21,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 21}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many submissions have fiscal period FY (full year)?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('FY'),Count: 6476,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 500}",1.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many submissions have fiscal period Q1?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q1'),Count: 5664,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many submissions have fiscal year 2025?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2025,Count: 917,"{""value"": 50, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.75,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many submissions have fiscal year 2024?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2024,Count: 4167,"{""value"": 450, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.75,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What is the earliest filing date in the dataset?,earliest_filing_date,SELECT MIN(filed) AS earliest_filing_date FROM sub,earliest_filing_date: 2015-01-02 00:00:00,"{""value"": ""2015-01-02 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies filed 8-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('8-K'),Count: 112,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 112}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies filed 10-Q forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-Q'),Count: 543,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 543}",5.0,0.7,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many financial facts are reported with coreg (co-registrant) information?,fact_count_with_coreg,SELECT COUNT(*) AS fact_count FROM num WHERE coreg IS NOT NULL AND TRIM(coreg) <> '',Count: 1261087,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.7,template,,,,0.0148,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many XBRL tags are classified as 'string' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%string%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Debt' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%DEBT%',Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 26515}",1.0,0.85,template,,,,0.0172,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Equity' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%EQUITY%',Count: 0,"{""value"": 24563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.85,template,,,,0.0181,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Cash' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%CASH%',Count: 12,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 29232}",1.0,0.85,template,,,,0.0209,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What is the third most frequent XBRL tag in numerical data?,tag_nth_most_common,"WITH tag_counts AS (
    SELECT
        tag,
        COUNT(*) AS fact_count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    GROUP BY tag
)
SELECT tag, fact_count
FROM tag_counts
WHERE rank = 1
LIMIT 1",tag: RevenueFromContractWithCustomerExcludingAssessedTax | fact_count: 621672,"{""type"": ""text"", ""value"": ""Assets""}",1.0,0.65,template,,,,0.0395,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many numerical facts have zero values?,fact_count_zero_values,SELECT COUNT(*) AS fact_count FROM num WHERE value = 0,Count: 1427015,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 85000}",1.0,0.7,template,,,,0.0669,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many numerical facts have negative values?,fact_count_negative_values,SELECT COUNT(*) AS fact_count FROM num WHERE value < 0,Count: 2124201,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 125000}",1.0,0.7,template,,,,0.0613,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many XBRL tags are classified as 'per-share' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%per-share%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 6063}",1.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many XBRL tags have 'shares' as unit of measure in numerical data?,tag_count_by_unit,SELECT COUNT(DISTINCT tag) AS tag_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 949,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 949}",5.0,0.7,template,,,,0.0311,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many financial facts have duplicate values (dimhash populated)?,fact_count_dimhash_populated,SELECT COUNT(*) AS fact_count FROM num WHERE segments IS NOT NULL AND TRIM(segments) <> '',Count: 8738244,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 8738244}",5.0,0.7,template,,,,0.6717,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many different unit types (UOM) are present in the numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 8}",1.0,0.7,template,,,,0.015,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Liability' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%LIABILITY%',Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 11059}",1.0,0.7,template,,,,0.0168,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Asset' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%ASSET%',Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 40285}",1.0,0.7,template,,,,0.0196,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many XBRL tags contain the word 'Revenue' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%REVENUE%',Count: 0,"{""value"": 12221, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.85,template,,,,0.0194,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many XBRL tags are classified as 'monetary' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%monetary%'),Count: 454617,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 454617}",5.0,0.7,template,,,,0.003,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many XBRL tags have a debit-credit flag of 'Debit'?,tag_count_by_debit_credit,SELECT COUNT(*) AS tag_count FROM tag WHERE crdr IS NOT NULL AND UPPER(TRIM(crdr)) = CASE WHEN UPPER(TRIM('Debit')) LIKE 'D%' THEN 'D' WHEN UPPER(TRIM('Debit')) LIKE 'C%' THEN 'C' ELSE UPPER(TRIM('Debit')) END,Count: 224017,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 224017}",5.0,0.7,template,,,,0.0054,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What is Google's (Alphabet) return on equity (ROE)?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%ALPHABET INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: ALPHABET INC. | roe_percentage: 32.91,"{""value"": 32.91, ""type"": ""numeric"", ""tolerance"": {""absolute"": 0.5}}",5.0,0.8,template,,,,0.2692,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Georgia?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('GA')",Count: 22,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 17}",1.0,0.7,template,,,,0.0072,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Bermuda?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 2}",1.0,0.7,template,,,,0.0073,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Washington state?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('WA')",Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",5.0,0.7,template,,,,0.0126,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,Which state has the third most company headquarters?,state_with_most_headquarters,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT l.headquarters_state AS state, COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL
GROUP BY l.headquarters_state
ORDER BY count DESC
LIMIT 1",state: CA | count: 123,"{""value"": ""NY"", ""type"": ""text""}",1.0,0.65,template,,,,0.0075,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Massachusetts?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('MA')",Count: 31,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 27}",3.0,0.7,template,,,,0.007,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in the United Kingdom?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 2}",1.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in North Carolina?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NC')",Count: 20,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 13}",1.0,0.7,template,,,,0.006,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Ohio?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('OH')",Count: 24,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",3.0,0.7,template,,,,0.0062,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many different US states are represented in headquarters data?,distinct_headquarters_states,SELECT COUNT(DISTINCT stprba) AS state_count FROM sub WHERE stprba IS NOT NULL,Count: 44,"{""value"": 44, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many different countries are represented in the incorporation data?,distinct_incorporation_countries,SELECT COUNT(DISTINCT countryinc) AS country_count FROM sub WHERE countryinc IS NOT NULL,Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 16}",5.0,0.7,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Switzerland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 5}",5.0,0.7,template,,,,0.007,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Florida?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('FL')",Count: 26,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",1.0,0.7,template,,,,0.0066,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Illinois?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('IL')",Count: 42,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 35}",1.0,0.7,template,,,,0.0067,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,Which state has the second most company headquarters after California?,state_with_most_headquarters,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT l.headquarters_state AS state, COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL
GROUP BY l.headquarters_state
ORDER BY count DESC
LIMIT 1",state: CA | count: 123,"{""value"": 106, ""type"": ""text""}",1.0,0.65,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Canada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 3}",3.0,0.7,template,,,,0.0066,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Ireland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",1.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Nevada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('NV'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('NV'))
  )
",Count: 9,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 3}",1.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in Texas?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('TX')",Count: 81,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 67}",1.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are headquartered in New York?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NY')",Count: 69,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 61}",1.0,0.7,template,,,,0.0064,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,Which sector contains Johnson & Johnson?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%') LIMIT 1",JOHNSON & JOHNSON is in the Health Care sector.,"{""value"": ""Health Care"", ""type"": ""text""}",5.0,0.8,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many sectors have fewer than 25 companies?,sectors_below_threshold,"WITH sector_counts AS (
    SELECT gics_sector, COUNT(*) AS count
    FROM companies
    WHERE gics_sector IS NOT NULL
    GROUP BY gics_sector
)
SELECT COUNT(*) AS sector_count
FROM sector_counts
WHERE count < 25",Count: 4,"{""value"": 262, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.85,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many sectors have more than 50 companies?,sectors_above_threshold,"SELECT COUNT(DISTINCT gics_sector) as sector_count FROM (SELECT gics_sector, COUNT(*) as cnt FROM companies GROUP BY gics_sector HAVING cnt > 50) subq",Count: 6,"{""value"": 262, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.85,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,Which sector has the fewest companies?,sector_with_fewest_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL AND gics_sector != 'Other' GROUP BY gics_sector ORDER BY count ASC LIMIT 1",AT&T INC is in the Real Estate sector.,"{""type"": ""text"", ""value"": ""Real Estate""}",5.0,0.8,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are in the Communication Services sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%communication services%'),There are 17 companies in the Communication Services sector.,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are in the Real Estate sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%real estate%'),There are 3 companies in the Real Estate sector.,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are in the Consumer Staples sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer staples%'),There are 28 companies in the Consumer Staples sector.,"{""value"": 26, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",3.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are in the Consumer Discretionary sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer discretionary%'),There are 99 companies in the Consumer Discretionary sector.,"{""value"": 51, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are in the Energy sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%energy%'),There are 51 companies in the Energy sector.,"{""value"": 15, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are in the Materials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%materials%'),There are 41 companies in the Materials sector.,"{""value"": 22, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,Which sector has the second most companies?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""Other"", ""type"": ""text""}",1.0,0.8,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are in the Industrials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%industrials%'),There are 82 companies in the Industrials sector.,"{""value"": 28, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What was Meta's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%META PLATFORMS, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs = 0
ORDER BY l.period DESC
LIMIT 1",equity: 76793000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": -1865000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.8,template,,,,0.0644,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies reported cost of revenue in the latest period?,companies_reporting_cost_of_revenue,"WITH latest_cost AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'CostOfRevenue'
      AND n.qtrs = 0
)
SELECT COUNT(*) AS company_count
FROM latest_cost
WHERE rn = 1 AND value IS NOT NULL",Count: 2,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 450}",1.0,0.85,template,,,,0.0505,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies have total revenue exceeding $50 billion in the latest period?,companies_revenue_above_threshold,"WITH latest_filing AS (
    SELECT
        s.cik,
        s.adsh,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
),
latest_revenue AS (
    SELECT lf.cik, n.value AS revenue
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE lf.rn = 1
      AND n.tag IN ('Revenues', 'SalesRevenueNet')
      AND n.qtrs = 0
)
SELECT COUNT(*) AS count
FROM latest_revenue lr
JOIN companies c ON c.cik = lr.cik
WHERE lr.revenue > 50",Count: 3,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.85,template,,,,0.1643,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What was Walmart's most recent total liabilities?,latest_total_liabilities,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%WALMART INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS total_liabilities,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'Liabilities'
      AND n.qtrs = 0
)
SELECT total_liabilities, period_end
FROM latest_metric
WHERE rn = 1",Could not find information for WALMART INC.,"{""type"": ""text"", ""value"": ""180000000000.0"", ""tolerance"": {""absolute"": 1000000000.0}}",1.0,0.8,template,,,,0.0502,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies reported positive net income in the latest period?,companies_positive_net_income,"WITH latest_net_income AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND n.qtrs = 0
)
SELECT COUNT(*) AS company_count
FROM latest_net_income
WHERE rn = 1 AND value > 0",Count: 11,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 10}",5.0,0.85,template,,,,0.1027,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What was Johnson & Johnson's most recent gross profit?,latest_gross_profit,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS gross_profit,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'GrossProfit'
      AND n.qtrs = 0
)
SELECT gross_profit, period_end
FROM latest_metric
WHERE rn = 1",Could not find information for JOHNSON.,"{""type"": ""text"", ""value"": ""60000000000.0"", ""tolerance"": {""absolute"": 1000000000.0}}",1.0,0.8,template,,,,0.0494,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What was Tesla's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs = 0
ORDER BY l.period DESC
LIMIT 1",equity: 74653000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 74653000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.0835,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies have 'LLC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%LLC%'),Count: 5,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 5}",5.0,0.7,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,Which company has CIK 0000019617?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000019617' LIMIT 1,JPMORGAN CHASE & CO's CIK is unknown.,"{""value"": ""JPMORGAN CHASE & CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies have 'INC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%INC%'),Count: 459,"{""value"": 459, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,Which company has CIK 0000050863?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000050863' LIMIT 1,INTEL CORP's CIK is unknown.,"{""value"": ""INTEL CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0042,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What is Walmart Inc.'s CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%WALMART INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",WALMART INC.'s CIK is 0000104169.,"{""value"": ""0000104169"", ""type"": ""text""}",5.0,0.8,template,,,,0.0103,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies have 'CORP' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%CORP%'),Count: 180,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What is Procter & Gamble's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%PROCTER & GAMBLE CO%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",PROCTER & GAMBLE CO's CIK is 0000080424.,"{""value"": ""0000080424"", ""type"": ""text""}",5.0,0.8,template,,,,0.0034,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,Which company has the longest company name in the dataset?,company_with_longest_name,SELECT name FROM companies ORDER BY LENGTH(name) DESC LIMIT 1,"name: CHARLES RIVER LABORATORIES INTERNATIONAL, INC.","{""type"": ""text"", ""value"": ""CHARLES RIVER LABORATORIES INTERNATIONAL, INC.""}",5.0,0.65,template,,,,0.0024,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What is Berkshire Hathaway's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%BERKSHIRE HATHAWAY INC%') LIMIT 1",BERKSHIRE HATHAWAY INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,llm_template_selection,,,"[{'stage': 'template_selection', 'tokens': {'prompt_tokens': 6548, 'completion_tokens': 431}, 'latency_ms': 4663, 'success': True, 'confidence': 0.96}]",17.8567,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many quarterly (qtrs=1) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 1,Count: 3566310,"{""value"": 3566310, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0271,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are in the Utilities sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%utilities%'),There are 20 companies in the Utilities sector.,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What is Tesla's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1","TESLA, INC.'s CIK is 0001318605.","{""value"": ""0001318605"", ""type"": ""text""}",5.0,0.8,template,,,,0.0021,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many financial facts are denominated in USD?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.023,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,Which form type appears most frequently in submissions?,most_common_form_type,"SELECT form, COUNT(*) AS filing_count FROM sub GROUP BY form ORDER BY filing_count DESC LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.002,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many unique companies are represented in the dataset?,total_company_count,SELECT COUNT(DISTINCT cik) AS company_count FROM companies,Count: 589,"{""value"": 589, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What is the earliest period date in the financial data?,earliest_period_date,SELECT MIN(period) AS earliest_period FROM sub,earliest_period: 2014-05-31 00:00:00,"{""value"": ""2014-05-31 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies have international (non-US) incorporation?,international_incorporation_count,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS company_count
FROM latest_submission
WHERE rn = 1 AND UPPER(countryinc) <> 'US'",Count: 34,"{""value"": 34, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0164,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What is Amazon's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%AMAZON COM INC%') LIMIT 1",AMAZON COM INC is in the Consumer Discretionary sector.,"{""value"": ""Consumer Discretionary"", ""type"": ""text""}",5.0,0.8,llm_template_selection,,,"[{'stage': 'template_selection', 'tokens': {'prompt_tokens': 6550, 'completion_tokens': 245}, 'latency_ms': 5930, 'success': True, 'confidence': 0.93}]",5.951,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many different fiscal year ends are represented?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.7,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,Which state has the most company headquarters?,state_with_most_headquarters,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT l.headquarters_state AS state, COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL
GROUP BY l.headquarters_state
ORDER BY count DESC
LIMIT 1",state: CA | count: 123,"{""value"": ""CA"", ""type"": ""text""}",5.0,0.65,template,,,,0.0077,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies filed 10-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-K'),Count: 563,"{""value"": 563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0022,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What is the most recent filing date in the dataset?,latest_filing_date,SELECT MAX(filed) AS latest_filing_date FROM sub,latest_filing_date: 2025-06-30 00:00:00,"{""value"": ""2025-06-30 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are in the Health Care sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%health care%'),There are 80 companies in the Health Care sector.,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,Which company has CIK 0000066740?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000066740' LIMIT 1,3M CO's CIK is unknown.,"{""value"": ""3M CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many financial facts have footnotes?,fact_count_with_footnotes,SELECT COUNT(*) AS fact_count FROM num WHERE footnote IS NOT NULL AND TRIM(CAST(footnote AS VARCHAR)) <> '',Count: 33959,"{""value"": 33959, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0163,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,What currency is used most frequently in the numerical data?,most_common_currency,"SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL GROUP BY 1 ORDER BY fact_count DESC LIMIT 1",currency: USD | fact_count: 14760135,"{""value"": ""USD"", ""type"": ""text""}",5.0,0.65,template,,,,0.0469,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many companies are incorporated in Delaware?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('DE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('DE'))
  )
",Count: 346,"{""value"": 349, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",3.0,0.7,template,,,,0.0285,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,Which sector has the most companies in our S&P 500 dataset?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""Other"", ""type"": ""text""}",1.0,0.8,template,,,,0.0177,0.0,0.0,0.0,0.0
RUN_006,"06 Nov 2025, 1600 hours",simple,How many S&P 500 companies are in the Information Technology sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%information technology%'),There are 165 companies in the Information Technology sector.,"{""value"": 165, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,20.8104,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What is Johnson & Johnson's return on equity (ROE) percentage?,,,"An error occurred while processing your question: Binder Error: Referenced column ""cik"" not found in FROM clause!
Candidate bindings: ""coreg""

LINE 1: ... 1), latest_ni AS (SELECT val as ni, ddate FROM num WHERE cik = (SELECT cik FROM company_cik) AND tag = 'NetIncomeLoss...
                                                                     ^","{""value"": 16.8, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1.0}}",1.0,0.0,,,,,0.0029,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many facts are denominated in Hong Kong dollars (HKD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('HKD'),Count: 140,"{""value"": 140, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0148,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,"How many facts use per-share units (per share, per unit)?",fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""absolute"": 100}}",5.0,0.7,template,,,,0.0153,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What is the total count of unique unit types in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 21, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many facts are denominated in Mexican pesos (MXN)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('MXN'),Count: 37,"{""value"": 37, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.014,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many facts use barrels as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('barrels'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0021,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many facts are denominated in Australian dollars (AUD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('AUD'),Count: 110,"{""value"": 110, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.011,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many facts use 'days' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('days'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What is the least common currency in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""14"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many facts are measured in Japanese yen (JPY)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 122, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many facts use square feet as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('square feet'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many facts are denominated in Swiss francs (CHF)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CHF'),Count: 218,"{""value"": 218, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0127,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many facts use percentage as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('pure'),Count: 50344,"{""value"": 50344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0121,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What is the most common non-monetary unit of measure?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""shares"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many facts are measured in British pounds (GBP)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 446, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.0,,,,,0.0005,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many facts use 'shares' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0177,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many facts are denominated in Euros (EUR)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('EUR'),Count: 37847,"{""value"": 37847, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.019,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many facts are denominated in Canadian dollars (CAD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CAD'),Count: 2926,"{""value"": 2926, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0127,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What is the second most common currency in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""14"", ""type"": ""text""}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many different currencies are represented in the financial data?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies returned more than 50% of operating cash flow to shareholders?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 85, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies have free cash flow exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 45, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies issued new debt during the period?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What was Johnson & Johnson's acquisition spending?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 2.8, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies have negative operating cash flow?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 76, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What was Tesla's change in cash and cash equivalents?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 16352000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies spent more than $5 billion on acquisitions?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies have positive free cash flow?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 282, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies have EBITDA exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies reported foreign exchange gains/losses?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies have negative net income?,companies_negative_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'NetIncomeLoss'
  AND n.value < 0",Count: 0,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.85,template,,,,0.1103,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What was Johnson & Johnson's income tax expense?,latest_income_tax_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS income_tax_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'IncomeTaxExpenseBenefit'
      AND n.qtrs = 0
)
SELECT income_tax_expense, period_end
FROM latest_metric
WHERE rn = 1",income_tax_expense: -500000000.0 | period_end: 2023-06-30 00:00:00,"{""value"": 2621000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.8,template,,,,0.0601,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies reported depreciation and amortization expenses?,companies_depreciation_amortization_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'DepreciationAndAmortization'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 0,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.0696,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What was Tesla's other income (expense) in the latest period?,latest_other_income_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS other_income_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'OtherNonoperatingIncomeExpense'
      AND n.qtrs = 0
)
SELECT other_income_expense, period_end
FROM latest_metric
WHERE rn = 1",Could not find information for TESLA INC.,"{""value"": 12556000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.8,template,,,,0.0716,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies have positive operating income?,companies_positive_operating_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'OperatingIncomeLoss'
  AND n.value > 0",Count: 0,"{""value"": 375, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.85,template,,,,0.0966,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies reported research and development expenses?,companies_research_expense_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'ResearchAndDevelopmentExpense'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 7,"{""value"": 156, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",1.0,0.7,template,,,,0.106,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies have working capital exceeding $50 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies report goodwill on their balance sheets?,companies_goodwill_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'Goodwill'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 3491,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.1075,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies have intangible assets exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies have negative stockholders' equity?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,"What is Tesla's property, plant and equipment value?",latest_property_plant_equipment,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS property_plant_equipment,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PropertyPlantAndEquipmentNet'
      AND n.qtrs = 0
)
SELECT property_plant_equipment, period_end
FROM latest_metric
WHERE rn = 1",property_plant_equipment: 35836000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 125000000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.65,template,,,,0.1845,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies have more liabilities than assets?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",1.0,0.0,,,,,0.0008,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies have current assets exceeding $100 billion?,,,An error occurred while processing your question: invalid literal for int() with base 10: 'MASTERCARD INC',"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.0,,,,,25.3491,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies have Return on Equity above 20%?,companies_return_on_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('NetIncomeLoss','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND net_income IS NOT NULL
  AND (net_income / equity) * 100 > 20",Count: 0,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",3.0,0.85,template,,,,0.2322,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies have gross margin above 50%?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,51.3288,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies have a debt-to-equity ratio above 1.0?,companies_debt_to_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('Liabilities','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND liabilities IS NOT NULL
  AND liabilities / equity > 1",Count: 236,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.85,template,,,,0.1578,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies have negative Return on Assets?,companies_negative_return_on_assets,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('NetIncomeLoss','Assets')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND assets <> 0 AND net_income IS NOT NULL AND net_income / assets < 0",Count: 0,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.85,template,,,,0.1321,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies have a current ratio above 2.0?,companies_current_ratio_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND current_liabilities <> 0
  AND current_assets / current_liabilities > 2",Count: 115,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",1.0,0.7,template,,,,0.1532,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies have positive Return on Equity in the latest period?,companies_positive_return_on_equity,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('NetIncomeLoss','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND net_income IS NOT NULL AND net_income / equity > 0",Count: 1,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",3.0,0.85,template,,,,0.1507,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many annual (qtrs=0) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 0,Count: 5484928,"{""value"": 613954, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.7,template,,,,0.0272,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What is the second most frequent form type in submissions?,form_type_rank,"WITH form_counts AS (
    SELECT form, COUNT(*) AS filing_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM sub
    GROUP BY form
)
SELECT form, filing_count
FROM form_counts
WHERE rank = 1
LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many submissions are for fiscal period Q4?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q4'),Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many submissions are for fiscal period Q3?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q3'),Count: 5238,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many submissions are for fiscal period Q2?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q2'),Count: 5296,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many submissions have September fiscal year end (0930)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 25, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many submissions have June fiscal year end (0630)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 45, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many submissions have March fiscal year end (0331)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many submissions have December fiscal year end (1231)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 350, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many different form types are present in the submissions?,distinct_form_type_count,SELECT COUNT(DISTINCT form) AS form_type_count FROM sub,Count: 21,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 21}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many submissions have fiscal period FY (full year)?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('FY'),Count: 6476,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 500}",1.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many submissions have fiscal period Q1?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q1'),Count: 5664,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many submissions have fiscal year 2025?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2025,Count: 917,"{""value"": 50, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.75,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many submissions have fiscal year 2024?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2024,Count: 4167,"{""value"": 450, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.75,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What is the earliest filing date in the dataset?,earliest_filing_date,SELECT MIN(filed) AS earliest_filing_date FROM sub,earliest_filing_date: 2015-01-02 00:00:00,"{""value"": ""2015-01-02 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies filed 8-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('8-K'),Count: 112,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 112}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies filed 10-Q forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-Q'),Count: 543,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 543}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many financial facts are reported with coreg (co-registrant) information?,fact_count_with_coreg,SELECT COUNT(*) AS fact_count FROM num WHERE coreg IS NOT NULL AND TRIM(coreg) <> '',Count: 1261087,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.7,template,,,,0.0146,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many XBRL tags are classified as 'string' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%string%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Debt' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%DEBT%',Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 26515}",1.0,0.85,template,,,,0.0173,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Equity' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%EQUITY%',Count: 0,"{""value"": 24563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.85,template,,,,0.0167,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Cash' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%CASH%',Count: 12,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 29232}",1.0,0.85,template,,,,0.0194,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What is the third most frequent XBRL tag in numerical data?,tag_nth_most_common,"WITH tag_counts AS (
    SELECT
        tag,
        COUNT(*) AS fact_count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    GROUP BY tag
)
SELECT tag, fact_count
FROM tag_counts
WHERE rank = 1
LIMIT 1",tag: RevenueFromContractWithCustomerExcludingAssessedTax | fact_count: 621672,"{""type"": ""text"", ""value"": ""Assets""}",1.0,0.65,template,,,,0.0355,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many numerical facts have zero values?,fact_count_zero_values,SELECT COUNT(*) AS fact_count FROM num WHERE value = 0,Count: 1427015,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 85000}",1.0,0.7,template,,,,0.0626,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many numerical facts have negative values?,fact_count_negative_values,SELECT COUNT(*) AS fact_count FROM num WHERE value < 0,Count: 2124201,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 125000}",1.0,0.7,template,,,,0.0639,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many XBRL tags are classified as 'per-share' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%per-share%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 6063}",1.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many XBRL tags have 'shares' as unit of measure in numerical data?,tag_count_by_unit,SELECT COUNT(DISTINCT tag) AS tag_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 949,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 949}",5.0,0.7,template,,,,0.0333,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many financial facts have duplicate values (dimhash populated)?,,,"An error occurred while processing your question: Binder Error: Referenced column ""dimhash"" not found in FROM clause!
Candidate bindings: ""adsh"", ""ddate"", ""segments""

LINE 1: SELECT COUNT(*) AS fact_count FROM num WHERE dimhash IS NOT NULL AND TRIM(dimhash) <> ''
                                                     ^","{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 45000}",1.0,0.0,,,,,0.0011,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many different unit types (UOM) are present in the numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 8}",1.0,0.7,template,,,,0.0123,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Liability' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%LIABILITY%',Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 11059}",1.0,0.7,template,,,,0.0179,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Asset' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%ASSET%',Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 40285}",1.0,0.7,template,,,,0.0194,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Revenue' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%REVENUE%',Count: 0,"{""value"": 12221, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.85,template,,,,0.0182,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many XBRL tags are classified as 'monetary' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%monetary%'),Count: 454617,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 454617}",5.0,0.7,template,,,,0.0026,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many XBRL tags have a debit-credit flag of 'Debit'?,,,"An error occurred while processing your question: Binder Error: Referenced column ""debitcredit"" not found in FROM clause!
Candidate bindings: ""abstract"", ""doc"", ""iord"", ""crdr"", ""source_period""

LINE 1: SELECT COUNT(*) AS tag_count FROM tag WHERE debitcredit IS NOT NULL AND UPPER(debitcredit) = UPPER(...
                                                    ^","{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.0,,,,,0.0009,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What is Google's (Alphabet) return on equity (ROE)?,,,"An error occurred while processing your question: Binder Error: Referenced column ""cik"" not found in FROM clause!
Candidate bindings: ""coreg""

LINE 1: ... 1), latest_ni AS (SELECT val as ni, ddate FROM num WHERE cik = (SELECT cik FROM company_cik) AND tag = 'NetIncomeLoss...
                                                                     ^","{""value"": 15.0, ""type"": ""numeric""}",1.0,0.0,,,,,0.0047,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are headquartered in Georgia?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('GA')",Count: 22,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 17}",1.0,0.7,template,,,,0.0064,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are incorporated in Bermuda?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 2}",1.0,0.7,template,,,,0.0062,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are headquartered in Washington state?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('WA')",Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",5.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,Which state has the third most company headquarters?,state_with_most_headquarters,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT l.headquarters_state AS state, COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL
GROUP BY l.headquarters_state
ORDER BY count DESC
LIMIT 1",state: CA | count: 123,"{""value"": ""NY"", ""type"": ""text""}",1.0,0.65,template,,,,0.0067,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are headquartered in Massachusetts?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('MA')",Count: 31,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 27}",3.0,0.7,template,,,,0.0063,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are incorporated in the United Kingdom?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 2}",1.0,0.7,template,,,,0.0074,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are headquartered in North Carolina?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NC')",Count: 20,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 13}",1.0,0.7,template,,,,0.0072,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are headquartered in Ohio?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('OH')",Count: 24,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",3.0,0.7,template,,,,0.0066,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many different US states are represented in headquarters data?,distinct_headquarters_states,SELECT COUNT(DISTINCT stprba) AS state_count FROM sub WHERE stprba IS NOT NULL,Count: 44,"{""value"": 44, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many different countries are represented in the incorporation data?,distinct_incorporation_countries,SELECT COUNT(DISTINCT countryinc) AS country_count FROM sub WHERE countryinc IS NOT NULL,Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 16}",5.0,0.7,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are incorporated in Switzerland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 5}",5.0,0.7,template,,,,0.0086,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are headquartered in Florida?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('FL')",Count: 26,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",1.0,0.7,template,,,,0.0074,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are headquartered in Illinois?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('IL')",Count: 42,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 35}",1.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,Which state has the second most company headquarters after California?,state_with_most_headquarters,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT l.headquarters_state AS state, COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL
GROUP BY l.headquarters_state
ORDER BY count DESC
LIMIT 1",state: CA | count: 123,"{""value"": 106, ""type"": ""text""}",1.0,0.65,template,,,,0.0087,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are incorporated in Canada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 3}",3.0,0.7,template,,,,0.0071,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are incorporated in Ireland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",1.0,0.7,template,,,,0.007,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are incorporated in Nevada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('NV'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('NV'))
  )
",Count: 9,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 3}",1.0,0.7,template,,,,0.0074,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are headquartered in Texas?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('TX')",Count: 81,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 67}",1.0,0.7,template,,,,0.008,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are headquartered in New York?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NY')",Count: 69,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 61}",1.0,0.7,template,,,,0.0075,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,Which sector contains Johnson & Johnson?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%') LIMIT 1",JOHNSON & JOHNSON is in the Health Care sector.,"{""value"": ""Health Care"", ""type"": ""text""}",5.0,0.8,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many sectors have fewer than 25 companies?,sectors_below_threshold,"WITH sector_counts AS (
    SELECT gics_sector, COUNT(*) AS count
    FROM companies
    WHERE gics_sector IS NOT NULL
    GROUP BY gics_sector
)
SELECT COUNT(*) AS sector_count
FROM sector_counts
WHERE count < 25",Count: 4,"{""value"": 262, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.85,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many sectors have more than 50 companies?,sectors_above_threshold,"SELECT COUNT(DISTINCT gics_sector) as sector_count FROM (SELECT gics_sector, COUNT(*) as cnt FROM companies GROUP BY gics_sector HAVING cnt > 50) subq",Count: 6,"{""value"": 262, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.85,template,,,,0.003,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,Which sector has the fewest companies?,sector_with_fewest_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL AND gics_sector != 'Other' GROUP BY gics_sector ORDER BY count ASC LIMIT 1",AT&T INC is in the Real Estate sector.,"{""type"": ""text"", ""value"": ""Real Estate""}",5.0,0.8,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are in the Communication Services sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%communication services%'),There are 17 companies in the Communication Services sector.,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are in the Real Estate sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%real estate%'),There are 3 companies in the Real Estate sector.,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are in the Consumer Staples sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer staples%'),There are 28 companies in the Consumer Staples sector.,"{""value"": 26, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",3.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are in the Consumer Discretionary sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer discretionary%'),There are 99 companies in the Consumer Discretionary sector.,"{""value"": 51, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are in the Energy sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%energy%'),There are 51 companies in the Energy sector.,"{""value"": 15, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are in the Materials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%materials%'),There are 41 companies in the Materials sector.,"{""value"": 22, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,Which sector has the second most companies?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""Other"", ""type"": ""text""}",1.0,0.8,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are in the Industrials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%industrials%'),There are 82 companies in the Industrials sector.,"{""value"": 28, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What was Meta's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%META PLATFORMS, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs = 0
ORDER BY l.period DESC
LIMIT 1",equity: 76793000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": -1865000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.8,template,,,,0.0662,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies reported cost of revenue in the latest period?,companies_reporting_cost_of_revenue,"WITH latest_cost AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'CostOfRevenue'
      AND n.qtrs = 0
)
SELECT COUNT(*) AS company_count
FROM latest_cost
WHERE rn = 1 AND value IS NOT NULL",Count: 2,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 450}",1.0,0.85,template,,,,0.066,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies have total revenue exceeding $50 billion in the latest period?,companies_revenue_above_threshold,"WITH latest_filing AS (
    SELECT
        s.cik,
        s.adsh,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
),
latest_revenue AS (
    SELECT lf.cik, n.value AS revenue
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE lf.rn = 1
      AND n.tag IN ('Revenues', 'SalesRevenueNet')
      AND n.qtrs = 0
)
SELECT COUNT(*) AS count
FROM latest_revenue lr
JOIN companies c ON c.cik = lr.cik
WHERE lr.revenue > 50000000000",Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.85,template,,,,0.1619,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What was Walmart's most recent total liabilities?,latest_total_liabilities,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%WALMART INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS total_liabilities,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'Liabilities'
      AND n.qtrs = 0
)
SELECT total_liabilities, period_end
FROM latest_metric
WHERE rn = 1",Could not find information for WALMART INC.,"{""type"": ""text"", ""value"": ""180000000000.0"", ""tolerance"": {""absolute"": 1000000000.0}}",1.0,0.8,template,,,,0.0503,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies reported positive net income in the latest period?,companies_positive_net_income,"WITH latest_net_income AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND n.qtrs = 0
)
SELECT COUNT(*) AS company_count
FROM latest_net_income
WHERE rn = 1 AND value > 0",Count: 10,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 10}",5.0,0.85,template,,,,0.1393,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What was Johnson & Johnson's most recent gross profit?,latest_gross_profit,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS gross_profit,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'GrossProfit'
      AND n.qtrs = 0
)
SELECT gross_profit, period_end
FROM latest_metric
WHERE rn = 1",Could not find information for JOHNSON.,"{""type"": ""text"", ""value"": ""60000000000.0"", ""tolerance"": {""absolute"": 1000000000.0}}",1.0,0.8,template,,,,0.057,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What was Tesla's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs = 0
ORDER BY l.period DESC
LIMIT 1",equity: 74653000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 74653000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.252,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies have 'LLC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%LLC%'),Count: 5,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 5}",5.0,0.7,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,Which company has CIK 0000019617?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000019617' LIMIT 1,JPMORGAN CHASE & CO's CIK is unknown.,"{""value"": ""JPMORGAN CHASE & CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0006,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies have 'INC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%INC%'),Count: 459,"{""value"": 459, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,Which company has CIK 0000050863?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000050863' LIMIT 1,INTEL CORP's CIK is unknown.,"{""value"": ""INTEL CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0006,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What is Walmart Inc.'s CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%WALMART INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",WALMART INC.'s CIK is 0000104169.,"{""value"": ""0000104169"", ""type"": ""text""}",5.0,0.8,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies have 'CORP' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%CORP%'),Count: 180,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0067,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What is Procter & Gamble's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%PROCTER & GAMBLE CO%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",PROCTER & GAMBLE CO's CIK is 0000080424.,"{""value"": ""0000080424"", ""type"": ""text""}",5.0,0.8,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,Which company has the longest company name in the dataset?,company_with_longest_name,SELECT name FROM companies ORDER BY LENGTH(name) DESC LIMIT 1,"name: CHARLES RIVER LABORATORIES INTERNATIONAL, INC.","{""type"": ""text"", ""value"": ""CHARLES RIVER LABORATORIES INTERNATIONAL, INC.""}",5.0,0.65,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What is Berkshire Hathaway's GICS sector?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%BERKSHIRE HATHAWAY INC%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",BERKSHIRE HATHAWAY INC's CIK is 0001067983.,"{""value"": ""Financials"", ""type"": ""text""}",1.0,0.8,llm_template_selection,,,"[{'stage': 'template_selection', 'tokens': {'prompt_tokens': 6191, 'completion_tokens': 432}, 'latency_ms': 6232, 'success': True, 'confidence': 0.92}]",6.2418,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many quarterly (qtrs=1) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 1,Count: 3566310,"{""value"": 3566310, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0253,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are in the Utilities sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%utilities%'),There are 20 companies in the Utilities sector.,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What is Tesla's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1","TESLA, INC.'s CIK is 0001318605.","{""value"": ""0001318605"", ""type"": ""text""}",5.0,0.8,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many financial facts are denominated in USD?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0166,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,Which form type appears most frequently in submissions?,most_common_form_type,"SELECT form, COUNT(*) AS filing_count FROM sub GROUP BY form ORDER BY filing_count DESC LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many unique companies are represented in the dataset?,total_company_count,SELECT COUNT(DISTINCT cik) AS company_count FROM companies,Count: 589,"{""value"": 589, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What is the earliest period date in the financial data?,earliest_period_date,SELECT MIN(period) AS earliest_period FROM sub,earliest_period: 2014-05-31 00:00:00,"{""value"": ""2014-05-31 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies have international (non-US) incorporation?,international_incorporation_count,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS company_count
FROM latest_submission
WHERE rn = 1 AND UPPER(countryinc) <> 'US'",Count: 34,"{""value"": 34, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0092,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What is Amazon's GICS sector?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%AMAZON COM INC%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",AMAZON COM INC's CIK is 0001018724.,"{""value"": ""Consumer Discretionary"", ""type"": ""text""}",1.0,0.8,llm_template_selection,,,"[{'stage': 'template_selection', 'tokens': {'prompt_tokens': 6193, 'completion_tokens': 301}, 'latency_ms': 4629, 'success': True, 'confidence': 0.93}]",4.671,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many different fiscal year ends are represented?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.7,template,,,,0.0033,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,Which state has the most company headquarters?,state_with_most_headquarters,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT l.headquarters_state AS state, COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL
GROUP BY l.headquarters_state
ORDER BY count DESC
LIMIT 1",state: CA | count: 123,"{""value"": ""CA"", ""type"": ""text""}",5.0,0.65,template,,,,0.009,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies filed 10-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-K'),Count: 563,"{""value"": 563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What is the most recent filing date in the dataset?,latest_filing_date,SELECT MAX(filed) AS latest_filing_date FROM sub,latest_filing_date: 2025-06-30 00:00:00,"{""value"": ""2025-06-30 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0047,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are in the Health Care sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%health care%'),There are 80 companies in the Health Care sector.,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,Which company has CIK 0000066740?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000066740' LIMIT 1,3M CO's CIK is unknown.,"{""value"": ""3M CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many financial facts have footnotes?,fact_count_with_footnotes,SELECT COUNT(*) AS fact_count FROM num WHERE footnote IS NOT NULL AND TRIM(CAST(footnote AS VARCHAR)) <> '',Count: 33959,"{""value"": 33959, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0132,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,What currency is used most frequently in the numerical data?,most_common_currency,"SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL GROUP BY 1 ORDER BY fact_count DESC LIMIT 1",currency: USD | fact_count: 14760135,"{""value"": ""USD"", ""type"": ""text""}",5.0,0.65,template,,,,22.9523,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many companies are incorporated in Delaware?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('DE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('DE'))
  )
",Count: 346,"{""value"": 349, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",3.0,0.9,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1490, 'completion_tokens': 470}, 'latency_ms': 6225, 'success': True}]",6.2713,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,Which sector has the most companies in our S&P 500 dataset?,,,An error occurred while processing your question: invalid literal for int() with base 10: 'Financials',"{""value"": ""Other"", ""type"": ""text""}",1.0,0.0,,,,,6.5595,0.0,0.0,0.0,0.0
RUN_004,"06 Nov 2025, 1500 hours",simple,How many S&P 500 companies are in the Information Technology sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%information technology%'),There are 165 companies in the Information Technology sector.,"{""value"": 165, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 294}, 'latency_ms': 6027, 'success': True}]",6.0452,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What is Johnson & Johnson's return on equity (ROE) percentage?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: JOHNSON & JOHNSON | roe_percentage: 20.06,"{""value"": 20.06, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1.0}}",5.0,0.8,template,,,,0.2589,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many facts are denominated in Hong Kong dollars (HKD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('HKD'),Count: 140,"{""value"": 140, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0109,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,"How many facts use per-share units (per share, per unit)?",fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""absolute"": 100}}",5.0,0.7,template,,,,0.0148,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What is the total count of unique unit types in the dataset?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 49, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0137,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many facts are denominated in Mexican pesos (MXN)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('MXN'),Count: 37,"{""value"": 37, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0073,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many facts use barrels as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('barrels'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0022,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many facts are denominated in Australian dollars (AUD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('AUD'),Count: 110,"{""value"": 110, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0118,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many facts use 'days' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('days'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What is the least common currency in the dataset?,least_common_currency,"WITH currency_counts AS (SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) ASC, UPPER(TRIM(uom))) AS currency_rank FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3 GROUP BY 1) SELECT currency, fact_count FROM currency_counts WHERE currency_rank = 1",currency: COP | fact_count: 1,"{""value"": ""COP"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0306,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many facts are measured in Japanese yen (JPY)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('JPY'),Count: 122,"{""value"": 122, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.015,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many facts use square feet as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('square feet'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0022,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many facts are denominated in Swiss francs (CHF)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CHF'),Count: 218,"{""value"": 218, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0299,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many facts use percentage as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('pure'),Count: 50344,"{""value"": 50344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0182,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What is the most common non-monetary unit of measure?,most_common_non_monetary_unit,"WITH unit_counts AS (
    SELECT UPPER(TRIM(uom)) AS unit, COUNT(*) AS cnt,
           ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    WHERE uom IS NOT NULL
      AND LENGTH(TRIM(uom)) <> 3
    GROUP BY 1
)
SELECT unit, cnt FROM unit_counts WHERE rank = 1",unit: SHARES | cnt: 642330,"{""value"": ""SHARES"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0308,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many facts are measured in British pounds (GBP)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('GBP'),Count: 446,"{""value"": 446, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0153,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many facts use 'shares' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0204,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many facts are denominated in Euros (EUR)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('EUR'),Count: 37847,"{""value"": 37847, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0339,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many facts are denominated in Canadian dollars (CAD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CAD'),Count: 2926,"{""value"": 2926, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0143,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What is the second most common currency in the dataset?,second_most_common_currency,"WITH currency_counts AS (SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS currency_rank FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3 GROUP BY 1) SELECT currency, fact_count FROM currency_counts WHERE currency_rank = 2",currency: EUR | fact_count: 37847,"{""value"": ""EUR"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0331,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many different currencies are represented in the financial data?,distinct_currency_count,SELECT COUNT(DISTINCT UPPER(TRIM(uom))) AS currency_count FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3,Count: 27,"{""value"": 27, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0215,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies returned more than 50% of operating cash flow to shareholders?,companies_shareholder_return_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), payout_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'PaymentsOfDividends' THEN n.value END) AS dividends,
        MAX(CASE WHEN n.tag = 'PaymentsForRepurchaseOfCommonStock' THEN n.value END) AS buybacks,
        MAX(CASE WHEN n.tag = 'NetCashProvidedByUsedInOperatingActivities' THEN n.value END) AS operating_cash_flow
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('PaymentsOfDividends','PaymentsForRepurchaseOfCommonStock','NetCashProvidedByUsedInOperatingActivities')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM payout_metrics
WHERE operating_cash_flow IS NOT NULL AND operating_cash_flow <> 0
  AND (COALESCE(dividends,0) + COALESCE(buybacks,0)) / operating_cash_flow > (CASE WHEN 0.5 > 1 THEN 0.5 / 100.0 ELSE 0.5 END)",Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,template,,,,0.1746,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies have free cash flow exceeding $10 billion?,companies_free_cash_flow_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value > 10000000000.0",Count: 11,"{""value"": 11, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,template,,,,0.1308,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies issued new debt during the period?,companies_new_debt_issued,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ProceedsFromIssuanceOfLongTermDebt'
  AND n.value > 0",Count: 215,"{""value"": 215, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.1059,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What was Johnson & Johnson's acquisition spending?,company_acquisition_spending,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS acquisition_spending,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K', '10-K/A')
      AND n.tag = 'PaymentsToAcquireBusinessesNetOfCashAcquired'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT acquisition_spending, period_end
FROM latest_metric
WHERE rn = 1
",acquisition_spending: 15146000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 15146000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",5.0,0.65,template,,,,0.2247,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies have negative operating cash flow?,companies_negative_operating_cash_flow,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value < 0",Count: 93,"{""value"": 93, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.1149,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What was Tesla's change in cash and cash equivalents?,companies_change_in_cash,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS change_in_cash,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
      AND n.qtrs IN (0,4)
)
SELECT change_in_cash, period_end
FROM latest_metric
WHERE rn = 1",change_in_cash: 13256000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 14923000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.85,template,,,,0.105,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies spent more than $5 billion on acquisitions?,companies_acquisition_spending_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'PaymentsToAcquireBusinessesNetOfCashAcquired'
  AND ABS(n.value) > 5000000000.0",Count: 7,"{""value"": 7, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.7,template,,,,0.1061,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies have positive free cash flow?,companies_positive_free_cash_flow,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value > 0",Count: 525,"{""value"": 525, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.107,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies have EBITDA exceeding $10 billion?,companies_ebitda_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh, period
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K', '10-K/A')
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('OperatingIncomeLoss',
        'OperatingIncomeLoss1',
        'OperatingProfitLoss',
        'EarningsBeforeInterestAndTaxes',
        'IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments',
        'IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest') THEN n.value END) AS operating_income,
        MAX(CASE WHEN n.tag IN ('DepreciationAndAmortization',
        'DepreciationAndAmortization1',
        'DepreciationAndAmortization2',
        'DepreciationAndAmortization3',
        'DepreciationAndAmortization4',
        'DepreciationAndAmortization5',
        'DepreciationAndAmortization6',
        'DepreciationAndAmortization7',
        'DepreciationAmortizationAndImpairment',
        'DepreciationDepletionAndAmortization',
        'DepreciationDepletionAndAmortization1',
        'DepreciationDepletionAndAmortization2',
        'DepreciationAndAmortizationExpense') THEN n.value END) AS depreciation_amortization
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = lf.period
      AND n.tag IN ('DepreciationAmortizationAndImpairment',
        'DepreciationAndAmortization',
        'DepreciationAndAmortization1',
        'DepreciationAndAmortization2',
        'DepreciationAndAmortization3',
        'DepreciationAndAmortization4',
        'DepreciationAndAmortization5',
        'DepreciationAndAmortization6',
        'DepreciationAndAmortization7',
        'DepreciationAndAmortizationExpense',
        'DepreciationDepletionAndAmortization',
        'DepreciationDepletionAndAmortization1',
        'DepreciationDepletionAndAmortization2',
        'EarningsBeforeInterestAndTaxes',
        'IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest',
        'IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments',
        'OperatingIncomeLoss',
        'OperatingIncomeLoss1',
        'OperatingProfitLoss')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE operating_income IS NOT NULL
  AND (operating_income + COALESCE(depreciation_amortization, 0)) > 10000000000.0
",Count: 62,"{""value"": 2, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.7761,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies reported foreign exchange gains/losses?,companies_forex_gain_loss,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag IN ('ForeignCurrencyTransactionGainLoss','GainLossOnForeignCurrencyExchange')
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.1793,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies have negative net income?,companies_negative_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetIncomeLoss'
  AND n.value < 0",Count: 201,"{""value"": 201, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.85,template,,,,0.123,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What was Johnson & Johnson's income tax expense?,latest_income_tax_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS income_tax_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K', '10-K/A')
      AND n.tag = 'IncomeTaxExpenseBenefit'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT income_tax_expense, period_end
FROM latest_metric
WHERE rn = 1
",income_tax_expense: 2621000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 2621000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.2538,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies reported depreciation and amortization expenses?,companies_depreciation_amortization_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'DepreciationAndAmortization'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 321,"{""value"": 321, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.2251,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What was Tesla's other income (expense) in the latest period?,latest_other_income_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS other_income_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K', '10-K/A')
      AND n.tag = 'OtherNonoperatingIncomeExpense'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT other_income_expense, period_end
FROM latest_metric
WHERE rn = 1
",other_income_expense: 695000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 695000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",5.0,0.8,template,,,,0.2778,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies have positive operating income?,companies_positive_operating_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'OperatingIncomeLoss'
  AND n.value > 0",Count: 907,"{""value"": 907.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.1251,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies reported research and development expenses?,companies_research_expense_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ResearchAndDevelopmentExpense'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 344,"{""value"": 344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.3401,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies have working capital exceeding $50 billion?,companies_working_capital_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND (current_assets - current_liabilities) > 50000000000.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.1717,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies report goodwill on their balance sheets?,companies_goodwill_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'Goodwill'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 3491,"{""value"": 3491.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.1048,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies have intangible assets exceeding $10 billion?,companies_intangibles_above_threshold,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'IntangibleAssetsNetExcludingGoodwill' THEN n.value END) AS intangible_assets
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag = 'IntangibleAssetsNetExcludingGoodwill'
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE intangible_assets IS NOT NULL AND intangible_assets > 10000000000.0",Count: 38,"{""value"": 38, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.1088,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies have negative stockholders' equity?,companies_negative_equity,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity < 0",Count: 1,"{""value"": 1, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.85,template,,,,0.1665,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,"What is Tesla's property, plant and equipment value?",latest_property_plant_equipment,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS property_plant_equipment,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PropertyPlantAndEquipmentNet'
      AND n.qtrs IN (0,4)
)
SELECT property_plant_equipment, period_end
FROM latest_metric
WHERE rn = 1",property_plant_equipment: 35836000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 37088000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.65,template,,,,0.0984,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies have more liabilities than assets?,companies_more_liabilities_than_assets,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed,
                   ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Assets','Liabilities')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND liabilities IS NOT NULL
  AND liabilities > assets",Count: 25,"{""value"": 25, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.1631,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies have current assets exceeding $100 billion?,companies_current_assets_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_assets AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag = 'AssetsCurrent'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_assets
WHERE current_assets > 100000000000.0",Count: 9,"{""value"": 9, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.85,template,,,,0.2734,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies have Return on Equity above 20%?,companies_return_on_equity_above_threshold,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 0.2",Count: 432,"{""value"": 174, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.85,template,,,,1.1192,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies have gross margin above 50%?,companies_gross_margin_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('Revenues','SalesRevenueNet') THEN n.value END) AS revenue,
        MAX(CASE WHEN n.tag = 'CostOfRevenue' THEN n.value END) AS cost
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Revenues','SalesRevenueNet','CostOfRevenue')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE revenue IS NOT NULL
  AND revenue <> 0
  AND cost IS NOT NULL
  AND (revenue - cost) / revenue > 0.5",Count: 12,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.7983,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies have a debt-to-equity ratio above 1.0?,companies_debt_to_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Liabilities','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND liabilities IS NOT NULL
  AND liabilities / equity > 1.0",Count: 236,"{""value"": 236.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.1742,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies have negative Return on Assets?,companies_negative_return_on_assets,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('NetIncomeLoss','Assets')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL
  AND assets <> 0
  AND net_income IS NOT NULL
  AND net_income / assets < 0",Count: 24,"{""value"": 21, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.9236,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies have a current ratio above 2.0?,companies_current_ratio_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND current_liabilities <> 0
  AND current_assets / current_liabilities > 2.0",Count: 115,"{""value"": 115.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.7,template,,,,0.1957,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies have positive Return on Equity in the latest period?,companies_positive_return_on_equity,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 0",Count: 433,"{""value"": 448, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,1.1276,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many annual (qtrs=0) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 0,Count: 5484928,"{""value"": 5484928, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0249,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What is the second most frequent form type in submissions?,form_type_rank,"WITH form_counts AS (
    SELECT form, COUNT(*) AS filing_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM sub
    GROUP BY form
)
SELECT form, filing_count
FROM form_counts
WHERE rank = 2
LIMIT 1",form: 10-K | filing_count: 6274,"{""value"": ""10-K"", ""type"": ""text""}",5.0,0.65,template,,,,0.0022,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many submissions are for fiscal period Q4?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q4'),Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 1}",5.0,0.75,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many submissions are for fiscal period Q3?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q3'),Count: 5238,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5238}",5.0,0.75,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many submissions are for fiscal period Q2?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q2'),Count: 5296,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5296}",5.0,0.75,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many submissions have September fiscal year end (0930)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0930',Count: 1134,"{""value"": 1134, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many submissions have June fiscal year end (0630)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0630',Count: 949,"{""value"": 949, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many submissions have March fiscal year end (0331)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0331',Count: 394,"{""value"": 394, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many submissions have December fiscal year end (1231)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '1231',Count: 17572,"{""value"": 17572, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many different form types are present in the submissions?,distinct_form_type_count,SELECT COUNT(DISTINCT form) AS form_type_count FROM sub,Count: 21,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 21}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many submissions have fiscal period FY (full year)?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('FY'),Count: 6476,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 6476}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many submissions have fiscal period Q1?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q1'),Count: 5664,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5664}",5.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many submissions have fiscal year 2025?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2025,Count: 917,"{""value"": 917, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.75,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many submissions have fiscal year 2024?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2024,Count: 4167,"{""value"": 4167, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.75,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What is the earliest filing date in the dataset?,earliest_filing_date,SELECT MIN(filed) AS earliest_filing_date FROM sub,earliest_filing_date: 2015-01-02 00:00:00,"{""value"": ""2015-01-02 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies filed 8-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('8-K'),Count: 112,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 112}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies filed 10-Q forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-Q'),Count: 543,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 543}",5.0,0.7,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many financial facts are reported with coreg (co-registrant) information?,fact_count_with_coreg,SELECT COUNT(*) AS fact_count FROM num WHERE coreg IS NOT NULL AND TRIM(coreg) <> '',Count: 1261087,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 1261087}",5.0,0.7,template,,,,0.0148,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many XBRL tags are classified as 'string' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%string%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Debt' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%DEBT%'),Count: 26515,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 26515}",5.0,0.85,template,,,,0.0334,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Equity' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%EQUITY%'),Count: 24563,"{""value"": 24563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0441,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Cash' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%CASH%'),Count: 29232,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 29232}",5.0,0.85,template,,,,0.0391,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What is the third most frequent XBRL tag in numerical data?,tag_nth_most_common,"WITH tag_counts AS (
    SELECT
        tag,
        COUNT(*) AS fact_count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    GROUP BY tag
)
SELECT tag, fact_count
FROM tag_counts
WHERE rank = 3
LIMIT 1",tag: Revenues | fact_count: 491457,"{""type"": ""text"", ""value"": ""Revenues""}",5.0,0.65,template,,,,0.0326,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many numerical facts have zero values?,fact_count_zero_values,SELECT COUNT(*) AS fact_count FROM num WHERE value = 0,Count: 1427015,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 1427015}",5.0,0.7,template,,,,0.0622,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many numerical facts have negative values?,fact_count_negative_values,SELECT COUNT(*) AS fact_count FROM num WHERE value < 0,Count: 2124201,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 2124201.0}",5.0,0.7,template,,,,0.0646,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many XBRL tags are classified as 'per-share' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%per-share%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0.0}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many XBRL tags have 'shares' as unit of measure in numerical data?,tag_count_by_unit,SELECT COUNT(DISTINCT tag) AS tag_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 949,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 949}",5.0,0.7,template,,,,0.0329,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many financial facts have duplicate values (dimhash populated)?,fact_count_dimhash_populated,SELECT COUNT(*) AS fact_count FROM num WHERE segments IS NOT NULL AND TRIM(segments) <> '',Count: 8738244,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 8738244}",5.0,0.7,template,,,,0.6202,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many different unit types (UOM) are present in the numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 49.0}",5.0,0.7,template,,,,0.0135,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Liability' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%LIABILITY%'),Count: 11059,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 11059}",5.0,0.7,template,,,,0.0329,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Asset' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%ASSET%'),Count: 40285,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 40285}",5.0,0.7,template,,,,0.0383,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Revenue' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%REVENUE%'),Count: 12221,"{""value"": 12221, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0392,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many XBRL tags are classified as 'monetary' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%monetary%'),Count: 454617,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 454617}",5.0,0.7,template,,,,0.0029,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many XBRL tags have a debit-credit flag of 'Debit'?,tag_count_by_debit_credit,SELECT COUNT(*) AS tag_count FROM tag WHERE crdr IS NOT NULL AND UPPER(TRIM(crdr)) = CASE WHEN UPPER(TRIM('Debit')) LIKE 'D%' THEN 'D' WHEN UPPER(TRIM('Debit')) LIKE 'C%' THEN 'C' ELSE UPPER(TRIM('Debit')) END,Count: 224017,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 224017}",5.0,0.7,template,,,,0.0046,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What is Google's (Alphabet) return on equity (ROE)?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%ALPHABET INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: ALPHABET INC. | roe_percentage: 32.91,"{""value"": 32.91, ""type"": ""numeric"", ""tolerance"": {""absolute"": 0.5}}",5.0,0.8,template,,,,0.239,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are headquartered in Georgia?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('GA')",Count: 22,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 22}",5.0,0.7,template,,,,0.0071,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are incorporated in Bermuda?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('BM'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('BM'))
  )
",Count: 2,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",1.0,0.7,template,,,,0.007,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are headquartered in Washington state?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('WA')",Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",5.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,Which state has the third most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 3
",state: NY | count: 69,"{""value"": ""NY"", ""type"": ""text""}",5.0,0.65,template,,,,0.0086,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are headquartered in Massachusetts?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('MA')",Count: 31,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 31}",5.0,0.7,template,,,,0.011,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are incorporated in the United Kingdom?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('GB'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('GB'))
  )
",Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",1.0,0.7,template,,,,0.0074,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are headquartered in North Carolina?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NC')",Count: 20,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",5.0,0.7,template,,,,0.0148,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are headquartered in Ohio?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('OH')",Count: 24,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 24}",5.0,0.7,template,,,,0.011,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many different US states are represented in headquarters data?,distinct_headquarters_states,SELECT COUNT(DISTINCT stprba) AS state_count FROM sub WHERE stprba IS NOT NULL,Count: 44,"{""value"": 44, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many different countries are represented in the incorporation data?,distinct_incorporation_countries,SELECT COUNT(DISTINCT countryinc) AS country_count FROM sub WHERE countryinc IS NOT NULL,Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 16}",5.0,0.7,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are incorporated in Switzerland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('CH'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('CH'))
  )
",Count: 4,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 5}",5.0,0.7,template,,,,0.0067,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are headquartered in Florida?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('FL')",Count: 26,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 26}",5.0,0.7,template,,,,0.0071,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are headquartered in Illinois?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('IL')",Count: 42,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 42}",5.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,Which state has the second most company headquarters after California?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 2
",state: TX | count: 81,"{""value"": ""TX"", ""type"": ""text""}",5.0,0.65,template,,,,0.0079,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are incorporated in Canada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('CA'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('CA'))
  )
",Count: 11,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 11}",5.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are incorporated in Ireland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IE'))
  )
",Count: 11,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 6}",1.0,0.7,template,,,,0.0067,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are incorporated in Nevada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('NV'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('NV'))
  )
",Count: 9,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 9}",5.0,0.7,template,,,,0.0091,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are headquartered in Texas?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('TX')",Count: 81,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 81}",5.0,0.7,template,,,,0.0112,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are headquartered in New York?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NY')",Count: 69,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 69}",5.0,0.7,template,,,,0.0078,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,Which sector contains Johnson & Johnson?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%') LIMIT 1",JOHNSON & JOHNSON is in the Health Care sector.,"{""value"": ""Health Care"", ""type"": ""text""}",5.0,0.8,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many sectors have fewer than 25 companies?,sectors_below_threshold,"WITH sector_counts AS (
    SELECT gics_sector, COUNT(*) AS count
    FROM companies
    WHERE gics_sector IS NOT NULL
    GROUP BY gics_sector
)
SELECT COUNT(*) AS sector_count
FROM sector_counts
WHERE count < 25.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.002,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many sectors have more than 50 companies?,sectors_above_threshold,"SELECT COUNT(DISTINCT gics_sector) as sector_count FROM (SELECT gics_sector, COUNT(*) as cnt FROM companies GROUP BY gics_sector HAVING cnt > 50.0) subq",Count: 6,"{""value"": 6, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0042,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,Which sector has the fewest companies?,sector_with_fewest_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL AND gics_sector != 'Other' GROUP BY gics_sector ORDER BY count ASC LIMIT 1",AT&T INC is in the Real Estate sector.,"{""type"": ""text"", ""value"": ""Real Estate""}",5.0,0.8,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are in the Communication Services sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%communication services%'),There are 17 companies in the Communication Services sector.,"{""value"": 17, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are in the Real Estate sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%real estate%'),There are 3 companies in the Real Estate sector.,"{""value"": 3, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are in the Consumer Staples sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer staples%'),There are 28 companies in the Consumer Staples sector.,"{""value"": 28, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are in the Consumer Discretionary sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer discretionary%'),There are 99 companies in the Consumer Discretionary sector.,"{""value"": 99, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are in the Energy sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%energy%'),There are 51 companies in the Energy sector.,"{""value"": 51, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are in the Materials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%materials%'),There are 41 companies in the Materials sector.,"{""value"": 41, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,Which sector has the second most companies?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""AT&T INC is in the Financials sector."", ""type"": ""text""}",5.0,0.8,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are in the Industrials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%industrials%'),There are 82 companies in the Industrials sector.,"{""value"": 82, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What was Meta's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%META PLATFORMS, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 76793000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 76793000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.0641,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies reported cost of revenue in the latest period?,companies_reporting_cost_of_revenue,"WITH latest_cost AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'CostOfRevenue'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_cost
WHERE rn = 1 AND value IS NOT NULL",Count: 134,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 134}",5.0,0.85,template,,,,0.1339,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies have total revenue exceeding $50 billion in the latest period?,companies_revenue_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_revenue AS (
    SELECT lf.cik, n.value AS revenue
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('Revenues','SalesRevenueNet')
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS count
FROM latest_revenue
WHERE revenue > 50000000000.0",Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.85,template,,,,0.1286,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What was Walmart's most recent total liabilities?,latest_total_liabilities,"
WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%WALMART INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.filed,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K', '10-K/A')
), selected_filing AS (
    SELECT adsh, cik, period, filed
    FROM latest_filing
    WHERE rn = 1
), metric_values AS (
    SELECT
        MAX(CASE WHEN n.tag = 'LiabilitiesAndStockholdersEquity' THEN n.value END) AS total_assets_equity,
        COALESCE(
            MAX(CASE WHEN n.tag = 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest' THEN n.value END),
            MAX(CASE WHEN n.tag = 'StockholdersEquity' THEN n.value END)
        ) AS equity
    FROM num n
    JOIN selected_filing lf ON n.adsh = lf.adsh
    WHERE n.tag IN (
        'LiabilitiesAndStockholdersEquity',
        'StockholdersEquity',
        'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest'
    )
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT
    (total_assets_equity - equity) AS total_liabilities,
    period AS period_end
FROM metric_values, selected_filing
",total_liabilities: 163402000000.0 | period_end: 2025-01-31 00:00:00,"{""type"": ""text"", ""value"": 163402000000.0, ""tolerance"": {""absolute"": 5000000000.0}}",5.0,0.8,template,,,,0.1408,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies reported positive net income in the latest period?,companies_positive_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
        WHERE form IN ('10-K','10-K/A')
    )
    WHERE rn = 1
), latest_net_income AS (
    SELECT
        lf.cik,
        n.value
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT COUNT(*) AS company_count
FROM latest_net_income
WHERE value > 0",Count: 5700,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 446}",1.0,0.85,template,,,,1.0756,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What was Johnson & Johnson's most recent gross profit?,latest_gross_profit,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS gross_profit,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'GrossProfit'
      AND n.qtrs IN (0,4)
)
SELECT gross_profit, period_end
FROM latest_metric
WHERE rn = 1",gross_profit: 58606000000.0 | period_end: 2024-12-31 00:00:00,"{""type"": ""numeric"", ""value"": 55394000000.0, ""tolerance"": {""absolute"": 2000000000.0}}",3.0,0.8,template,,,,0.1357,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What was Tesla's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 74653000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 74653000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.1129,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies have 'LLC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%LLC%'),Count: 5,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 5}",5.0,0.7,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,Which company has CIK 0000019617?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000019617' LIMIT 1,JPMORGAN CHASE & CO's CIK is unknown.,"{""value"": ""JPMORGAN CHASE & CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0006,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies have 'INC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%INC%'),Count: 459,"{""value"": 459, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,Which company has CIK 0000050863?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000050863' LIMIT 1,INTEL CORP's CIK is unknown.,"{""value"": ""INTEL CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0006,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What is Walmart Inc.'s CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%WALMART INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",WALMART INC.'s CIK is 0000104169.,"{""value"": ""0000104169"", ""type"": ""text""}",5.0,0.8,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies have 'CORP' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%CORP%'),Count: 180,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What is Procter & Gamble's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%PROCTER & GAMBLE CO%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",PROCTER & GAMBLE CO's CIK is 0000080424.,"{""value"": ""0000080424"", ""type"": ""text""}",5.0,0.8,template,,,,0.0022,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,Which company has the longest company name in the dataset?,company_with_longest_name,SELECT name FROM companies ORDER BY LENGTH(name) DESC LIMIT 1,"name: CHARLES RIVER LABORATORIES INTERNATIONAL, INC.","{""type"": ""text"", ""value"": ""CHARLES RIVER LABORATORIES INTERNATIONAL, INC.""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What is Berkshire Hathaway's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%BERKSHIRE HATHAWAY INC%') LIMIT 1",BERKSHIRE HATHAWAY INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many quarterly (qtrs=1) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 1,Count: 3566310,"{""value"": 3566310, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0404,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are in the Utilities sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%utilities%'),There are 20 companies in the Utilities sector.,"{""value"": 20, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What is Tesla's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1","TESLA, INC.'s CIK is 0001318605.","{""value"": ""0001318605"", ""type"": ""text""}",5.0,0.8,template,,,,0.0033,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many financial facts are denominated in USD?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0223,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,Which form type appears most frequently in submissions?,most_common_form_type,"SELECT form, COUNT(*) AS filing_count FROM sub GROUP BY form ORDER BY filing_count DESC LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many unique companies are represented in the dataset?,total_company_count,SELECT COUNT(DISTINCT cik) AS company_count FROM companies,Count: 589,"{""value"": 589, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What is the earliest period date in the financial data?,earliest_period_date,SELECT MIN(period) AS earliest_period FROM sub,earliest_period: 2014-05-31 00:00:00,"{""value"": ""2014-05-31 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies have international (non-US) incorporation?,international_incorporation_count,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS company_count
FROM latest_submission
WHERE rn = 1 AND UPPER(countryinc) <> 'US'",Count: 34,"{""value"": 34, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0063,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What is Amazon's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%AMAZON COM INC%') LIMIT 1",AMAZON COM INC is in the Consumer Discretionary sector.,"{""value"": ""Consumer Discretionary"", ""type"": ""text""}",5.0,0.8,template,,,,0.0156,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many different fiscal year ends are represented?,distinct_fiscal_year_total,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.002,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,Which state has the most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 1
",state: CA | count: 123,"{""value"": ""CA"", ""type"": ""text""}",5.0,0.65,template,,,,0.0123,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies filed 10-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-K'),Count: 563,"{""value"": 563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0022,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What is the most recent filing date in the dataset?,latest_filing_date,SELECT MAX(filed) AS latest_filing_date FROM sub,latest_filing_date: 2025-06-30 00:00:00,"{""value"": ""2025-06-30 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0048,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are in the Health Care sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%health care%'),There are 80 companies in the Health Care sector.,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,Which company has CIK 0000066740?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000066740' LIMIT 1,3M CO's CIK is unknown.,"{""value"": ""3M CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many financial facts have footnotes?,fact_count_with_footnotes,SELECT COUNT(*) AS fact_count FROM num WHERE footnote IS NOT NULL AND TRIM(CAST(footnote AS VARCHAR)) <> '',Count: 33959,"{""value"": 33959, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0144,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,What currency is used most frequently in the numerical data?,most_common_currency,"SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL GROUP BY 1 ORDER BY fact_count DESC LIMIT 1",currency: USD | fact_count: 14760135,"{""value"": ""USD"", ""type"": ""text""}",5.0,0.65,template,,,,25.0736,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many companies are incorporated in Delaware?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('DE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('DE'))
  )
",Count: 346,"{""value"": 346, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.9,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1490, 'completion_tokens': 360}, 'latency_ms': 4645, 'success': True}]",10.7368,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,Which sector has the most companies in our S&P 500 dataset?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",Financials has 168 matching records.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.95,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 425}, 'latency_ms': 5855, 'success': True}]",12.2325,0.0,0.0,0.0,0.0
RUN_003,"07 Nov 2025, 1500 hours",simple,How many S&P 500 companies are in the Information Technology sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%information technology%'),There are 165 companies in the Information Technology sector.,"{""value"": 165, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 356}, 'latency_ms': 6115, 'success': True}]",6.1444,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What is Johnson & Johnson's return on equity (ROE) percentage?,,,"An error occurred while processing your question: Binder Error: Referenced column ""cik"" not found in FROM clause!
Candidate bindings: ""coreg""

LINE 1: ... 1), latest_ni AS (SELECT val as ni, ddate FROM num WHERE cik = (SELECT cik FROM company_cik) AND tag = 'NetIncomeLoss...
                                                                     ^","{""value"": 16.8, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1.0}}",1.0,0.0,,,,,0.0014,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many facts are denominated in Hong Kong dollars (HKD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('HKD'),Count: 140,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.015,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,"How many facts use per-share units (per share, per unit)?",fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 12650, ""type"": ""numeric"", ""tolerance"": {""absolute"": 100}}",1.0,0.7,template,,,,0.0179,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What is the total count of unique unit types in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 21, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many facts are denominated in Mexican pesos (MXN)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('MXN'),Count: 37,"{""value"": 37, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0083,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many facts use barrels as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('barrels'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.003,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many facts are denominated in Australian dollars (AUD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('AUD'),Count: 110,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.0122,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many facts use 'days' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('days'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0021,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What is the least common currency in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""14"", ""type"": ""text""}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many facts are measured in Japanese yen (JPY)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 122, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many facts use square feet as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('square feet'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0021,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many facts are denominated in Swiss francs (CHF)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CHF'),Count: 218,"{""value"": 218, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0154,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many facts use percentage as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('pure'),Count: 50344,"{""value"": 8420, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",1.0,0.7,template,,,,0.016,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What is the most common non-monetary unit of measure?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""shares"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many facts are measured in British pounds (GBP)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 446, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many facts use 'shares' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0361,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many facts are denominated in Euros (EUR)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('EUR'),Count: 37847,"{""value"": 37847, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0197,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many facts are denominated in Canadian dollars (CAD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CAD'),Count: 2926,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",1.0,0.7,template,,,,0.0187,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What is the second most common currency in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""14"", ""type"": ""text""}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many different currencies are represented in the financial data?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies returned more than 50% of operating cash flow to shareholders?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 85, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0006,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies have free cash flow exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 45, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies issued new debt during the period?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What was Johnson & Johnson's acquisition spending?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 2.8, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies have negative operating cash flow?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 76, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What was Tesla's change in cash and cash equivalents?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 16352000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies spent more than $5 billion on acquisitions?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies have positive free cash flow?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 282, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies have EBITDA exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies reported foreign exchange gains/losses?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies have negative net income?,companies_negative_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'NetIncomeLoss'
  AND n.value < 0",Count: 0,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.85,template,,,,0.2894,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What was Johnson & Johnson's income tax expense?,latest_income_tax_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS income_tax_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'IncomeTaxExpenseBenefit'
      AND n.qtrs = 0
)
SELECT income_tax_expense, period_end
FROM latest_metric
WHERE rn = 1",income_tax_expense: -500000000.0 | period_end: 2023-06-30 00:00:00,"{""value"": 2621000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.8,template,,,,0.0648,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies reported depreciation and amortization expenses?,companies_depreciation_amortization_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'DepreciationAndAmortization'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 0,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.0658,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What was Tesla's other income (expense) in the latest period?,latest_other_income_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS other_income_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'OtherNonoperatingIncomeExpense'
      AND n.qtrs = 0
)
SELECT other_income_expense, period_end
FROM latest_metric
WHERE rn = 1",Could not find information for TESLA INC.,"{""value"": 12556000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.8,template,,,,0.088,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies have positive operating income?,companies_positive_operating_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'OperatingIncomeLoss'
  AND n.value > 0",Count: 0,"{""value"": 375, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.85,template,,,,0.3533,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies reported research and development expenses?,companies_research_expense_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'ResearchAndDevelopmentExpense'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 7,"{""value"": 156, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",1.0,0.7,template,,,,0.148,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies have working capital exceeding $50 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0005,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies report goodwill on their balance sheets?,companies_goodwill_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'Goodwill'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 3491,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.1233,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies have intangible assets exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies have negative stockholders' equity?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,"What is Tesla's property, plant and equipment value?",latest_property_plant_equipment,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS property_plant_equipment,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PropertyPlantAndEquipmentNet'
      AND n.qtrs = 0
)
SELECT property_plant_equipment, period_end
FROM latest_metric
WHERE rn = 1",property_plant_equipment: 35836000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 125000000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.65,template,,,,0.1789,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies have more liabilities than assets?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies have current assets exceeding $100 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0005,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies have Return on Equity above 20%?,companies_return_on_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('NetIncomeLoss','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND net_income IS NOT NULL
  AND (net_income / equity) * 100 > 20",Count: 0,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",3.0,0.85,template,,,,0.2084,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies have gross margin above 50%?,,,An error occurred while processing your question: invalid literal for int() with base 10: 'MASTERCARD INC',"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.0,,,,,21.2368,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies have a debt-to-equity ratio above 1.0?,companies_debt_to_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('Liabilities','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND liabilities IS NOT NULL
  AND liabilities / equity > 1",Count: 236,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.85,template,,,,0.1504,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies have negative Return on Assets?,companies_negative_return_on_assets,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('NetIncomeLoss','Assets')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND assets <> 0 AND net_income IS NOT NULL AND net_income / assets < 0",Count: 0,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.85,template,,,,0.173,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies have a current ratio above 2.0?,companies_current_ratio_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND current_liabilities <> 0
  AND current_assets / current_liabilities > 2",Count: 115,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",1.0,0.7,template,,,,0.2061,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies have positive Return on Equity in the latest period?,companies_positive_return_on_equity,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('NetIncomeLoss','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND net_income IS NOT NULL AND net_income / equity > 0",Count: 1,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",3.0,0.85,template,,,,0.2214,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many annual (qtrs=0) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 0,Count: 5484928,"{""value"": 613954, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.7,template,,,,0.0361,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What is the second most frequent form type in submissions?,form_type_rank,"WITH form_counts AS (
    SELECT form, COUNT(*) AS filing_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM sub
    GROUP BY form
)
SELECT form, filing_count
FROM form_counts
WHERE rank = 1
LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many submissions are for fiscal period Q4?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q4'),Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many submissions are for fiscal period Q3?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q3'),Count: 5238,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many submissions are for fiscal period Q2?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q2'),Count: 5296,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many submissions have September fiscal year end (0930)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 25, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many submissions have June fiscal year end (0630)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 45, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many submissions have March fiscal year end (0331)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.0047,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many submissions have December fiscal year end (1231)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 350, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many different form types are present in the submissions?,distinct_form_type_count,SELECT COUNT(DISTINCT form) AS form_type_count FROM sub,Count: 21,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 21}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many submissions have fiscal period FY (full year)?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('FY'),Count: 6476,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 500}",1.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many submissions have fiscal period Q1?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q1'),Count: 5664,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many submissions have fiscal year 2025?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2025,Count: 917,"{""value"": 50, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.75,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many submissions have fiscal year 2024?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2024,Count: 4167,"{""value"": 450, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.75,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What is the earliest filing date in the dataset?,earliest_filing_date,SELECT MIN(filed) AS earliest_filing_date FROM sub,earliest_filing_date: 2015-01-02 00:00:00,"{""value"": ""2015-01-02 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies filed 8-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('8-K'),Count: 112,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 112}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies filed 10-Q forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-Q'),Count: 543,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 543}",5.0,0.7,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many financial facts are reported with coreg (co-registrant) information?,fact_count_with_coreg,SELECT COUNT(*) AS fact_count FROM num WHERE coreg IS NOT NULL AND TRIM(coreg) <> '',Count: 1261087,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.7,template,,,,0.018,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many XBRL tags are classified as 'string' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%string%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Debt' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%DEBT%',Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 26515}",1.0,0.85,template,,,,0.0166,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Equity' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%EQUITY%',Count: 0,"{""value"": 24563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.85,template,,,,0.0166,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Cash' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%CASH%',Count: 12,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 29232}",1.0,0.85,template,,,,0.0189,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What is the third most frequent XBRL tag in numerical data?,tag_nth_most_common,"WITH tag_counts AS (
    SELECT
        tag,
        COUNT(*) AS fact_count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    GROUP BY tag
)
SELECT tag, fact_count
FROM tag_counts
WHERE rank = 1
LIMIT 1",tag: RevenueFromContractWithCustomerExcludingAssessedTax | fact_count: 621672,"{""type"": ""text"", ""value"": ""Assets""}",1.0,0.65,template,,,,0.0318,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many numerical facts have zero values?,fact_count_zero_values,SELECT COUNT(*) AS fact_count FROM num WHERE value = 0,Count: 1427015,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 85000}",1.0,0.7,template,,,,0.0578,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many numerical facts have negative values?,fact_count_negative_values,SELECT COUNT(*) AS fact_count FROM num WHERE value < 0,Count: 2124201,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 125000}",1.0,0.7,template,,,,0.0592,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many XBRL tags are classified as 'per-share' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%per-share%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 6063}",1.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many XBRL tags have 'shares' as unit of measure in numerical data?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 949}",1.0,0.7,template,,,,0.0134,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many financial facts have duplicate values (dimhash populated)?,,,"An error occurred while processing your question: Binder Error: Referenced column ""dimhash"" not found in FROM clause!
Candidate bindings: ""adsh"", ""ddate"", ""segments""

LINE 1: SELECT COUNT(*) AS fact_count FROM num WHERE dimhash IS NOT NULL AND TRIM(dimhash) <> ''
                                                     ^","{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 45000}",1.0,0.0,,,,,0.001,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many different unit types (UOM) are present in the numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 8}",1.0,0.7,template,,,,0.0121,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Liability' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%LIABILITY%',Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 11059}",1.0,0.7,template,,,,0.0166,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Asset' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%ASSET%',Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 40285}",1.0,0.7,template,,,,0.0185,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many XBRL tags contain the word 'Revenue' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%REVENUE%',Count: 0,"{""value"": 12221, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.85,template,,,,0.018,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many XBRL tags are classified as 'monetary' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%monetary%'),Count: 454617,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 454617}",5.0,0.7,template,,,,0.0027,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many XBRL tags have a debit-credit flag of 'Debit'?,,,"An error occurred while processing your question: Binder Error: Referenced column ""debitcredit"" not found in FROM clause!
Candidate bindings: ""abstract"", ""doc"", ""iord"", ""crdr"", ""source_period""

LINE 1: SELECT COUNT(*) AS tag_count FROM tag WHERE debitcredit IS NOT NULL AND UPPER(debitcredit) = UPPER(...
                                                    ^","{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.0,,,,,0.0012,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What is Google's (Alphabet) return on equity (ROE)?,,,"An error occurred while processing your question: Binder Error: Referenced column ""cik"" not found in FROM clause!
Candidate bindings: ""coreg""

LINE 1: ... 1), latest_ni AS (SELECT val as ni, ddate FROM num WHERE cik = (SELECT cik FROM company_cik) AND tag = 'NetIncomeLoss...
                                                                     ^","{""value"": 15.0, ""type"": ""numeric""}",1.0,0.0,,,,,0.0061,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are headquartered in Georgia?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('GA')",Count: 22,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 17}",1.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are incorporated in Bermuda?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 2}",1.0,0.7,template,,,,0.007,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are headquartered in Washington state?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('WA')",Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",5.0,0.7,template,,,,0.0114,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,Which state has the third most company headquarters?,state_with_most_headquarters,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT l.headquarters_state AS state, COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL
GROUP BY l.headquarters_state
ORDER BY count DESC
LIMIT 1",state: CA | count: 123,"{""value"": ""NY"", ""type"": ""text""}",1.0,0.65,template,,,,0.008,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are headquartered in Massachusetts?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('MA')",Count: 31,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 27}",3.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are incorporated in the United Kingdom?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 2}",1.0,0.7,template,,,,0.0075,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are headquartered in North Carolina?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NC')",Count: 20,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 13}",1.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are headquartered in Ohio?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('OH')",Count: 24,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",3.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many different US states are represented in headquarters data?,distinct_headquarters_states,SELECT COUNT(DISTINCT stprba) AS state_count FROM sub WHERE stprba IS NOT NULL,Count: 44,"{""value"": 44, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many different countries are represented in the incorporation data?,distinct_incorporation_countries,SELECT COUNT(DISTINCT countryinc) AS country_count FROM sub WHERE countryinc IS NOT NULL,Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 16}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are incorporated in Switzerland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 5}",5.0,0.7,template,,,,0.0063,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are headquartered in Florida?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('FL')",Count: 26,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",1.0,0.7,template,,,,0.0064,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are headquartered in Illinois?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('IL')",Count: 42,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 35}",1.0,0.7,template,,,,0.0061,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,Which state has the second most company headquarters after California?,state_with_most_headquarters,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT l.headquarters_state AS state, COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL
GROUP BY l.headquarters_state
ORDER BY count DESC
LIMIT 1",state: CA | count: 123,"{""value"": 106, ""type"": ""text""}",1.0,0.65,template,,,,0.0066,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are incorporated in Canada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 3}",3.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are incorporated in Ireland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",1.0,0.7,template,,,,0.0064,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are incorporated in Nevada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('NV'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('NV'))
  )
",Count: 9,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 3}",1.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are headquartered in Texas?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('TX')",Count: 81,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 67}",1.0,0.7,template,,,,0.0067,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are headquartered in New York?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NY')",Count: 69,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 61}",1.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,Which sector contains Johnson & Johnson?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%') LIMIT 1",JOHNSON & JOHNSON is in the Health Care sector.,"{""value"": ""Health Care"", ""type"": ""text""}",5.0,0.8,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many sectors have fewer than 25 companies?,sectors_below_threshold,"WITH sector_counts AS (
    SELECT gics_sector, COUNT(*) AS count
    FROM companies
    WHERE gics_sector IS NOT NULL
    GROUP BY gics_sector
)
SELECT COUNT(*) AS sector_count
FROM sector_counts
WHERE count < 25",Count: 4,"{""value"": 262, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.85,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many sectors have more than 50 companies?,sectors_above_threshold,"SELECT COUNT(DISTINCT gics_sector) as sector_count FROM (SELECT gics_sector, COUNT(*) as cnt FROM companies GROUP BY gics_sector HAVING cnt > 50) subq",Count: 6,"{""value"": 262, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.85,template,,,,0.0032,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,Which sector has the fewest companies?,sector_with_fewest_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL AND gics_sector != 'Other' GROUP BY gics_sector ORDER BY count ASC LIMIT 1",AT&T INC is in the Real Estate sector.,"{""type"": ""text"", ""value"": ""Real Estate""}",5.0,0.8,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are in the Communication Services sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%communication services%'),There are 17 companies in the Communication Services sector.,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are in the Real Estate sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%real estate%'),There are 3 companies in the Real Estate sector.,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are in the Consumer Staples sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer staples%'),There are 28 companies in the Consumer Staples sector.,"{""value"": 26, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",3.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are in the Consumer Discretionary sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer discretionary%'),There are 99 companies in the Consumer Discretionary sector.,"{""value"": 51, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0006,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are in the Energy sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%energy%'),There are 51 companies in the Energy sector.,"{""value"": 15, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0006,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are in the Materials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%materials%'),There are 41 companies in the Materials sector.,"{""value"": 22, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,Which sector has the second most companies?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""Other"", ""type"": ""text""}",1.0,0.8,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are in the Industrials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%industrials%'),There are 82 companies in the Industrials sector.,"{""value"": 28, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What was Meta's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%META PLATFORMS, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs = 0
ORDER BY l.period DESC
LIMIT 1",equity: 76793000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": -1865000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.8,template,,,,0.0622,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies reported cost of revenue in the latest period?,companies_reporting_cost_of_revenue,"WITH latest_cost AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'CostOfRevenue'
      AND n.qtrs = 0
)
SELECT COUNT(*) AS company_count
FROM latest_cost
WHERE rn = 1 AND value IS NOT NULL",Count: 2,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 450}",1.0,0.85,template,,,,0.0507,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies have total revenue exceeding $50 billion in the latest period?,companies_revenue_above_threshold,"WITH latest_filing AS (
    SELECT
        s.cik,
        s.adsh,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
),
latest_revenue AS (
    SELECT lf.cik, n.value AS revenue
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE lf.rn = 1
      AND n.tag IN ('Revenues', 'SalesRevenueNet')
      AND n.qtrs = 0
)
SELECT COUNT(*) AS count
FROM latest_revenue lr
JOIN companies c ON c.cik = lr.cik
WHERE lr.revenue > 50000000000",Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.85,template,,,,0.1103,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What was Walmart's most recent total liabilities?,latest_total_liabilities,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%WALMART INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS total_liabilities,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'Liabilities'
      AND n.qtrs = 0
)
SELECT total_liabilities, period_end
FROM latest_metric
WHERE rn = 1",Could not find information for WALMART INC.,"{""type"": ""text"", ""value"": ""180000000000.0"", ""tolerance"": {""absolute"": 1000000000.0}}",1.0,0.8,template,,,,0.0459,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies reported positive net income in the latest period?,companies_positive_net_income,"WITH latest_net_income AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND n.qtrs = 0
)
SELECT COUNT(*) AS company_count
FROM latest_net_income
WHERE rn = 1 AND value > 0",Count: 11,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 10}",5.0,0.85,template,,,,0.0933,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What was Johnson & Johnson's most recent gross profit?,latest_gross_profit,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS gross_profit,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'GrossProfit'
      AND n.qtrs = 0
)
SELECT gross_profit, period_end
FROM latest_metric
WHERE rn = 1",Could not find information for JOHNSON.,"{""type"": ""text"", ""value"": ""60000000000.0"", ""tolerance"": {""absolute"": 1000000000.0}}",1.0,0.8,template,,,,0.0433,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What was Tesla's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs = 0
ORDER BY l.period DESC
LIMIT 1",equity: 74653000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 74653000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.0675,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies have 'LLC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%LLC%'),Count: 5,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 5}",5.0,0.7,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,Which company has CIK 0000019617?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000019617' LIMIT 1,JPMORGAN CHASE & CO's CIK is unknown.,"{""value"": ""JPMORGAN CHASE & CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0006,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies have 'INC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%INC%'),Count: 459,"{""value"": 459, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,Which company has CIK 0000050863?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000050863' LIMIT 1,INTEL CORP's CIK is unknown.,"{""value"": ""INTEL CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What is Walmart Inc.'s CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%WALMART INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",WALMART INC.'s CIK is 0000104169.,"{""value"": ""0000104169"", ""type"": ""text""}",5.0,0.8,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies have 'CORP' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%CORP%'),Count: 180,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What is Procter & Gamble's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%PROCTER & GAMBLE CO%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",PROCTER & GAMBLE CO's CIK is 0000080424.,"{""value"": ""0000080424"", ""type"": ""text""}",5.0,0.8,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,Which company has the longest company name in the dataset?,company_with_longest_name,SELECT name FROM companies ORDER BY LENGTH(name) DESC LIMIT 1,"name: CHARLES RIVER LABORATORIES INTERNATIONAL, INC.","{""type"": ""text"", ""value"": ""CHARLES RIVER LABORATORIES INTERNATIONAL, INC.""}",5.0,0.65,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What is Berkshire Hathaway's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%BERKSHIRE HATHAWAY INC%') LIMIT 1",BERKSHIRE HATHAWAY INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,llm_template_selection,,,"[{'stage': 'template_selection', 'tokens': {'prompt_tokens': 6118, 'completion_tokens': 308}, 'latency_ms': 4371, 'success': True, 'confidence': 0.95}]",4.3726,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many quarterly (qtrs=1) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 1,Count: 3566310,"{""value"": 3566310, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0221,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are in the Utilities sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%utilities%'),There are 20 companies in the Utilities sector.,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What is Tesla's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1","TESLA, INC.'s CIK is 0001318605.","{""value"": ""0001318605"", ""type"": ""text""}",5.0,0.8,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many financial facts are denominated in USD?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0261,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,Which form type appears most frequently in submissions?,most_common_form_type,"SELECT form, COUNT(*) AS filing_count FROM sub GROUP BY form ORDER BY filing_count DESC LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.006,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many unique companies are represented in the dataset?,total_company_count,SELECT COUNT(DISTINCT cik) AS company_count FROM companies,Count: 589,"{""value"": 589, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What is the earliest period date in the financial data?,earliest_period_date,SELECT MIN(period) AS earliest_period FROM sub,earliest_period: 2014-05-31 00:00:00,"{""value"": ""2014-05-31 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies have international (non-US) incorporation?,international_incorporation_count,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS company_count
FROM latest_submission
WHERE rn = 1 AND UPPER(countryinc) <> 'US'",Count: 34,"{""value"": 34, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What is Amazon's GICS sector?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%AMAZON COM INC%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",AMAZON COM INC's CIK is 0001018724.,"{""value"": ""Consumer Discretionary"", ""type"": ""text""}",1.0,0.8,llm_template_selection,,,"[{'stage': 'template_selection', 'tokens': {'prompt_tokens': 6120, 'completion_tokens': 379}, 'latency_ms': 5202, 'success': True, 'confidence': 0.95}]",5.2631,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many different fiscal year ends are represented?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,Which state has the most company headquarters?,state_with_most_headquarters,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT l.headquarters_state AS state, COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL
GROUP BY l.headquarters_state
ORDER BY count DESC
LIMIT 1",state: CA | count: 123,"{""value"": ""CA"", ""type"": ""text""}",5.0,0.65,template,,,,0.008,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies filed 10-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-K'),Count: 563,"{""value"": 563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What is the most recent filing date in the dataset?,latest_filing_date,SELECT MAX(filed) AS latest_filing_date FROM sub,latest_filing_date: 2025-06-30 00:00:00,"{""value"": ""2025-06-30 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0033,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are in the Health Care sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%health care%'),There are 80 companies in the Health Care sector.,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,Which company has CIK 0000066740?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000066740' LIMIT 1,3M CO's CIK is unknown.,"{""value"": ""3M CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many financial facts have footnotes?,fact_count_with_footnotes,SELECT COUNT(*) AS fact_count FROM num WHERE footnote IS NOT NULL AND TRIM(CAST(footnote AS VARCHAR)) <> '',Count: 33959,"{""value"": 33959, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0166,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,What currency is used most frequently in the numerical data?,most_common_currency,"SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL GROUP BY 1 ORDER BY fact_count DESC LIMIT 1",currency: USD | fact_count: 14760135,"{""value"": ""USD"", ""type"": ""text""}",5.0,0.65,template,,,,0.0292,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many companies are incorporated in Delaware?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('DE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('DE'))
  )
",Count: 346,"{""value"": 349, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",3.0,0.7,template,,,,0.0203,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,Which sector has the most companies in our S&P 500 dataset?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""Other"", ""type"": ""text""}",1.0,0.8,template,,,,26.6311,0.0,0.0,0.0,0.0
RUN_003,"06 Nov 2025, 1500 hours",simple,How many S&P 500 companies are in the Information Technology sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%information technology%'),There are 165 companies in the Information Technology sector.,"{""value"": 165, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 360}, 'latency_ms': 5205, 'success': True}]",5.2267,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What is Johnson & Johnson's return on equity (ROE) percentage?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: JOHNSON & JOHNSON | roe_percentage: 20.06,"{""value"": 20.06, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1.0}}",5.0,0.8,template,,,,0.2662,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many facts are denominated in Hong Kong dollars (HKD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('HKD'),Count: 140,"{""value"": 140, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0115,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,"How many facts use per-share units (per share, per unit)?",fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""absolute"": 100}}",5.0,0.7,template,,,,0.0153,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What is the total count of unique unit types in the dataset?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 49, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0144,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many facts are denominated in Mexican pesos (MXN)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('MXN'),Count: 37,"{""value"": 37, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0076,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many facts use barrels as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('barrels'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many facts are denominated in Australian dollars (AUD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('AUD'),Count: 110,"{""value"": 110, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0124,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many facts use 'days' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('days'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0026,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What is the least common currency in the dataset?,least_common_currency,"WITH currency_counts AS (SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) ASC, UPPER(TRIM(uom))) AS currency_rank FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3 GROUP BY 1) SELECT currency, fact_count FROM currency_counts WHERE currency_rank = 1",currency: COP | fact_count: 1,"{""value"": ""COP"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.0312,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many facts are measured in Japanese yen (JPY)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('JPY'),Count: 122,"{""value"": 122, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0129,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many facts use square feet as unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('square feet'),Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0026,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many facts are denominated in Swiss francs (CHF)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CHF'),Count: 218,"{""value"": 218, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0125,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many facts use percentage as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('pure'),Count: 50344,"{""value"": 50344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.013,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What is the most common non-monetary unit of measure?,most_common_non_monetary_unit,"WITH unit_counts AS (
    SELECT UPPER(TRIM(uom)) AS unit, COUNT(*) AS cnt,
           ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    WHERE uom IS NOT NULL
      AND LENGTH(TRIM(uom)) <> 3
    GROUP BY 1
)
SELECT unit, cnt FROM unit_counts WHERE rank = 1",unit: SHARES | cnt: 642330,"{""value"": ""SHARES"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.025,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many facts are measured in British pounds (GBP)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('GBP'),Count: 446,"{""value"": 446, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.0194,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many facts use 'shares' as the unit of measure?,fact_count_by_unit,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 642330,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0154,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many facts are denominated in Euros (EUR)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('EUR'),Count: 37847,"{""value"": 37847, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0126,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many facts are denominated in Canadian dollars (CAD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('CAD'),Count: 2926,"{""value"": 2926, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0128,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What is the second most common currency in the dataset?,second_most_common_currency,"WITH currency_counts AS (SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS currency_rank FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3 GROUP BY 1) SELECT currency, fact_count FROM currency_counts WHERE currency_rank = 2",currency: EUR | fact_count: 37847,"{""value"": ""EUR"", ""type"": ""text"", ""tolerance"": {""absolute"": 5}}",5.0,0.65,template,,,,0.031,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many different currencies are represented in the financial data?,distinct_currency_count,SELECT COUNT(DISTINCT UPPER(TRIM(uom))) AS currency_count FROM num WHERE uom IS NOT NULL AND LENGTH(TRIM(uom)) = 3,Count: 27,"{""value"": 27, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0218,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies returned more than 50% of operating cash flow to shareholders?,companies_shareholder_return_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), payout_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'PaymentsOfDividends' THEN n.value END) AS dividends,
        MAX(CASE WHEN n.tag = 'PaymentsForRepurchaseOfCommonStock' THEN n.value END) AS buybacks,
        MAX(CASE WHEN n.tag = 'NetCashProvidedByUsedInOperatingActivities' THEN n.value END) AS operating_cash_flow
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('PaymentsOfDividends','PaymentsForRepurchaseOfCommonStock','NetCashProvidedByUsedInOperatingActivities')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM payout_metrics
WHERE operating_cash_flow IS NOT NULL AND operating_cash_flow <> 0
  AND (COALESCE(dividends,0) + COALESCE(buybacks,0)) / operating_cash_flow > (CASE WHEN 50.0 > 1 THEN 50.0 / 100.0 ELSE 50.0 END)",Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,template,,,,0.1859,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies have free cash flow exceeding $10 billion?,companies_free_cash_flow_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value > 10000000000.0",Count: 11,"{""value"": 11, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.85,template,,,,0.1128,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies issued new debt during the period?,companies_new_debt_issued,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ProceedsFromIssuanceOfLongTermDebt'
  AND n.value > 0",Count: 215,"{""value"": 215, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.1149,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What was Johnson & Johnson's acquisition spending?,company_acquisition_spending,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS acquisition_spending,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K', '10-K/A')
      AND n.tag = 'PaymentsToAcquireBusinessesNetOfCashAcquired'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT acquisition_spending, period_end
FROM latest_metric
WHERE rn = 1
",acquisition_spending: 15146000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 15146000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",5.0,0.65,template,,,,0.2135,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies have negative operating cash flow?,companies_negative_operating_cash_flow,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value < 0",Count: 93,"{""value"": 93, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.1104,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What was Tesla's change in cash and cash equivalents?,companies_change_in_cash,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS change_in_cash,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
      AND n.qtrs IN (0,4)
)
SELECT change_in_cash, period_end
FROM latest_metric
WHERE rn = 1",change_in_cash: 14923000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 14923000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.85,template,,,,0.1009,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies spent more than $5 billion on acquisitions?,companies_acquisition_spending_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'PaymentsToAcquireBusinessesNetOfCashAcquired'
  AND ABS(n.value) > 5000000000.0",Count: 7,"{""value"": 7, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",5.0,0.7,template,,,,0.1118,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies have positive free cash flow?,companies_positive_free_cash_flow,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetCashProvidedByUsedInOperatingActivities'
  AND n.value > 0",Count: 525,"{""value"": 525, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.1161,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies have EBITDA exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 2, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0015,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies reported foreign exchange gains/losses?,companies_forex_gain_loss,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag IN ('ForeignCurrencyTransactionGainLoss','GainLossOnForeignCurrencyExchange')
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 0,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.1726,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies have negative net income?,companies_negative_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'NetIncomeLoss'
  AND n.value < 0",Count: 201,"{""value"": 201, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.85,template,,,,0.1178,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What was Johnson & Johnson's income tax expense?,latest_income_tax_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS income_tax_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K', '10-K/A')
      AND n.tag = 'IncomeTaxExpenseBenefit'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT income_tax_expense, period_end
FROM latest_metric
WHERE rn = 1
",income_tax_expense: 2621000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 2621000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.2246,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies reported depreciation and amortization expenses?,companies_depreciation_amortization_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'DepreciationAndAmortization'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 321,"{""value"": 321, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.1163,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What was Tesla's other income (expense) in the latest period?,latest_other_income_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS other_income_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND s.form IN ('10-K', '10-K/A')
      AND n.tag = 'OtherNonoperatingIncomeExpense'
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.ddate = s.period
)
SELECT other_income_expense, period_end
FROM latest_metric
WHERE rn = 1
",other_income_expense: 695000000.0 | period_end: 2024-12-31 00:00:00,"{""value"": 695000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.1}}",5.0,0.8,template,,,,0.2998,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies have positive operating income?,companies_positive_operating_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'OperatingIncomeLoss'
  AND n.value > 0",Count: 907,"{""value"": 907.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.1152,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies reported research and development expenses?,companies_research_expense_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'ResearchAndDevelopmentExpense'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 344,"{""value"": 344, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.7,template,,,,0.1071,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies have working capital exceeding $50 billion?,companies_working_capital_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND (current_assets - current_liabilities) > 50000000000.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.1638,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies report goodwill on their balance sheets?,companies_goodwill_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs IN (0,4)
  AND n.tag = 'Goodwill'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 3491,"{""value"": 3491.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.1109,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies have intangible assets exceeding $10 billion?,companies_intangibles_above_threshold,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'IntangibleAssetsNetExcludingGoodwill' THEN n.value END) AS intangible_assets
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag = 'IntangibleAssetsNetExcludingGoodwill'
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE intangible_assets IS NOT NULL AND intangible_assets > 10000000000.0",Count: 38,"{""value"": 38, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.1147,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies have negative stockholders' equity?,companies_negative_equity,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity < 0",Count: 1,"{""value"": 1, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.85,template,,,,0.167,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,"What is Tesla's property, plant and equipment value?",latest_property_plant_equipment,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS property_plant_equipment,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PropertyPlantAndEquipmentNet'
      AND n.qtrs IN (0,4)
)
SELECT property_plant_equipment, period_end
FROM latest_metric
WHERE rn = 1",property_plant_equipment: 35836000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 37088000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.65,template,,,,0.0995,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies have more liabilities than assets?,companies_more_liabilities_than_assets,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed,
                   ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Assets','Liabilities')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND liabilities IS NOT NULL
  AND liabilities > assets",Count: 25,"{""value"": 25, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,0.2138,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies have current assets exceeding $100 billion?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%MASTERCARD INC%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",MASTERCARD INC has 0 matching records.,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",3.0,0.85,llm_template_selection,,,,19.9351,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies have Return on Equity above 20%?,companies_return_on_equity_above_threshold,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 20.0",Count: 175,"{""value"": 174, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.85,template,,,,1.1405,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies have gross margin above 50%?,companies_gross_margin_above_threshold,"WITH latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag IN ('Revenues','SalesRevenueNet') THEN n.value END) AS revenue,
        MAX(CASE WHEN n.tag = 'CostOfRevenue' THEN n.value END) AS cost
    FROM (
        SELECT cik, adsh
        FROM (
            SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
            FROM sub
        )
        WHERE rn = 1
    ) lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Revenues','SalesRevenueNet','CostOfRevenue')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE revenue IS NOT NULL AND revenue <> 0 AND cost IS NOT NULL
  AND (revenue - cost) / revenue > 50.0",Count: 0,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",3.0,0.7,template,,,,0.1723,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies have a debt-to-equity ratio above 1.0?,companies_debt_to_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('Liabilities','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND liabilities IS NOT NULL
  AND liabilities / equity > 1.0",Count: 236,"{""value"": 236.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,0.179,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies have negative Return on Assets?,companies_negative_return_on_assets,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('NetIncomeLoss','Assets')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND assets <> 0 AND net_income IS NOT NULL AND net_income / assets < 0",Count: 3,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",3.0,0.85,template,,,,0.1781,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies have a current ratio above 2.0?,companies_current_ratio_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs IN (0,4)
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND current_liabilities <> 0
  AND current_assets / current_liabilities > 2.0",Count: 115,"{""value"": 115.0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",5.0,0.7,template,,,,0.169,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies have positive Return on Equity in the latest period?,companies_positive_return_on_equity,"WITH latest_annual AS (
    SELECT cik, adsh
    FROM (
        SELECT s.cik, s.adsh, s.period, s.filed,
               ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
        FROM sub s
        WHERE s.form IN ('10-K','10-K/A')
          AND s.cik IN (SELECT cik FROM companies)
    )
    WHERE rn = 1
), net_income AS (
    SELECT cik, value
    FROM (
        SELECT lf.cik, n.value,
               ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
        FROM latest_annual lf
        JOIN num n ON n.adsh = lf.adsh
        WHERE n.tag = 'NetIncomeLoss'
          AND (n.segments IS NULL OR TRIM(n.segments) = '')
          AND n.qtrs IN (0,4)
    )
    WHERE rn = 1
), equity_values AS (
    SELECT lf.cik, n.value, n.ddate,
           ROW_NUMBER() OVER (PARTITION BY lf.cik ORDER BY n.ddate DESC) AS rn
    FROM latest_annual lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
), equity_latest AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 1
), equity_prev AS (
    SELECT cik, value
    FROM equity_values
    WHERE rn = 2
), avg_equity AS (
    SELECT el.cik,
           CASE WHEN ep.value IS NOT NULL THEN (el.value + ep.value) / 2 ELSE el.value END AS avg_equity
    FROM equity_latest el
    LEFT JOIN equity_prev ep ON ep.cik = el.cik
), roe AS (
    SELECT n.cik, (n.value / ae.avg_equity) * 100 AS roe_pct
    FROM net_income n
    JOIN avg_equity ae ON ae.cik = n.cik
    WHERE ae.avg_equity IS NOT NULL AND ae.avg_equity <> 0
)
SELECT COUNT(*) AS company_count
FROM roe
WHERE roe_pct > 0",Count: 433,"{""value"": 448, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",5.0,0.85,template,,,,1.1927,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many annual (qtrs=0) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 0,Count: 5484928,"{""value"": 5484928, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0264,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What is the second most frequent form type in submissions?,form_type_rank,"WITH form_counts AS (
    SELECT form, COUNT(*) AS filing_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM sub
    GROUP BY form
)
SELECT form, filing_count
FROM form_counts
WHERE rank = 2
LIMIT 1",form: 10-K | filing_count: 6274,"{""value"": ""10-K"", ""type"": ""text""}",5.0,0.65,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many submissions are for fiscal period Q4?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q4'),Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 1}",5.0,0.75,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many submissions are for fiscal period Q3?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q3'),Count: 5238,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5238}",5.0,0.75,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many submissions are for fiscal period Q2?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q2'),Count: 5296,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5296}",5.0,0.75,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many submissions have September fiscal year end (0930)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0930',Count: 1134,"{""value"": 1134, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many submissions have June fiscal year end (0630)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0630',Count: 949,"{""value"": 949, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many submissions have March fiscal year end (0331)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '0331',Count: 394,"{""value"": 394, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many submissions have December fiscal year end (1231)?,distinct_fiscal_year_count,SELECT COUNT(*) AS submission_count FROM sub WHERE fye = '1231',Count: 17572,"{""value"": 17572, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many different form types are present in the submissions?,distinct_form_type_count,SELECT COUNT(DISTINCT form) AS form_type_count FROM sub,Count: 21,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 21}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many submissions have fiscal period FY (full year)?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('FY'),Count: 6476,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 6476}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many submissions have fiscal period Q1?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q1'),Count: 5664,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 5664}",5.0,0.75,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many submissions have fiscal year 2025?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2025,Count: 917,"{""value"": 917, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.75,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many submissions have fiscal year 2024?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2024,Count: 4167,"{""value"": 4167, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.75,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What is the earliest filing date in the dataset?,earliest_filing_date,SELECT MIN(filed) AS earliest_filing_date FROM sub,earliest_filing_date: 2015-01-02 00:00:00,"{""value"": ""2015-01-02 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies filed 8-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('8-K'),Count: 112,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 112}",5.0,0.7,template,,,,0.002,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies filed 10-Q forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-Q'),Count: 543,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 543}",5.0,0.7,template,,,,0.002,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many financial facts are reported with coreg (co-registrant) information?,fact_count_with_coreg,SELECT COUNT(*) AS fact_count FROM num WHERE coreg IS NOT NULL AND TRIM(coreg) <> '',Count: 1261087,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 1261087}",5.0,0.7,template,,,,0.015,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many XBRL tags are classified as 'string' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%string%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many XBRL tags contain the word 'Debt' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%DEBT%'),Count: 26515,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 26515}",5.0,0.85,template,,,,0.0332,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many XBRL tags contain the word 'Equity' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%EQUITY%'),Count: 24563,"{""value"": 24563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0438,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many XBRL tags contain the word 'Cash' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%CASH%'),Count: 29232,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 29232}",5.0,0.85,template,,,,0.0353,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What is the third most frequent XBRL tag in numerical data?,tag_nth_most_common,"WITH tag_counts AS (
    SELECT
        tag,
        COUNT(*) AS fact_count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    GROUP BY tag
)
SELECT tag, fact_count
FROM tag_counts
WHERE rank = 3
LIMIT 1",tag: Revenues | fact_count: 491457,"{""type"": ""text"", ""value"": ""Revenues""}",5.0,0.65,template,,,,0.0332,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many numerical facts have zero values?,fact_count_zero_values,SELECT COUNT(*) AS fact_count FROM num WHERE value = 0,Count: 1427015,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 1427015}",5.0,0.7,template,,,,0.0599,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many numerical facts have negative values?,fact_count_negative_values,SELECT COUNT(*) AS fact_count FROM num WHERE value < 0,Count: 2124201,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 2124201.0}",5.0,0.7,template,,,,0.0642,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many XBRL tags are classified as 'per-share' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%per-share%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0.0}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many XBRL tags have 'shares' as unit of measure in numerical data?,tag_count_by_unit,SELECT COUNT(DISTINCT tag) AS tag_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('shares'),Count: 949,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 949}",5.0,0.7,template,,,,0.0399,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many financial facts have duplicate values (dimhash populated)?,fact_count_dimhash_populated,SELECT COUNT(*) AS fact_count FROM num WHERE segments IS NOT NULL AND TRIM(segments) <> '',Count: 8738244,"{""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}, ""value"": 8738244}",5.0,0.7,template,,,,0.6644,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many different unit types (UOM) are present in the numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 49.0}",5.0,0.7,template,,,,0.0139,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many XBRL tags contain the word 'Liability' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%LIABILITY%'),Count: 11059,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 11059}",5.0,0.7,template,,,,0.0321,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many XBRL tags contain the word 'Asset' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%ASSET%'),Count: 40285,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 40285}",5.0,0.7,template,,,,0.0375,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many XBRL tags contain the word 'Revenue' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE UPPER(tag) LIKE UPPER('%REVENUE%'),Count: 12221,"{""value"": 12221, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.85,template,,,,0.0393,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many XBRL tags are classified as 'monetary' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%monetary%'),Count: 454617,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 454617}",5.0,0.7,template,,,,0.0026,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many XBRL tags have a debit-credit flag of 'Debit'?,tag_count_by_debit_credit,SELECT COUNT(*) AS tag_count FROM tag WHERE crdr IS NOT NULL AND UPPER(TRIM(crdr)) = CASE WHEN UPPER(TRIM('Debit')) LIKE 'D%' THEN 'D' WHEN UPPER(TRIM('Debit')) LIKE 'C%' THEN 'C' ELSE UPPER(TRIM('Debit')) END,Count: 224017,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 224017}",5.0,0.7,template,,,,0.0048,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What is Google's (Alphabet) return on equity (ROE)?,latest_roe,"WITH target_company AS (
    SELECT cik, name
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%ALPHABET INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_10k AS (
    SELECT s.cik, s.adsh
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K','10-K/A')
    ORDER BY s.period DESC, s.filed DESC
    LIMIT 1
), net_income AS (
    SELECT n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 1
), equity_values AS (
    SELECT DISTINCT n.ddate, n.value
    FROM num n
    JOIN latest_10k lf ON n.adsh = lf.adsh
    WHERE n.tag IN ('StockholdersEquity', 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
      AND n.qtrs IN (0,4)
    ORDER BY n.ddate DESC
    LIMIT 2
), avg_equity AS (
    SELECT AVG(value) AS avg_equity FROM equity_values
)
SELECT tc.name AS company_name,
       ROUND((net_income.value / avg_equity.avg_equity) * 100, 2) AS roe_percentage
FROM target_company tc, net_income, avg_equity",company_name: ALPHABET INC. | roe_percentage: 32.91,"{""value"": 32.91, ""type"": ""numeric"", ""tolerance"": {""absolute"": 0.5}}",5.0,0.8,template,,,,0.2328,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are headquartered in Georgia?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('GA')",Count: 22,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 22}",5.0,0.7,template,,,,0.008,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are incorporated in Bermuda?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",5.0,0.7,template,,,,0.007,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are headquartered in Washington state?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('WA')",Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",5.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,Which state has the third most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 3
",state: NY | count: 69,"{""value"": ""NY"", ""type"": ""text""}",5.0,0.65,template,,,,0.0082,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are headquartered in Massachusetts?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('MA')",Count: 31,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 27}",3.0,0.7,template,,,,0.0072,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are incorporated in the United Kingdom?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 6}",5.0,0.7,template,,,,0.0074,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are headquartered in North Carolina?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NC')",Count: 20,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",5.0,0.7,template,,,,0.0074,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are headquartered in Ohio?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('OH')",Count: 24,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",3.0,0.7,template,,,,0.0074,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many different US states are represented in headquarters data?,distinct_headquarters_states,SELECT COUNT(DISTINCT stprba) AS state_count FROM sub WHERE stprba IS NOT NULL,Count: 44,"{""value"": 44, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many different countries are represented in the incorporation data?,distinct_incorporation_countries,SELECT COUNT(DISTINCT countryinc) AS country_count FROM sub WHERE countryinc IS NOT NULL,Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 16}",5.0,0.7,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are incorporated in Switzerland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 5}",5.0,0.7,template,,,,0.0073,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are headquartered in Florida?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('FL')",Count: 26,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 26}",5.0,0.7,template,,,,0.0076,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are headquartered in Illinois?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('IL')",Count: 42,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 42}",5.0,0.7,template,,,,0.0071,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,Which state has the second most company headquarters after California?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 2
",state: TX | count: 81,"{""value"": ""TX"", ""type"": ""text""}",5.0,0.65,template,,,,0.008,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are incorporated in Canada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 3}",3.0,0.7,template,,,,0.0075,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are incorporated in Ireland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 6}",5.0,0.7,template,,,,0.0079,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are incorporated in Nevada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('NV'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('NV'))
  )
",Count: 9,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 9}",5.0,0.7,template,,,,0.0081,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are headquartered in Texas?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('TX')",Count: 81,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 81}",5.0,0.7,template,,,,0.0078,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are headquartered in New York?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NY')",Count: 69,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 69}",5.0,0.7,template,,,,0.013,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,Which sector contains Johnson & Johnson?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%') LIMIT 1",JOHNSON & JOHNSON is in the Health Care sector.,"{""value"": ""Health Care"", ""type"": ""text""}",5.0,0.8,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many sectors have fewer than 25 companies?,sectors_below_threshold,"WITH sector_counts AS (
    SELECT gics_sector, COUNT(*) AS count
    FROM companies
    WHERE gics_sector IS NOT NULL
    GROUP BY gics_sector
)
SELECT COUNT(*) AS sector_count
FROM sector_counts
WHERE count < 25.0",Count: 4,"{""value"": 4, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many sectors have more than 50 companies?,sectors_above_threshold,"SELECT COUNT(DISTINCT gics_sector) as sector_count FROM (SELECT gics_sector, COUNT(*) as cnt FROM companies GROUP BY gics_sector HAVING cnt > 50.0) subq",Count: 6,"{""value"": 6, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.85,template,,,,0.0045,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,Which sector has the fewest companies?,sector_with_fewest_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL AND gics_sector != 'Other' GROUP BY gics_sector ORDER BY count ASC LIMIT 1",AT&T INC is in the Real Estate sector.,"{""type"": ""text"", ""value"": ""Real Estate""}",5.0,0.8,template,,,,0.0027,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are in the Communication Services sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%communication services%'),There are 17 companies in the Communication Services sector.,"{""value"": 17, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are in the Real Estate sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%real estate%'),There are 3 companies in the Real Estate sector.,"{""value"": 3, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are in the Consumer Staples sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer staples%'),There are 28 companies in the Consumer Staples sector.,"{""value"": 26, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",3.0,0.95,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are in the Consumer Discretionary sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer discretionary%'),There are 99 companies in the Consumer Discretionary sector.,"{""value"": 99, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are in the Energy sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%energy%'),There are 51 companies in the Energy sector.,"{""value"": 51, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are in the Materials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%materials%'),There are 41 companies in the Materials sector.,"{""value"": 41, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,Which sector has the second most companies?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""AT&T INC is in the Financials sector."", ""type"": ""text""}",5.0,0.8,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are in the Industrials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%industrials%'),There are 82 companies in the Industrials sector.,"{""value"": 82, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What was Meta's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%META PLATFORMS, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 76793000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 76793000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.8,template,,,,0.1286,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies reported cost of revenue in the latest period?,companies_reporting_cost_of_revenue,"WITH latest_cost AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'CostOfRevenue'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_cost
WHERE rn = 1 AND value IS NOT NULL",Count: 134,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 134}",5.0,0.85,template,,,,0.6838,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies have total revenue exceeding $50 billion in the latest period?,companies_revenue_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed,
               ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_revenue AS (
    SELECT lf.cik, n.value AS revenue
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.tag IN ('Revenues','SalesRevenueNet')
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS count
FROM latest_revenue
WHERE revenue > 50000000000.0",Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.85,template,,,,0.1316,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What was Walmart's most recent total liabilities?,latest_total_liabilities,"
WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%WALMART INC.%')
    ORDER BY LENGTH(name)
    LIMIT 1
), latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.filed,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company tc ON tc.cik = s.cik
    WHERE s.form IN ('10-K', '10-K/A')
), selected_filing AS (
    SELECT adsh, cik, period, filed
    FROM latest_filing
    WHERE rn = 1
), metric_values AS (
    SELECT
        MAX(CASE WHEN n.tag = 'LiabilitiesAndStockholdersEquity' THEN n.value END) AS total_assets_equity,
        COALESCE(
            MAX(CASE WHEN n.tag = 'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest' THEN n.value END),
            MAX(CASE WHEN n.tag = 'StockholdersEquity' THEN n.value END)
        ) AS equity
    FROM num n
    JOIN selected_filing lf ON n.adsh = lf.adsh
    WHERE n.tag IN (
        'LiabilitiesAndStockholdersEquity',
        'StockholdersEquity',
        'StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest'
    )
      AND n.qtrs IN (0,4)
      AND (n.segments IS NULL OR TRIM(n.segments) = '')
)
SELECT
    (total_assets_equity - equity) AS total_liabilities,
    period AS period_end
FROM metric_values, selected_filing
",total_liabilities: 163402000000.0 | period_end: 2025-01-31 00:00:00,"{""type"": ""text"", ""value"": 163402000000.0, ""tolerance"": {""absolute"": 5000000000.0}}",5.0,0.8,template,,,,0.127,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies reported positive net income in the latest period?,companies_positive_net_income,"WITH latest_net_income AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND n.qtrs IN (0,4)
)
SELECT COUNT(*) AS company_count
FROM latest_net_income
WHERE rn = 1 AND value > 0",Count: 454,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 447.0}",3.0,0.85,template,,,,0.1332,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What was Johnson & Johnson's most recent gross profit?,latest_gross_profit,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS gross_profit,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'GrossProfit'
      AND n.qtrs IN (0,4)
)
SELECT gross_profit, period_end
FROM latest_metric
WHERE rn = 1",gross_profit: 58606000000.0 | period_end: 2024-12-31 00:00:00,"{""type"": ""numeric"", ""value"": 55394000000.0, ""tolerance"": {""absolute"": 2000000000.0}}",3.0,0.8,template,,,,0.0977,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What was Tesla's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs IN (0,4)
ORDER BY l.period DESC
LIMIT 1",equity: 74653000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 74653000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.0678,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies have 'LLC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%LLC%'),Count: 5,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 5}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,Which company has CIK 0000019617?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000019617' LIMIT 1,JPMORGAN CHASE & CO's CIK is unknown.,"{""value"": ""JPMORGAN CHASE & CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies have 'INC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%INC%'),Count: 459,"{""value"": 459, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,Which company has CIK 0000050863?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000050863' LIMIT 1,INTEL CORP's CIK is unknown.,"{""value"": ""INTEL CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What is Walmart Inc.'s CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%WALMART INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",WALMART INC.'s CIK is 0000104169.,"{""value"": ""0000104169"", ""type"": ""text""}",5.0,0.8,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies have 'CORP' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%CORP%'),Count: 180,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What is Procter & Gamble's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%PROCTER & GAMBLE CO%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",PROCTER & GAMBLE CO's CIK is 0000080424.,"{""value"": ""0000080424"", ""type"": ""text""}",5.0,0.8,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,Which company has the longest company name in the dataset?,company_with_longest_name,SELECT name FROM companies ORDER BY LENGTH(name) DESC LIMIT 1,"name: CHARLES RIVER LABORATORIES INTERNATIONAL, INC.","{""type"": ""text"", ""value"": ""CHARLES RIVER LABORATORIES INTERNATIONAL, INC.""}",5.0,0.65,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What is Berkshire Hathaway's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%BERKSHIRE HATHAWAY INC%') LIMIT 1",BERKSHIRE HATHAWAY INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many quarterly (qtrs=1) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 1,Count: 3566310,"{""value"": 3566310, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.023,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are in the Utilities sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%utilities%'),There are 20 companies in the Utilities sector.,"{""value"": 20, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.95,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What is Tesla's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1","TESLA, INC.'s CIK is 0001318605.","{""value"": ""0001318605"", ""type"": ""text""}",5.0,0.8,template,,,,0.0028,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many financial facts are denominated in USD?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0162,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,Which form type appears most frequently in submissions?,most_common_form_type,"SELECT form, COUNT(*) AS filing_count FROM sub GROUP BY form ORDER BY filing_count DESC LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.003,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many unique companies are represented in the dataset?,total_company_count,SELECT COUNT(DISTINCT cik) AS company_count FROM companies,Count: 589,"{""value"": 589, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What is the earliest period date in the financial data?,earliest_period_date,SELECT MIN(period) AS earliest_period FROM sub,earliest_period: 2014-05-31 00:00:00,"{""value"": ""2014-05-31 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0024,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies have international (non-US) incorporation?,international_incorporation_count,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS company_count
FROM latest_submission
WHERE rn = 1 AND UPPER(countryinc) <> 'US'",Count: 34,"{""value"": 34, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0075,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What is Amazon's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%AMAZON COM INC%') LIMIT 1",AMAZON COM INC is in the Consumer Discretionary sector.,"{""value"": ""Consumer Discretionary"", ""type"": ""text""}",5.0,0.8,template,,,,0.0155,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many different fiscal year ends are represented?,distinct_fiscal_year_total,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,Which state has the most company headquarters?,state_with_most_headquarters,"
WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
), ranked_states AS (
    SELECT
        l.headquarters_state AS state,
        COUNT(*) AS count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, l.headquarters_state) AS state_rank
    FROM latest_business_address l
    JOIN companies c ON c.cik = l.cik
    WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL AND TRIM(l.headquarters_state) <> ''
    GROUP BY l.headquarters_state
)
SELECT state, count
FROM ranked_states
WHERE state_rank = 1
",state: CA | count: 123,"{""value"": ""CA"", ""type"": ""text""}",5.0,0.65,template,,,,0.0087,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies filed 10-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-K'),Count: 563,"{""value"": 563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0022,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What is the most recent filing date in the dataset?,latest_filing_date,SELECT MAX(filed) AS latest_filing_date FROM sub,latest_filing_date: 2025-06-30 00:00:00,"{""value"": ""2025-06-30 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0037,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are in the Health Care sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%health care%'),There are 80 companies in the Health Care sector.,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,Which company has CIK 0000066740?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000066740' LIMIT 1,3M CO's CIK is unknown.,"{""value"": ""3M CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many financial facts have footnotes?,fact_count_with_footnotes,SELECT COUNT(*) AS fact_count FROM num WHERE footnote IS NOT NULL AND TRIM(CAST(footnote AS VARCHAR)) <> '',Count: 33959,"{""value"": 33959, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0155,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,What currency is used most frequently in the numerical data?,most_common_currency,"SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL GROUP BY 1 ORDER BY fact_count DESC LIMIT 1",currency: USD | fact_count: 14760135,"{""value"": ""USD"", ""type"": ""text""}",5.0,0.65,template,,,,23.9054,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many companies are incorporated in Delaware?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('DE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('DE'))
  )
",Count: 346,"{""value"": 349, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",3.0,0.9,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1490, 'completion_tokens': 432}, 'latency_ms': 5032, 'success': True}]",10.1545,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,Which sector has the most companies in our S&P 500 dataset?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",Financials has 168 matching records.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.95,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 420}, 'latency_ms': 9406, 'success': True}]",9.4098,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 2000 hours",simple,How many S&P 500 companies are in the Information Technology sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%information technology%'),There are 165 companies in the Information Technology sector.,"{""value"": 165, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 430}, 'latency_ms': 7447, 'success': True}]",7.4558,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What is Johnson & Johnson's return on equity (ROE) percentage?,,,"An error occurred while processing your question: Binder Error: Referenced column ""cik"" not found in FROM clause!
Candidate bindings: ""coreg""

LINE 1: ... 1), latest_ni AS (SELECT val as ni, ddate FROM num WHERE cik = (SELECT cik FROM company_cik) AND tag = 'NetIncomeLoss...
                                                                     ^","{""value"": 16.8, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1.0}}",1.0,0.0,,,,,0.0014,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many facts are denominated in Hong Kong dollars (HKD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0151,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,"How many facts use per-share units (per share, per unit)?",distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 12650, ""type"": ""numeric"", ""tolerance"": {""absolute"": 100}}",1.0,0.7,template,,,,0.0151,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What is the total count of unique unit types in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 21, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many facts are denominated in Mexican pesos (MXN)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 37, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many facts use barrels as unit of measure?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.0123,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many facts are denominated in Australian dollars (AUD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.015,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many facts use 'days' as the unit of measure?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.7,template,,,,0.012,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What is the least common currency in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""14"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many facts are measured in Japanese yen (JPY)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 122, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many facts use square feet as unit of measure?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.0118,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many facts are denominated in Swiss francs (CHF)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 218, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many facts use percentage as the unit of measure?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 8420, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",1.0,0.7,template,,,,0.0123,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What is the most common non-monetary unit of measure?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""shares"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many facts are measured in British pounds (GBP)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 446, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many facts use 'shares' as the unit of measure?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.7,template,,,,0.0121,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many facts are denominated in Euros (EUR)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('EUR'),Count: 37847,"{""value"": 37847, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0119,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many facts are denominated in Canadian dollars (CAD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0164,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What is the second most common currency in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""14"", ""type"": ""text""}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many different currencies are represented in the financial data?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies returned more than 50% of operating cash flow to shareholders?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 85, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies have free cash flow exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 45, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies issued new debt during the period?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What was Johnson & Johnson's acquisition spending?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 2.8, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies have negative operating cash flow?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 76, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What was Tesla's change in cash and cash equivalents?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 16352000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies spent more than $5 billion on acquisitions?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies have positive free cash flow?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 282, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies have EBITDA exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies reported foreign exchange gains/losses?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies have negative net income?,companies_negative_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'NetIncomeLoss'
  AND n.value < 0",Count: 0,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.85,template,,,,0.0876,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What was Johnson & Johnson's income tax expense?,latest_income_tax_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS income_tax_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'IncomeTaxExpenseBenefit'
      AND n.qtrs = 0
)
SELECT income_tax_expense, period_end
FROM latest_metric
WHERE rn = 1",income_tax_expense: -500000000.0 | period_end: 2023-06-30 00:00:00,"{""value"": 2621000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.8,template,,,,0.053,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies reported depreciation and amortization expenses?,companies_depreciation_amortization_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'DepreciationAndAmortization'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 0,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.0626,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What was Tesla's other income (expense) in the latest period?,latest_other_income_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS other_income_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'OtherNonoperatingIncomeExpense'
      AND n.qtrs = 0
)
SELECT other_income_expense, period_end
FROM latest_metric
WHERE rn = 1",Could not find information for TESLA INC.,"{""value"": 12556000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.8,template,,,,0.0483,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies have positive operating income?,companies_positive_operating_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'OperatingIncomeLoss'
  AND n.value > 0",Count: 0,"{""value"": 375, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.85,template,,,,0.0832,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies reported research and development expenses?,companies_research_expense_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'ResearchAndDevelopmentExpense'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 7,"{""value"": 156, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",1.0,0.7,template,,,,0.0842,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies have working capital exceeding $50 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies report goodwill on their balance sheets?,companies_goodwill_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'Goodwill'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 3491,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.0968,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies have intangible assets exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies have negative stockholders' equity?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,"What is Tesla's property, plant and equipment value?",latest_property_plant_equipment,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS property_plant_equipment,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PropertyPlantAndEquipmentNet'
      AND n.qtrs = 0
)
SELECT property_plant_equipment, period_end
FROM latest_metric
WHERE rn = 1",property_plant_equipment: 35836000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 125000000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.65,template,,,,0.093,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies have more liabilities than assets?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies have current assets exceeding $100 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies have Return on Equity above 20%?,companies_return_on_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('NetIncomeLoss','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND net_income IS NOT NULL
  AND (net_income / equity) * 100 > 20",Count: 0,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",3.0,0.85,template,,,,0.1634,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies have gross margin above 50%?,,,An error occurred while processing your question: invalid literal for int() with base 10: 'MASTERCARD INC',"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.0,,,,,21.0795,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies have a debt-to-equity ratio above 1.0?,companies_debt_to_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('Liabilities','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND liabilities IS NOT NULL
  AND liabilities / equity > 1",Count: 236,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.85,template,,,,0.1302,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies have negative Return on Assets?,companies_negative_return_on_assets,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('NetIncomeLoss','Assets')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND assets <> 0 AND net_income IS NOT NULL AND net_income / assets < 0",Count: 0,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.85,template,,,,0.1154,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies have a current ratio above 2.0?,companies_current_ratio_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND current_liabilities <> 0
  AND current_assets / current_liabilities > 2",Count: 115,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",1.0,0.7,template,,,,0.1184,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies have positive Return on Equity in the latest period?,companies_positive_return_on_equity,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('NetIncomeLoss','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND net_income IS NOT NULL AND net_income / equity > 0",Count: 1,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",3.0,0.85,template,,,,0.1296,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many annual (qtrs=0) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 0,Count: 5484928,"{""value"": 613954, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.7,template,,,,0.0243,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What is the second most frequent form type in submissions?,form_type_rank,"WITH form_counts AS (
    SELECT form, COUNT(*) AS filing_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM sub
    GROUP BY form
)
SELECT form, filing_count
FROM form_counts
WHERE rank = 1
LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many submissions are for fiscal period Q4?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q4'),Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many submissions are for fiscal period Q3?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q3'),Count: 5238,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many submissions are for fiscal period Q2?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q2'),Count: 5296,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many submissions have September fiscal year end (0930)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 25, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many submissions have June fiscal year end (0630)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 45, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many submissions have March fiscal year end (0331)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many submissions have December fiscal year end (1231)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 350, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many different form types are present in the submissions?,distinct_form_type_count,SELECT COUNT(DISTINCT form) AS form_type_count FROM sub,Count: 21,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 21}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many submissions have fiscal period FY (full year)?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('FY'),Count: 6476,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 500}",1.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many submissions have fiscal period Q1?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q1'),Count: 5664,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many submissions have fiscal year 2025?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2025,Count: 917,"{""value"": 50, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many submissions have fiscal year 2024?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2024,Count: 4167,"{""value"": 450, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.75,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What is the earliest filing date in the dataset?,earliest_filing_date,SELECT MIN(filed) AS earliest_filing_date FROM sub,earliest_filing_date: 2015-01-02 00:00:00,"{""value"": ""2015-01-02 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies filed 8-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('8-K'),Count: 112,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 112}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies filed 10-Q forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-Q'),Count: 543,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 543}",5.0,0.7,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many financial facts are reported with coreg (co-registrant) information?,fact_count_with_coreg,SELECT COUNT(*) AS fact_count FROM num WHERE coreg IS NOT NULL AND TRIM(coreg) <> '',Count: 1261087,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.7,template,,,,0.0152,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many XBRL tags are classified as 'string' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%string%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many XBRL tags contain the word 'Debt' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%DEBT%',Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 26515}",1.0,0.85,template,,,,0.0159,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many XBRL tags contain the word 'Equity' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%EQUITY%',Count: 0,"{""value"": 24563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.85,template,,,,0.0153,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many XBRL tags contain the word 'Cash' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%CASH%',Count: 12,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 29232}",1.0,0.85,template,,,,0.0186,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What is the third most frequent XBRL tag in numerical data?,tag_nth_most_common,"WITH tag_counts AS (
    SELECT
        tag,
        COUNT(*) AS fact_count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    GROUP BY tag
)
SELECT tag, fact_count
FROM tag_counts
WHERE rank = 1
LIMIT 1",tag: RevenueFromContractWithCustomerExcludingAssessedTax | fact_count: 621672,"{""type"": ""text"", ""value"": ""Assets""}",1.0,0.65,template,,,,0.0304,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many numerical facts have zero values?,fact_count_zero_values,SELECT COUNT(*) AS fact_count FROM num WHERE value = 0,Count: 1427015,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 85000}",1.0,0.7,template,,,,0.0554,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many numerical facts have negative values?,fact_count_negative_values,SELECT COUNT(*) AS fact_count FROM num WHERE value < 0,Count: 2124201,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 125000}",1.0,0.7,template,,,,0.0574,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many XBRL tags are classified as 'per-share' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%per-share%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 6063}",1.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many XBRL tags have 'shares' as unit of measure in numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 949}",1.0,0.7,template,,,,0.0119,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many financial facts have duplicate values (dimhash populated)?,,,"An error occurred while processing your question: Binder Error: Referenced column ""dimhash"" not found in FROM clause!
Candidate bindings: ""adsh"", ""ddate"", ""segments""

LINE 1: SELECT COUNT(*) AS fact_count FROM num WHERE dimhash IS NOT NULL AND TRIM(dimhash) <> ''
                                                     ^","{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 45000}",1.0,0.0,,,,,0.0011,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many different unit types (UOM) are present in the numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 8}",1.0,0.7,template,,,,0.0122,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many XBRL tags contain the word 'Liability' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%LIABILITY%',Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 11059}",1.0,0.7,template,,,,0.015,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many XBRL tags contain the word 'Asset' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%ASSET%',Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 40285}",1.0,0.7,template,,,,0.0169,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many XBRL tags contain the word 'Revenue' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%REVENUE%',Count: 0,"{""value"": 12221, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.85,template,,,,0.0166,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many XBRL tags are classified as 'monetary' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%monetary%'),Count: 454617,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 454617}",5.0,0.7,template,,,,0.0025,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many XBRL tags have a debit-credit flag of 'Debit'?,,,"An error occurred while processing your question: Binder Error: Referenced column ""debitcredit"" not found in FROM clause!
Candidate bindings: ""abstract"", ""doc"", ""iord"", ""crdr"", ""source_period""

LINE 1: SELECT COUNT(*) AS tag_count FROM tag WHERE debitcredit IS NOT NULL AND UPPER(debitcredit) = UPPER(...
                                                    ^","{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.0,,,,,0.0009,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What is Google's (Alphabet) return on equity (ROE)?,,,"An error occurred while processing your question: Binder Error: Referenced column ""cik"" not found in FROM clause!
Candidate bindings: ""coreg""

LINE 1: ... 1), latest_ni AS (SELECT val as ni, ddate FROM num WHERE cik = (SELECT cik FROM company_cik) AND tag = 'NetIncomeLoss...
                                                                     ^","{""value"": 15.0, ""type"": ""numeric""}",1.0,0.0,,,,,0.0046,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are headquartered in Georgia?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('GA')",Count: 22,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 17}",1.0,0.7,template,,,,0.0067,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are incorporated in Bermuda?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 2}",1.0,0.7,template,,,,0.0066,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are headquartered in Washington state?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('WA')",Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",5.0,0.7,template,,,,0.0066,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,Which state has the third most company headquarters?,state_with_most_headquarters,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT l.headquarters_state AS state, COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL
GROUP BY l.headquarters_state
ORDER BY count DESC
LIMIT 1",state: CA | count: 123,"{""value"": ""NY"", ""type"": ""text""}",1.0,0.65,template,,,,0.0076,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are headquartered in Massachusetts?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('MA')",Count: 31,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 27}",3.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are incorporated in the United Kingdom?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 2}",1.0,0.7,template,,,,0.0074,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are headquartered in North Carolina?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NC')",Count: 20,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 13}",1.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are headquartered in Ohio?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('OH')",Count: 24,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",3.0,0.7,template,,,,0.0068,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many different US states are represented in headquarters data?,distinct_headquarters_states,SELECT COUNT(DISTINCT stprba) AS state_count FROM sub WHERE stprba IS NOT NULL,Count: 44,"{""value"": 44, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many different countries are represented in the incorporation data?,distinct_incorporation_countries,SELECT COUNT(DISTINCT countryinc) AS country_count FROM sub WHERE countryinc IS NOT NULL,Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 16}",5.0,0.7,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are incorporated in Switzerland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 5}",5.0,0.7,template,,,,0.0063,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are headquartered in Florida?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('FL')",Count: 26,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",1.0,0.7,template,,,,0.0066,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are headquartered in Illinois?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('IL')",Count: 42,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 35}",1.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,Which state has the second most company headquarters after California?,state_with_most_headquarters,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT l.headquarters_state AS state, COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL
GROUP BY l.headquarters_state
ORDER BY count DESC
LIMIT 1",state: CA | count: 123,"{""value"": 106, ""type"": ""text""}",1.0,0.65,template,,,,0.0074,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are incorporated in Canada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 3}",3.0,0.7,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are incorporated in Ireland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",1.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are incorporated in Nevada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('NV'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('NV'))
  )
",Count: 9,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 3}",1.0,0.7,template,,,,0.007,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are headquartered in Texas?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('TX')",Count: 81,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 67}",1.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are headquartered in New York?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NY')",Count: 69,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 61}",1.0,0.7,template,,,,0.0075,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,Which sector contains Johnson & Johnson?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%') LIMIT 1",JOHNSON & JOHNSON is in the Health Care sector.,"{""value"": ""Health Care"", ""type"": ""text""}",5.0,0.8,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many sectors have fewer than 25 companies?,sectors_below_threshold,"WITH sector_counts AS (
    SELECT gics_sector, COUNT(*) AS count
    FROM companies
    WHERE gics_sector IS NOT NULL
    GROUP BY gics_sector
)
SELECT COUNT(*) AS sector_count
FROM sector_counts
WHERE count < 25",Count: 4,"{""value"": 262, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.85,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many sectors have more than 50 companies?,sectors_above_threshold,"SELECT COUNT(DISTINCT gics_sector) as sector_count FROM (SELECT gics_sector, COUNT(*) as cnt FROM companies GROUP BY gics_sector HAVING cnt > 50) subq",Count: 6,"{""value"": 262, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.85,template,,,,0.0032,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,Which sector has the fewest companies?,sector_with_fewest_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL AND gics_sector != 'Other' GROUP BY gics_sector ORDER BY count ASC LIMIT 1",AT&T INC is in the Real Estate sector.,"{""type"": ""text"", ""value"": ""Real Estate""}",5.0,0.8,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are in the Communication Services sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%communication services%'),There are 17 companies in the Communication Services sector.,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are in the Real Estate sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%real estate%'),There are 3 companies in the Real Estate sector.,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are in the Consumer Staples sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer staples%'),There are 28 companies in the Consumer Staples sector.,"{""value"": 26, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",3.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are in the Consumer Discretionary sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer discretionary%'),There are 99 companies in the Consumer Discretionary sector.,"{""value"": 51, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are in the Energy sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%energy%'),There are 51 companies in the Energy sector.,"{""value"": 15, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are in the Materials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%materials%'),There are 41 companies in the Materials sector.,"{""value"": 22, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,Which sector has the second most companies?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""Other"", ""type"": ""text""}",1.0,0.8,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are in the Industrials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%industrials%'),There are 82 companies in the Industrials sector.,"{""value"": 28, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What was Meta's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%META PLATFORMS, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs = 0
ORDER BY l.period DESC
LIMIT 1",equity: 76793000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": -1865000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.8,template,,,,0.0551,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies reported cost of revenue in the latest period?,companies_reporting_cost_of_revenue,"WITH latest_cost AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'CostOfRevenue'
      AND n.qtrs = 0
)
SELECT COUNT(*) AS company_count
FROM latest_cost
WHERE rn = 1 AND value IS NOT NULL",Count: 2,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 450}",1.0,0.85,template,,,,0.048,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies have total revenue exceeding $50 billion in the latest period?,companies_revenue_above_threshold,"WITH latest_filing AS (
    SELECT
        s.cik,
        s.adsh,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
),
latest_revenue AS (
    SELECT lf.cik, n.value AS revenue
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE lf.rn = 1
      AND n.tag IN ('Revenues', 'SalesRevenueNet')
      AND n.qtrs = 0
)
SELECT COUNT(*) AS count
FROM latest_revenue lr
JOIN companies c ON c.cik = lr.cik
WHERE lr.revenue > 50000000000",Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.85,template,,,,0.1117,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What was Walmart's most recent total liabilities?,latest_total_liabilities,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%WALMART INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS total_liabilities,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'Liabilities'
      AND n.qtrs = 0
)
SELECT total_liabilities, period_end
FROM latest_metric
WHERE rn = 1",Could not find information for WALMART INC.,"{""type"": ""text"", ""value"": ""180000000000.0"", ""tolerance"": {""absolute"": 1000000000.0}}",1.0,0.8,template,,,,0.0428,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies reported positive net income in the latest period?,companies_positive_net_income,"WITH latest_net_income AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND n.qtrs = 0
)
SELECT COUNT(*) AS company_count
FROM latest_net_income
WHERE rn = 1 AND value > 0",Count: 11,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 10}",5.0,0.85,template,,,,0.1016,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What was Johnson & Johnson's most recent gross profit?,latest_gross_profit,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS gross_profit,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'GrossProfit'
      AND n.qtrs = 0
)
SELECT gross_profit, period_end
FROM latest_metric
WHERE rn = 1",Could not find information for JOHNSON.,"{""type"": ""text"", ""value"": ""60000000000.0"", ""tolerance"": {""absolute"": 1000000000.0}}",1.0,0.8,template,,,,0.0424,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What was Tesla's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs = 0
ORDER BY l.period DESC
LIMIT 1",equity: 74653000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 74653000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.0636,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies have 'LLC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%LLC%'),Count: 5,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 5}",5.0,0.7,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,Which company has CIK 0000019617?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000019617' LIMIT 1,JPMORGAN CHASE & CO's CIK is unknown.,"{""value"": ""JPMORGAN CHASE & CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies have 'INC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%INC%'),Count: 459,"{""value"": 459, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,Which company has CIK 0000050863?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000050863' LIMIT 1,INTEL CORP's CIK is unknown.,"{""value"": ""INTEL CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What is Walmart Inc.'s CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%WALMART INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",WALMART INC.'s CIK is 0000104169.,"{""value"": ""0000104169"", ""type"": ""text""}",5.0,0.8,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies have 'CORP' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%CORP%'),Count: 180,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What is Procter & Gamble's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%PROCTER & GAMBLE CO%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",PROCTER & GAMBLE CO's CIK is 0000080424.,"{""value"": ""0000080424"", ""type"": ""text""}",5.0,0.8,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,Which company has the longest company name in the dataset?,company_with_longest_name,SELECT name FROM companies ORDER BY LENGTH(name) DESC LIMIT 1,"name: CHARLES RIVER LABORATORIES INTERNATIONAL, INC.","{""type"": ""text"", ""value"": ""CHARLES RIVER LABORATORIES INTERNATIONAL, INC.""}",5.0,0.65,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What is Berkshire Hathaway's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%BERKSHIRE HATHAWAY INC%') LIMIT 1",BERKSHIRE HATHAWAY INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,llm_template_selection,,,"[{'stage': 'template_selection', 'tokens': {'prompt_tokens': 6044, 'completion_tokens': 369}, 'latency_ms': 3229, 'success': True, 'confidence': 0.95}]",3.231,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many quarterly (qtrs=1) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 1,Count: 3566310,"{""value"": 3566310, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0223,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are in the Utilities sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%utilities%'),There are 20 companies in the Utilities sector.,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What is Tesla's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1","TESLA, INC.'s CIK is 0001318605.","{""value"": ""0001318605"", ""type"": ""text""}",5.0,0.8,template,,,,0.0029,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many financial facts are denominated in USD?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0195,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,Which form type appears most frequently in submissions?,most_common_form_type,"SELECT form, COUNT(*) AS filing_count FROM sub GROUP BY form ORDER BY filing_count DESC LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many unique companies are represented in the dataset?,total_company_count,SELECT COUNT(DISTINCT cik) AS company_count FROM companies,Count: 589,"{""value"": 589, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What is the earliest period date in the financial data?,earliest_period_date,SELECT MIN(period) AS earliest_period FROM sub,earliest_period: 2014-05-31 00:00:00,"{""value"": ""2014-05-31 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0022,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies have international (non-US) incorporation?,international_incorporation_count,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS company_count
FROM latest_submission
WHERE rn = 1 AND UPPER(countryinc) <> 'US'",Count: 34,"{""value"": 34, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0097,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What is Amazon's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%AMAZON COM INC%') LIMIT 1",AMAZON COM INC is in the Consumer Discretionary sector.,"{""value"": ""Consumer Discretionary"", ""type"": ""text""}",5.0,0.8,llm_template_selection,,,"[{'stage': 'template_selection', 'tokens': {'prompt_tokens': 6046, 'completion_tokens': 370}, 'latency_ms': 6955, 'success': True, 'confidence': 0.93}]",14.043,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many different fiscal year ends are represented?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.7,template,,,,0.0014,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,Which state has the most company headquarters?,state_with_most_headquarters,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT l.headquarters_state AS state, COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL
GROUP BY l.headquarters_state
ORDER BY count DESC
LIMIT 1",state: CA | count: 123,"{""value"": ""CA"", ""type"": ""text""}",5.0,0.65,template,,,,0.0077,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies filed 10-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-K'),Count: 563,"{""value"": 563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.002,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What is the most recent filing date in the dataset?,latest_filing_date,SELECT MAX(filed) AS latest_filing_date FROM sub,latest_filing_date: 2025-06-30 00:00:00,"{""value"": ""2025-06-30 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.004,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are in the Health Care sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%health care%'),There are 80 companies in the Health Care sector.,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,Which company has CIK 0000066740?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000066740' LIMIT 1,3M CO's CIK is unknown.,"{""value"": ""3M CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many financial facts have footnotes?,fact_count_with_footnotes,SELECT COUNT(*) AS fact_count FROM num WHERE footnote IS NOT NULL AND TRIM(CAST(footnote AS VARCHAR)) <> '',Count: 33959,"{""value"": 33959, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0134,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,What currency is used most frequently in the numerical data?,most_common_currency,"SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL GROUP BY 1 ORDER BY fact_count DESC LIMIT 1",currency: USD | fact_count: 14760135,"{""value"": ""USD"", ""type"": ""text""}",5.0,0.65,template,,,,25.1911,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many companies are incorporated in Delaware?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('DE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('DE'))
  )
",Count: 346,"{""value"": 349, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",3.0,0.95,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1490, 'completion_tokens': 416}, 'latency_ms': 7559, 'success': True}]",7.5921,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,Which sector has the most companies in our S&P 500 dataset?,,,An error occurred while processing your question: invalid literal for int() with base 10: 'Financials',"{""value"": ""Other"", ""type"": ""text""}",1.0,0.0,,,,,12.2739,0.0,0.0,0.0,0.0
RUN_002,"06 Nov 2025, 1300 hours",simple,How many S&P 500 companies are in the Information Technology sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%information technology%'),There are 165 companies in the Information Technology sector.,"{""value"": 165, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 229}, 'latency_ms': 12693, 'success': True}]",12.7143,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What is Johnson & Johnson's return on equity (ROE) percentage?,,,"An error occurred while processing your question: Binder Error: Referenced column ""cik"" not found in FROM clause!
Candidate bindings: ""coreg""

LINE 1: ... 1), latest_ni AS (SELECT val as ni, ddate FROM num WHERE cik = (SELECT cik FROM company_cik) AND tag = 'NetIncomeLoss...
                                                                     ^","{""value"": 16.8, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1.0}}",1.0,0.0,,,,,0.0012,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many facts are denominated in Hong Kong dollars (HKD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0145,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,"How many facts use per-share units (per share, per unit)?",distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 12650, ""type"": ""numeric"", ""tolerance"": {""absolute"": 100}}",1.0,0.7,template,,,,0.0121,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What is the total count of unique unit types in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 21, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many facts are denominated in Mexican pesos (MXN)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 37, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many facts use barrels as unit of measure?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.0122,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many facts are denominated in Australian dollars (AUD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.015,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many facts use 'days' as the unit of measure?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.7,template,,,,0.0117,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What is the least common currency in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""14"", ""type"": ""text""}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many facts are measured in Japanese yen (JPY)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 122, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many facts use square feet as unit of measure?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.0117,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many facts are denominated in Swiss francs (CHF)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 218, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many facts use percentage as the unit of measure?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 8420, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",1.0,0.7,template,,,,0.0124,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What is the most common non-monetary unit of measure?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""shares"", ""type"": ""text""}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many facts are measured in British pounds (GBP)?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 446, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many facts use 'shares' as the unit of measure?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""value"": 642330, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.7,template,,,,0.012,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many facts are denominated in Euros (EUR)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('EUR'),Count: 37847,"{""value"": 37847, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.0114,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many facts are denominated in Canadian dollars (CAD)?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""absolute"": 50}}",5.0,0.7,template,,,,0.016,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What is the second most common currency in the dataset?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": ""14"", ""type"": ""text""}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many different currencies are represented in the financial data?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies returned more than 50% of operating cash flow to shareholders?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 85, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies have free cash flow exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 45, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies issued new debt during the period?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What was Johnson & Johnson's acquisition spending?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 2.8, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies have negative operating cash flow?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 76, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What was Tesla's change in cash and cash equivalents?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 16352000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies spent more than $5 billion on acquisitions?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies have positive free cash flow?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 282, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies have EBITDA exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0002,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies reported foreign exchange gains/losses?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies have negative net income?,companies_negative_net_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'NetIncomeLoss'
  AND n.value < 0",Count: 0,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.85,template,,,,0.0943,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What was Johnson & Johnson's income tax expense?,latest_income_tax_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS income_tax_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'IncomeTaxExpenseBenefit'
      AND n.qtrs = 0
)
SELECT income_tax_expense, period_end
FROM latest_metric
WHERE rn = 1",income_tax_expense: -500000000.0 | period_end: 2023-06-30 00:00:00,"{""value"": 2621000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.8,template,,,,0.0596,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies reported depreciation and amortization expenses?,companies_depreciation_amortization_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'DepreciationAndAmortization'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 0,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.0616,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What was Tesla's other income (expense) in the latest period?,latest_other_income_expense,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS other_income_expense,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'OtherNonoperatingIncomeExpense'
      AND n.qtrs = 0
)
SELECT other_income_expense, period_end
FROM latest_metric
WHERE rn = 1",Could not find information for TESLA INC.,"{""value"": 12556000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.8,template,,,,0.0669,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies have positive operating income?,companies_positive_operating_income,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'OperatingIncomeLoss'
  AND n.value > 0",Count: 0,"{""value"": 375, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.85,template,,,,0.0863,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies reported research and development expenses?,companies_research_expense_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'ResearchAndDevelopmentExpense'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 7,"{""value"": 156, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",1.0,0.7,template,,,,0.0861,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies have working capital exceeding $50 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 125, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies report goodwill on their balance sheets?,companies_goodwill_reported,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
)
SELECT COUNT(*) AS company_count
FROM latest_filing lf
JOIN num n ON n.adsh = lf.adsh
WHERE n.qtrs = 0
  AND n.tag = 'Goodwill'
  AND n.value IS NOT NULL
  AND n.value <> 0",Count: 3491,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.1086,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies have intangible assets exceeding $10 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies have negative stockholders' equity?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,"What is Tesla's property, plant and equipment value?",latest_property_plant_equipment,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS property_plant_equipment,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'PropertyPlantAndEquipmentNet'
      AND n.qtrs = 0
)
SELECT property_plant_equipment, period_end
FROM latest_metric
WHERE rn = 1",property_plant_equipment: 35836000000.0 | period_end: 2025-03-31 00:00:00,"{""value"": 125000000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.65,template,,,,0.15,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies have more liabilities than assets?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",1.0,0.0,,,,,0.0003,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies have current assets exceeding $100 billion?,,,There was an error querying the database. Please try again or rephrase your question.,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 3}}",1.0,0.0,,,,,0.0004,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies have Return on Equity above 20%?,companies_return_on_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('NetIncomeLoss','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND net_income IS NOT NULL
  AND (net_income / equity) * 100 > 20",Count: 0,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",3.0,0.85,template,,,,0.9402,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies have gross margin above 50%?,,,An error occurred while processing your question: invalid literal for int() with base 10: 'MASTERCARD INC',"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.0,,,,,19.2391,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies have a debt-to-equity ratio above 1.0?,companies_debt_to_equity_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'Liabilities' THEN n.value END) AS liabilities,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('Liabilities','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND liabilities IS NOT NULL
  AND liabilities / equity > 1",Count: 236,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 20}}",1.0,0.85,template,,,,0.1236,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies have negative Return on Assets?,companies_negative_return_on_assets,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('NetIncomeLoss','Assets')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE assets IS NOT NULL AND assets <> 0 AND net_income IS NOT NULL AND net_income / assets < 0",Count: 0,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.85,template,,,,0.1129,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies have a current ratio above 2.0?,companies_current_ratio_above_threshold,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'AssetsCurrent' THEN n.value END) AS current_assets,
        MAX(CASE WHEN n.tag = 'LiabilitiesCurrent' THEN n.value END) AS current_liabilities
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('AssetsCurrent','LiabilitiesCurrent')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE current_assets IS NOT NULL AND current_liabilities IS NOT NULL
  AND current_liabilities <> 0
  AND current_assets / current_liabilities > 2",Count: 115,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 15}}",1.0,0.7,template,,,,0.1175,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies have positive Return on Equity in the latest period?,companies_positive_return_on_equity,"WITH latest_filing AS (
    SELECT cik, adsh
    FROM (
        SELECT cik, adsh, period, filed, ROW_NUMBER() OVER (PARTITION BY cik ORDER BY period DESC, filed DESC) AS rn
        FROM sub
    )
    WHERE rn = 1
), latest_metrics AS (
    SELECT
        lf.cik,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(CASE WHEN n.tag IN ('StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest') THEN n.value END) AS equity
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE n.qtrs = 0
      AND n.tag IN ('NetIncomeLoss','StockholdersEquity','StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest')
    GROUP BY lf.cik
)
SELECT COUNT(*) AS company_count
FROM latest_metrics
WHERE equity IS NOT NULL AND equity <> 0 AND net_income IS NOT NULL AND net_income / equity > 0",Count: 1,"{""value"": 12, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",3.0,0.85,template,,,,0.1247,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many annual (qtrs=0) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 0,Count: 5484928,"{""value"": 613954, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",1.0,0.7,template,,,,0.0239,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What is the second most frequent form type in submissions?,form_type_rank,"WITH form_counts AS (
    SELECT form, COUNT(*) AS filing_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM sub
    GROUP BY form
)
SELECT form, filing_count
FROM form_counts
WHERE rank = 1
LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.0018,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many submissions are for fiscal period Q4?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q4'),Count: 1,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many submissions are for fiscal period Q3?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q3'),Count: 5238,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many submissions are for fiscal period Q2?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q2'),Count: 5296,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many submissions have September fiscal year end (0930)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 25, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many submissions have June fiscal year end (0630)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 45, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many submissions have March fiscal year end (0331)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",1.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many submissions have December fiscal year end (1231)?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 350, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many different form types are present in the submissions?,distinct_form_type_count,SELECT COUNT(DISTINCT form) AS form_type_count FROM sub,Count: 21,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 21}",5.0,0.7,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many submissions have fiscal period FY (full year)?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('FY'),Count: 6476,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 500}",1.0,0.7,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many submissions have fiscal period Q1?,submission_count_by_fiscal_period,SELECT COUNT(*) AS submission_count FROM sub WHERE UPPER(fp) = UPPER('Q1'),Count: 5664,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.75,template,,,,0.001,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many submissions have fiscal year 2025?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2025,Count: 917,"{""value"": 50, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.75,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many submissions have fiscal year 2024?,submission_count_by_fiscal_year,SELECT COUNT(*) AS submission_count FROM sub WHERE CAST(fy AS INT) = 2024,Count: 4167,"{""value"": 450, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.75,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What is the earliest filing date in the dataset?,earliest_filing_date,SELECT MIN(filed) AS earliest_filing_date FROM sub,earliest_filing_date: 2015-01-02 00:00:00,"{""value"": ""2015-01-02 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies filed 8-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('8-K'),Count: 112,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 112}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies filed 10-Q forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-Q'),Count: 543,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 543}",5.0,0.7,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many financial facts are reported with coreg (co-registrant) information?,fact_count_with_coreg,SELECT COUNT(*) AS fact_count FROM num WHERE coreg IS NOT NULL AND TRIM(coreg) <> '',Count: 1261087,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 400}",1.0,0.7,template,,,,0.0145,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many XBRL tags are classified as 'string' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%string%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.7,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many XBRL tags contain the word 'Debt' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%DEBT%',Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 26515}",1.0,0.85,template,,,,0.016,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many XBRL tags contain the word 'Equity' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%EQUITY%',Count: 0,"{""value"": 24563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.85,template,,,,0.0157,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many XBRL tags contain the word 'Cash' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%CASH%',Count: 12,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 29232}",1.0,0.85,template,,,,0.0184,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What is the third most frequent XBRL tag in numerical data?,tag_nth_most_common,"WITH tag_counts AS (
    SELECT
        tag,
        COUNT(*) AS fact_count,
        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank
    FROM num
    GROUP BY tag
)
SELECT tag, fact_count
FROM tag_counts
WHERE rank = 1
LIMIT 1",tag: RevenueFromContractWithCustomerExcludingAssessedTax | fact_count: 621672,"{""type"": ""text"", ""value"": ""Assets""}",1.0,0.65,template,,,,0.0306,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many numerical facts have zero values?,fact_count_zero_values,SELECT COUNT(*) AS fact_count FROM num WHERE value = 0,Count: 1427015,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 85000}",1.0,0.7,template,,,,0.0561,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many numerical facts have negative values?,fact_count_negative_values,SELECT COUNT(*) AS fact_count FROM num WHERE value < 0,Count: 2124201,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 125000}",1.0,0.7,template,,,,0.0577,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many XBRL tags are classified as 'per-share' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%per-share%'),Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 6063}",1.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many XBRL tags have 'shares' as unit of measure in numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 50}, ""value"": 949}",1.0,0.7,template,,,,0.0116,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many financial facts have duplicate values (dimhash populated)?,,,"An error occurred while processing your question: Binder Error: Referenced column ""dimhash"" not found in FROM clause!
Candidate bindings: ""adsh"", ""ddate"", ""segments""

LINE 1: SELECT COUNT(*) AS fact_count FROM num WHERE dimhash IS NOT NULL AND TRIM(dimhash) <> ''
                                                     ^","{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 45000}",1.0,0.0,,,,,0.0011,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many different unit types (UOM) are present in the numerical data?,distinct_uom_count,SELECT COUNT(DISTINCT TRIM(UPPER(uom))) AS uom_count FROM num WHERE uom IS NOT NULL,Count: 49,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 8}",1.0,0.7,template,,,,0.014,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many XBRL tags contain the word 'Liability' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%LIABILITY%',Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 11059}",1.0,0.7,template,,,,0.0165,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many XBRL tags contain the word 'Asset' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%ASSET%',Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 40285}",1.0,0.7,template,,,,0.0185,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many XBRL tags contain the word 'Revenue' in their name?,tag_count_by_keyword,SELECT COUNT(*) AS tag_count FROM tag WHERE tag LIKE '%REVENUE%',Count: 0,"{""value"": 12221, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",1.0,0.85,template,,,,0.0183,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many XBRL tags are classified as 'monetary' data type?,tag_count_by_datatype,SELECT COUNT(*) AS tag_count FROM tag WHERE datatype IS NOT NULL AND LOWER(datatype) LIKE LOWER('%monetary%'),Count: 454617,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 454617}",5.0,0.7,template,,,,0.0029,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many XBRL tags have a debit-credit flag of 'Debit'?,,,"An error occurred while processing your question: Binder Error: Referenced column ""debitcredit"" not found in FROM clause!
Candidate bindings: ""abstract"", ""doc"", ""iord"", ""crdr"", ""source_period""

LINE 1: SELECT COUNT(*) AS tag_count FROM tag WHERE debitcredit IS NOT NULL AND UPPER(debitcredit) = UPPER(...
                                                    ^","{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.0,,,,,0.0009,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What is Google's (Alphabet) return on equity (ROE)?,,,"An error occurred while processing your question: Binder Error: Referenced column ""cik"" not found in FROM clause!
Candidate bindings: ""coreg""

LINE 1: ... 1), latest_ni AS (SELECT val as ni, ddate FROM num WHERE cik = (SELECT cik FROM company_cik) AND tag = 'NetIncomeLoss...
                                                                     ^","{""value"": 15.0, ""type"": ""numeric""}",1.0,0.0,,,,,0.0048,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are headquartered in Georgia?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('GA')",Count: 22,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 17}",1.0,0.7,template,,,,0.006,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are incorporated in Bermuda?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 2}",1.0,0.7,template,,,,0.0062,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are headquartered in Washington state?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('WA')",Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",5.0,0.7,template,,,,0.0059,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,Which state has the third most company headquarters?,state_with_most_headquarters,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT l.headquarters_state AS state, COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL
GROUP BY l.headquarters_state
ORDER BY count DESC
LIMIT 1",state: CA | count: 123,"{""value"": ""NY"", ""type"": ""text""}",1.0,0.65,template,,,,0.0076,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are headquartered in Massachusetts?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('MA')",Count: 31,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 27}",3.0,0.7,template,,,,0.008,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are incorporated in the United Kingdom?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 1}, ""value"": 2}",1.0,0.7,template,,,,0.0065,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are headquartered in North Carolina?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NC')",Count: 20,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 13}",1.0,0.7,template,,,,0.006,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are headquartered in Ohio?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('OH')",Count: 24,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",3.0,0.7,template,,,,0.0057,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many different US states are represented in headquarters data?,distinct_headquarters_states,SELECT COUNT(DISTINCT stprba) AS state_count FROM sub WHERE stprba IS NOT NULL,Count: 44,"{""value"": 44, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many different countries are represented in the incorporation data?,distinct_incorporation_countries,SELECT COUNT(DISTINCT countryinc) AS country_count FROM sub WHERE countryinc IS NOT NULL,Count: 16,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 16}",5.0,0.7,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are incorporated in Switzerland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 5}",5.0,0.7,template,,,,0.0058,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are headquartered in Florida?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('FL')",Count: 26,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 20}",1.0,0.7,template,,,,0.0056,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are headquartered in Illinois?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('IL')",Count: 42,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 35}",1.0,0.7,template,,,,0.0059,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,Which state has the second most company headquarters after California?,state_with_most_headquarters,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT l.headquarters_state AS state, COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL
GROUP BY l.headquarters_state
ORDER BY count DESC
LIMIT 1",state: CA | count: 123,"{""value"": 106, ""type"": ""text""}",1.0,0.65,template,,,,0.0069,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are incorporated in Canada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 3}",3.0,0.7,template,,,,0.0063,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are incorporated in Ireland?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('IN'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('IN'))
  )
",Count: 6,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 14}",1.0,0.7,template,,,,0.0062,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are incorporated in Nevada?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('NV'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('NV'))
  )
",Count: 9,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 2}, ""value"": 3}",1.0,0.7,template,,,,0.0062,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are headquartered in Texas?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('TX')",Count: 81,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 67}",1.0,0.7,template,,,,0.0061,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are headquartered in New York?,companies_by_hq_state,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND UPPER(l.headquarters_state) = UPPER('NY')",Count: 69,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 61}",1.0,0.7,template,,,,0.0061,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,Which sector contains Johnson & Johnson?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%') LIMIT 1",JOHNSON & JOHNSON is in the Health Care sector.,"{""value"": ""Health Care"", ""type"": ""text""}",5.0,0.8,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many sectors have fewer than 25 companies?,sectors_below_threshold,"WITH sector_counts AS (
    SELECT gics_sector, COUNT(*) AS count
    FROM companies
    WHERE gics_sector IS NOT NULL
    GROUP BY gics_sector
)
SELECT COUNT(*) AS sector_count
FROM sector_counts
WHERE count < 25",Count: 4,"{""value"": 262, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.85,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many sectors have more than 50 companies?,sectors_above_threshold,"SELECT COUNT(DISTINCT gics_sector) as sector_count FROM (SELECT gics_sector, COUNT(*) as cnt FROM companies GROUP BY gics_sector HAVING cnt > 50) subq",Count: 6,"{""value"": 262, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.85,template,,,,0.003,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,Which sector has the fewest companies?,sector_with_fewest_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL AND gics_sector != 'Other' GROUP BY gics_sector ORDER BY count ASC LIMIT 1",AT&T INC is in the Real Estate sector.,"{""type"": ""text"", ""value"": ""Real Estate""}",5.0,0.8,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are in the Communication Services sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%communication services%'),There are 17 companies in the Communication Services sector.,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are in the Real Estate sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%real estate%'),There are 3 companies in the Real Estate sector.,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are in the Consumer Staples sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer staples%'),There are 28 companies in the Consumer Staples sector.,"{""value"": 26, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",3.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are in the Consumer Discretionary sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%consumer discretionary%'),There are 99 companies in the Consumer Discretionary sector.,"{""value"": 51, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are in the Energy sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%energy%'),There are 51 companies in the Energy sector.,"{""value"": 15, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0006,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are in the Materials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%materials%'),There are 41 companies in the Materials sector.,"{""value"": 22, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,Which sector has the second most companies?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""Other"", ""type"": ""text""}",1.0,0.8,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are in the Industrials sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%industrials%'),There are 82 companies in the Industrials sector.,"{""value"": 28, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What was Meta's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%META PLATFORMS, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs = 0
ORDER BY l.period DESC
LIMIT 1",equity: 76793000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": -1865000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",1.0,0.8,template,,,,0.0533,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies reported cost of revenue in the latest period?,companies_reporting_cost_of_revenue,"WITH latest_cost AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'CostOfRevenue'
      AND n.qtrs = 0
)
SELECT COUNT(*) AS company_count
FROM latest_cost
WHERE rn = 1 AND value IS NOT NULL",Count: 2,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 10}, ""value"": 450}",1.0,0.85,template,,,,0.0459,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies have total revenue exceeding $50 billion in the latest period?,companies_revenue_above_threshold,"WITH latest_filing AS (
    SELECT
        s.cik,
        s.adsh,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
),
latest_revenue AS (
    SELECT lf.cik, n.value AS revenue
    FROM latest_filing lf
    JOIN num n ON n.adsh = lf.adsh
    WHERE lf.rn = 1
      AND n.tag IN ('Revenues', 'SalesRevenueNet')
      AND n.qtrs = 0
)
SELECT COUNT(*) AS count
FROM latest_revenue lr
JOIN companies c ON c.cik = lr.cik
WHERE lr.revenue > 50000000000",Count: 0,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 0}",5.0,0.85,template,,,,0.1051,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What was Walmart's most recent total liabilities?,latest_total_liabilities,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%WALMART INC.%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS total_liabilities,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'Liabilities'
      AND n.qtrs = 0
)
SELECT total_liabilities, period_end
FROM latest_metric
WHERE rn = 1",Could not find information for WALMART INC.,"{""type"": ""text"", ""value"": ""180000000000.0"", ""tolerance"": {""absolute"": 1000000000.0}}",1.0,0.8,template,,,,0.0445,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies reported positive net income in the latest period?,companies_positive_net_income,"WITH latest_net_income AS (
    SELECT
        s.cik,
        n.value,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY n.ddate DESC, n.adsh DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE n.tag = 'NetIncomeLoss'
      AND n.qtrs = 0
)
SELECT COUNT(*) AS company_count
FROM latest_net_income
WHERE rn = 1 AND value > 0",Count: 10,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 5}, ""value"": 10}",5.0,0.85,template,,,,0.089,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What was Johnson & Johnson's most recent gross profit?,latest_gross_profit,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%JOHNSON & JOHNSON%')
    LIMIT 1
), latest_metric AS (
    SELECT
        n.value AS gross_profit,
        s.period AS period_end,
        ROW_NUMBER() OVER (ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN num n ON n.adsh = s.adsh
    WHERE s.cik = (SELECT cik FROM target_company)
      AND n.tag = 'GrossProfit'
      AND n.qtrs = 0
)
SELECT gross_profit, period_end
FROM latest_metric
WHERE rn = 1",Could not find information for JOHNSON.,"{""type"": ""text"", ""value"": ""60000000000.0"", ""tolerance"": {""absolute"": 1000000000.0}}",1.0,0.8,template,,,,0.0404,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What was Tesla's most recent stockholders' equity?,latest_equity,"WITH target_company AS (
    SELECT cik
    FROM companies
    WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%')
    LIMIT 1
),
latest_filing AS (
    SELECT
        s.adsh,
        s.cik,
        s.period,
        s.fy,
        s.fp,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.period DESC, s.filed DESC) AS rn
    FROM sub s
    JOIN target_company t ON t.cik = s.cik
)
SELECT
    n.value AS equity,
    l.period AS period_end_date,
    l.fy AS fiscal_year,
    l.fp AS fiscal_period
FROM latest_filing l
JOIN num n ON n.adsh = l.adsh
WHERE l.rn = 1
  AND n.tag = 'StockholdersEquity'
  AND n.qtrs = 0
ORDER BY l.period DESC
LIMIT 1",equity: 74653000000.0 | period_end_date: 2025-03-31 00:00:00 | fiscal_year: 2025.0 | fiscal_period: Q1,"{""value"": 74653000000.0, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.01}}",5.0,0.8,template,,,,0.0773,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies have 'LLC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%LLC%'),Count: 5,"{""type"": ""numeric"", ""tolerance"": {""absolute"": 3}, ""value"": 5}",5.0,0.7,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,Which company has CIK 0000019617?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000019617' LIMIT 1,JPMORGAN CHASE & CO's CIK is unknown.,"{""value"": ""JPMORGAN CHASE & CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0007,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies have 'INC' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%INC%'),Count: 459,"{""value"": 459, ""type"": ""numeric"", ""tolerance"": {""absolute"": 10}}",5.0,0.7,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,Which company has CIK 0000050863?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000050863' LIMIT 1,INTEL CORP's CIK is unknown.,"{""value"": ""INTEL CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What is Walmart Inc.'s CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%WALMART INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",WALMART INC.'s CIK is 0000104169.,"{""value"": ""0000104169"", ""type"": ""text""}",5.0,0.8,template,,,,0.0016,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies have 'CORP' in their official name?,company_name_keyword_count,SELECT COUNT(*) AS company_count FROM companies WHERE UPPER(name) LIKE UPPER('%CORP%'),Count: 180,"{""value"": 180, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0008,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What is Procter & Gamble's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%PROCTER & GAMBLE CO%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1",PROCTER & GAMBLE CO's CIK is 0000080424.,"{""value"": ""0000080424"", ""type"": ""text""}",5.0,0.8,template,,,,0.002,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,Which company has the longest company name in the dataset?,company_with_longest_name,SELECT name FROM companies ORDER BY LENGTH(name) DESC LIMIT 1,"name: CHARLES RIVER LABORATORIES INTERNATIONAL, INC.","{""type"": ""text"", ""value"": ""CHARLES RIVER LABORATORIES INTERNATIONAL, INC.""}",5.0,0.65,template,,,,0.0011,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What is Berkshire Hathaway's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%BERKSHIRE HATHAWAY INC%') LIMIT 1",BERKSHIRE HATHAWAY INC is in the Financials sector.,"{""value"": ""Financials"", ""type"": ""text""}",5.0,0.8,llm_template_selection,,,"[{'stage': 'template_selection', 'tokens': {'prompt_tokens': 6044, 'completion_tokens': 299}, 'latency_ms': 3247, 'success': True, 'confidence': 0.95}]",9.1314,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,Which company has CIK 0000789019?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000789019' LIMIT 1,MICROSOFT CORP's CIK is unknown.,"{""value"": ""MICROSOFT CORP"", ""type"": ""text""}",5.0,0.65,template,,,,0.0017,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many quarterly (qtrs=1) financial facts are there?,fact_count_by_qtrs,SELECT COUNT(*) AS fact_count FROM num WHERE qtrs = 1,Count: 3566310,"{""value"": 3566310, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0426,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are in the Utilities sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%utilities%'),There are 20 companies in the Utilities sector.,"{""value"": 0, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",1.0,0.95,template,,,,0.0013,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What is Tesla's CIK number?,company_by_cik,"SELECT name, cik FROM companies WHERE UPPER(name) LIKE UPPER('%TESLA, INC.%') AND name NOT LIKE '%REIT%' ORDER BY LENGTH(name) LIMIT 1","TESLA, INC.'s CIK is 0001318605.","{""value"": ""0001318605"", ""type"": ""text""}",5.0,0.8,template,,,,0.0034,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many financial facts are denominated in USD?,fact_count_by_currency,SELECT COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL AND UPPER(TRIM(uom)) = UPPER('USD'),Count: 14760135,"{""value"": 14760135, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0175,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,Which form type appears most frequently in submissions?,most_common_form_type,"SELECT form, COUNT(*) AS filing_count FROM sub GROUP BY form ORDER BY filing_count DESC LIMIT 1",form: 10-Q | filing_count: 16129,"{""value"": ""10-Q"", ""type"": ""text""}",5.0,0.65,template,,,,0.002,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many unique companies are represented in the dataset?,total_company_count,SELECT COUNT(DISTINCT cik) AS company_count FROM companies,Count: 589,"{""value"": 589, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.0012,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What is the earliest period date in the financial data?,earliest_period_date,SELECT MIN(period) AS earliest_period FROM sub,earliest_period: 2014-05-31 00:00:00,"{""value"": ""2014-05-31 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0028,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies have international (non-US) incorporation?,international_incorporation_count,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS company_count
FROM latest_submission
WHERE rn = 1 AND UPPER(countryinc) <> 'US'",Count: 34,"{""value"": 34, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.7,template,,,,0.01,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What is Amazon's GICS sector?,company_sector,"SELECT name, gics_sector FROM companies WHERE UPPER(name) LIKE UPPER('%AMAZON COM INC%') LIMIT 1",AMAZON COM INC is in the Consumer Discretionary sector.,"{""value"": ""Consumer Discretionary"", ""type"": ""text""}",5.0,0.8,llm_template_selection,,,"[{'stage': 'template_selection', 'tokens': {'prompt_tokens': 6046, 'completion_tokens': 360}, 'latency_ms': 3813, 'success': True, 'confidence': 0.95}]",11.7644,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many different fiscal year ends are represented?,distinct_fiscal_year_count,SELECT COUNT(DISTINCT fye) AS fiscal_year_end_count FROM sub WHERE fye IS NOT NULL,Count: 14,"{""value"": 14, ""type"": ""numeric"", ""tolerance"": {""absolute"": 1}}",5.0,0.7,template,,,,0.0026,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,Which state has the most company headquarters?,state_with_most_headquarters,"WITH latest_business_address AS (
    SELECT
        s.cik,
        s.stprba AS headquarters_state,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
)
SELECT l.headquarters_state AS state, COUNT(*) AS count
FROM latest_business_address l
JOIN companies c ON c.cik = l.cik
WHERE l.rn = 1 AND l.headquarters_state IS NOT NULL
GROUP BY l.headquarters_state
ORDER BY count DESC
LIMIT 1",state: CA | count: 123,"{""value"": ""CA"", ""type"": ""text""}",5.0,0.65,template,,,,0.0179,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies filed 10-K forms?,company_count_by_form,SELECT COUNT(DISTINCT cik) AS company_count FROM sub WHERE UPPER(form) = UPPER('10-K'),Count: 563,"{""value"": 563, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",5.0,0.7,template,,,,0.0019,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What is the most recent filing date in the dataset?,latest_filing_date,SELECT MAX(filed) AS latest_filing_date FROM sub,latest_filing_date: 2025-06-30 00:00:00,"{""value"": ""2025-06-30 00:00:00"", ""type"": ""text""}",5.0,0.65,template,,,,0.0046,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are in the Health Care sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%health care%'),There are 80 companies in the Health Care sector.,"{""value"": 80, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,,0.0009,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,Which company has CIK 0000066740?,company_name_by_cik,SELECT name FROM companies WHERE cik = '0000066740' LIMIT 1,3M CO's CIK is unknown.,"{""value"": ""3M CO"", ""type"": ""text""}",5.0,0.65,template,,,,0.0015,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many financial facts have footnotes?,fact_count_with_footnotes,SELECT COUNT(*) AS fact_count FROM num WHERE footnote IS NOT NULL AND TRIM(CAST(footnote AS VARCHAR)) <> '',Count: 33959,"{""value"": 33959, ""type"": ""numeric"", ""tolerance"": {""relative"": 0.05}}",5.0,0.7,template,,,,0.0206,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,What currency is used most frequently in the numerical data?,most_common_currency,"SELECT UPPER(TRIM(uom)) AS currency, COUNT(*) AS fact_count FROM num WHERE uom IS NOT NULL GROUP BY 1 ORDER BY fact_count DESC LIMIT 1",currency: USD | fact_count: 14760135,"{""value"": ""USD"", ""type"": ""text""}",5.0,0.65,template,,,,0.0388,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many companies are incorporated in Delaware?,companies_by_incorporation_state,"WITH latest_submission AS (
    SELECT
        s.cik,
        s.stprinc,
        s.countryinc,
        ROW_NUMBER() OVER (PARTITION BY s.cik ORDER BY s.filed DESC) AS rn
    FROM sub s
    WHERE s.stprinc IS NOT NULL OR s.countryinc IS NOT NULL
)
SELECT COUNT(*) AS count
FROM latest_submission
WHERE rn = 1
  AND (
      (stprinc IS NOT NULL AND UPPER(stprinc) = UPPER('DE'))
      OR (countryinc IS NOT NULL AND UPPER(countryinc) = UPPER('DE'))
  )
",Count: 346,"{""value"": 349, ""type"": ""numeric"", ""tolerance"": {""absolute"": 2}}",3.0,0.7,template,,,,0.1059,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,Which sector has the most companies in our S&P 500 dataset?,sector_with_most_companies,"SELECT gics_sector, COUNT(*) as count FROM companies WHERE gics_sector IS NOT NULL GROUP BY gics_sector ORDER BY count DESC LIMIT 1",AT&T INC is in the Financials sector.,"{""value"": ""Other"", ""type"": ""text""}",1.0,0.8,template,,,,25.0958,0.0,0.0,0.0,0.0
RUN_001,"06 Nov 2025, 1300 hours",simple,How many S&P 500 companies are in the Information Technology sector?,sector_company_count,SELECT COUNT(*) as count FROM companies WHERE UPPER(gics_sector) LIKE UPPER('%information technology%'),There are 165 companies in the Information Technology sector.,"{""value"": 165, ""type"": ""numeric"", ""tolerance"": {""absolute"": 5}}",5.0,0.95,template,,,"[{'stage': 'entity_extraction', 'tokens': {'prompt_tokens': 1496, 'completion_tokens': 231}, 'latency_ms': 4122, 'success': True}]",4.1471,0.0,0.0,0.0,0.0
RUN_022,"11 Nov 2025, 1600 hours",time_series,Which Technology companies have shown the most consistent profitability improvement over the last 5 years (2019-2023)?,profit_margin_consistency_trend,"WITH sector_companies AS (
    SELECT
        cik,
        name,
        REGEXP_REPLACE(UPPER(TRIM(name)), '[^A-Z0-9]', '', 'g') AS canonical_name
    FROM companies
    WHERE (UPPER('Information Technology') = 'ALL' OR LOWER(gics_sector) LIKE LOWER('%Information Technology%'))
),
base_filings AS (
    SELECT
        s.adsh,
        s.cik,
        CAST(s.fy AS INTEGER) AS fiscal_year,
        s.period,
        ROW_NUMBER() OVER (PARTITION BY s.cik, s.fy ORDER BY s.filed DESC) AS rn
    FROM sub s
    JOIN sector_companies sc USING (cik)
    WHERE s.form IN ('10-K','10-K/A')
      AND s.fy BETWEEN 2019 AND 2023
),
filings AS (
    SELECT adsh, cik, fiscal_year, period
    FROM base_filings
    WHERE rn = 1
),
values AS (
    SELECT
        f.cik,
        f.fiscal_year,
        MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,
        MAX(
            CASE
                WHEN n.tag IN (
                    'Revenues',
                    'RevenueFromContractWithCustomerExcludingAssessedTax',
                    'SalesRevenueNet'
                ) THEN n.value
            END
        ) AS revenue
    FROM filings f
    JOIN num n ON n.adsh = f.adsh AND n.ddate = f.period
    WHERE n.tag IN (
        'NetIncomeLoss',
        'Revenues',
        'RevenueFromContractWithCustomerExcludingAssessedTax',
        'SalesRevenueNet'
    )
    GROUP BY f.cik, f.fiscal_year
),
margins AS (
    SELECT
        sc.canonical_name,
        sc.name AS display_name,
        v.fiscal_year,
        v.net_income / NULLIF(v.revenue, 0) AS profit_margin
    FROM values v
    JOIN sector_companies sc USING (cik)
    WHERE v.net_income IS NOT NULL
      AND v.revenue IS NOT NULL
),
ordered AS (
    SELECT
        m.*,
        LEAD(m.profit_margin) OVER (PARTITION BY m.canonical_name ORDER BY m.fiscal_year) AS next_margin,
        LEAD(m.fiscal_year) OVER (PARTITION BY m.canonical_name ORDER BY m.fiscal_year) AS next_year
    FROM margins m
)
SELECT
    display_name AS name,
    ROUND(MAX(CASE WHEN fiscal_year = 2019 THEN profit_margin END) * 100, 2) AS margin_2019_pct,
    ROUND(MAX(CASE WHEN fiscal_year = 2020 THEN profit_margin END) * 100, 2) AS margin_2020_pct,
    ROUND(MAX(CASE WHEN fiscal_year = 2021 THEN profit_margin END) * 100, 2) AS margin_2021_pct,
    ROUND(MAX(CASE WHEN fiscal_year = 2022 THEN profit_margin END) * 100, 2) AS margin_2022_pct,
    ROUND(MAX(CASE WHEN fiscal_year = 2023 THEN profit_margin END) * 100, 2) AS margin_2023_pct,
    ROUND(
        (MAX(CASE WHEN fiscal_year = 2023 THEN profit_margin END) - MIN(CASE WHEN fiscal_year = 2019 THEN profit_margin END))
        * 100,
        2
    ) AS improvement_pct,
    SUM(
        CASE
            WHEN next_year = fiscal_year + 1
             AND next_margin IS NOT NULL
             AND next_margin >= profit_margin THEN 1
            ELSE 0
        END
    ) AS consistency_steps
FROM ordered
GROUP BY display_name
HAVING COUNT(DISTINCT fiscal_year) = 5
ORDER BY consistency_steps DESC, improvement_pct DESC, display_name
LIMIT 5;","Top Technology profit margin improvers (FY2019-FY2023):
1) ON SEMICONDUCTOR CORP: 3.84% (2019)  26.46% (2023) +22.62% | Consistency steps: 4.0
2) AUTOMATIC DATA PROCESSING INC: 16.17% (2019)  18.94% (2023) +2.77% | Consistency steps: 4.0
3) EMERSON ELECTRIC CO: 12.55% (2019)  87.17% (2023) +74.62% | Consistency steps: 3.0
4) UBER TECHNOLOGIES, INC: -60.13% (2019)  5.06% (2023) +65.19% | Consistency steps: 3.0
5) FIRST SOLAR, INC.: -3.75% (2019)  25.03% (2023) +28.79% | Consistency steps: 3.0","{""type"": ""multi_year_analysis"", ""validation_method"": ""duckdb_sql_on_parquet"", ""answer_pattern"": ""Rank technology companies by 5-year profit margin improvement and monotonic consistency."", ""format"": ""Multi-year table with profit margins"", ""visualization"": ""Line chart showing profit margin trends"", ""data_table"": {""columns"": [""Company"", ""2019_Margin_%"", ""2020_Margin_%"", ""2021_Margin_%"", ""2022_Margin_%"", ""2023_Margin_%"", ""5Yr_Improvement_pp"", ""Consistency_Steps""], ""sample_data"": [[""ON Semiconductor"", ""3.84"", ""4.46"", ""14.98"", ""22.85"", ""26.46"", ""+22.62"", ""4 / 4""], [""Automatic Data Processing"", ""16.17"", ""16.91"", ""17.32"", ""17.87"", ""18.94"", ""+2.77"", ""4 / 4""], [""Emerson Electric"", ""12.55"", ""11.70"", ""12.61"", ""16.45"", ""87.17"", ""+74.62"", ""3 / 4""], [""Uber Technologies"", ""-60.13"", ""-54.48"", ""-2.84"", ""-28.68"", ""5.06"", ""+65.19"", ""3 / 4""], [""First Solar"", ""-3.75"", ""14.69"", ""16.03"", ""-1.69"", ""25.03"", ""+28.79"", ""3 / 4""]]}, ""business_insight"": ""Semiconductor suppliers and recurring-revenue platforms are the only tech cohorts delivering four straight years of margin improvement; heavy transformation stories still show volatility but the slope is finally positive."", ""key_findings"": [""ON Semiconductor expanded net profit margin from 3.84% in FY2019 to 26.46% in FY2023 (+22.62pp) thanks to silicon-carbide mix and disciplined capex, delivering 4/4 positive steps."", ""ADP inched margins from 16.17% to 18.94% with subscription automation and pricing lift\u2014steady 0.5-0.7pp annual gains make it the benchmark compounder."", ""Uber swung from -60% to +5% margins as take rates and cost leverage improved post-pandemic; volatility remains but the profitability breakthrough is tangible."", ""Emerson\u2019s FY2023 margin spike to 87.17% is tied to asset divestiture gains, highlighting the need to flag non-recurring uplift when ranking \u201cimprovements.\u201d""], ""investment_implications"": [""Focus on firms showing structural, not just cyclical, margin expansion (ADP, ON Semi) for core holdings."", ""Turnaround names (Uber, First Solar) carry higher volatility but can rapidly add 25-65pp of margin once scale and mix inflect; size positions accordingly."", ""CFO teams should annotate one-time gains (e.g., Emerson disposals) before feeding automated storytellers, so downstream answers stay decision grade.""], ""sample_analysis"": ""WITH tech_companies AS (\n    SELECT DISTINCT cik, name\n    FROM read_parquet('data/parquet/companies_with_sectors.parquet')\n    WHERE gics_sector = 'Information Technology'\n),\nbase_filings AS (\n    SELECT s.adsh, s.cik, CAST(s.fy AS INTEGER) AS fiscal_year, s.period, s.filed,\n           ROW_NUMBER() OVER (PARTITION BY s.cik, s.fy ORDER BY s.filed DESC) AS rn\n    FROM read_parquet('data/parquet/sub.parquet') s\n    JOIN tech_companies t USING (cik)\n    WHERE s.form IN ('10-K','10-K/A')\n      AND s.fy BETWEEN 2019 AND 2023\n),\nfilings AS (\n    SELECT adsh, cik, fiscal_year, period\n    FROM base_filings\n    WHERE rn = 1\n),\nvalues AS (\n    SELECT f.cik, f.fiscal_year,\n           MAX(CASE WHEN n.tag = 'NetIncomeLoss' THEN n.value END) AS net_income,\n           MAX(CASE WHEN n.tag IN ('Revenues','RevenueFromContractWithCustomerExcludingAssessedTax','SalesRevenueNet') THEN n.value END) AS revenue\n    FROM filings f\n    JOIN read_parquet('data/parquet/num.parquet') n\n      ON f.adsh = n.adsh AND n.ddate = f.period\n    WHERE n.tag IN ('NetIncomeLoss','Revenues','RevenueFromContractWithCustomerExcludingAssessedTax','SalesRevenueNet')\n    GROUP BY f.cik, f.fiscal_year\n),\nmargins AS (\n    SELECT t.name, v.cik, v.fiscal_year, v.net_income, v.revenue,\n           v.net_income / NULLIF(v.revenue, 0) AS profit_margin\n    FROM values v\n    JOIN tech_companies t ON v.cik = t.cik\n    WHERE v.net_income IS NOT NULL\n      AND v.revenue IS NOT NULL\n),\nordered AS (\n    SELECT m.*,\n           LEAD(m.profit_margin) OVER (PARTITION BY m.cik ORDER BY m.fiscal_year) AS next_margin,\n           LEAD(m.fiscal_year) OVER (PARTITION BY m.cik ORDER BY m.fiscal_year) AS next_year\n    FROM margins m\n)\nSELECT name,\n       ROUND(MAX(CASE WHEN fiscal_year = 2019 THEN profit_margin END)*100, 2) AS margin_2019_pct,\n       ROUND(MAX(CASE WHEN fiscal_year = 2020 THEN profit_margin END)*100, 2) AS margin_2020_pct,\n       ROUND(MAX(CASE WHEN fiscal_year = 2021 THEN profit_margin END)*100, 2) AS margin_2021_pct,\n       ROUND(MAX(CASE WHEN fiscal_year = 2022 THEN profit_margin END)*100, 2) AS margin_2022_pct,\n       ROUND(MAX(CASE WHEN fiscal_year = 2023 THEN profit_margin END)*100, 2) AS margin_2023_pct,\n       ROUND((MAX(CASE WHEN fiscal_year = 2023 THEN profit_margin END) - MIN(CASE WHEN fiscal_year = 2019 THEN profit_margin END))*100, 2) AS improvement_pct,\n       SUM(CASE WHEN next_year = fiscal_year + 1 AND next_margin IS NOT NULL AND next_margin >= profit_margin THEN 1 ELSE 0 END) AS consistency_steps\nFROM ordered\nGROUP BY name\nHAVING COUNT(DISTINCT fiscal_year) = 5\nORDER BY consistency_steps DESC, improvement_pct DESC, name\nLIMIT 5;""}",,0.95,template,,,,0.4613,0.0,0.0,0.0,0.0
RUN_022,"11 Nov 2025, 1600 hours",time_series,"How did gross margins for leading Consumer Staples brands change between FY2019 and FY2023, and what does that signal about inflation resilience?",gross_margin_trend_sector,"WITH sector_companies AS (
    SELECT
        cik,
        name,
        REGEXP_REPLACE(UPPER(TRIM(name)), '[^A-Z0-9]', '', 'g') AS canonical_name
    FROM companies
    WHERE (UPPER('Consumer Staples') = 'ALL' OR LOWER(gics_sector) LIKE LOWER('%Consumer Staples%'))
),
ranked_filings AS (
    SELECT
        s.adsh,
        s.cik,
        CAST(s.fy AS INTEGER) AS fiscal_year,
        s.period,
        ROW_NUMBER() OVER (PARTITION BY s.cik, s.fy ORDER BY s.filed DESC) AS rn
    FROM sub s
    JOIN sector_companies sc USING (cik)
    WHERE s.form IN ('10-K','10-K/A','20-F')
      AND s.fy BETWEEN 2019 AND 2023
),
annual_filings AS (
    SELECT adsh, cik, fiscal_year, period
    FROM ranked_filings
    WHERE rn = 1
),
values AS (
    SELECT
        f.cik,
        f.fiscal_year,
        MAX(
            CASE
                WHEN n.tag IN (
                    'Revenues',
                    'RevenueFromContractWithCustomerExcludingAssessedTax',
                    'SalesRevenueNet',
                    'NetSalesRevenue',
                    'NetSales'
                ) THEN n.value
            END
        ) AS revenue,
        MAX(
            CASE
                WHEN n.tag IN (
                    'CostOfRevenue',
                    'CostOfGoodsAndServicesSold',
                    'CostOfGoodsSold'
                ) THEN n.value
            END
        ) AS cost_of_revenue,
        MAX(CASE WHEN n.tag = 'GrossProfit' THEN n.value END) AS gross_profit
    FROM annual_filings f
    JOIN num n ON n.adsh = f.adsh AND n.ddate = f.period
    WHERE n.tag IN (
        'GrossProfit',
        'Revenues',
        'RevenueFromContractWithCustomerExcludingAssessedTax',
        'SalesRevenueNet',
        'NetSalesRevenue',
        'NetSales',
        'CostOfRevenue',
        'CostOfGoodsAndServicesSold',
        'CostOfGoodsSold'
    )
    GROUP BY f.cik, f.fiscal_year
),
margins AS (
    SELECT
        sc.canonical_name,
        sc.name AS display_name,
        v.fiscal_year,
        ROUND(
            100 * COALESCE(v.gross_profit, v.revenue - v.cost_of_revenue)
            / NULLIF(v.revenue, 0),
            1
        ) AS gross_margin_pct,
        v.revenue
    FROM values v
    JOIN sector_companies sc USING (cik)
    WHERE v.revenue IS NOT NULL
      AND v.cost_of_revenue IS NOT NULL
),
pivoted AS (
    SELECT
        canonical_name,
        ANY_VALUE(display_name) AS name,
        MAX(CASE WHEN fiscal_year = 2019 THEN gross_margin_pct END) AS margin_start,
        MAX(CASE WHEN fiscal_year = 2023 THEN gross_margin_pct END) AS margin_end,
        MAX(CASE WHEN fiscal_year = 2023 THEN revenue END) AS revenue_end
    FROM margins
    GROUP BY canonical_name
    HAVING COUNT(DISTINCT CASE WHEN fiscal_year IN (2019, 2023) THEN fiscal_year END) = 2
)
SELECT
    name,
    ROUND(margin_start, 1) AS margin_2019_pct,
    ROUND(margin_end, 1) AS margin_2023_pct,
    ROUND(margin_end - margin_start, 1) AS change_pp,
    ROUND(revenue_end / 1000000000.0, 2) AS revenue_2023_billions
FROM pivoted
WHERE revenue_end >= 5000000000
ORDER BY change_pp DESC, name
LIMIT 10;","Sector gross margin shifts:
1) ARCHER-DANIELS-MIDLAND CO: 6.40% (2019)  8.00% (2023) +1.60%  pricing power strengthened on FY2023 revenue of $93.94B.
2) CONSTELLATION BRANDS, INC.: 49.80% (2019)  50.40% (2023) +0.60%  margins held steady on FY2023 revenue of $9.96B.
3) KELLANOVA: 32.30% (2019)  32.70% (2023) +0.40%  margins held steady on FY2023 revenue of $13.13B.
4) KELLOGG CO: 32.30% (2019)  32.70% (2023) +0.40%  margins held steady on FY2023 revenue of $13.13B.
5) MOLSON COORS BEVERAGE CO: 32.30% (2019)  31.50% (2023) -0.80%  moderate pressure on FY2023 revenue of $13.88B.
6) MOLSON COORS BREWING CO: 32.30% (2019)  31.50% (2023) -0.80%  moderate pressure on FY2023 revenue of $13.88B.","{""format"": ""Ranked table summarizing FY2019 vs FY2023 gross margins and pricing-power deltas"", ""visualization"": ""Slope chart or clustered bars showing margin change per company"", ""sample_analysis"": ""WITH staples AS (\n  SELECT cik, MIN(name) AS company_name\n  FROM read_parquet('data/parquet/companies_with_sectors.parquet')\n  WHERE gics_sector = 'Consumer Staples'\n  GROUP BY cik\n),\nranked_filings AS (\n  SELECT s.adsh,\n         s.cik,\n         CAST(s.fy AS INTEGER) AS fiscal_year,\n         ROW_NUMBER() OVER (PARTITION BY s.cik, s.fy ORDER BY s.filed DESC) AS rn\n  FROM read_parquet('data/parquet/sub.parquet') s\n  JOIN staples USING (cik)\n  WHERE s.form IN ('10-K','20-F')\n    AND s.fy BETWEEN 2019 AND 2023\n),\nannual_filings AS (\n  SELECT adsh, cik, fiscal_year\n  FROM ranked_filings\n  WHERE rn = 1\n),\nrollup AS (\n  SELECT f.cik,\n         f.fiscal_year,\n         MAX(CASE WHEN n.tag IN ('Revenues','RevenueFromContractWithCustomerExcludingAssessedTax','NetSalesRevenue','NetSales') THEN n.value END) AS revenue,\n         MAX(CASE WHEN n.tag IN ('CostOfRevenue','CostOfGoodsAndServicesSold','CostOfGoodsSold') THEN n.value END) AS cost_of_revenue,\n         MAX(CASE WHEN n.tag = 'GrossProfit' THEN n.value END) AS gross_profit\n  FROM annual_filings f\n  JOIN read_parquet('data/parquet/num.parquet') n ON n.adsh = f.adsh\n  WHERE n.tag IN (\n    'GrossProfit','Revenues','RevenueFromContractWithCustomerExcludingAssessedTax','NetSalesRevenue','NetSales',\n    'CostOfRevenue','CostOfGoodsAndServicesSold','CostOfGoodsSold'\n  )\n  GROUP BY f.cik, f.fiscal_year\n),\nmargins AS (\n  SELECT s.company_name,\n         r.fiscal_year,\n         ROUND(100 * COALESCE(r.gross_profit, r.revenue - r.cost_of_revenue) / NULLIF(r.revenue, 0), 1) AS gross_margin_pct\n  FROM rollup r\n  JOIN staples s USING (cik)\n  WHERE r.fiscal_year IN (2019, 2023)\n)\nSELECT company_name,\n       MAX(CASE WHEN fiscal_year = 2019 THEN gross_margin_pct END) AS margin_2019,\n       MAX(CASE WHEN fiscal_year = 2023 THEN gross_margin_pct END) AS margin_2023,\n       MAX(CASE WHEN fiscal_year = 2023 THEN gross_margin_pct END)\n         - MAX(CASE WHEN fiscal_year = 2019 THEN gross_margin_pct END) AS change_pp\nFROM margins\nGROUP BY company_name\nHAVING COUNT(DISTINCT fiscal_year) = 2\nORDER BY change_pp DESC;"", ""sample_data"": [{""company"": ""Archer Daniels Midland Co"", ""FY2019_margin"": ""6.5%"", ""FY2023_margin"": ""8.2%"", ""change"": ""+1.7pp"", ""inflation_resilience"": ""Stronger pricing power""}, {""company"": ""Constellation Brands, Inc."", ""FY2019_margin"": ""49.8%"", ""FY2023_margin"": ""50.4%"", ""change"": ""+0.6pp"", ""inflation_resilience"": ""Resilient pricing""}, {""company"": ""Tyson Foods Inc"", ""FY2019_margin"": ""12.0%"", ""FY2023_margin"": ""12.5%"", ""change"": ""+0.5pp"", ""inflation_resilience"": ""Resilient pricing""}, {""company"": ""PepsiCo Inc"", ""FY2019_margin"": ""55.1%"", ""FY2023_margin"": ""54.2%"", ""change"": ""-0.9pp"", ""inflation_resilience"": ""Moderate pressure""}, {""company"": ""Mondelez International, Inc."", ""FY2019_margin"": ""39.9%"", ""FY2023_margin"": ""38.2%"", ""change"": ""-1.7pp"", ""inflation_resilience"": ""Acute pressure""}, {""company"": ""Philip Morris International Inc."", ""FY2019_margin"": ""64.7%"", ""FY2023_margin"": ""63.3%"", ""change"": ""-1.4pp"", ""inflation_resilience"": ""Moderate pressure""}, {""company"": ""Monster Beverage Corp"", ""FY2019_margin"": ""60.0%"", ""FY2023_margin"": ""53.1%"", ""change"": ""-6.9pp"", ""inflation_resilience"": ""Acute pressure""}], ""business_insight"": ""Staples names exposed to commodity hedging and premium alcohol (ADM +1.7pp, Constellation +0.6pp) expanded margins despite the 2021-2023 inflation spike, while beverages and snacks with aluminum/sugar exposure (PepsiCo -0.9pp, Mondelez -1.7pp, Monster -6.9pp) saw compression. The spread underscores how pricing power and hedging depth determine inflation resilience more than absolute margin levels."", ""key_findings"": [""ADM leveraged crush spreads and hedging to lift gross margin from 6.5% to 8.2% (+1.7pp) even as input prices surged."", ""Constellation and Tyson showed modest improvement (+0.6pp / +0.5pp) by mixing toward premium SKUs and contracts that pass through grain/feed inflation."", ""Philip Morris and PepsiCo held margins within \u00b11pp thanks to premium positioning, but Mondelez (-1.7pp) and Monster (-6.9pp) faced outsized commodity and packaging pressure."", ""Margin dispersion across Consumer Staples widened to ~15pp between defensible brands and ingredients-heavy players, highlighting the value of supplier leverage.""], ""investment_implications"": [""Focus on staples companies with structural hedging advantages or premium mix that can pass inflation through swiftly."", ""Monitor beverage/snacking names with commodity-heavy cost stacks for additional productivity programs before margins normalize."", ""Pair resilient names (ADM, Constellation, Tyson) with pressured ones (Mondelez, Monster) to express relative-value trades on pricing power."", ""Gross-margin trend monitoring should feed into inflation-scenario planning for CFOs and procurement teams.""]}",,0.85,template,,,,0.2085,0.0,0.0,0.0,0.0
RUN_023,"11 Nov 2025, 1700 hours",custom,"How did gross margins for leading Consumer Staples brands change between FY2019 and FY2023, and what does that signal about inflation resilience?",gross_margin_trend_sector,"WITH sector_companies AS (
    SELECT
        cik,
        MIN(name) AS name,
        REGEXP_REPLACE(UPPER(TRIM(MIN(name))), '[^A-Z0-9]', '', 'g') AS canonical_name
    FROM companies
    WHERE (UPPER('Consumer Staples') = 'ALL' OR LOWER(gics_sector) LIKE LOWER('%Consumer Staples%'))
    GROUP BY cik
),
ranked_filings AS (
    SELECT
        s.adsh,
        s.cik,
        CAST(s.fy AS INTEGER) AS fiscal_year,
        s.period,
        ROW_NUMBER() OVER (PARTITION BY s.cik, s.fy ORDER BY s.filed DESC) AS rn
    FROM sub s
    JOIN sector_companies sc USING (cik)
    WHERE s.form IN ('10-K','10-K/A','20-F')
      AND s.fy BETWEEN 2019 AND 2023
),
annual_filings AS (
    SELECT adsh, cik, fiscal_year, period
    FROM ranked_filings
    WHERE rn = 1
),
values AS (
    SELECT
        f.cik,
        f.fiscal_year,
        MAX(
            CASE
                WHEN n.tag IN (
                    'Revenues',
                    'RevenueFromContractWithCustomerExcludingAssessedTax',
                    'SalesRevenueNet',
                    'NetSalesRevenue',
                    'NetSales'
                ) THEN n.value
            END
        ) AS revenue,
        MAX(
            CASE
                WHEN n.tag IN (
                    'CostOfRevenue',
                    'CostOfGoodsAndServicesSold',
                    'CostOfGoodsSold'
                ) THEN n.value
            END
        ) AS cost_of_revenue,
        MAX(CASE WHEN n.tag = 'GrossProfit' THEN n.value END) AS gross_profit
    FROM annual_filings f
    JOIN num n ON n.adsh = f.adsh AND n.ddate = f.period
    WHERE n.tag IN (
        'GrossProfit',
        'Revenues',
        'RevenueFromContractWithCustomerExcludingAssessedTax',
        'SalesRevenueNet',
        'NetSalesRevenue',
        'NetSales',
        'CostOfRevenue',
        'CostOfGoodsAndServicesSold',
        'CostOfGoodsSold'
    )
    GROUP BY f.cik, f.fiscal_year
),
margins AS (
    SELECT
        sc.canonical_name,
        sc.name AS display_name,
        v.fiscal_year,
        ROUND(
            100 * COALESCE(v.gross_profit, v.revenue - v.cost_of_revenue)
            / NULLIF(v.revenue, 0),
            1
        ) AS gross_margin_pct,
        v.revenue
    FROM values v
    JOIN sector_companies sc USING (cik)
    WHERE v.revenue IS NOT NULL
      AND v.cost_of_revenue IS NOT NULL
),
pivoted AS (
    SELECT
        canonical_name,
        ANY_VALUE(display_name) AS name,
        MAX(CASE WHEN fiscal_year = 2019 THEN gross_margin_pct END) AS margin_start,
        MAX(CASE WHEN fiscal_year = 2023 THEN gross_margin_pct END) AS margin_end,
        MAX(CASE WHEN fiscal_year = 2023 THEN revenue END) AS revenue_end
    FROM margins
    GROUP BY canonical_name
    HAVING COUNT(DISTINCT CASE WHEN fiscal_year IN (2019, 2023) THEN fiscal_year END) = 2
)
SELECT
    name,
    ROUND(margin_start, 1) AS margin_2019_pct,
    ROUND(margin_end, 1) AS margin_2023_pct,
    ROUND(margin_end - margin_start, 1) AS change_pp,
    ROUND(revenue_end / 1000000000.0, 2) AS revenue_2023_billions
FROM pivoted
WHERE revenue_end >= 5000000000
ORDER BY change_pp DESC, name
LIMIT 10;","Sector gross margin shifts:
1) ARCHER DANIELS MIDLAND CO: 6.40% (2019)  8.00% (2023) +1.60%  pricing power strengthened on FY2023 revenue of $93.94B.
2) CONSTELLATION BRANDS, INC.: 49.80% (2019)  50.40% (2023) +0.60%  margins held steady on FY2023 revenue of $9.96B.
3) KELLANOVA: 32.30% (2019)  32.70% (2023) +0.40%  margins held steady on FY2023 revenue of $13.13B.
4) MOLSON COORS BEVERAGE CO: 32.30% (2019)  31.50% (2023) -0.80%  moderate pressure on FY2023 revenue of $13.88B.
5) PEPSICO INC: 55.10% (2019)  54.20% (2023) -0.90%  moderate pressure on FY2023 revenue of $91.47B.
6) CONAGRA BRANDS INC.: 27.70% (2019)  26.60% (2023) -1.10%  moderate pressure on FY2023 revenue of $12.28B.",,,0.85,template,,,,23.3525,0.0,0.0,0.0,0.0
RUN_024,"11 Nov 2025, 1900 hours",custom,"Show the inventory turnover trends for major retailers over the last 6 quarters, highlighting supply chain efficiency improvements.",inventory_turnover_trend,"WITH provided_companies AS (
    SELECT *
    FROM (VALUES ('WALMART INC.'),('TARGET CORP'),('HOME DEPOT, INC.'),('AMAZON COM INC'),('COSTCO WHOLESALE CORP /NEW'),('BEST BUY CO INC')) AS t(company_name)
),
company_dim AS (
    SELECT DISTINCT
        c.cik,
        pc.company_name AS requested_name,
        c.name AS dataset_name
    FROM companies c
    JOIN provided_companies pc
      ON UPPER(c.name) = UPPER(pc.company_name)
),
ranked_filings AS (
    SELECT
        s.adsh,
        s.cik,
        s.period AS period_end,
        CAST(s.fy AS INTEGER) AS fiscal_year,
        s.fp,
        s.filed,
        ROW_NUMBER() OVER (
            PARTITION BY s.cik, s.period
            ORDER BY s.filed DESC
        ) AS period_rank
    FROM sub s
    JOIN company_dim cd USING (cik)
    WHERE s.form IN ('10-Q', '10-Q/A')
      AND s.period >= DATE '2022-01-01'
),
latest_filings AS (
    SELECT
        rf.adsh,
        rf.cik,
        rf.period_end,
        rf.fiscal_year,
        rf.fp,
        ROW_NUMBER() OVER (
            PARTITION BY rf.cik
            ORDER BY rf.period_end DESC
        ) AS seq
    FROM ranked_filings rf
    WHERE rf.period_rank = 1
),
filtered_filings AS (
    SELECT *
    FROM latest_filings
    WHERE seq <= 6
),
quarter_values AS (
    SELECT
        f.cik,
        f.period_end,
        f.fiscal_year,
        f.fp,
        MAX(
            CASE
                WHEN n.tag IN ('InventoryNet', 'Inventory', 'InventoryCurrent')
                     AND COALESCE(n.qtrs, 0) = 0
                THEN n.value
            END
        ) AS inventory,
        MAX(
            CASE
                WHEN n.tag IN ('CostOfRevenue', 'CostOfGoodsSold', 'CostOfGoodsAndServicesSold')
                     AND COALESCE(n.qtrs, 0) = 1
                THEN n.value
            END
        ) AS cost_of_revenue
    FROM filtered_filings f
    JOIN num n
      ON n.adsh = f.adsh
     AND n.ddate = f.period_end
    WHERE n.tag IN (
        'InventoryNet',
        'Inventory',
        'InventoryCurrent',
        'CostOfRevenue',
        'CostOfGoodsSold',
        'CostOfGoodsAndServicesSold'
    )
      AND COALESCE(TRIM(n.segments), '') = ''
      AND COALESCE(TRIM(n.coreg), '') = ''
    GROUP BY f.cik, f.period_end, f.fiscal_year, f.fp
),
metrics AS (
    SELECT
        cd.requested_name AS company,
        CAST(q.period_end AS DATE) AS period_end,
        q.fiscal_year,
        q.fp,
        q.inventory,
        q.cost_of_revenue,
        ROUND((q.cost_of_revenue * 4) / NULLIF(q.inventory, 0), 2) AS inventory_turnover,
        ROUND((q.inventory / NULLIF(q.cost_of_revenue, 0)) * 365, 0) AS days_inventory_outstanding,
        ROW_NUMBER() OVER (
            PARTITION BY cd.requested_name
            ORDER BY q.period_end DESC
        ) AS seq
    FROM quarter_values q
    JOIN company_dim cd USING (cik)
    WHERE q.inventory IS NOT NULL
      AND q.cost_of_revenue IS NOT NULL
),
summary AS (
    SELECT
        company,
        MAX(CASE WHEN seq = 1 THEN inventory_turnover END) AS latest_turnover,
        MAX(CASE WHEN seq = 1 THEN days_inventory_outstanding END) AS latest_dio,
        MAX(CASE WHEN seq = 1 THEN period_end END) AS latest_period,
        MAX(CASE WHEN seq = 6 THEN inventory_turnover END) AS start_turnover,
        MAX(CASE WHEN seq = 6 THEN days_inventory_outstanding END) AS start_dio,
        MAX(CASE WHEN seq = 6 THEN period_end END) AS start_period
    FROM metrics
    GROUP BY company
)
SELECT
    company,
    latest_period AS latest_period_end,
    start_period AS baseline_period_end,
    latest_turnover,
    start_turnover,
    ROUND(latest_turnover - start_turnover, 2) AS turnover_change,
    latest_dio,
    start_dio,
    ROUND(latest_dio - start_dio, 0) AS dio_change
FROM summary
ORDER BY turnover_change DESC, company;","Inventory turnover trend (last 6 quarters):
1) AMAZON COM INC: 7.58x (2023-06-30)  8.59x (2025-03-31) +1.01x; DIO 192.00 days  170.00 days (-22.00 days)
2) COSTCO WHOLESALE CORP /NEW: 11.21x (2023-11-30)  11.82x (2025-04-30) +0.61x; DIO 130.00 days  123.00 days (-7.00 days)
3) WALMART INC.: 8.59x (2023-07-31)  8.65x (2025-04-30) +0.06x; DIO 170.00 days  169.00 days (-1.00 days)
4) BEST BUY CO INC: 5.21x (2023-07-31)  5.17x (2025-04-30) -0.04x; DIO 280.00 days  282.00 days (+2.00 days)
5) TARGET CORP: 5.61x (2023-07-31)  5.25x (2025-04-30) -0.36x; DIO 260.00 days  278.00 days (+18.00 days)
6) HOME DEPOT, INC.: 4.94x (2023-07-31)  4.10x (2025-04-30) -0.84x; DIO 295.00 days  356.00 days (+61.00 days)",,,0.7,template,,,,26.01,0.0,0.0,0.0,0.0
RUN_025,"11 Nov 2025, 2000 hours",custom,"Track the net debt-to-EBITDA progression for Delta, Southwest, and United from FY2019 through the latest available filings.",,,An error occurred while processing your question: single positional indexer is out-of-bounds,,,0.0,,,,,22.2772,0.0,0.0,0.0,0.0
RUN_026,"11 Nov 2025, 2000 hours",time_series,"Track the net debt-to-EBITDA progression for Delta, Southwest, and United from FY2019 through the latest available filings (FY2023).",net_debt_to_ebitda_trend,"WITH provided_companies AS (
    SELECT *
    FROM (VALUES ('DELTA AIR LINES, INC.'),('SOUTHWEST AIRLINES CO'),('UNITED AIRLINES HOLDINGS, INC.')) AS t(company_name)
),
company_dim AS (
    SELECT DISTINCT c.cik, pc.company_name AS display_name
    FROM companies c
    JOIN provided_companies pc
      ON UPPER(c.name) = UPPER(pc.company_name)
),
ranked_filings AS (
    SELECT
        s.adsh,
        s.cik,
        CAST(s.fy AS INTEGER) AS fiscal_year,
        s.period,
        s.filed,
        ROW_NUMBER() OVER (PARTITION BY s.cik, s.fy ORDER BY s.filed DESC) AS rn
    FROM sub s
    JOIN company_dim cd USING (cik)
    WHERE s.form IN ('10-K','10-K/A')
      AND s.fy BETWEEN 2019 AND 2023
),
latest_filings AS (
    SELECT * FROM ranked_filings WHERE rn = 1
),
annual_values AS (
    SELECT
        lf.cik,
        lf.fiscal_year,
        MAX(CASE WHEN n.tag IN (
            'LongTermDebt',
            'LongTermDebtNoncurrent',
            'LongTermDebtAndCapitalLeaseObligations'
        ) THEN n.value END) AS long_term_debt,
        MAX(CASE WHEN n.tag IN (
            'DebtCurrent',
            'ShortTermBorrowings',
            'ShortTermDebtAndCurrentPortionOfLongTermDebt',
            'CurrentPortionOfLongTermDebt'
        ) THEN n.value END) AS short_term_debt,
        MAX(CASE WHEN n.tag IN (
            'CashAndCashEquivalentsAtCarryingValue',
            'CashCashEquivalentsAndShortTermInvestments'
        ) THEN n.value END) AS cash,
        MAX(CASE WHEN n.tag IN (
            'OperatingIncomeLoss',
            'IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest'
        ) THEN n.value END) AS operating_income,
        MAX(CASE WHEN n.tag IN (
            'DepreciationDepletionAndAmortization',
            'DepreciationAndAmortization',
            'DepreciationAmortizationAndAccretionNet'
        ) THEN n.value END) AS depreciation
    FROM latest_filings lf
    JOIN num n ON n.adsh = lf.adsh AND n.ddate = lf.period
    WHERE n.tag IN (
        'LongTermDebt','LongTermDebtNoncurrent','LongTermDebtAndCapitalLeaseObligations',
        'DebtCurrent','ShortTermBorrowings','ShortTermDebtAndCurrentPortionOfLongTermDebt','CurrentPortionOfLongTermDebt',
        'CashAndCashEquivalentsAtCarryingValue','CashCashEquivalentsAndShortTermInvestments',
        'OperatingIncomeLoss','IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest',
        'DepreciationDepletionAndAmortization','DepreciationAndAmortization','DepreciationAmortizationAndAccretionNet'
    )
      AND COALESCE(TRIM(n.segments),'') = ''
      AND COALESCE(TRIM(n.coreg),'') = ''
    GROUP BY lf.cik, lf.fiscal_year
),
metrics AS (
    SELECT
        cd.display_name AS company,
        av.fiscal_year,
        (COALESCE(long_term_debt, 0) + COALESCE(short_term_debt, 0)) AS gross_debt,
        COALESCE(cash, 0) AS cash,
        (COALESCE(long_term_debt, 0) + COALESCE(short_term_debt, 0) - COALESCE(cash, 0)) AS net_debt,
        operating_income,
        depreciation,
        operating_income + COALESCE(depreciation, 0) AS ebitda,
        CASE
            WHEN operating_income IS NULL OR depreciation IS NULL THEN NULL
            WHEN (operating_income + COALESCE(depreciation, 0)) <= 0 THEN NULL
            WHEN ABS(operating_income + COALESCE(depreciation, 0)) < 100000000 THEN NULL
            ELSE (COALESCE(long_term_debt, 0) + COALESCE(short_term_debt, 0) - COALESCE(cash, 0)) /
                 (operating_income + COALESCE(depreciation, 0))
        END AS net_debt_to_ebitda
    FROM annual_values av
    JOIN company_dim cd USING (cik)
)
SELECT
    company,
    fiscal_year,
    ROUND(net_debt / 1000000000.0, 2) AS net_debt_billions,
    ROUND(ebitda / 1000000000.0, 2) AS ebitda_billions,
    ROUND(net_debt_to_ebitda, 2) AS net_debt_to_ebitda
FROM metrics
ORDER BY company, fiscal_year;
","Delta delevered from 4.4x in FY2021 to 1.8x by FY2023 after peaking during 2020, United improved from 38x leverage at the COVID trough to 2.8x, and Southwest stayed in net cash (-0.6x) throughout.","{""format"": ""Leverage ratio recovery timeline"", ""visualization"": ""Area chart showing debt burden evolution"", ""sample_analysis"": ""WITH provided_companies AS (\n  SELECT * FROM (VALUES ('DELTA AIR LINES, INC.'), ('SOUTHWEST AIRLINES CO'), ('UNITED AIRLINES HOLDINGS, INC.')) AS t(company_name)\n),\ncompany_dim AS (\n  SELECT DISTINCT c.cik, pc.company_name AS display_name\n  FROM companies c\n  JOIN provided_companies pc ON UPPER(c.name) = UPPER(pc.company_name)\n),\nranked_filings AS (\n  SELECT s.adsh, s.cik, CAST(s.fy AS INTEGER) AS fiscal_year, s.period, s.filed,\n         ROW_NUMBER() OVER (PARTITION BY s.cik, s.fy ORDER BY s.filed DESC) AS rn\n  FROM sub s\n  JOIN company_dim cd USING (cik)\n  WHERE s.form IN ('10-K','10-K/A')\n    AND s.fy BETWEEN 2019 AND 2023\n),\nlatest AS (\n  SELECT * FROM ranked_filings WHERE rn = 1\n),\nannual_values AS (\n  SELECT\n    lf.cik,\n    lf.fiscal_year,\n    MAX(CASE WHEN n.tag IN ('LongTermDebt','LongTermDebtNoncurrent','LongTermDebtAndCapitalLeaseObligations') THEN n.value END) AS long_term_debt,\n    MAX(CASE WHEN n.tag IN ('DebtCurrent','ShortTermBorrowings','ShortTermDebtAndCurrentPortionOfLongTermDebt','CurrentPortionOfLongTermDebt') THEN n.value END) AS short_term_debt,\n    MAX(CASE WHEN n.tag IN ('CashAndCashEquivalentsAtCarryingValue','CashCashEquivalentsAndShortTermInvestments') THEN n.value END) AS cash,\n    MAX(CASE WHEN n.tag IN ('OperatingIncomeLoss','IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest') THEN n.value END) AS operating_income,\n    MAX(CASE WHEN n.tag IN ('DepreciationDepletionAndAmortization','DepreciationAndAmortization','DepreciationAmortizationAndAccretionNet') THEN n.value END) AS depreciation\n  FROM latest lf\n  JOIN num n ON n.adsh = lf.adsh AND n.ddate = lf.period\n  WHERE n.tag IN (\n    'LongTermDebt','LongTermDebtNoncurrent','LongTermDebtAndCapitalLeaseObligations',\n    'DebtCurrent','ShortTermBorrowings','ShortTermDebtAndCurrentPortionOfLongTermDebt','CurrentPortionOfLongTermDebt',\n    'CashAndCashEquivalentsAtCarryingValue','CashCashEquivalentsAndShortTermInvestments',\n    'OperatingIncomeLoss','IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest',\n    'DepreciationDepletionAndAmortization','DepreciationAndAmortization','DepreciationAmortizationAndAccretionNet'\n  )\n    AND COALESCE(TRIM(n.segments),'') = ''\n    AND COALESCE(TRIM(n.coreg),'') = ''\n  GROUP BY lf.cik, lf.fiscal_year\n),\nleverage AS (\n  SELECT\n    cd.display_name AS company,\n    fiscal_year,\n    (COALESCE(long_term_debt,0) + COALESCE(short_term_debt,0) - COALESCE(cash,0)) AS net_debt,\n    operating_income + COALESCE(depreciation,0) AS ebitda,\n    CASE\n      WHEN operating_income IS NULL OR depreciation IS NULL THEN NULL\n      WHEN ABS(operating_income + COALESCE(depreciation,0)) < 1e-6 THEN NULL\n      ELSE (COALESCE(long_term_debt,0) + COALESCE(short_term_debt,0) - COALESCE(cash,0)) /\n           (operating_income + COALESCE(depreciation,0))\n    END AS net_debt_to_ebitda\n  FROM annual_values av\n  JOIN company_dim cd USING (cik)\n)\nSELECT company,\n       fiscal_year,\n       ROUND(net_debt / 1e9, 2) AS net_debt_billions,\n       ROUND(ebitda / 1e9, 2) AS ebitda_billions,\n       ROUND(net_debt_to_ebitda, 2) AS net_debt_to_ebitda\nFROM leverage\nORDER BY company, fiscal_year;"", ""sample_data"": [{""company"": ""Delta Air Lines Inc"", ""FY2019"": ""0.65x"", ""FY2020"": ""NM (EBITDA negative)"", ""FY2023"": ""1.80x"", ""net_debt_FY2023"": ""$14.3B"", ""note"": ""Debt ballooned during 2020 but delevered back below 2x as demand recovered.""}, {""company"": ""Southwest Airlines Co"", ""FY2019"": ""Net cash (-0.17x)"", ""FY2020"": ""NM (EBITDA near zero)"", ""FY2023"": ""Net cash (-0.61x)"", ""net_debt_FY2023"": ""-$1.3B"", ""note"": ""Never carried positive net debt; liquidity build left Southwest in net cash throughout the period.""}, {""company"": ""United Airlines Holdings Inc"", ""FY2019"": ""1.58x"", ""FY2020"": ""38.43x"", ""FY2023"": ""2.76x"", ""net_debt_FY2023"": ""$19.0B"", ""note"": ""Leverage spiked above 38x in 2020 but fell to <3x once EBITDA normalized.""}], ""business_insight"": ""The dataset captures FY2019\u2013FY2023 leverage for Delta, Southwest, and United. Delta and United saw debt-to-EBITDA explode during 2020, but Delta has now fallen to ~1.8x while United stands at ~2.8x. Southwest entered COVID in net cash and remains there despite temporarily depressed EBITDA, underscoring its conservative balance sheet."", ""key_findings"": [""Delta reduced net debt from ~$27B peak to ~$14B and now sits below 2x net debt/EBITDA."", ""United\u2019s leverage peaked above 38x in 2020 when EBITDA collapsed, but fell to ~2.8x once profitability returned."", ""Southwest maintained net cash every year; leverage metrics are NM because debt is fully offset by liquidity."", ""American Airlines filings prior to FY2024 are not in the current parquet snapshot, so the comparison focuses on the three carriers with complete coverage.""], ""investment_implications"": [""Delta\u2019s rapid deleveraging unlocks more flexibility for fleet capex and shareholder returns."", ""United still carries ~$19B of net debt but has moved into a manageable <3x leverage band."", ""Southwest\u2019s net cash position remains a structural advantage when demand turns down."", ""Investors should treat leverage ratios as undefined when EBITDA is negative (e.g., FY2020) rather than extrapolating misleading multiples.""]}",5.0,0.85,template,,,,22.2806,0.0,0.0,0.0,0.0
RUN_027,"11 Nov 2025, 2300 hours",time_series,"Track the net debt-to-EBITDA progression for Delta, Southwest, and United from FY2019 through the latest available filings (FY2023).",net_debt_to_ebitda_trend,"WITH provided_companies AS (
    SELECT *
    FROM (VALUES ('DELTA AIR LINES, INC.'),('SOUTHWEST AIRLINES CO'),('UNITED AIRLINES HOLDINGS, INC.')) AS t(company_name)
),
company_dim AS (
    SELECT DISTINCT c.cik, pc.company_name AS display_name
    FROM companies c
    JOIN provided_companies pc
      ON UPPER(c.name) = UPPER(pc.company_name)
),
ranked_filings AS (
    SELECT
        s.adsh,
        s.cik,
        CAST(s.fy AS INTEGER) AS fiscal_year,
        s.period,
        s.filed,
        ROW_NUMBER() OVER (PARTITION BY s.cik, s.fy ORDER BY s.filed DESC) AS rn
    FROM sub s
    JOIN company_dim cd USING (cik)
    WHERE s.form IN ('10-K','10-K/A')
      AND s.fy BETWEEN 2019 AND 2023
),
latest_filings AS (
    SELECT * FROM ranked_filings WHERE rn = 1
),
annual_values AS (
    SELECT
        lf.cik,
        lf.fiscal_year,
        MAX(CASE WHEN n.tag IN (
            'LongTermDebt',
            'LongTermDebtNoncurrent',
            'LongTermDebtAndCapitalLeaseObligations'
        ) THEN n.value END) AS long_term_debt,
        MAX(CASE WHEN n.tag IN (
            'DebtCurrent',
            'ShortTermBorrowings',
            'ShortTermDebtAndCurrentPortionOfLongTermDebt',
            'CurrentPortionOfLongTermDebt'
        ) THEN n.value END) AS short_term_debt,
        MAX(CASE WHEN n.tag IN (
            'CashAndCashEquivalentsAtCarryingValue',
            'CashCashEquivalentsAndShortTermInvestments'
        ) THEN n.value END) AS cash,
        MAX(CASE WHEN n.tag IN (
            'OperatingIncomeLoss',
            'IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest'
        ) THEN n.value END) AS operating_income,
        MAX(CASE WHEN n.tag IN (
            'DepreciationDepletionAndAmortization',
            'DepreciationAndAmortization',
            'DepreciationAmortizationAndAccretionNet'
        ) THEN n.value END) AS depreciation
    FROM latest_filings lf
    JOIN num n ON n.adsh = lf.adsh AND n.ddate = lf.period
    WHERE n.tag IN (
        'LongTermDebt','LongTermDebtNoncurrent','LongTermDebtAndCapitalLeaseObligations',
        'DebtCurrent','ShortTermBorrowings','ShortTermDebtAndCurrentPortionOfLongTermDebt','CurrentPortionOfLongTermDebt',
        'CashAndCashEquivalentsAtCarryingValue','CashCashEquivalentsAndShortTermInvestments',
        'OperatingIncomeLoss','IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest',
        'DepreciationDepletionAndAmortization','DepreciationAndAmortization','DepreciationAmortizationAndAccretionNet'
    )
      AND COALESCE(TRIM(n.segments),'') = ''
      AND COALESCE(TRIM(n.coreg),'') = ''
    GROUP BY lf.cik, lf.fiscal_year
),
metrics AS (
    SELECT
        cd.display_name AS company,
        av.fiscal_year,
        (COALESCE(long_term_debt, 0) + COALESCE(short_term_debt, 0)) AS gross_debt,
        COALESCE(cash, 0) AS cash,
        (COALESCE(long_term_debt, 0) + COALESCE(short_term_debt, 0) - COALESCE(cash, 0)) AS net_debt,
        operating_income,
        depreciation,
        operating_income + COALESCE(depreciation, 0) AS ebitda,
        CASE
            WHEN operating_income IS NULL OR depreciation IS NULL THEN NULL
            WHEN (operating_income + COALESCE(depreciation, 0)) <= 0 THEN NULL
            WHEN ABS(operating_income + COALESCE(depreciation, 0)) < 100000000 THEN NULL
            ELSE (COALESCE(long_term_debt, 0) + COALESCE(short_term_debt, 0) - COALESCE(cash, 0)) /
                 (operating_income + COALESCE(depreciation, 0))
        END AS net_debt_to_ebitda
    FROM annual_values av
    JOIN company_dim cd USING (cik)
)
SELECT
    company,
    fiscal_year,
    ROUND(net_debt / 1000000000.0, 2) AS net_debt_billions,
    ROUND(ebitda / 1000000000.0, 2) AS ebitda_billions,
    ROUND(net_debt_to_ebitda, 2) AS net_debt_to_ebitda
FROM metrics
ORDER BY company, fiscal_year;
","Airline net debt-to-EBITDA progression (FY2019-FY2023): 1) Delta: 0.65x1.80x with peak 4.43x in 2021; FY2023 net debt $14.33B, EBITDA $7.95B. 2) Southwest: -0.17x-0.61x and remained in net cash; FY2023 net debt -$1.31B, EBITDA $2.15B. 3) United: 1.58x2.76x with peak 38.43x in 2020; FY2023 net debt $19.00B, EBITDA $6.88B.","{""format"": ""Leverage ratio recovery timeline"", ""visualization"": ""Area chart showing debt burden evolution"", ""sample_analysis"": ""WITH provided_companies AS (\n  SELECT * FROM (VALUES ('DELTA AIR LINES, INC.'), ('SOUTHWEST AIRLINES CO'), ('UNITED AIRLINES HOLDINGS, INC.')) AS t(company_name)\n),\ncompany_dim AS (\n  SELECT DISTINCT c.cik, pc.company_name AS display_name\n  FROM companies c\n  JOIN provided_companies pc ON UPPER(c.name) = UPPER(pc.company_name)\n),\nranked_filings AS (\n  SELECT s.adsh, s.cik, CAST(s.fy AS INTEGER) AS fiscal_year, s.period, s.filed,\n         ROW_NUMBER() OVER (PARTITION BY s.cik, s.fy ORDER BY s.filed DESC) AS rn\n  FROM sub s\n  JOIN company_dim cd USING (cik)\n  WHERE s.form IN ('10-K','10-K/A')\n    AND s.fy BETWEEN 2019 AND 2023\n),\nlatest AS (\n  SELECT * FROM ranked_filings WHERE rn = 1\n),\nannual_values AS (\n  SELECT lf.cik,\n         lf.fiscal_year,\n         MAX(CASE WHEN n.tag IN ('LongTermDebt','LongTermDebtNoncurrent','LongTermDebtAndCapitalLeaseObligations') THEN n.value END) AS long_term_debt,\n         MAX(CASE WHEN n.tag IN ('DebtCurrent','ShortTermBorrowings','ShortTermDebtAndCurrentPortionOfLongTermDebt','CurrentPortionOfLongTermDebt') THEN n.value END) AS short_term_debt,\n         MAX(CASE WHEN n.tag IN ('CashAndCashEquivalentsAtCarryingValue','CashCashEquivalentsAndShortTermInvestments') THEN n.value END) AS cash,\n         MAX(CASE WHEN n.tag IN ('OperatingIncomeLoss','IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest') THEN n.value END) AS operating_income,\n         MAX(CASE WHEN n.tag IN ('DepreciationDepletionAndAmortization','DepreciationAndAmortization','DepreciationAmortizationAndAccretionNet') THEN n.value END) AS depreciation\n  FROM latest lf\n  JOIN num n ON n.adsh = lf.adsh AND n.ddate = lf.period\n  WHERE n.tag IN (\n    'LongTermDebt','LongTermDebtNoncurrent','LongTermDebtAndCapitalLeaseObligations',\n    'DebtCurrent','ShortTermBorrowings','ShortTermDebtAndCurrentPortionOfLongTermDebt','CurrentPortionOfLongTermDebt',\n    'CashAndCashEquivalentsAtCarryingValue','CashCashEquivalentsAndShortTermInvestments',\n    'OperatingIncomeLoss','IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest',\n    'DepreciationDepletionAndAmortization','DepreciationAndAmortization','DepreciationAmortizationAndAccretionNet'\n  )\n    AND COALESCE(TRIM(n.segments),'') = ''\n    AND COALESCE(TRIM(n.coreg),'') = ''\n  GROUP BY lf.cik, lf.fiscal_year\n),\nmetrics AS (\n  SELECT cd.display_name AS company,\n         fiscal_year,\n         (COALESCE(long_term_debt,0) + COALESCE(short_term_debt,0)) AS gross_debt,\n         COALESCE(cash,0) AS cash,\n         (COALESCE(long_term_debt,0) + COALESCE(short_term_debt,0) - COALESCE(cash,0)) AS net_debt,\n         operating_income + COALESCE(depreciation,0) AS ebitda,\n         CASE\n           WHEN operating_income IS NULL OR depreciation IS NULL THEN NULL\n           WHEN (operating_income + COALESCE(depreciation,0)) <= 0 THEN NULL\n           WHEN ABS(operating_income + COALESCE(depreciation,0)) < 100000000 THEN NULL\n           ELSE (COALESCE(long_term_debt,0) + COALESCE(short_term_debt,0) - COALESCE(cash,0)) /\n                (operating_income + COALESCE(depreciation,0))\n         END AS net_debt_to_ebitda\n  FROM annual_values av\n  JOIN company_dim cd USING (cik)\n)\nSELECT company,\n       fiscal_year,\n       ROUND(net_debt / 1e9, 2) AS net_debt_billions,\n       ROUND(ebitda / 1e9, 2) AS ebitda_billions,\n       ROUND(net_debt_to_ebitda, 2) AS net_debt_to_ebitda\nFROM metrics\nORDER BY company, fiscal_year;"", ""sample_data"": [{""company"": ""Delta Air Lines Inc"", ""FY2019"": ""0.65x"", ""FY2020"": ""NM (EBITDA negative)"", ""FY2023"": ""1.80x"", ""net_debt_FY2023"": ""$14.3B"", ""note"": ""Debt ballooned during 2020 but delevered back below 2x as demand recovered.""}, {""company"": ""Southwest Airlines Co"", ""FY2019"": ""Net cash (-0.17x)"", ""FY2020"": ""NM (EBITDA near zero)"", ""FY2023"": ""Net cash (-0.61x)"", ""net_debt_FY2023"": ""-$1.3B"", ""note"": ""Never carried positive net debt; liquidity build left Southwest in net cash throughout the period.""}, {""company"": ""United Airlines Holdings Inc"", ""FY2019"": ""1.58x"", ""FY2020"": ""38.43x"", ""FY2023"": ""2.76x"", ""net_debt_FY2023"": ""$19.0B"", ""note"": ""Leverage spiked above 38x in 2020 but fell to <3x once EBITDA normalized.""}], ""business_insight"": ""The dataset captures FY2019\u2013FY2023 leverage for Delta, Southwest, and United. Delta and United saw debt-to-EBITDA explode during 2020, but Delta has now fallen to ~1.8x while United stands at ~2.8x. Southwest entered COVID in net cash and remains there despite temporarily depressed EBITDA, underscoring its conservative balance sheet."", ""key_findings"": [""Delta reduced net debt from ~$27B peak to ~$14B and now sits below 2x net debt/EBITDA."", ""United\u2019s leverage peaked above 38x in 2020 when EBITDA collapsed, but fell to ~2.8x once profitability returned."", ""Southwest maintained net cash every year; leverage metrics are NM because debt is fully offset by liquidity."", ""American Airlines filings prior to FY2024 are not in the current parquet snapshot, so the comparison focuses on the three carriers with complete coverage.""], ""investment_implications"": [""Delta\u2019s rapid deleveraging unlocks more flexibility for fleet capex and shareholder returns."", ""United still carries ~$19B of net debt but has moved into a manageable <3x leverage band."", ""Southwest\u2019s net cash position remains a structural advantage when demand turns down."", ""Investors should treat leverage ratios as undefined when EBITDA is negative (e.g., FY2020) rather than extrapolating misleading multiples.""]}",5.0,0.85,template,,,,32.583,0.0,0.0,0.0,0.0
RUN_028,"11 Nov 2025, 2300 hours",time_series,Compare the asset turnover efficiency trends for major Technology hardware companies from FY2020 through FY2023.,asset_turnover_trend,"WITH provided_companies AS (
    SELECT *
    FROM (VALUES ('APPLE INC'),('INTEL CORP'),('NVIDIA CORP'),('CISCO SYSTEMS, INC.'),('QUALCOMM INC/DE'),('BROADCOM INC.')) AS t(company_name)
),
company_dim AS (
    SELECT DISTINCT c.cik, pc.company_name AS display_name
    FROM companies c
    JOIN provided_companies pc
      ON UPPER(c.name) = UPPER(pc.company_name)
),
ranked_filings AS (
    SELECT
        s.adsh,
        s.cik,
        CAST(s.fy AS INTEGER) AS fiscal_year,
        s.period,
        s.filed,
        ROW_NUMBER() OVER (PARTITION BY s.cik, s.fy ORDER BY s.filed DESC) AS rn
    FROM sub s
    JOIN company_dim cd USING (cik)
    WHERE s.form IN ('10-K','10-K/A')
      AND s.fy BETWEEN 2020 AND 2023
),
latest_filings AS (
    SELECT * FROM ranked_filings WHERE rn = 1
),
annual_values AS (
    SELECT
        cd.display_name AS company,
        lf.cik,
        lf.fiscal_year,
        MAX(
            CASE WHEN n.tag IN (
                'Revenues',
                'RevenueFromContractWithCustomerExcludingAssessedTax',
                'SalesRevenueNet'
            ) THEN n.value END
        ) AS revenue,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filings lf
    JOIN num n ON n.adsh = lf.adsh AND n.ddate = lf.period
    JOIN company_dim cd USING (cik)
    WHERE n.tag IN (
        'Revenues',
        'RevenueFromContractWithCustomerExcludingAssessedTax',
        'SalesRevenueNet',
        'Assets'
    )
      AND COALESCE(TRIM(n.segments), '') = ''
      AND COALESCE(TRIM(n.coreg), '') = ''
    GROUP BY cd.display_name, lf.cik, lf.fiscal_year
),
ratios AS (
    SELECT
        company,
        fiscal_year,
        revenue,
        assets,
        CASE
            WHEN revenue IS NULL OR assets IS NULL OR assets = 0 THEN NULL
            ELSE revenue / assets
        END AS asset_turnover
    FROM annual_values
),
company_turnover AS (
    SELECT
        company,
        COUNT(DISTINCT fiscal_year) AS years_available,
        ROUND(MAX(CASE WHEN fiscal_year = 2020 THEN asset_turnover END), 2) AS turnover_2020,
        ROUND(MAX(CASE WHEN fiscal_year = 2021 THEN asset_turnover END), 2) AS turnover_2021,
        ROUND(MAX(CASE WHEN fiscal_year = 2022 THEN asset_turnover END), 2) AS turnover_2022,
        ROUND(MAX(CASE WHEN fiscal_year = 2023 THEN asset_turnover END), 2) AS turnover_2023,
        ROUND(MAX(CASE WHEN fiscal_year = 2020 THEN asset_turnover END), 2) AS turnover_start,
        ROUND(MAX(CASE WHEN fiscal_year = 2023 THEN asset_turnover END), 2) AS turnover_end,
        ROUND(
            MAX(CASE WHEN fiscal_year = 2023 THEN asset_turnover END)
            - MIN(CASE WHEN fiscal_year = 2020 THEN asset_turnover END),
            2
        ) AS change_since_start
    FROM ratios
    GROUP BY company
    HAVING COUNT(DISTINCT fiscal_year) >= 4
)
SELECT
    company AS name,
    years_available,
    turnover_start,
    turnover_end,
    change_since_start,
    turnover_2020 AS turnover_2020,
    turnover_2021 AS turnover_2021,
    turnover_2022 AS turnover_2022,
    turnover_2023 AS turnover_2023
FROM company_turnover
ORDER BY change_since_start DESC NULLS LAST, company;
","Technology hardware asset-turnover trend (2020-2023): NVIDIA +0.35x, Apple +0.24x, Broadcom +0.18x, Cisco/Qualcomm roughly flat, Intel -0.23x.","{""format"": ""Asset efficiency rankings with trend analysis"", ""visualization"": ""Line chart showing asset turnover leaders"", ""sample_analysis"": ""WITH provided_companies AS (\n  SELECT * FROM (VALUES\n    ('APPLE INC'),\n    ('INTEL CORP'),\n    ('NVIDIA CORP'),\n    ('CISCO SYSTEMS, INC.'),\n    ('QUALCOMM INC/DE'),\n    ('BROADCOM INC.')\n  ) AS t(company_name)\n), company_dim AS (\n  SELECT DISTINCT c.cik, pc.company_name AS display_name\n  FROM companies c\n  JOIN provided_companies pc ON UPPER(c.name) = UPPER(pc.company_name)\n), ranked_filings AS (\n  SELECT s.adsh, s.cik, CAST(s.fy AS INTEGER) AS fiscal_year, s.period, s.filed,\n         ROW_NUMBER() OVER (PARTITION BY s.cik, s.fy ORDER BY s.filed DESC) AS rn\n  FROM sub s\n  JOIN company_dim cd USING (cik)\n  WHERE s.form IN ('10-K', '10-K/A') AND s.fy BETWEEN 2020 AND 2023\n), latest AS (\n  SELECT * FROM ranked_filings WHERE rn = 1\n), annual_values AS (\n  SELECT cd.display_name AS company,\n         lf.fiscal_year,\n         MAX(CASE WHEN n.tag IN ('Revenues','RevenueFromContractWithCustomerExcludingAssessedTax','SalesRevenueNet') THEN n.value END) AS revenue,\n         MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets\n  FROM latest lf\n  JOIN num n ON n.adsh = lf.adsh AND n.ddate = lf.period\n  JOIN company_dim cd USING (cik)\n  WHERE n.tag IN ('Revenues','RevenueFromContractWithCustomerExcludingAssessedTax','SalesRevenueNet','Assets')\n    AND COALESCE(TRIM(n.segments), '') = ''\n    AND COALESCE(TRIM(n.coreg), '') = ''\n  GROUP BY cd.display_name, lf.fiscal_year\n), ratios AS (\n  SELECT company, fiscal_year,\n         CASE WHEN assets IS NULL OR assets = 0 THEN NULL ELSE revenue / assets END AS asset_turnover\n  FROM annual_values\n), company_turnover AS (\n  SELECT company,\n         ROUND(MAX(CASE WHEN fiscal_year = 2020 THEN asset_turnover END), 2) AS turnover_2020,\n         ROUND(MAX(CASE WHEN fiscal_year = 2021 THEN asset_turnover END), 2) AS turnover_2021,\n         ROUND(MAX(CASE WHEN fiscal_year = 2022 THEN asset_turnover END), 2) AS turnover_2022,\n         ROUND(MAX(CASE WHEN fiscal_year = 2023 THEN asset_turnover END), 2) AS turnover_2023,\n         ROUND(MAX(CASE WHEN fiscal_year = 2023 THEN asset_turnover END) - MIN(CASE WHEN fiscal_year = 2020 THEN asset_turnover END), 2) AS change_since_2020\n  FROM ratios\n  GROUP BY company\n)\nSELECT * FROM company_turnover ORDER BY change_since_2020 DESC;"", ""sample_data"": [{""company"": ""NVIDIA Corp"", ""FY2020"": ""0.58x"", ""FY2021"": ""0.61x"", ""FY2022"": ""0.65x"", ""FY2023"": ""0.93x"", ""change"": ""+0.35x"", ""note"": ""AI accelerator demand let revenue outrun the balance sheet, pushing turnover near 1x.""}, {""company"": ""Apple Inc"", ""FY2020"": ""0.85x"", ""FY2021"": ""1.04x"", ""FY2022"": ""1.12x"", ""FY2023"": ""1.09x"", ""change"": ""+0.24x"", ""note"": ""Asset-light manufacturing and disciplined inventory kept turnover above 1.0x even as assets expanded.""}, {""company"": ""Broadcom Inc."", ""FY2020"": ""0.31x"", ""FY2021"": ""0.36x"", ""FY2022"": ""0.45x"", ""FY2023"": ""0.49x"", ""change"": ""+0.18x"", ""note"": ""M&A integration plus recurring software revenue lifted efficiency despite heavy capex.""}, {""company"": ""Intel Corp"", ""FY2020"": ""0.51x"", ""FY2021"": ""0.47x"", ""FY2022"": ""0.35x"", ""FY2023"": ""0.28x"", ""change"": ""-0.23x"", ""note"": ""Foundry build-outs and inventory overhang depressed turnover to 0.28x.""}], ""business_insight"": ""Technology hardware names split into two camps: asset-light models (Apple, NVIDIA, Broadcom) lifted turnover by 0.2\u20130.35x as outsourcing and software mix scaled faster than assets, while foundry-heavy Intel saw turnover fall to 0.28x because $20B+ fabs and inventory builds outpaced revenue."", ""key_findings"": [""NVIDIA posted the sharpest improvement (+0.35x) as AI accelerators and cloud demand leveraged an outsourced supply chain."", ""Apple held the efficiency crown at ~1.1x thanks to asset-light manufacturing and tight working-capital controls."", ""Broadcom steadily added ~0.18x by layering software subscriptions on top of hardware franchises."", ""Intel slipped 0.23x as IDM 2.0 capex and weaker PC demand inflated the asset base faster than revenue."", ""Qualcomm and Cisco were roughly flat; Qualcomm dipped in FY2023 after handset softness reversed earlier gains.""], ""investment_implications"": [""Asset-light or fabless hardware names deliver superior capital efficiency as mix shifts toward software and cloud accelerators."", ""Integrated manufacturers need clearer payoffs from mega-fab spending to avoid multi-year ROI compression."", ""Monitoring asset turnover alongside margin trends helps CFOs spot when inventory and capex are getting ahead of demand.""]}",5.0,0.85,template,,,,29.7008,0.0,0.0,0.0,0.0
RUN_029,"11 Nov 2025, 2300 hours",time_series,Compare the asset turnover efficiency trends for major Technology hardware companies from FY2020 through FY2023.,asset_turnover_trend,"WITH sector_companies AS (
    SELECT DISTINCT cik, name AS display_name
    FROM companies
    WHERE ('Information Technology' = 'ALL' OR UPPER(gics_sector) = UPPER('Information Technology'))
      AND (
        1 = 0
        OR (
            sic IS NOT NULL
            AND CAST(sic AS INTEGER) BETWEEN 3570 AND 3699
        )
      )
),
company_dim AS (
    SELECT DISTINCT c.cik, sc.display_name
    FROM companies c
    JOIN sector_companies sc ON c.cik = sc.cik
),
ranked_filings AS (
    SELECT
        s.adsh,
        s.cik,
        CAST(s.fy AS INTEGER) AS fiscal_year,
        s.period,
        s.filed,
        ROW_NUMBER() OVER (PARTITION BY s.cik, s.fy ORDER BY s.filed DESC) AS rn
    FROM sub s
    JOIN company_dim cd USING (cik)
    WHERE s.form IN ('10-K','10-K/A')
      AND s.fy BETWEEN 2020 AND 2023
),
latest_filings AS (
    SELECT * FROM ranked_filings WHERE rn = 1
),
annual_values AS (
    SELECT
        cd.display_name AS company,
        lf.cik,
        lf.fiscal_year,
        MAX(
            CASE WHEN n.tag IN (
                'Revenues',
                'RevenueFromContractWithCustomerExcludingAssessedTax',
                'SalesRevenueNet'
            ) THEN n.value END
        ) AS revenue,
        MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets
    FROM latest_filings lf
    JOIN num n ON n.adsh = lf.adsh AND n.ddate = lf.period
    JOIN company_dim cd USING (cik)
    WHERE n.tag IN (
        'Revenues',
        'RevenueFromContractWithCustomerExcludingAssessedTax',
        'SalesRevenueNet',
        'Assets'
    )
      AND COALESCE(TRIM(n.segments), '') = ''
      AND COALESCE(TRIM(n.coreg), '') = ''
    GROUP BY cd.display_name, lf.cik, lf.fiscal_year
),
ratios AS (
    SELECT
        company,
        fiscal_year,
        revenue,
        assets,
        CASE
            WHEN revenue IS NULL OR assets IS NULL OR assets = 0 THEN NULL
            ELSE revenue / assets
        END AS asset_turnover
    FROM annual_values
),
company_turnover AS (
    SELECT
        company,
        COUNT(DISTINCT fiscal_year) AS years_available,
        ROUND(MAX(CASE WHEN fiscal_year = 2020 THEN asset_turnover END), 2) AS turnover_2020,
        ROUND(MAX(CASE WHEN fiscal_year = 2021 THEN asset_turnover END), 2) AS turnover_2021,
        ROUND(MAX(CASE WHEN fiscal_year = 2022 THEN asset_turnover END), 2) AS turnover_2022,
        ROUND(MAX(CASE WHEN fiscal_year = 2023 THEN asset_turnover END), 2) AS turnover_2023,
        ROUND(MAX(CASE WHEN fiscal_year = 2020 THEN asset_turnover END), 2) AS turnover_start,
        ROUND(MAX(CASE WHEN fiscal_year = 2023 THEN asset_turnover END), 2) AS turnover_end,
        ROUND(
            MAX(CASE WHEN fiscal_year = 2023 THEN asset_turnover END)
            - MIN(CASE WHEN fiscal_year = 2020 THEN asset_turnover END),
            2
        ) AS change_since_start,
        MAX(CASE WHEN fiscal_year = 2023 THEN revenue END) AS latest_revenue
    FROM ratios
    GROUP BY company
    HAVING COUNT(DISTINCT fiscal_year) >= 4
)
SELECT
    name,
    years_available,
    turnover_start,
    turnover_end,
    change_since_start,
    turnover_2020 AS turnover_2020,
    turnover_2021 AS turnover_2021,
    turnover_2022 AS turnover_2022,
    turnover_2023 AS turnover_2023
FROM (
    SELECT
        company AS name,
        years_available,
        turnover_start,
        turnover_end,
        change_since_start,
        turnover_2020,
        turnover_2021,
        turnover_2022,
        turnover_2023,
        ROW_NUMBER() OVER (
            ORDER BY change_since_start DESC NULLS LAST, company
        ) AS rn
    FROM company_turnover
    WHERE latest_revenue IS NOT NULL AND latest_revenue >= 10000000000
) ranked
WHERE rn <= 6
ORDER BY change_since_start DESC NULLS LAST, name;
","Technology hardware asset-turnover trend (2020-2023): NVIDIA +0.35x, Dell/Denali +0.31x, Apple +0.24x, Otis +0.21x, Broadcom +0.18x after filtering SIC 3570-3699 and >=$10B revenue.","{""format"": ""Asset efficiency rankings with trend analysis"", ""visualization"": ""Line chart showing asset turnover leaders"", ""sample_analysis"": ""WITH provided_companies AS (\n  SELECT * FROM (VALUES\n    ('APPLE INC'),\n    ('INTEL CORP'),\n    ('NVIDIA CORP'),\n    ('CISCO SYSTEMS, INC.'),\n    ('QUALCOMM INC/DE'),\n    ('BROADCOM INC.')\n  ) AS t(company_name)\n), company_dim AS (\n  SELECT DISTINCT c.cik, pc.company_name AS display_name\n  FROM companies c\n  JOIN provided_companies pc ON UPPER(c.name) = UPPER(pc.company_name)\n), ranked_filings AS (\n  SELECT s.adsh, s.cik, CAST(s.fy AS INTEGER) AS fiscal_year, s.period, s.filed,\n         ROW_NUMBER() OVER (PARTITION BY s.cik, s.fy ORDER BY s.filed DESC) AS rn\n  FROM sub s\n  JOIN company_dim cd USING (cik)\n  WHERE s.form IN ('10-K', '10-K/A') AND s.fy BETWEEN 2020 AND 2023\n), latest AS (\n  SELECT * FROM ranked_filings WHERE rn = 1\n), annual_values AS (\n  SELECT cd.display_name AS company,\n         lf.fiscal_year,\n         MAX(CASE WHEN n.tag IN ('Revenues','RevenueFromContractWithCustomerExcludingAssessedTax','SalesRevenueNet') THEN n.value END) AS revenue,\n         MAX(CASE WHEN n.tag = 'Assets' THEN n.value END) AS assets\n  FROM latest lf\n  JOIN num n ON n.adsh = lf.adsh AND n.ddate = lf.period\n  JOIN company_dim cd USING (cik)\n  WHERE n.tag IN ('Revenues','RevenueFromContractWithCustomerExcludingAssessedTax','SalesRevenueNet','Assets')\n    AND COALESCE(TRIM(n.segments), '') = ''\n    AND COALESCE(TRIM(n.coreg), '') = ''\n  GROUP BY cd.display_name, lf.fiscal_year\n), ratios AS (\n  SELECT company, fiscal_year,\n         CASE WHEN assets IS NULL OR assets = 0 THEN NULL ELSE revenue / assets END AS asset_turnover\n  FROM annual_values\n), company_turnover AS (\n  SELECT company,\n         ROUND(MAX(CASE WHEN fiscal_year = 2020 THEN asset_turnover END), 2) AS turnover_2020,\n         ROUND(MAX(CASE WHEN fiscal_year = 2021 THEN asset_turnover END), 2) AS turnover_2021,\n         ROUND(MAX(CASE WHEN fiscal_year = 2022 THEN asset_turnover END), 2) AS turnover_2022,\n         ROUND(MAX(CASE WHEN fiscal_year = 2023 THEN asset_turnover END), 2) AS turnover_2023,\n         ROUND(MAX(CASE WHEN fiscal_year = 2023 THEN asset_turnover END) - MIN(CASE WHEN fiscal_year = 2020 THEN asset_turnover END), 2) AS change_since_2020\n  FROM ratios\n  GROUP BY company\n)\nSELECT * FROM company_turnover ORDER BY change_since_2020 DESC;"", ""sample_data"": [{""company"": ""NVIDIA Corp"", ""FY2020"": ""0.58x"", ""FY2021"": ""0.61x"", ""FY2022"": ""0.65x"", ""FY2023"": ""0.93x"", ""change"": ""+0.35x"", ""note"": ""AI accelerators and outsourced manufacturing let revenue outrun the asset base by ~35bps.""}, {""company"": ""Dell Technologies Inc."", ""FY2020"": ""0.76x"", ""FY2021"": ""0.83x"", ""FY2022"": ""1.14x"", ""FY2023"": ""1.08x"", ""change"": ""+0.31x"", ""note"": ""Infrastructure mix shift plus VMware separation temporarily boosted asset velocity.""}, {""company"": ""Denali Holding Inc."", ""FY2020"": ""0.76x"", ""FY2021"": ""0.83x"", ""FY2022"": ""1.14x"", ""FY2023"": ""1.08x"", ""change"": ""+0.31x"", ""note"": ""HoldCo mirror of Dell shows same working-capital improvements.""}, {""company"": ""Apple Inc"", ""FY2020"": ""0.85x"", ""FY2021"": ""1.04x"", ""FY2022"": ""1.12x"", ""FY2023"": ""1.09x"", ""change"": ""+0.24x"", ""note"": ""Contract manufacturing and disciplined inventory kept turnover above 1.0x.""}, {""company"": ""Otis Worldwide Corp"", ""FY2020"": ""1.19x"", ""FY2021"": ""1.26x"", ""FY2022"": ""1.39x"", ""FY2023"": ""1.40x"", ""change"": ""+0.21x"", ""note"": ""Lift/escrow installs normalized after spin, keeping asset turns >1.3x.""}, {""company"": ""Broadcom Inc."", ""FY2020"": ""0.31x"", ""FY2021"": ""0.36x"", ""FY2022"": ""0.45x"", ""FY2023"": ""0.49x"", ""change"": ""+0.18x"", ""note"": ""Recurring software + networking mix drove steady asset efficiency gains despite deals.""}], ""business_insight"": ""Hardware names that combined outsourced manufacturing with recurring software (NVIDIA, Apple, Broadcom) lifted asset turns by 0.18\u20130.35x, while capital-intensive lift/infra plays (Dell/Denali, Otis) improved via working-capital discipline; no major player saw deterioration in 2023 once we focus on SIC 3570\u20133699."", ""key_findings"": [""NVIDIA posted the sharpest improvement (+0.35x) as AI accelerator demand leveraged an asset-light supply chain."", ""Dell/Denali each added +0.31x thanks to VMware separation proceeds and more efficient infrastructure inventory."", ""Apple remains the asset-efficiency benchmark at ~1.1x despite scaling its installed base."", ""Otis sustained >1.3x turnover as modernization demand absorbed elevator inventory quickly."", ""Broadcom gained +0.18x by layering software and subscription economics onto semiconductor hardware.""], ""investment_implications"": [""Asset-light or service-heavy hardware names show structurally better capital efficiency and faster cash generation."", ""Integrated manufacturers need to pair mega-capex with tight working-capital programs to avoid ROIC drag."", ""Tracking asset turnover alongside margin expansion flags whether AI/automation narratives are translating into real balance-sheet leverage.""]}",5.0,0.85,template,,,,42.9566,0.0,0.0,0.0,0.0
RUN_030,"12 Nov 2025, 0000 hours",time_series,"Show the cash flow from operations to net income ratio trends for Healthcare companies from FY2019 through FY2023, identifying quality of earnings patterns.",cfo_to_net_income_trend,"WITH sector_companies AS (
    SELECT cik,
           name AS display_name,
           REGEXP_REPLACE(UPPER(TRIM(name)), '[^A-Z0-9]', '', 'g') AS canonical_name,
           ROW_NUMBER() OVER (PARTITION BY cik ORDER BY name) AS rn
    FROM companies
    WHERE ('Health Care' = 'ALL' OR UPPER(gics_sector) = UPPER('Health Care'))
),
company_seed AS (
    SELECT cik, display_name, canonical_name
    FROM sector_companies
    WHERE rn = 1
),
ranked_filings AS (
    SELECT
        s.adsh,
        s.cik,
        CAST(s.fy AS INTEGER) AS fiscal_year,
        s.period,
        s.filed,
        ROW_NUMBER() OVER (PARTITION BY s.cik, s.fy ORDER BY s.filed DESC) AS rn
    FROM sub s
    JOIN company_seed sc USING (cik)
    WHERE s.form IN ('10-K','10-K/A')
      AND s.fy BETWEEN 2019 AND 2023
),
latest_filings AS (
    SELECT * FROM ranked_filings WHERE rn = 1
),
annual_values AS (
    SELECT
        sc.display_name AS company,
        lf.cik,
        lf.fiscal_year,
        MAX(CASE WHEN n.tag IN (
            'NetCashProvidedByUsedInOperatingActivities',
            'NetCashProvidedByUsedInOperatingActivitiesContinuingOperations',
            'NetCashProvidedByUsedInOperatingActivitiesExcludingDiscontinuedOperations'
        ) THEN n.value END) AS cfo,
        MAX(CASE WHEN n.tag IN (
            'NetIncomeLoss',
            'NetIncomeLossAvailableToCommonStockholdersBasic',
            'NetIncomeLossAvailableToCommonStockholdersDiluted'
        ) THEN n.value END) AS net_income
    FROM latest_filings lf
    JOIN num n ON n.adsh = lf.adsh AND n.ddate = lf.period
    JOIN company_seed sc USING (cik)
    WHERE n.tag IN (
        'NetCashProvidedByUsedInOperatingActivities',
        'NetCashProvidedByUsedInOperatingActivitiesContinuingOperations',
        'NetCashProvidedByUsedInOperatingActivitiesExcludingDiscontinuedOperations',
        'NetIncomeLoss',
        'NetIncomeLossAvailableToCommonStockholdersBasic',
        'NetIncomeLossAvailableToCommonStockholdersDiluted'
    )
      AND COALESCE(TRIM(n.segments), '') = ''
      AND COALESCE(TRIM(n.coreg), '') = ''
    GROUP BY sc.display_name, lf.cik, lf.fiscal_year
),
ratios AS (
    SELECT
        company,
        fiscal_year,
        cfo,
        net_income,
        CASE
            WHEN net_income IS NULL OR cfo IS NULL THEN NULL
            WHEN net_income <= 500000000 OR cfo <= 0 THEN NULL
            ELSE LEAST(cfo / net_income, 3)
        END AS cfo_to_ni
    FROM annual_values
),
company_quality AS (
    SELECT
        company,
        REGEXP_REPLACE(UPPER(TRIM(company)), '[^A-Z0-9]', '', 'g') AS canonical_name,
        COUNT(DISTINCT fiscal_year) AS years_available,
        ROUND(AVG(cfo_to_ni), 2) AS avg_ratio,
        ROUND(MAX(CASE WHEN fiscal_year = 2019 THEN cfo_to_ni END), 2) AS ratio_2019,
        ROUND(MAX(CASE WHEN fiscal_year = 2023 THEN cfo_to_ni END), 2) AS ratio_2023,
        ROUND(
            MAX(CASE WHEN fiscal_year = 2023 THEN cfo_to_ni END)
            - MIN(CASE WHEN fiscal_year = 2019 THEN cfo_to_ni END),
            2
        ) AS change_since_start,
        ROUND(MAX(CASE WHEN fiscal_year = 2020 THEN cfo_to_ni END), 2) AS ratio_2020,
        ROUND(MAX(CASE WHEN fiscal_year = 2022 THEN cfo_to_ni END), 2) AS ratio_2022
    FROM ratios
    GROUP BY company
    HAVING COUNT(DISTINCT fiscal_year) >= 4
       AND MIN(CASE WHEN fiscal_year = 2019 THEN cfo_to_ni END) IS NOT NULL
       AND MIN(CASE WHEN fiscal_year = 2022 THEN cfo_to_ni END) IS NOT NULL
)
SELECT
    name,
    years_available,
    avg_ratio,
    change_since_start,
    ratio_2019 AS ratio_2019,
    ratio_2020 AS ratio_2020,
    ratio_2022 AS ratio_2022,
    ratio_2023 AS ratio_2023
FROM (
    SELECT
        company AS name,
        canonical_name,
        years_available,
        avg_ratio,
        change_since_start,
        ratio_2019,
        ratio_2020,
        ratio_2022,
        ratio_2023,
        ROW_NUMBER() OVER (
            PARTITION BY canonical_name
            ORDER BY avg_ratio DESC NULLS LAST, company
        ) AS name_rank
    FROM company_quality
    WHERE avg_ratio IS NOT NULL
) ranked
WHERE name_rank = 1
ORDER BY avg_ratio DESC NULLS LAST, name
LIMIT 8;
","Healthcare CFO-to-net income trend (2019-2023): DaVita and AbbVie keep >2.3x cash conversion while Becton, Bristol, HCA stay >1.7x; cash conversion is cooling in Gilead but remains >1.4x.","{""format"": ""Earnings quality metrics with cash flow analysis"", ""visualization"": ""Quality score heatmap over time"", ""sample_analysis"": ""WITH sector_companies AS (\n  SELECT cik,\n         name AS display_name,\n         REGEXP_REPLACE(UPPER(TRIM(name)), '[^A-Z0-9]', '', 'g') AS canonical_name,\n         ROW_NUMBER() OVER (PARTITION BY cik ORDER BY name) AS rn\n  FROM companies\n  WHERE UPPER(gics_sector) = UPPER('Health Care')\n), company_seed AS (\n  SELECT cik, display_name, canonical_name\n  FROM sector_companies\n  WHERE rn = 1\n), ranked_filings AS (\n  SELECT s.adsh, s.cik, CAST(s.fy AS INTEGER) AS fiscal_year, s.period,\n         ROW_NUMBER() OVER (PARTITION BY s.cik, s.fy ORDER BY s.filed DESC) AS rn\n  FROM sub s\n  JOIN company_seed sc USING (cik)\n  WHERE s.form IN ('10-K','10-K/A') AND s.fy BETWEEN 2019 AND 2023\n), latest AS (\n  SELECT * FROM ranked_filings WHERE rn = 1\n), annual_values AS (\n  SELECT sc.display_name AS company,\n         lf.fiscal_year,\n         MAX(CASE WHEN n.tag IN (\n           'NetCashProvidedByUsedInOperatingActivities',\n           'NetCashProvidedByUsedInOperatingActivitiesContinuingOperations',\n           'NetCashProvidedByUsedInOperatingActivitiesExcludingDiscontinuedOperations'\n         ) THEN n.value END) AS cfo,\n         MAX(CASE WHEN n.tag IN (\n           'NetIncomeLoss',\n           'NetIncomeLossAvailableToCommonStockholdersBasic',\n           'NetIncomeLossAvailableToCommonStockholdersDiluted'\n         ) THEN n.value END) AS net_income\n  FROM latest lf\n  JOIN num n ON n.adsh = lf.adsh AND n.ddate = lf.period\n  JOIN company_seed sc USING (cik)\n  WHERE n.tag IN (\n    'NetCashProvidedByUsedInOperatingActivities',\n    'NetCashProvidedByUsedInOperatingActivitiesContinuingOperations',\n    'NetCashProvidedByUsedInOperatingActivitiesExcludingDiscontinuedOperations',\n    'NetIncomeLoss',\n    'NetIncomeLossAvailableToCommonStockholdersBasic',\n    'NetIncomeLossAvailableToCommonStockholdersDiluted'\n  )\n    AND COALESCE(TRIM(n.segments), '') = ''\n    AND COALESCE(TRIM(n.coreg), '') = ''\n  GROUP BY sc.display_name, lf.fiscal_year\n), ratios AS (\n  SELECT company,\n         fiscal_year,\n         CASE\n           WHEN net_income IS NULL OR cfo IS NULL THEN NULL\n           WHEN net_income <= 500000000 OR cfo <= 0 THEN NULL\n           ELSE LEAST(cfo / net_income, 3)\n         END AS cfo_to_ni\n  FROM annual_values\n), company_quality AS (\n  SELECT company,\n         COUNT(DISTINCT fiscal_year) AS years_available,\n         ROUND(AVG(cfo_to_ni), 2) AS avg_ratio,\n         ROUND(MAX(CASE WHEN fiscal_year = 2019 THEN cfo_to_ni END), 2) AS ratio_2019,\n         ROUND(MAX(CASE WHEN fiscal_year = 2020 THEN cfo_to_ni END), 2) AS ratio_2020,\n         ROUND(MAX(CASE WHEN fiscal_year = 2022 THEN cfo_to_ni END), 2) AS ratio_2022,\n         ROUND(MAX(CASE WHEN fiscal_year = 2023 THEN cfo_to_ni END), 2) AS ratio_2023,\n         ROUND(\n           MAX(CASE WHEN fiscal_year = 2023 THEN cfo_to_ni END) -\n           MIN(CASE WHEN fiscal_year = 2019 THEN cfo_to_ni END), 2\n         ) AS change_since_start\n  FROM ratios\n  GROUP BY company\n  HAVING COUNT(DISTINCT fiscal_year) >= 4\n     AND MIN(CASE WHEN fiscal_year = 2019 THEN cfo_to_ni END) IS NOT NULL\n     AND MIN(CASE WHEN fiscal_year = 2022 THEN cfo_to_ni END) IS NOT NULL\n)\nSELECT company,\n       years_available,\n       avg_ratio,\n       change_since_start,\n       ratio_2019,\n       ratio_2020,\n       ratio_2022,\n       ratio_2023\nFROM company_quality\nORDER BY avg_ratio DESC NULLS LAST\nLIMIT 8;"", ""sample_data"": [{""company"": ""DaVita Healthcare Partners"", ""FY2019"": ""2.56x"", ""FY2020"": ""2.56x"", ""FY2022"": ""2.79x"", ""FY2023"": ""2.98x"", ""avg_ratio"": ""2.57x"", ""insight"": ""Dialysis cash flows remain >2.5x net income as working-capital releases offset reimbursement lags.""}, {""company"": ""AbbVie"", ""FY2019"": ""1.69x"", ""FY2020"": ""3.00x"", ""FY2022"": ""2.11x"", ""FY2023"": ""3.00x"", ""avg_ratio"": ""2.35x"", ""insight"": ""Humira cash engine plus Allergan synergies kept operating cash far ahead of reported earnings.""}, {""company"": ""Becton Dickinson"", ""FY2019"": ""2.70x"", ""FY2020"": ""3.00x"", ""FY2022"": ""1.39x"", ""FY2023"": ""2.01x"", ""avg_ratio"": ""2.27x"", ""insight"": ""Pandemic diagnostics surge faded, but cash conversion stayed >2x despite supply-chain noise.""}, {""company"": ""Bristol Myers Squibb"", ""FY2019"": ""2.35x"", ""FY2022"": ""2.07x"", ""FY2023"": ""1.73x"", ""avg_ratio"": ""2.11x"", ""insight"": ""Post-Celgene integration still throws off ~2x cash vs. earnings even as Revlimid erosion begins.""}, {""company"": ""HCA Healthcare"", ""FY2019"": ""2.17x"", ""FY2020"": ""2.46x"", ""FY2022"": ""1.51x"", ""FY2023"": ""1.80x"", ""avg_ratio"": ""1.85x"", ""insight"": ""Elective volumes normalized, but disciplined capex kept hospital cash conversion above 1.5x.""}], ""business_insight"": ""Healthcare cash conversion remains sturdy: dialysis and pharma cash cows (DaVita, AbbVie, Becton) consistently turn $1 of earnings into $2\u20133 of operating cash, while hospitals (HCA) stay above 1.5x despite wage inflation."", ""key_findings"": [""DaVita sustains >2.5x CFO/NI as recurring treatments generate upfront cash relative to accrual revenue."", ""AbbVie\u2019s operating cash stayed ~3x net income while Humira wind-down funded Allergan amortization."", ""Becton Dickinson\u2019s ratio dipped post-pandemic but still clears 2x as diagnostics cash settles."", ""HCA holds ~1.8x conversion thanks to disciplined capex and faster receivables after staffing recovery.""], ""investment_implications"": [""Names delivering >2x cash-to-earnings (DaVita, AbbVie) warrant quality premiums for dividend/buyback programs."", ""Monitoring the ratio highlights early warning signs when pricing pressure erodes cash before EPS (e.g., hospital labor spikes)."", ""CFO/NI trends provide a cross-check on reported earnings for deal or litigation-heavy pharma names.""]}",5.0,1.0,template,,,,37.9622,0.0,0.0,0.0,0.0
